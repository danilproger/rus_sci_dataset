АЛГОРИТМ ВЫДЕЛЕНИЯ ТРЕНДА ЗАШУМЛЕННЫХ БОЛЬШИХ ВРЕМЕННЫХ РЯДОВ 

В работе предложен эффективный и точный метод нахождения тренда, фильтрации шумов и сглаживания больших нестационарных временных рядов. Показано, что тренды таких рядов могут быть определены при помощи вейвлет-пакетного преобразования совместно с сингулярно-спектральным анализом..

 Выделение тренда и сглаживание больших, порядка десятков тысяч значений, временных рядов является актуальной задачей. Для ее решения, предлагается применять сингулярный спектральный анализ в сочетании с предварительным применением к исходному временному ряду вейвлетпакетного разложения. Сингулярный спектральный анализ При изучении временных рядов, помимо анализа Фурье и вейвлет-анализа, широко применяется метод сингулярно-спектрального анализа 1. Данный метод основан на построении по исходному временному ряду, по так называемой траекторной матрице, ее аппроксимации при помощи сингулярного разложения матриц. Поэтому его можно рассматривать как исследование временного ряда хорошо известным в статистике методом главных компонент . Матрица аппроксимируется при помощи r троек, отвечающих r наибольшим сингулярным числам. Временной ряд восстанавливается путем диагонального усреднения матрицы, то есть матрицы, в которой оставлены только r более гладких компонент. Матрица U это матрица собственных векторов матрицы C, а сингулярные числа матрицы A являются положительными корнями собственных чисел матрицы C. Этот подход довольно широко используется в задачах нахождения периодических зависимостей во временных рядах наблюдений, фильтрации шумов и сглаживания временных рядов, так как использование сингулярного разложения матрицы позволяет выделить наиболее значимые составляющие ряда и отсеять случайные возмущения. Однако при непосредственном применении этого подхода к обработке очень больших рядов наблюдений возникают трудности. Количество используемых главных компонент в данной задаче можно определять интерактивно. Выбор длины скользящего окна определяется основной идеей метода ССА, то есть соображением о том, что, если исходный временной ряд имел какую-то структуру, то и его отрезки имеют такую же структуру. Если стоит задача выделения составляющих с известным периодом, размер окна равен или кратен этому периоду. Поэтому в задаче о выделении глобального тренда и сглаживании ряда рекомендуемый размер окна примерно равен половине длины ряда. При этом выбор размера движущегося окна оказывается очень существенным. На рисунке 1 изображен временной ряд, полученный в ходе реального эксперимента по гидродинамическому прослушиванию скважин. На рисунках 2 и 3, иллюстрирующих влияние выбора размера окна, приведены результаты сглаживания исходного временного ряда с использованием окон в 100 и 1 000 отсчетов соответственно. Были проведены численные эксперименты по последовательному применению метода ССА. Исходный ряд сглаживался методом ССА с использованием окна размером 100, 500, 5 000 отсчетов. На рисунке 4 приведено сопоставление результатов последовательного сглаживания для различных окон . Из этих расчетов следует, что для надежного и корректного нахождения тренда временного ряда необходимо использовать траекторную матрицу с длиной столбца, равной примерно половине длины ряда. Заметим, что для вычисления сингулярного разложения матрицы размерности порядка 5 000 5 000 на компьютере c CPU Intel Core i5-750 потребовалось несколько суток непрерывной работы. Поэтому предлагается сочетать метод ССА и применение вейвлет-пакетов. Обобщение метода ССА на случай больших временных рядов Допустим имеется большой, порядка десятков тысяч отсчетов, временной ряд длины N. . Фактически на основе раскладывается ряд X по вейвлетам Хаара 4. То есть, если, то. Таким образом, пренебрежение какой-либо величиной в преобразованном временном ряде означает пренебрежение такой же малой величиной в исходном. На следующем этапе применяем введенное преобразование к рядам S и D. То есть от ряда Z перейдем к ряду по тем же правилам, что и при переходе от ряда X к ряду Z. Все то, что справедливо при переходе от ряда X к ряду Z, справедливо и для перехода от ряда Z к ряду. Ряд SS является временным рядом локально сглаженных, усредненных значений элементов ряда S, а ряд DS состоит из уточняющих коэффициентов. Аналогичное справедливо и для рядов SD и DD. При этом ряд SS описывает самую гладкую часть исходного временного ряда. Последовательно применяя этот прием k раз получаем временной ряд, состоящий из временных рядов, имеющих длину. Вычислим сингулярные разложения этих матриц. Заметим, что эта часть алгоритма может быть эффективно выполнена как на традиционных последовательных, так и на параллельных системах. Обратимся к примеру. На 8-м уровне вейвлет-пакетного разложения имеется 256 временных рядов длиной 511 значений, каждый из которых соответствует всему исходному временному ряду. На рисунке 5 приведен график гладкой части вейвлет-разложения, на рисунках 6 и 7 следующие 2 временных ряда поправочных коэффициентов. Заметим, что график на рисунке 5 внешне похож на график рисунка 4, соответствующий последовательному двойному сглаживанию методом ССА с окном в 100 отсчетов, поскольку последовательное применение первой формулы преобразования можно рассматривать как своеобразное усреднение в окне 256 отсчетов. На рисунках 6 и 7 приведены следующие после самой гладкой части массивы вейвлет-коэффициентов. Легко заметить, что их нерегулярность увеличивается, то есть растет влияние шумовой компоненты. Однако просматривается также закономерность. Влияние шума на графике на рисунке 7 больше, чем на рисунке 6, и тем более, чем на рисунке 5. На рисунке 8 приведен график 20 наибольших значений сингулярных чисел для 1-й и 2-й траекторных матриц. Предположим, что в разложении решено ограничиться только первым членом. Тогда, отбрасывая все члены в разложении для всех рядов коэффициентов, сингулярные числа которых меньше использованного, и k раз проделав обратное вейвлет-преобразование, получим тренд на рисунке 9. Последовательно добавляя в разложение матрицы новые члены, повышаем детальность воспроизведения временного ряда. На рисунке 10 приведен график первого ряда вейвлет-коэффициентов, восстановленного с использованием 10 первых членов в . По формуле восстанавливаем ряды и, проделав обратое вейвлетпреобразование, получаем сглаженный тренд. Сравним стоимость SVD-разложения траекторной матрицы исходного ряда в предположении равенства длины движущегося окна половине длины ряда и траекторных матриц предлагаемого алгоритма. Если длина движущегося окна примерно равна половине ряда, то и стоимость SVD-разложения операций. Для данного алгоритма стоимость SVD-разложения траекторных матриц с примерно равна операций. Таким образом, стоимость вычисления SVD-разложения при использовании предлагаемого алгоритма уменьшается в раза. В заключение необходимо отметить, что ССА в сочетании с вейвлет-пакетным разложением может служить реальным инструментом корректного выделения тренда и сглаживания сильно зашумленных больших временных рядов. 