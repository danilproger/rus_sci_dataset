НЕЙРОННЫЕ СЕТИ И МОДЕЛИ ARIMA ДЛЯ ПРОГНОЗИРОВАНИЯ КОТИРОВОК 

В работе динамика стоимости ценных бумаг моделируется с помощью аппарата нейронных сетей и дискретных стохастических моделей. На основе разработанного в среде Borland Delphi 7.0 программного продукта проведено сравнительное исследование построенных моделей на примере временного ряда котировок акций ОАО «Сбербанк» на ММВБ..

 Цель исследования прогнозирование стоимости ценных бумаг с использованием нейронных сетей и дискретных стохастических моделей и сравнительная оценка рассмотренных методов. Актуальность данного исследования объясняется важностью получения качественных прогнозов основных индикаторов фондового рынка, а также успешным опытом применения нейронных сетей и стохастических моделей в задачах прогнозирования. Для решения поставленных задач в среде программирования Borland Delphi 7.0 разработан программный продукт, реализующий построение дискретных стохастических моделей по методике БоксаДженкинса и моделей нейронных сетей на основе многослойного персептрона. Исходные данные для прогнозирования представляют собой табулированный текстовый файл, который содержит ежедневные котировки акций ОАО Сбербанк по цене закрытия. На рисунке 1 представлены исходные данные в графическом виде. Для улучшения качества прогноза исходный временной ряд предварительно обрабатывается . Таким образом, в качестве исходных данных для прогнозирования выбираются логарифмы относительного приращения сглаженных котировок, ведущие себя более однородно, что особенно важно для длительных временных рядов, когда уже заметно влияние инфляции. Методика БоксаДженкинса. Методика, предложенная Боксом и Дженкинсом для построения моделей типа ARIMA, в общем случае включает четыре этапа. 1. Идентификация стохастической модели. На основе вычисленных оценок для автокорреляционной и частной автокорреляционной функций делается предварительный вывод о порядке интеграции d, а также о значениях порядков p и q операторов авторегрессии и скользящего среднего. 2. Оценивание стохастической модели. На основе вычисленных автоковариаций для идентифицированной модели типа ARIMA определяются начальные оценки параметров авторегрессии и начальные оценки параметров скользящего среднего, затем с помощью алгоритма ЛевенбергаМарквардта вычисляются оценки наименьших квадратов для соответствующих параметров стохастической модели. 3. Диагностика стохастической модели. Исходной информацией для диагностики служат остатки построенной стохастической модели. Проверке подлежат качество модели и некоррелированность остатков. 4. Прогнозирование с помощью стохастической модели. После определения оценок наименьших квадратов для параметров стохастической модели и ее диагностики можно прогнозировать будущие значения временного ряда. Для записи прогноза используется общая формула представления ряда в виде разностного уравнения Построение модели нейронной сети для прогнозирования. Для моделирования динамики временного ряда использована полносвязная нейронная сеть с одним скрытым слоем, в которой каждый нейрон слоя l связан со всеми нейронами предыдущего слоя l1 синаптический вес, связывающий выход нейрона i с входом нейрона j на итерации n функциональный сигнал, генерируемый на выходе нейрона i на итерации n. Нейронная сеть указанной структуры обучается по алгоритму обратного распространения ошибки в последовательном режиме, в котором корректировка весовых коэффициентов проводится после подачи каждого примера обучения вида x, d, где x входной вектор, поступающий на вход сети d желаемый отклик N общее число примеров. Для организации процессов обучения и тестирования нейронной сети сформированный на этапе предварительной обработки набор исходных данных делится на два множества обучающее и тестовое. Из элементов этих множеств по методу скользящего окна формируются примеры для обучения и тестирования нейронной сети соответственно. Таким образом, обучающее множество для данной задачи состоит из 105 примеров, тестовое содержит 15 примеров. Выбор оптимальной архитектуры нейронной сети и параметров скорости обучения и момента не имеет математического решения и производится опытным путем. Проведенный численный эксперимент показал, что оптимальные значения параметров скорости обучения и момента для рассматриваемого временного ряда, . Также отметим, что конечная среднеквадратическая ошибка мало отличается для разных кривых, это означает, что поверхность ошибок в рассматриваемой задаче достаточно гладкая. Для определения оптимального значения параметра точности обучения используется метод обучения с ранним остановом, подробно описанный в 3. Согласно результатам проведенных исследований, оптимальная нейронная сеть для рассматриваемой задачи содержит один скрытый слой. Входной слой содержит 5 нейронов, скрытый 3 нейрона, а выходной 1 нейрон. Критерий оценки качества прогноза котировок на рынке ценных бумаг должен учитывать отклонение прогноза от истинного значения, а также ошибку в направлении тренда на каждом шаге. В качестве критерия для оценки отклонения прогноза от истинного значения используется ошибка, рассчитываемая по формуле z z 1 E 100 N z, где N размерность тестовой выборки z прогноз. Результаты прогнозирования цены закрытия по методике БоксаДженкинса для 15 значений временного ряда представлены в таблицах 1 и 2 и на рисунке 2. Итоги одношагового и многошагового прогнозирования цены закрытия с помощью нейросетевой модели, обученной по алгоритму обратного распространения ошибки с целевым функционалом для 15 значений временного ряда, представлены в таблице 3 и на рисунке 3. Это свидетельствует о применимости построенной модели к инвестиционной деятельности на фондовом рынке. Результаты многошагового прогнозирования для нейросетевых и стохастических моделей также демонстрируют преимущество моделей на основе нейронных сетей, однако общее качество прогноза оказалось недостаточно высоким по точности, что не позволяет рекомендовать ни одну из построенных моделей для планирования среднесрочной и долгосрочной динамик индексов на фондовом рынке. 