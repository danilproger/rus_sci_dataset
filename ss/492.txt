ПРОТОТИП СИСТЕМЫ АНАЛИЗА СОСТОЯНИЯ ВЫЧИСЛИТЕЛЬНОГО КЛАСТЕРА НА ОСНОВЕ МЕТОДА ОПОРНЫХ ВЕКТОРОВ 

С ростом сложности вычислительных кластеров для обеспечения их эффективной работы на первый план выходит проблема отказоустойчивости. Ее решение в настоящее время является одной из самых активно развивающихся областей, связанной с высокопроизводительными вычислениями. В данной работе рассмотрена задача построения автоматизированной системы классификации состояний вычислительного кластера с целью прогнозирования и своевременного выявления нештатных ситуаций в его работе. Для ее решения был предложен алгоритм, использующий методы машинного обучения на основе подхода опорных векторов (SVM/SVR). Отличительной особенностью используемого алгоритма является его модульный характер, допускающий выбор наиболее эффективных методов для решения подзадач всего алгоритма обработки входных данных. На примере анализа данных мониторинга, собранных с реально действующих вычислительных кластеров, была показана принципиальная применимость предложенного алгоритма для обнаружения новых состояний вычислительного кластера: при правильном выборе параметров используемых методов удается осуществлять прогнозирование возможных будущих состояний с точностью 6–16 % и фиксировать критическое изменение контролирующих величин в пределах 3–5 шагов прогноза. При малом числе показаний сенсорных датчиков, содержащих выпадающие значения (5–10 %), наблюдается устойчивость системы к сбоям в показаниях сенсорных датчиков. Возможное дальнейшее развитие автоматизированной системы связано с использованием online-алгоритмов SVM/SVR и методов выявления сложных типов аномального поведения вычислительных кластеров.

 Современный вычислительный кластер ВК является технически сложной системой, представляющей собой комплекс взаимосвязанных и взаимодействующих подсистем вычислительных узлов, сетевого оборудования, инженерной инфраструктуры. Мониторинг состояния всех подобных подсистем требует наличия разветвленной сети сенсорных датчиков, занимающихся сбором информации о разнообразных параметрах системы. В то же время для эффективного управления инфраструктурой ВК необходима такая упрощенная система анализа, которая позволяла бы на основе всей получаемой от сенсорных датчиков информации выявлять наступление нештатной ситуации и оперативно реагировать на нее. Актуальной задачей представляется построение автоматизированной системы анализа, осуществляющей обработку данных мониторинга с использованием современных статистических методов. Разнообразие типов сенсорных датчиков, являющееся следствием разнообразия свойств контролируемых параметров, приводит к разнообразию статистических свойств получаемых от них данных мониторинга, поэтому из всех методов статистической обработки данных наибольшую эффективность при решении данной задачи имеют универсальные, непараметрические методы. К их числу относятся методы машинного обучения. В качестве базового подхода был выбран подход на основе метода опорных векторов . В общих чертах он состоит в оценке целевой функции с помощью ее подгонки к набору заданных данных и используется в самой широкой предметной области от изучения поведения финансового рынка до вычисления возможной загруженности электрических сетей или транспортного потока 1. Популярность практического применения этого подхода связана с его простотой, универсальностью и эффективностью, особенно при решении задач из реальной жизни, где, как правило, требуется использование нелинейных моделей. Немаловажным является его высокая производительность, позволяющая использовать такой подход в автоматизированных системах, работающих в режиме реального времени. Общая схема алгоритма В предлагаемом подходе анализ данных мониторинга осуществляется путем построения двух статистических моделей и их использования для обработки новых непрерывно поступающих данных в автоматическом режиме. Первая из моделей описывает набор собранных ранее данных мониторинга, соответствующих стабильной работе ВК. Эту модель далее будем называть моделью множества нормальных, типичных состояний ВК. Вторая модель на основе данных, полученных в течение некоторого промежутка времени, непосредственно предшествующего моменту построения модели, позволяет вычислять возможные будущие состояния ВК. Далее будем ссылаться на нее как на модель регрессора. Все параметры моделей задаются пользователем перед запуском всей системы, исходя из статистических свойств обрабатываемых данных. Обе модели строятся автоматически с определенной периодичностью с учетом поступления новых данных. Например, типичное время между двумя последовательными построениями модели нормальных состояний ВК может составлять 24 часа, тогда как модель регрессора может обновляться раз в минуту. Общая схема обработки данных заключается в периодическом применении модели множества нормальных состояний для решения задачи классификации возможных будущих состояний ВК, получаемых с использованием модели регрессора. Представление данных. При таком представлении данных мониторинга задача их анализа может быть сформулирована как анализ статистических свойств многомерного временного ряда. При этом следует отметить, что, поскольку отдельные компоненты такого динамически меняющегося многомерного вектора представляют собой величины разной физической природы, для их совместного рассмотрения необходимо провести масштабирование каждой компоненты в отдельности. Наибольшее распространение получил способ масштабирования Здесь x среднее значение из выборки для случайной величины x sd стандартное отклонение для этой выборки. В данной работе при построении моделей и при дальнейшей обработке все показания сенсорных датчиков приводятся к стандартному виду z-score, однако для удобства пользователя результаты обработки выводятся в первоначальном масштабе. Регуляризация входных данных. При обработке данных мониторинга по представленному алгоритму возникают две проблемы, связанные с возможностью построения в каждый момент времени вектора состояний ВК, которые необходимо решить до начала процедуры обработки, то есть построения моделей множества нормальных состояний и модели регрессора. Во многих системах мониторинга для решения проблемы регулярности поступления данных мониторинга проводится процедура интерполяции значений таким образом, чтобы измерения были доступны через одинаковые интервалы времени, данный подход, например, по умолчанию применяется в популярном средстве хранения данных RRDB 2. В таком случае возможны исчезновение, сглаживание пиковых значений измерений после регуляризации, что может быть в некоторых ситуациях нежелательным. Наряду с проблемой регуляризации временного шага входных данных существует проблема возможности появления так называемых выпадающих значений, под которыми принято понимать значения переменных, которые существенным образом искажающие статистические характеристики данных. Одномерные выпадающие значения, как правило, характеризуются экстремальными значениями, однако существуют и более сложные ситуации 3, которые требуют специальных методов для их выявления. В данной работе рассматривается только самый простой вариант аномального поведения одномерных данных, когда за выпадающие значения принимаются те, которые имеют большую абсолютную величину после приведения к стандартному масштабу z-score. Как правило, это величины с z-score по модулю 3,29. Однако z-score сильно зависит от размера выборки N. С учетом вышеизложенного регуляризация входных данных мониторинга в рассматриваемом прототипе осуществляется в несколько шагов по следующей схеме. 1. Удаление выпадающих значений, то есть данных, распознанных как аномальные в предыдущие моменты времени удаление данных, не обновлявшихся в течение определенного промежутка времени t по причине возможного отказа соответствующего сенсорного датчика удаление тех значений, которые не попадают в интервал допустимых значений x, x, и значений, для которых интервал допустимых значений не определен, а z-score по модулю больше 3,29. 2. Регуляризация временного шага путем переноса последнего определенного показания сенсора на ближайший справа шаг регулярной временной сетки. 3. Заполнение образовавшихся после удаления выпадающих значений лакун во временных рядах с учетом величины подобной лакуны dt. То есть, если dtt, то отсутствующие значения, попадающие в этот интервал, заменяются на ближайшее по времени к этому промежутку доступное показание сенсорного датчика, так как представляется наиболее вероятным, что это случайное событие. Если t dtt, то отсутствующие значения из этого интервала заменяются на средние значения всех доступных к моменту наступления этого события значений, поскольку в таком случае можно предположить, что данные отсутствуют по причине перегруженности СМ. Если t dt, то отсутствующие данные заменяются на значение по умолчанию x, поскольку отсутствие данных мониторинга в этом случае наиболее правдоподобно объяснить тем, что соответствующее оборудование либо было отключено, либо вышло из строя. Полученные регуляризованные данные поступают затем на вход основного алгоритма прототипа, то есть используются при построении статистических моделей. Построение модели множества нормальных состояний ВК. Данное построение осуществляется в два этапа. На первом этапе все множество нормальных состояний разбивается на k кластеров, для чего в рассматриваемом прототипе используется более эффективный по сравнению с общеизвестным методом k-средних метод k-медоид 4 на основе алгоритма CLARA . Как и все классические методы кластерного анализа, метод k-медоид предполагает априорное знание числа кластеров k, на которые нужно разбить исходное множество. После чего алгоритм использует это значение как входной параметр для метода k-медоид. Такой подход позволяет автоматизировать процесс построения модели множества нормальных состояний. На втором этапе построения модели происходит описание границ каждого из кластеров X, полученных на первом этапе. Для этого в данной работе с помощью метода опорных векторов находилось решение стандартной задачи о бинарной классификации, где в качестве дополнительного второго класса бралось центрально-симметричное к множеству X множество X. В такой постановке эта задача эквивалентна задаче о классификации с одним классом 6, это позволило использовать полуэмпирические формулы для расчета апостериорных вероятностей, полученных в работе 7. Построение модели регрессора. Как показало предварительное исследование статистических свойств данных мониторинга, они плохо описываются с помощью классических стандартных моделей, поэтому использование таких общеупотребительных параметрических моделей временных рядов, как VARX или SS, для осуществления прогнозирования возможных будущих состояний ВК представляется неэффективным. По этой причине в данной работе выбор был сделан в пользу методов, основанных на статистической теории машинного обучения, которые успели зарекомендовать себя как надежный и эффективный инструмент статистической обработки данных 7, 8. Выбранный авторами метод SVR состоит в построении такой линейной функции в характеристическом пространстве, которая наилучшим образом приближала бы значения искомой функции. Для поиска такого приближения используется принцип минимизации структурного риска . Основными достоинствами непараметрических методов являются их универсальность и независимость от априорных знаний, что позволяет единообразно обрабатывать данные разной статистической природы. В настоящей работе были использованы два варианта метода SVR, которые в дальнейшем будем обозначать как метод p-svr и метод msvr. Метод p-svr заключается в последовательном применении методавектора. Прогнозируемым значением является Y. Вычисление апостериорных вероятностей. Это становится особенно необходимым, когда процесс классификации одна из составных частей более сложного алгоритма. Однако метод SVM порождает на выходе непрокалиброванные значения, которые не являются вероятностями. Поэтому для их вычисления необходимы дополнительные построения. Экспериментальное тестирование прототипа Тестирование прототипа проводилось на основе численных экспериментов с использованием данных мониторинга, собранных в течение некоторого промежутка времени с реально действующих ВК. Такой набор данных после проведения процедуры первичной предобработки далее будет называться моделью данных. Для имитации нештатных ситуаций в них добавлялись искусственно созданные данные. Численный эксперимент, во-первых, исключает риск, связанный с выходом из строя ВК по причине программных сбоев во время тестирования, а во-вторых, использование модели данных позволяет контролировать процесс тестирования, когда, меняя модель данных или ее параметры, можно смоделировать различные режимы работы ВК. В тестировании были использованы данные, собранные системой мониторинга Infra-StruXure Central в течение одного дня с ВК с числом узлов около 1 000 и системой воздушного охлаждения на основе водяных кондиционеров и системой мониторинга ganglia в течение 14 дней с ВК с числом узлов около 200 и системой непосредственного водяного охлаждения . В обоих случаях шаг сбора данных составил 1 минуту. Эти наборы, помимо длины временных данных, отличаются характером собранной в них информации, что связано с различием в подходах к реализации в двух ВК подсистем охлаждения и электропитания, а также составом собственно вычислительных подсистем и решаемых на них задач, что обусловливает различие в нагрузках на ВК. Модели данных A и B. Для набора данных A из всего набора сенсорных датчиков на основе опыта эксплуатации ВК был выбран поднабор, состоящий из 263 сенсоров 7 различных типов сенсорных датчиков, контроль за показаниями которых представляет наибольшую важность. Таким образом, в этот набор вошли температура модулей памяти, сила тока и общая потребляемая мощность тока на шкафных блоках распределителей питания, входная и выходная температура теплоносителя кондиционера. Из всего множества сенсоров, осуществляющих мониторинг ВК, в случае модели данных B авторами был выбран поднабор, состоящий из 315 сенсоров 4 различных типов сенсорных датчиков, контроль за показаниями которых представляется наиболее важным температура процессоров, загруженность процессора, общая потребляемая мощность тока на шкафных блоках распределителей питания. На рисунках 1 и 2 приведены примеры типичного графика зависимостей от времени показаний сенсоров для моделей данных A и B соответственно. Выбор параметров модели прогнозирования. Известно, что обобщающая способность метода SVR зависит от правильного выбора метапараметров параметра регуляризации C, который определяет равновесие между сложностью модели регрессора и степенью допустимых отклонений, и параметра, задающего ширину нечувствительной зоны, используемой при обучении алгоритма, а также от параметров используемой кернел-функции. Этот выбор в большинстве случаев осуществляется эмпирическим путем на основе имеющегося опыта. Тем не менее делаются попытки предложить теоретически более обоснованные подходы к решению проблемы. Так, для кернел-функций гауссовского типа выбор параметра можно осуществить с помощью самих обучающих данных, для этого выбирается любое значение из интервала 0,10,9 квантилей случайной величины, соответствующей обучающим данным 11. Параметр C, как правило, выбирают из области значений выходных данных. Однако такой выбор не учитывает влияние выпадающих значений. Известно, что значение должно быть пропорционально уровню случайного шума во входных данных. Изучение качества прогнозирования. Для модели данных A значения N, M и K составили 1134, 205, 1 439 соответственно. Для модели данных B эти значения составили 12 900, 205, 13 205 соответственно. Таким образом, в обоих случаях размер тестовой выборки для проверки работы регрессора равнялся 100. Данные между моментами времени t t и t t использовались для инициализации работы алгоритма регрессора. Длина временного шага была задана равной одной минуте для обеих моделей данных. Значения метапараметров методов msvr и p-svr вычислялись по формулам и . Для метода p-svr значение метапараметра C было выбрано равным 1. Значение параметра рассчитывалось автоматически по обучающей выборке алгоритма. В этих формулах индексное множество S обозначает множество кластеров, на которые разбивается все множество нормальных состояний ВК P весовой коэффициент, равный отношению количества обучающих состояний, попавших в данный кластер, к общему числу обучающих данных P апостериорная вероятность, вычисленная по формуле . X означает среднее от наблюдаемых значений. В таблице 1 приводятся результаты, усредненные по всем метапараметрам. Из приведенных результатов видно, что методы msvr и p-svr в среднем имеют схожие порядки погрешностей вне зависимости от выбранной кернел-функции. Основной вывод, который можно сделать из проведенного экспериментального исследования, заключается в том, что при правильном выборе метапараметров с помощью выбранного подхода удается осуществлять прогнозирование возможных будущих состояний ВК с точностью 616 . Обнаружение нештатных ситуаций. В рамках подхода, рассматриваемого в данной работе, определение нештатных состояний ВК происходит путем обнаружения новых состояний, то есть таких, которые сильно отличаются от данных, участвовавших в процедуре обучения алгоритма. Для того чтобы промоделировать подобную ситуацию, было взято такое разбиение данных модели B, при котором выборка II содержала бы данные, отличающиеся от данных выборки I. На рисунке 3 представлены типичные зависимости рассчитанных вероятностей от времени для моделей А и В . Тогда как для однородной модели A как полная, так и максимальная вероятности слабо меняются от времени, аналогичные кривые для модели B претерпевают характерный излом, резкое падение, ступеньку, связанную с отсутствием в обучающих данных модели нормальных состояний ВК, элементов, схожих с элементами выборки II. Проверка устойчивости к сбоям в показаниях сенсоров. Сбои в показаниях сенсорных датчиков представляют серьезную проблему для эффективной работы всего прототипа, поэтому в данной работе было проведено тестирование алгоритма регуляризации входных данных с тем, чтобы выяснить влияние сбоев на работу прототипа. Затем для этих двух моделей данных изучалось качество прогнозирования, как это описано выше. Результаты экспериментальных исследований представлены в таблице 2. Приведенные данные свидетельствуют о том, что процедура искажения данных не вносит серьезных изменений в работу прототипа. Относительные ошибки составляют 0,24,3 для моделируемых величин, то есть результат прогнозирования практически не меняется. Обсуждение результатов В ходе процесса регуляризации данных происходят сглаживание и усреднение показаний сенсорных датчиков. Тем не менее, как показывает опыт эксплуатации ВК, наиболее важным из всех возможных характеристик наблюдаемых значений сенсорных датчиков является наблюдение за их трендами, и вариант предподготовки данных с отбрасыванием отдельных выпадающих значений это допускает. Еще одним необходимым условием эффективной работы рассматриваемого алгоритма является корректное построение модели множества нормальных состояний, предпочтительно на большом статистическом материале, когда подмножества, из которых состоит все множество нормальных состояний, представляют собой кластеры с четко выраженной границей. В этом случае контролирующие параметры алгоритма P и P характеризуются меньшим разбросом значений, что позволяет увеличить точность предсказания момента наступления критического события t. Задача обнаружения аномальных состояний ВК облегчается при увеличении скорости и массовости появления аномальных показаний сенсорных датчиков. И наоборот, в пограничных случаях определение точных значений t затрудняется, то есть этот вопрос требует дальнейшего рассмотрения и уточнения количественных критериев, предъявляемых к задаче классификации состояний ВК и необходимых для эффективной работы всего алгоритма. Наконец, немаловажное значение имеет точность прогнозирования возможных состояний ВК, которая, как показывают результаты, зависит не только от параметров используемых методов прогнозирования, но и от обрабатываемых данных. Так, большая величина относительной ошибки nRMSE в случае модели B по сравнению с моделью A, по-видимому, объясняется, с одной стороны, вырожденностью этих данных, которая характеризуется длинными участками близких значений, а с другой резкими скачкообразными изменениями по порядку величины, превышающими среднюю величину последовательных разностей временного ряда. Это приводит к появлению вырожденных матриц, которые алгоритмы методов SVR строят во время своей работы, что может привести к увеличению погрешности. Таким образом, выбор набора сенсорных датчиков, используемых для контроля, с учетом их статистических свойств и важности является ключевым моментом. Требования к скорости расчета одной точки прогноза определяются в первую очередь скоростью необратимого разрушения оборудования ВК при катастрофическом отказе инженерных подсистем. Для современных ВК этот промежуток времени, как правило, составляет 12 минуты. Дополнительно скорость расчета одной точки прогноза можно увеличить путем перехода от решения задачи построения регрессии в так называемом batch-mode-режиме, когда эта модель полностью перестраивается при поступлении новых данных, к online-режиму, в котором изменению подлежит лишь малая часть модели, соответствующая вновь поступившим данным. В работе 13 был предложен алгоритм, реализующий online-режим для задачи одномерной регрессии. Однако на основе сведений, известных авторам, для задачи многомерной регрессии такого алгоритма пока не существует. Для перехода от прототипа к построению рабочей системы анализа требуется дальнейшее изучение влияния всех этих факторов на эффективность работы, поскольку характер рассматриваемых зависимостей довольно сложен. При этом данный алгоритм обладает определенной устойчивостью к сбоям в показаниях сенсорных датчиков и повышает точность предсказания наступления критической ситуации с ростом ее опасности. Количественный аспект этих вопросов требует дальнейшего уточнения. К достоинствам используемого в данной работе алгоритма стоит также отнести его модулярный характер, когда в каждом из шагов базового алгоритма возможно использование разных альтернативных методов. В частности, выбранные в данной работе методы SVMSVR, помимо высокой вычислительной эффективности, являющейся следствием концептуальной простоты метода, сравнительно легко позволяют произвести усложнение выявляемых аномальных состояний, например, предсказывание коллективных аномалий 14. 