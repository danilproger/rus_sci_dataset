ГЕНЕРАТОР ТЕКСТА ПРОГРАММ В ИСХОДНОМ ВИДЕ ДЛЯ СИСТЕМ РЕАЛЬНОГО ВРЕМЕНИ 

Статья посвящена практическим вопросам технологии генерации текста программ в исходном виде для систем реального времени. Рассматриваются принципы работы технологических средств автоматизированной генерации программ, логическая структура генератора текста программ в исходном виде и алгоритмы функционирования его программных модулей.

 Повышение надежности специального программного обеспечения СПО комплексов, функционирующих в реальном масштабе времени под управлением oc2000, может быть достигнуто применением при его создании автоматизированных средств построения и анализа архитектурных и структурных моделей вычислительных систем реального времени ВС РВ, автоматизированной генерации заготовок программных модулей на языке программирования Си для компонентов СПО ВС РВ, имитационного моделирования работы ВС РВ. Разработанные НИИСИ РАН технологические средства автоматизированной генерации СПО позволяют снизить трудоемкость разработки СПО, повысить его надежность за счет применения типовых программных компонентов, автоматизировать значительную часть работ процесса разработки СПО в том числе работ по подготовке проектной документации. Программные средства ТСАГ СПО функционируют под управлением операционной системы типа Linux . ТСАГ СПО реализованы на основе стандарта унифицированного языка моделирования UML 1 и расширяемого языка разметки XML 2. Согласно стандарту UML особенности моделируемого объекта должны изображаться графически в виде совокупности связанных между собой графических элементов. В процессе проектирования программ ТСАГ СПО используют заготовки UML, которые представляются XML-документами и визуализируются ТСАГ СПО графическими вершинами типа action 1. XML-документы содержат представления конструкций языка программирования Си в соответствии со стандартом 3 в виде XML-разметки, а также данные, требуемые для отображения этих заготовок на диаграммах . Проект разрабатываемых программ может содержать сотни логически связанных диаграмм различных типов например, диаграммы классов, деятельностей, состояний, развертывания. Диаграммы, как и заготовки UML, представляются XML-документами. Создавая программу, пользователь переносит заготовки UML из библиотеки заготовок UML на ДПД и заполняет значения параметров этих заготовок. Такой перенос может предполагать вставку заготовки UML внутрь уже имеющейся. Заполнение значений параметров заготовки UML предполагает установку и сохранение значений полей диалогового окна Параметры ДПД. XML-документы, представляющие заготовки UML, соответствуют XML-схеме, разработанной на основе стандарта языка Си 3 и позволяющей устанавливать синтаксическую правильность генерируемых из ДПД программ без предварительной компиляции. Кроме конструкций языка программирования Си, описанных в стандарте 3, библиотеки заготовок UML могут содержать заготовки, объединяющие несколько конструкций языка программирования Си, а также заготовки, представляющие собой XML-представления вызовов специальных функций, относящихся к работе на конкретной платформе например, на платформе ос2000 4. Для каждой ДПД можно построить результирующий XML-документ, объединяющий в себе XML-документы, которыми представлены на ДПД заготовки UML. Порядок объединения XML-документов соответствует порядку следования заготовок UML на конкретной ДПД. Результирующий XML-документ содержит конкретные значения параметров XML-документов, которыми представлены заготовки UML. ДПД считается корректной, если построенный из нее результирующий XMLдокумент соответствует XML-схеме языка Си. Проверка корректности ДПД обеспечивается на лету, непосредственно в момент ее построения. Единственным источником синтаксических ошибок могут быть параметры заготовок UML, значения которых определяет пользователь. Представленные XML-документами данные удобны для автоматизированного разбора. Существуют программные библиотеки функций, например LibXML 2.0 или Expat, которые предоставляют программисту интерфейс для работы с XML-документами. В ТСАГ СПО для работы с XML-документами используется библиотека LibXML 2.0. Следует отметить, что данные, представленные XML-документами, удобны для обмена между программами. В ТСАГ СПО результирующий для ДПД XML-документ генерируется утилитой xmlgen, входящей в состав ТСАГ СПО. Этот документ преобразуется в текст программы в исходном виде на языке Си программой ПГЕН РВ, а также может быть открыт для просмотра и редактирования в программе ptp-editor, входящей в состав ТСАГ СПО. Так как язык XML является стандартом представления данных де-факто, XML-документы можно просматривать и редактировать с помощью программ, входящих в стандартные поставки операционных систем Linux, например gedit и kate. Просмотр и редактирование XML-документов возможны и в коммерческих программных продуктах, например, SyncRO Soft Oxygen XML editor или Altova XMLSpy. Программа ПГЕН РВ ДПД являются основой для получения программы на языке программирования Си. Преобразование ДПД в текст программы в исходном виде выполняет входящая в состав ТСАГ СПО программа ПГЕН РВ, предназначенная для перевода программных моделей ВС РВ в набор файлов с текстом в исходном виде на языке Си. Программа ПГЕН РВ поддерживает программный протокол обмена данными между программами, входящими в состав ТСАГ СПО. Программа использует библиотеки GTK 2.0 и LibXML 2.0. Программа ПГЕН РВ выполняет преобразование результирующих XML-документов ДПД в файлы с текстом в исходном виде на языке Си. Документы XML, передаваемые ПГЕН РВ, должны соответствовать схеме XML языка Си. Пользователь имеет возможность контролировать процесс преобразования XML-документов с помощью параметров запуска, сообщений и графических интерфейсных компонентов главного окна ПГЕН РВ . Программа сохраняет результаты работы в текстовый файл, который может использоваться для детального анализа работы программы и обработанных данных. Эти теги являются управляющими для алгоритма по ним ПГЕН РВ определяет начало, конец и тип синтаксических конструкций. Таким образом, ПГЕН РВ, используя структурированные в XML-документах данные, порождает форматированную последовательность символов, являющуюся текстом программы в исходном виде на языке Си. Правила обработки XMLдокументов определяются как в схеме XML, так и непосредственно в алгоритме преобразования. Вызов ПГЕН РВ в ТСАГ СПО выполняют программа ППГИ РВ, программа ПГП РВ, утилиты xmlgen, ptp-editor. В ПГЕН РВ реализованы дополнительные функции, такие как форматирование файлов, проверка на соответствие схеме XML, отображение документа XML в виде дерева, вывод информации о результатах преобразования документов XML, вывод отладочной информации, вывод конфигурации ПГЕН РВ, запуск ПГЕН РВ в оконном режиме. Наличие этих функций позволяет использовать ПГЕН РВ отдельно от ТСАГ СПО как самостоятельную программу. Логическая структура ПГЕН РВ Программа ПГЕН РВ реализована на языке программирования Си. Список программных модулей с кратким описанием приведен в таблице 1. У каждого программного модуля имеется препроцессорная директива include с одноименным заголовочным файлом. Заголовочные файлы содержат объявления используемых в программном модуле функций и располагаются в подкаталоге include. Программные модули логически связаны между собой объявлениями внешних функций . Список внешних функций приведен в таблице 2. Под внешней для программного модуля функцией понимается функция, не входящая в состав стандартных библиотек и определенная в другом модуле ПГЕН РВ. Логические связи между программными модулями на уровне объявлений внешних функций представлены на рисунке 1. Модель реализации ПГЕН РВ в контексте взаимодействия с подсистемами ТСАГ СПО представлена на рисунке 2. Функция получает дескриптор XML-документа и начинает последовательное чтение строк этого документа, тем самым напоминая канал, исходными данными для которого выступает XML-разметка. Этот канал условно называется потоком событий. Используемые технические и программные средства Программа ПГЕН РВ эксплуатируется на персональном компьютере типа IBM PC . Для работы в диалоговом режиме требуются цветной графический монитор, клавиатура, манипулятор типа мышь. На инструментальную ЭВМ должно быть установлено следующее ПО операционная система Linux Fedore Core 7, подсистемы ТСАГ СПО, пользовательская среда GNOME 2.18.0, обозреватель файлов для среды GNOME Nautilus 2.18.1. Вызов и загрузка Обращение к подсистеме ПГЕН РВ может быть выполнено как из командной строки Unixshell, так и из прикладной программы. usrlocalbinpgen параметры При использовании ключа pgp ПГЕН РВ после завершения обработки входных документов XML отправляет сообщения в канал FIFO. Сообщение соответствует следующему формату Mxxxx, где xxxx числовой идентификатор процесса ПГЕН РВ. ПГЕН РВ ожидает получения сообщения по каналу FIFO XMLGENxxxxyyyyIN, которое свидетельствует о завершении программы-потомка. Сообщение соответствует формату Mxxxx, где xxxx числовой идентификатор процесса программы-потомка. Входные и выходные данные Программа ПГЕН РВ выполняет преобразование XML-документов в файлы с текстом в исходном виде на языке Си. Пути к XML-документам в файловой системе инструментальной ЭВМ передаются ПГЕН РВ в качестве параметров. Вызов ПГЕН РВ из командной строки UNIX-shell может быть выполнен, например, следующим образом Входными данными для ПГЕН РВ при работе в текстовом режиме являются входные параметры, которые передаются ПГЕН РВ при запуске . При работе ПГЕН РВ с документами XML необходимыми являются следующие входные данные in file ключ специфицирует файл входного документа XML out file ключ специфицирует файл, в который будут помещены исходные тексты на языке Си sch file ключ специфицирует схему XML. При работе ПГЕН РВ с проектами ТСАГ СПО необходимыми являются следующие входные данные prj path ключ специфицирует каталог, где располагается проект ТСАГ СПО isrp file ключ специфицирует файл проекта ТСАГ СПО. Выходными данными для ПГЕН РВ являются один или несколько файлов с текстом в исходном виде на языке Си, сообщения, передаваемые ПГЕН РВ вызывающей подсистеме через канал FIFO, сообщения, передаваемые ПГЕН РВ другим программам, сообщения средств контроля ПГЕН РВ, файл отчета. При использовании ключей in и out ПГЕН РВ генерирует на основании документа XML, специфицированного ключом in, файл с исходным текстом на языке Си, специфицированный входным параметром out. Имя и путь к файлу с исходным текстом определяются параметром out. Сообщения, передаваемые ПГЕН РВ вызывающей подсистеме через FIFO-канал, соответствуют формату Mxxxx, где xxxx числовой идентификатор процесса ПГЕН РВ. Файл отчета создается ПГЕН РВ в случае, если был указан параметр r, который специфицирует путь к файлу отчета и его имя. Перспективы развития ПГЕН РВ может применяться как в виде отельного полнофункционального приложения, так и в составе системы проектирования. В настоящее время активно развиваются приложения, предоставляющие интерфейсы для разработки собственных расширений и плагинов . Таким образом, генератор исходных текстов может быть реализован для систем типа Eclipse, NetBeans и т.д. Особое место занимает подготовка скелетов программ, которые могут быть включены в общую библиотеку заготовок UML. Это могут быть скелеты потоков управления, процессов, критические участки кода, обработчики исключений и прерываний 4 и др. 