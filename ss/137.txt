АЛГОРИТМ ПОСТРОЕНИЯ ДЕРЕВА ДЕКОМПОЗИЦИИ ГИПЕРГРАФА НА ОСНОВЕ АЦИКЛИЧНОСТИ 

Задача нахождения оптимального дерева декомпозиции гиперграфа возникает во многих приложениях. Между тем она является NP-трудной. В данной работе предлагается новый полиномиальный по времени эвристический алгоритм, основанный на пополнении гиперграфа до ациклического. Алгоритм использует жадную стратегию, направленную на минимизацию ширины конструируемого дерева декомпозиции..

 Структура многих NP-трудных задач комбинаторной оптимизации может быть описана гиперграфом. Такие задачи возникают в системах принятия решений, БД, при анализе информационных и коммуникационных сетей, конструкторском проектировании радиоэлектронной и вычислительной аппаратуры, лингвистической трансляции, при формировании трафика компьютерных сетей и т.д. Дерево декомпозиции гиперграфа дает возможность организовать процесс поиска оптимального решения по принципу разделяй и властвуй. Если древовидная ширина гиперграфа ограничена сверху некоторой константой, то многие NP-трудные задачи комбинаторной оптимизации могут быть решены за полиномиальное время 1. Древовидная ширина это числовая характеристика гиперграфа, определяемая через оптимальное дерево декомпозиции. К сожалению, сама задача нахождения оптимального дерева декомпозиции также NP-трудная, поэтому в алгоритмической практике востребованы эвристики, позволяющие получать хорошие деревья декомпозиции за разумное время. Свойство М-ацикличности . Употребление данного свойства в алгоритме CTDA дает возможность создавать за полиномиальное время дерево декомпозиции гиперграфа с разной степенью приближения к оптимальному дереву декомпозиции. Гиперграф и дерево декомпозиции. Используем терминологию и обозначения, принятые в 35. В общем случае U конечное семейство произвольных подмножеств множества X. Пусть U множество ребер, инцидентных в H вершине x X X множество всех вершин, инцидентных в H ребру u U. Число U определяет степень вершины x, а X степень ребра u. Элемент гиперграфа степени 0 считают голым, степени 1 висячим. Ребро u вложено в ребро v, когда X X. Гиперграф называется минимальным, если он не содержит голых элементов, вложенных и кратных ребер. Существуют различные способы задания гиперграфа. Универсальным способом задания гиперграфа также является кенигово представление. Многие структурные свойства гиперграфа определяются через одноименные свойства кенигова представления. Так, гиперграф H считается связным, если граф K связный. Далее в качестве исходных гиперграфов будем рассматривать, не нарушая общности, только непустые, минимальные и связные гиперграфы. Граф L представляет отношение смежности вершин, а граф L отношение смежности ребер гиперграфа H. Свойства графов L и L определяют ряд важных свойств гиперграфа H. Так, гиперграф H комплектный, если каждой максимальной клике графа L отвечает некоторое ребро этого гиперграфа. С гиперграфом связана еще одна графовая структура, именуемая деревом декомпозиции. Следует отметить, что для каждого -гиперграфа всегда существует хотя бы одно дерево декомпозиции. Например, таковым является тривиальное дерево декомпозиции, состоящее из одного узла с мешком X и имеющее ширину n1. Ясно, что тривиальное дерево декомпозиции в общем случае не является оптимальным. Характеризация М-ациклических гиперграфов. В гиперграфе H последовательность P задает М-цикл длины k, если 1 u, u,. Гиперграф, не содержащий бесхордовых М-циклов, называется M-ациклическим. Наличие хотя бы одного бесхордового цикла приводит к M-цикличности гиперграфа. Отметим, что существуют различные трактовки ацикличности и цикличности гиперграфа. Приведенное выше определение М-ацикличности возникло в теории реляционных БД 2 и получило уточнение в работах 3, 4. Теорема 1. Данная теорема определяет свойства М-ациклического гиперграфа, используемые далее в алгоритме CTDA. Дадим краткие пояснения. Нетрудно убедиться, что для М-ациклического -гиперграфа дерево соединений является оптимальным деревом декомпозиции, каждый мешок которого содержит вершины в точности одного ребра гиперграфа. Из эквивалентности высказываний теоремы 1, пп. 1 и 4, вытекает полиномиальный по времени способ нахождения оптимального дерева декомпозиции для М-ациклического графа построить взвешенный реберный граф L и найти для него остовное дерево наибольшего веса. Распознать М-ацикличность можно с помощью алгоритма Грэхема 2. Обозначим через red гиперграф, полученный в результате применения алгоритма Грэхема к гиперграфу H. Алгоритм Грэхема всегда приводит к одному и тому же гиперграфу red независимо от порядка и числа удаляемых элементов на каждом шаге. Кроме того, операции СУВ и СУР сохраняют связность гиперграфа. Все это свидетельствует о рекурсивном характере алгоритма Грэхема и наследственности свойства М-ацикличности относительно операций СУВ и СУР . Алгоритм Грэхема прост в реализации и имеет полиномиальную временную сложность. Операция СУР алгоритма Грэхема осуществляет минимизацию текущего гиперграфа. Многие известные эвристические алгоритмы построения дерева декомпозиции гиперграфа опираются на свойства триангулированных графов 1. При этом структурные особенности самого гиперграфа H эксплуатируются лишь частично. Напомним, что граф называется триангулированным, если всякий его цикл длиной k 4 обладает хордой ребром, соединяющим две несмежные вершины данного цикла . Описание и обоснование алгоритма. Эвристический алгоритм CTDA конструирует дерево декомпозиции путем минимального пополнения исходного гиперграфа до М-ациклического. Это достигается разделением процесса решения задачи на три этапа. Этап 1. Уменьшение размерности решаемой задачи путем сокращения числа элементов исходного гиперграфа с помощью алгоритма Грэхема и выделения блоков гиперграфа. Этап 2. Устранение в каждом блоке бесхордовых М-циклов путем добавления в H множества дополнительных ребер U. Этап 3. 1, 3, 4. Алгоритм CTDA на этапе 2 применяет эвристику минимальная степень. Поскольку предварительно на этапе 1 размерность задачи снижается, область действия погрешностей, вносимых эвристикой, сокращается. Это позволяет добавлять в H дополнительные ребра минимально необходимой мощности для устранения бесхордовых М-циклов и получать в итоге деревья декомпозиции с шириной, близкой к tw. Дадим разъяснения к каждому из трех этапов алгоритма CTDA. Здесь H часть гиперграфа H, порожденная множеством вершин X Y, то есть полученная из H слабым удалением вершин, входящих в Y. Блок тривиальный, если у него лишь одно ребро. Это означает, что в H нет нетривиальных блоков и бесхордовых М-циклов. Необходимости в выполнении этапа 2 нет можно сразу перейти на этап 3 без изменения U. Согласно высказыванию теоремы 1, п. В выделенных блоках возможно появление висячих вершин, а после их удаления кратных и вложенных ребер. Также некоторые блоки могут быть тривиальными. Теорема 2. Некоторые из утверждений теоремы 2 доказаны в 3, другие очевидны. В силу теорем 1, 2 и того, что B непустой, минимальный, связный и М-циклический гиперграф, возможна одна из трех ситуаций. Ситуация I. Гиперграф B некомплектен, а его граф L триангулированный. Ситуация II. Гиперграф B комплектный, но граф L не является триангулированным. В данном случае гиперграф B содержит бесхордовые М-циклы только длины k3. Ситуация III. Гиперграф B некомплектен, и L не является триангулированным графом. Ситуация I самая простая. Тем самым гиперграф B превращается в комплектный, а значит, и в М-ациклический гиперграф. Нетрудно убедиться, что хорды для B являются также хордами для соответствующих бесхордовых М-циклов исходного гиперграфа H. Ситуацию I можно легко распознать с помощью свойств триангулированных графов любой триангулированный граф имеет симплициальную вершину свойство триангулированности не утрачивается при удалении из графа отдельной вершины. Вершина графа называется симплициальной, если ее окрестность клика. Таким образом, если последовательный поиск в L симплициальных вершин и их удаление из L приводят к пустому графу, то L триангулированный граф. Так как граф L содержит не более n вершин, распознать его триангулированность можно за время O. Ситуации II и III мало чем отличаются друг от друга, так как требуют прежде всего триангуляции графа L приведения его к триангулированному графу. Даже если гиперграф B ранее был комплектным, после триангуляции графа L он может утратить это свойство. Чрезвычайно важно выполнять триангуляцию графа L наилучшим образом. Известно, что задача нахождения наименьшей триангуляции произвольного графа является NP-трудной. Между тем триангуляцию хорошего качества можно всегда отыскать за время O. Для этого достаточно воспользоваться эвристикой минимальная степень. Суть ее в следующем в графе L выбирается вершина наименьшей степени, ее окрестность дополняется до клики затем данная вершина удаляется из L . Указанные действия повторяются до тех пор, пока L не выродится в пустой граф. Эвристика минимальная степень в большинстве случаев дает триангуляцию, близкую к наименьшей триангуляции. Это дерево может содержать узлы, мешки которых вложены. Важно, что данный алгоритм допускает построение требуемого дерева с разной степенью приближения к оптимальному дереву декомпозиции. 1. 2. Дерево соединений для H дерево декомпозиции исходного гиперграфа. 3. Тем самым получим дерево декомпозиции меньшей ширины, чем в предыдущем случае. 4. Выполнение этапа 2 исчерпывает все возможности алгоритма CTDA по построению дерева декомпозиции гиперграфа. Иллюстрация работы алгоритма CTDA. Ранг гиперграфа H равен 6. Процесс построения для H дерева декомпозиции изображен на рисунке 2 и включает в себя следующие действия. Ребра u, u U содержат висячие вершины x, x, x, x, x, x, x. Слабое удаление этой вершины приводит к блокам B и B. Блок B некомплектный гиперграф, для которого граф L нетриангулированный. В H нет ребер с таким составом вершин. Блок B некомплектный гиперграф, но граф L триангулированный. Для этой клики в H нет подходящего ребра. Его помеченный реберный граф L изображен на рисунке 2d. Построенное дерево декомпозиции имеет узлы с вложенными мешками, поэтому возможно сокращение числа узлов этого дерева без изменения его ширины. Однако блоки B и B состоят из 5 и 3 вершин соответственно. Это уже меньше r. Это приведет к дереву декомпозиции с меньшим числом узлов, чем на рисунке 2d, и той же ширины 5. Можно убедиться, что для заданного -гиперграфа H не существует дерева декомпозиции с шириной меньше 5. Таким образом, алгоритм CTDA в данном конкретном случае конструирует оптимальные деревья декомпозиции. В заключение необходимо отметить, что представленный в работе эвристический алгоритм CTDA основан на характеризациях М-ациклических гиперграфов. В нем применяется эвристика минимальная степень. Оптимальность алгоритма CTDA может быть потеряна только за счет этой эвристики. Основное преимущество алгоритма CTDA перед другими подобными алгоритмами использование в полном объеме информации о структуре исходного гиперграфа. Алгоритм CTDA реализован в виде программы на языке C. Вычислительные эксперименты показали, что алгоритм создает дерево декомпозиции, которое оптимально или близко к оптимальному, когда в исходном гиперграфе после предобработки алгоритмом Грэхема все ребра имеют приблизительно одну и ту же степень. Возможно включение в алгоритм CTDA новых эвристик, расширяющих область эффективного применения данного алгоритма. 