РАЗРАБОТКА СИСТЕМЫ ОЦЕНКИ ПАРАМЕТРОВ ЦУНАМИ   У ПРИБРЕЖНЫХ ТЕРРИТОРИЙ  

Проблема своевременного предупреждения населения об опасности цунами всё еще является актуальной  на прибрежных территориях всего мира. Несмотря на то что цунами довольно редкое явление, его последствия могут быть катастрофическими. В Академгородке многие годы занимаются разработкой и реализацией алгоритмов численного моделирования цунами, используемых для расчета параметров цунами у береговой линии. Целью данной работы является объединение существующих реализаций алгоритмов, написанных  на разных языках программирования (С++, Си, Python, Kotlin, Fortran и т. д.), в единую систему. Разработанная система позволит, принимая на вход данные о сейсмическом событии, рассчитывать параметры цунами  у защищаемой береговой линии. В статье рассмотрены основные этапы работы системы, такие как мониторинг сейсмической активности, извлечение данных с DART станций, фильтрация приливной компоненты, расчет времени добегания волны и непосредственно моделирование, и промежуточные шаги, связанные  с предобработкой и трансформацией данных. Особое внимание уделяется разработке архитектуры системы, взаимодействие между модулями построено таким образом, чтобы в дальнейшем реализации алгоритмов могли дорабатываться и беспрепятственно встраиваться в систему. 

 В настоящее время единственный метод защиты от цунами и его последствий своевременное предупреждение населения прибрежных территорий о надвигающейся опасности. Для оценки масштаба возможных разрушений необходимо обладать данными о высоте и скорости волны у береговой линии. Для решения этой задачи применяются методы математического моделирования. При прогнозировании такого рода событий критическую важность имеет время, которое необходимо затратить для моделирования цунами с момента получения первых данных о землетрясении. В новосибирском Академгородке, и в частности в НГУ, давно занимаются решением этой задачи. На данный момент реализовано множество алгоритмов, каждый из которых решает одну из подзадач. Данные алгоритмы постоянно совершенствуются, увеличивается скорость работы 1. При этом эффективность того или иного алгоритма оценивается на основании тестирования на синтетических и или исторических данных. Полный путь от сырых данных об эпицентре землетрясения до получения параметров волны у побережья состоит из 4 основных шагов извлечение данных о профиле волны, которая проходит через некоторый регистратор, фильтрация приливной компоненты, расчет начальной деформации водной поверхности в зоне источника цунами, моделирование распространения волны по открытой воде. Помимо этого, существуют промежуточные шаги, связанные с обработкой и трансформацией данных для передачи на вход следующему алгоритму. В такой ситуации ручное тестирование любого из основных алгоритмов является довольно трудоемким в плане подготовки тестовых данных. Также все шаги не тестируются в совокупности. Решением этой проблемы является создание системы по предупреждению опасности цунами, объединяющей разработанные алгоритмы. Такая система позволит в автономном режиме следить за сейсмической активностью и выдавать предупреждение в случае возникновения опасности цунами для прибрежной территории, а также проводить сквозное тестирование новых алгоритмов. Цель данной работы разработать систему, которая позволит в автоматическом режиме, принимая на вход данные о некотором сейсмическом событии, рассчитывать параметры цунами у прибрежных территорий. Дополнительным условием является то, что разные этапы алгоритма должны быть изолированы и могут реализовываться на разных языках программирования. Алгоритмы будут совершенствоваться, и система должна уметь реагировать на эти изменения. Рассмотрим основные шаги моделирования цунами. Причинами возникновения цунами могут стать подводные землетрясения вулканическая активность подводные оползни падение в воду обломков скал и т. д. Согласно глобальной исторической базе данных о цунами, с 1900 г. более 80 вероятных цунами были вызваны землетрясениями. Но далеко не каждое подводное землетрясение сопровождается цунами. Цунамигенным т. е. порождающим катастрофическую волну может быть лишь землетрясение с большой энергией магнитуда более 7,8. Если же магнитуда меньше 6, то вероятность цунами близка к нулю 2. В связи с этим начало деятельности по предупреждения населения об опасности цунами начинается с отслеживания сейсмической активности. На данный момент существует множество сервисов, которые представляют информацию о сейсмических событиях в реальном времени. Примером такого сервиса является сайт Геологической службы США United States Geological Survey, USGS. У каждого государства, которое подвержено опасности цунами, существуют программы по минимизации последствий от такого рода опасности. Наиболее интенсивно такие программы развиваются в США и Японии. В рамках Национальной программы США по предотвращению опасности цунами была построена сеть из DART Deep-ocean Assessment and Reporting of Tsunamis станций, расположенных вблизи цунамигенных регионов рис. 1. В данной работе для рассмотрения была выбрана именно программа США, так как она наиболее активно развивается и предоставляет открытые данные со станций в реальном времени на сайте Национального управления океанических и атмосферных исследований National Oceanic and Atmospheric Administration, NOAA . DART станция состоит из двух основных частей датчика давления, который крепится к морскому дну, и поверхностного буя. Датчик давления измеряет изменение высоты водяного столба и с помощью телеметрии сообщает поверхностному бую данные 3, которые через спутник передаются в центр обработки данных рис. 2. Система имеет два режима стандарт и событие. В обычном режиме датчик регулярно собирает информацию об уровне моря и сообщает результаты измерения при относительно низких частотах передачи каждые 15 минут. Это экономит электроэнергию и, следовательно, время автономной работы и продлевает срок службы. Система переходит в режим события, когда датчик давления фиксирует волну Релея, поверхностную сейсмическую волну. Затем он начинает сообщать информацию об уровне моря с частотой измерения 15 секунд, а затем с частотой в 1 минуту. Система возвращается в стандартный режим через 4 часа, если дальнейшие сейсмические события не обнаружены. Профиль волны, поступающий с DART станции, является суперпозицией волны от источника цунами и приливной компоненты и не может быть использован для дальнейших шагов. Ветровые волны станция не фиксирует, поскольку они не оказывают давления на датчик, который расположен на дне. Чтобы получить доступ к реальному профилю волны цунами, необходимо отфильтровать приливную компоненту. Для фильтрации приливной компоненты в рамках стажировок иностранных студентов на ФИТ НГУ Jessy Bogalho разработал скрипт на Python. На вход данный алгоритм принимает начало и конец временного интервала для извлечения данных и номер DART станции. Данные с DART станции в реальном времени размещаются на сайте Национального управление океанических и атмосферных исследований США . Для получения данных о профиле волны необходимо обладать информаций о номере станции и времени прохождения волны через нее. Специализированного API для получения данных с DART станции не предусмотрено, поэтому необходимо производить ручной разбор HTML страницы. Для этого используется библиотека Beautiful Soup . Алгоритм фильтрации приливной компоненты волны использует данные с датчика DART за несколько дней до события и во время прохождения волны цунами через станцию включительно. Этапы работы алгоритма 1 предобработка данных удаление дубликатов, восстановление пропусков в данных, исправление некорректных значений, удаление данных после прохождение цунами после возврата к 15 минутной частоте измерения 2 интерполяция данных о высоте волны для приведения к одному шагу измерения 3 построение функции экстраполяции по данным до события и применение ее на интервале прохождения цунами 4 на интервале прохождения цунами вычитаем из реальной функции экстраполированную, тем самым получая чистый сигнал, без приливной компоненты. Результатом работы алгоритма являются 2 набора чисел первый содержит данные о времени измерения, а второй соответствующую этому времени высоту волны в точке расположения DART станции. Для извлечения данных о профиле волны цунами с DART станции необходимо понимать, когда начинать снимать сигнал, т. е. когда волна достигнет станции. Время движения волны в океане неравномерно, поскольку зависит от профиля дна. Это ставит перед нами дополнительную задачу. Для расчета времени добегания волны используется алгоритм, описанный А. Г. Марчуком 4. В качестве шаблона соседних вершин используется шаблон, состоящий из 16 точек рис. 3, описанный в 5. Расчет времени добегания волны до рассматриваемой вершины строится путем минимизации суммы времени добегания волны от очага до соседних вершин в которые волна уже дошла и от этой соседней вершины до рассматриваемого узла 4. Скорость распространения волны зависит только от глубины воды и вычисляется по формуле Лагранжа, где ускорение силы тяжести, а глубина. Время движения волны цунами между соседними узлами расчетной сетки равно расстоянию между ними, деленному на среднее арифметическое скоростей цунами в этих точках 4, т. е. 2, где расстояние между узлами сетки, а и значение глубины в соответствующих точках. Пакет MOST, который используется для моделирования цунами, может работать в двух режимах принимая на вход параметры землетрясения например, длину и ширину разлома, угол разлома и т. д. или деформацию водной поверхности после сейсмического события . С практической точки зрения больше применим второй вариант, так как узнать вышеперечисленные характеристики в момент, когда произошло землетрясение не представляется возможным сейсмические наблюдения позволяют определить лишь координаты эпицентра землетрясения и оценить магнитуду количество выделившейся энергии. Для восстановления формы первоначального возмущения водной поверхности используется метод предварительных вычислений. Запись с DART станции аппроксимируется линейной комбинацией синтетических расчетных мареограмм 6. Для получения этих расчетных мареограмм наиболее сейсмогенные районы океана были покрыты системой эталонных единичных источников прямоугольников размером 50 100 км рис. 4. Затем в каждый единичный источник была помещена предварительно выбранная характерная форма возмущения морского дна и численно определены параметры волны от такого возмущения. В работах В. Титова было показано, что сигнал от неизвестного источника цунами можно с удовлетворительной точностью приблизить линейной комбинацией синтетических сигналов, вычисленных заранее, от эталонных источников 6. Далее по полученным коэффициентам в разложении реального сигнала необходимо сформировать деформацию для рассматриваемого события и передать его на вход алгоритму расчета распространения волны цунами, который по сути тот же самый, что и для расчетов профилей волны от единичных источников. Для моделирования используется пакет MOST Method of Splitting Tsunami, который представляет собой набор программ численного моделирования, способных имитировать три процесса эволюции цунами землетрясение, распространение волны и расчет наката волны на берег. Вышеперечисленные шаги составляют каркас системы моделирования цунами, однако для полной работы системы как единого целого необходимы еще и промежуточные этапы, которые будут решать задачи предобработки данных и обеспечивать интеграцию между различными реализациями основных алгоритмов. Полный алгоритм работы системы можно рассмотреть на схеме рис. 5. Основной целью работы является объединение существующих алгоритмов в единую систему. Так как существующие алгоритмы реализованы на разных языках программирования Fortran, C, C, Python и в будущем будут изменяться, необходимо обеспечить легкое внедрение нового алгоритма в общую систему. Для этого предлагается изолировать все элементы системы друг от друга, но четко зафиксировать контракт общения между ними рис. 6. Для такого рода взаимодействия хорошо подходит микросервисная архитектура. Каждый отдельный алгоритм инкапсулирован в микросервисе, общение происходит через REST API. Для удобства поставки модули упакованы в docker-контейнеры, а для запуска всех контейнеров как единой системы используется docker-compose . Это решение позволяет не задумываться о подготовке среды для запуска приложения на новом сервере, так как каждый контейнер уже включает в себя вс необходимое для работы приложения библиотеки, системные инструменты, код и среду исполнения 7. Рассмотрим подробнее назначение каждого модуля и общий алгоритм работы системы. 1. . Компонентом системы, инициирующим начало основной работы, является подмодуль отслеживания сейсмической активности в океане. Данный подмодуль периодически опрашивает систему мониторинга сейсмической активности. В настоящий момент используются данные с сайта Геологической службы США United States Geological Survey, USGS . В дальнейшем возможно использование других источников. При старте приложения запускается периодическая задача, которая опрашивает сервис USGS для получения данных о новых сейсмических событиях. Данная информация представлена в формате ATOM с использованием стандарта GeoRSS, для разбора используется библиотека Rome . Полученные данные фильтруются по локации землетрясения для моделирования цунами имеет смысл рассматривать только те события, которые произошли в море или океане. Также не имеет смысла обрабатывать события с низкой магнитудой. 2. . При обнаружении релевантного события для начала моделирования необходимо получить данные с DART станции в дальнейшем можно использовать несколько источников, например, кабельные системы, GPS буи. Для ускорения поиска ближайшей станции данные о расположении DART станций были извлечены из сети Интернет и сохранены в локальной базе данных. Для расчета времени добегания волны используется алгоритм описанный А. Г. Марчуком в статье Минимизация погрешностей при численных расчетах волновых лучей и фронтов цунами 4. На начало работы над системой уже существовала реализация данного алгоритма на C. Однако она не вполне подходила для применения в работе алгоритм был рассчитан для работы с батиметрической картой картой, изображающей подводный рельеф по равномерной сетке в формате GBR98. Батиметрия, которая используется для основного алгоритма системы MOST, построена на прямоугольной, но не квадратной сетке. На данный момент алгоритм портирован на язык Kotlin и доработан для работы с прямоугольной сеткой, протестирован и отлажен на исторических событиях. 3. . Профиль волны, полученный с DART станции, не может быть использован в чистом виде для выполнения дальнейших шагов, так как он содержит приливную компоненту. Существующая реализация алгоритма фильтрации приливной компоненты на Python, выдавала неплохой результат, однако в процессе обработки сигнала изменялся временной интервал измерений. Таким образом, на выходе программа выдавала корректные результаты в плане высоты волны, но неверные соответствия времени измерения рис. 7. На данный момент программа доработана и протестирована на нескольких исторических событиях. Для поднятия веб-сервера на Python был использован фреймворк Flask . 4. . Для разложения реального сигнала как линейной комбинации сигналов от синтетических источников П. Татаринцевым был реализован алгоритм на C 8. Данный алгоритм принимает на вход два текстовых файла, которые содержат реальный профиль волны и расчетные мареограммы от нескольких ближайших эталонных источников в месте расположения DART станции. Результатом работы алгоритма является текстовый файл, в котором каждому эталонному источнику соответствует коэффициент в разложении реального сигнала. Такой вариант входных и выходных файлов прост в разработке, но является неподходящим для интеграции с другой системой. В связи с этим данная реализация была изменена на общение с модулем координации через REST API. На вход алгоритм принимает отфильтрованный сигнал с DART станции без приливной компоненты и данные синтетических расчетных мареограмм от базисных источников. Результатом работы алгоритма являются коэффициенты, соответствующие базисным источникам, линейная комбинация которых приближает реальный сигнал с определенной точностью. Для обработки событий в реальном времени необходимо иметь базу данных синтетических мареограмм. Получение расчетных мареограмм производится с использованием пакета MOST для моделирования волны цунами от эталонного источника. Результатом рабо ты MOST является файл формата NetCDF Network Common Data Form, содержащий информацию о высоте волны и скорости по направлениям и для каждого узла батиметрии в зависимости от времени. NetCDF это бинарный формат файлов, предназначенный для создания, доступа и публикации научных данных. NetCDF является самоописательным форматом, это значит, что в файл входит информация о содержащихся в нем данных, включая указание на единицы измерения. Для работы с файлами формата NetCDF используется библиотека NetCDF Java . Полный расчет деформации водной поверхности океана от одного эталонного источника занимает на дисковом пространстве порядка 2 Гб данных. Это ставит перед нами дополнительную задачу обеспечить оптимальное хранение расчетных мареограмм. Если тщательно проанализировать задачу, становится ясно, что хранение данных о профиле волны для всех точек океана совсем не обязательно. Для подсчета коэффициента интересны только данные в точках расположения DART станций. Таким образом, проделав предварительную работу по извлечению из NetCDF файлов расчетных мареограмм данных о профиле волны в точках расположения DART станций, можно уменьшить объем хранимой информации на диске и увеличить скорость обработки сейсмического события. Но следует учитывать, что такого рода база данных требует периодического обновления для поддержания ее в актуальном состоянии, так как DART станции могут менять место своего расположения например, после поднятия на поверхность для сервисного обслуживания. 5. . По полученным на предыдущем этапе коэффициентам формируем деформацию для рассматриваемого события и передаем ее на вход пакету MOST. Результатом работы пакета MOST является файл в формате NetCDF, для просмотра результатов моделирования может быть использована утилита ncview рис. 8. В дальнейшем можно доработать систему таким образом, чтобы визуализировать сравнение результатов моделирования с реальными данными о профиле волны с DART станции. 6. . Модуль, контролирующий взаимодействие всех частей системы, разработан на языке Kotlin. Это статически типизированный язык программирования, работающий поверх JVM. Данный модуль отвечает за все промежуточные шаги между основными этапами моделирования цунами, такие как поиск ближайших к эпицентру сейсмического события DART станций и единичных источников, разбор NetCDF файла для извлечения профиля волны в точках расположения DART станций, формирование композитной деформации водной поверхности из деформаций от единичных источников по коэффициентам в разложении реального сигнала и т.д. Результатом работы является программное средство для оценки параметров цунами. Данная система позволит в автоматическом режиме анализировать волну цунами от получения данных о сейсмическом событии до моделирования поведения волны у прибрежной территории. Все этапы работы системы изолированы в отдельные модули, что позволяет легко тестировать и отлаживать новые реализации этапов алгоритма, отслеживая, как те или иные изменения повлияют на весь алгоритм моделирования. Работа над данным проектом еще не закончена, в дальнейшем планируется закончить интеграцию всех модулей системы, а также разработать пользовательский интерфейс для работы с системой. 