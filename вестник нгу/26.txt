РАЗРАБОТКА МУЗЫКАЛЬНОЙ РЕКОМЕНДАТЕЛЬНОЙ СИСТЕМЫ  НА ОСНОВЕ ОБРАБОТКИ МЕТАДАННЫХ КОНТЕНТА  

Музыкальная рекомендательная система (МРС) помогает пользователям музыкальных стриминговых сервисов находить интересующий их музыкальный контент. Разреженность пользовательских оценок – одна  из главных проблем исследования МРС. Она вызвана тем, что пользователь оценивает лишь малую долю объектов музыкального каталога. В результате МРС часто не обладает достаточным набором данных для составления рекомендаций.  В статье предложен подход для решения проблемы разреженности пользовательских оценок на основе использования оценок связанных объектов. Описана гибридная МРС, использующая как нормализованные пользовательские оценки треков, альбомов, артистов, жанров, так и информацию о связях между объектами разных типов. Произведена оценка эффективности разработанной МРС, а также произведен сравнительный анализ предложенного подхода с коллаборативным методом предсказания пользовательских предпочтений. 

 Рекомендательные системы это программные инструменты и методики, которые предлагают пользователям объекты, наиболее интересные для них 1. Музыкальная рекомендательная система МРС предлагает пользователям музыкального сервиса объекты музыкального каталога. Основными задачами и направлениями исследований МРС являются 1 предсказание пользовательских оценок треков, альбомов, артистов, жанров и др. 2 автоматическое тегирование 3 автоматическое составление продолжение плейлиста 4 контекстно-ориентированные системы. Задача предсказания пользовательских оценок решается для составления рекомендаций 25 и для восполнения пропусков в разреженной матрице пользовательских оценок 6. Семантические дескрипторы теги позволяют описать объекты музыкального каталога в терминах, понятных для пользователя 7 8, поэтому они удобны для поиска музыки. Этим вызван интерес к задачам автоматического тегирования, например, классификации жанров и распознавания эмоций 9. Так как пользователь обычно слушает треки в составе последовательности 10, задача автоматического составления продолжения плейлиста 8 11 также представляет интерес. Она связана с выбором треков, соответствующих предопределенным характеристикам например, семантическим дескрипторам 8, порядком выбранных треков и др. 10. Контекст пользователя локация, время, деятельность и др. значительно влияет на его ситуативные предпочтения 10, поэтому разработка контекстно-ориентированных систем 8 является перспективным направлением. Для решения задач исследований МРС используются три вида данных 1 контентные данные 2 музыкальный контекст 3 пользовательские данные. Контентные данные 12 это значения акустических признаков, полученные в результате обработки аудиосигнала 2 3 8 13. Музыкальный контекст 14 это данные, которые описывают музыкальные объекты, но не являются результатом обработки аудиосигнала. Например, текстовые описания объектов, информация о связях между объектами разных типов, теги, поставленные экспертной группой, и др. Пользовательские данные 15 включают в себя персональные данные 3 5, историю воспроизведений 4 11 16, историю сессий повторные воспроизведения треков, пропуски треков и др. 4 6, контекст пользователя 6 8, поставленные оценки 2 3 5 6, присвоенные теги 11 13 и др. Также используются данные о взаимодействии пользователей с другими видами контента 5. При решении задач исследований МРС возникают следующие проблемы 1 холодный старт новый пользователь, новый объект 2 разреженность пользовательских оценок. Проблема холодного старта 10 является обобщением проблемы нового пользователя и проблемы нового объекта. Проблема нового пользователя возникает, когда пользователь регистрируется в музыкальном сервисе, и МРС не обладает данными об этом пользователе, чтобы составить для него рекомендацию. Для решения этой проблемы применяются опрос пользователя при регистрации и кросс-доменный подход 5. Проблема нового объекта возникает, когда объект добавляется в каталог, и МРС не обладает данными об этом объекте, чтобы включить его в рекомендацию. Для решения этой проблемы применяются контентноориентированный подход 2 и контентные гибридные системы 13 16. Проблема разреженности пользовательских оценок 10 возникает, когда число поставленных оценок значительно меньше числа возможных. Разреженность определяется согласно формуле 1 где число пользователей, число объектов, число пользовательских оценок пользователь может поставить только одну оценку объекту. Эта проблема особенно актуальна для исследований МРС. Из-за того, что музыкальные каталоги содержат огромное число объектов десятки миллионов треков 10, пользователь обычно взаимодействует лишь с малой их долей. Также пользователь обычно слушает треки в составе последовательности и не прерывает воспроизведение, чтобы оценить их. Более того, пользователь нередко не концентрируется на воспроизводимых треках и не оценивает их. В результате доля объектов, оцененных пользователем, обычно близка к нулю. Значение разреженности одного из наибольших наборов данных C15 Yahoo Music user ratings of musical tracks, albums, artists and genres, v 1.0 составляет 99,96 набор данных содержит пользовательские оценки треков, альбомов, артистов, жанров. Для сравнения разреженность набора данных от Netflix составляет 98,82 набор данных содержит пользовательские оценки фильмов и сериалов 10. Разница более чем в процент существенна. Для решения этой проблемы применяются контентные гибридные системы и методы, в которых вычисляются неявные пользовательские оценки. В контентных гибридных системах 2 обычно для предсказания пользовательской оценки трека используются оценки треков похожих по значениям акустических признаков. Также может быть обучена модель 3, которая использует значения акустических признаков совместно с персональными данными. В методах, основанных на неявных оценках 4 6 для треков, с которыми пользователь взаимодействовал, но которые не оценивал, вычисляются неявные оценки, которые восполняют пропуски в разреженной матрице пользовательских оценок. Для решения проблемы разреженности пользовательских оценок предлагается использовать оценки связанных согласно метаданным контента объектов музыкального каталога как похожих. В статье описана гибридная МРС, в которой применен предложенный подход. Этапы работы МРС 1 определение похожих альбомов, артистов, жанров 2 предварительный выбор треков 3 определение похожих пользователей 4 вычисление значений признаков 5 обучение модели для предсказания пользовательских оценок треков 6 предсказание пользовательских оценок треков 7 составление рекомендации. На этапах 12 для пользователя предварительно выбираются треки. Для этого определяются альбомы, артисты, жанры, которые предположительно нравятся ему, и выбираются треки, связанные с ними. На этапах 36 для каждого выбранного трека предсказывается оценка. Для этого используются оценки, поставленные похожими пользователями как этому треку, так и связанным с ним объектам. На этапе 7 выбираются треки с наибольшими предсказанными оценками. Объекты представлены в виде целочисленных идентификаторов. Множество объектов определено согласно формуле где число объектов. Метаданные контента содержат информацию о типах объектов и о связях между объектами разных типов. В результате обработки метаданных контента определены 1, разбиение множества на множества треков, альбомов, артистов, жанров 2 отображение, которое сопоставляет с треком связанный альбом. Если трек не связан ни с одним альбомом, то сопоставляется 3 отображение, которое сопоставляет с треком связанного артиста. Если трек не связан ни с одним артистом, то сопоставляется 4 отображение, которое сопоставляет с треком множество связанных жанров 5 отображение, которое сопоставляет с альбомом связанного артиста. Если альбом не связан ни с одним артистом, то сопоставляется 6 отображение, которое сопоставляет с альбомом множество связанных жанров. Также определены вспомогательные отображения 1 отображение, которое сопоставляет с альбомом множество связанных треков 2 отображение, которое сопоставляет с артистом множество связанных треков 3 отображение, которое сопоставляет с артистом множество связанных альбомов 4 отображение, которое сопоставляет с жанром множество связанных треков 5 отображение, которое сопоставляет с жанром множество связанных альбомов. Пользователи представлены в виде целочисленных идентификаторов. Множество пользователей определено согласно формуле где число пользователей. МРС использует пользовательские оценки объектов 1 отображение, которое сопоставляет с пользователем и объектом нормализованную оценку. Если пользователь не оценивал объект, то сопоставляется 2 отображение, которое сопоставляет с пользователем и объектом бинарную оценку. Определено согласно формуле где пороговое значение. Если достигает, то считается, что пользователю нравится объект . Если пользователь не оценивал объект, то сопоставляется . Рассмотрим на примере альбомов. В первую очередь по формуле определяется множество альбомов, связанных хотя бы с одним треком, . Для каждого альбома согласно формуле строится вектор . Компонента соответствует пользователю и содержит значение из множества в зависимости от того, оценивал ли пользователь альбом, и если оценивал, то понравился ли альбом ему. Далее, для каждой пары альбомов на основе векторов и вычисляется значение коэффициента схожести Чем ближе значение к, тем больше альбомы, похожи. Чем ближе значение к, тем более они различны. Если значение близко к, то схожесть не определена. Если хотя бы один альбом не оценен ни одним пользователем, то считается, что . Далее, для каждого альбома на основе значений определяется множество похожих альбомов где пороговое значение. Для артистов, жанров, связанных хотя бы с одним треком, аналогично. Также при построении вектора для альбома, если пользователь не оценивал альбом, но оценивал хотя бы один связанный трек, предлагается вычислять среднее значение нормализованных оценок пользователя, поставленных связанным трекам, и в зависимости от того, достигает ли это значение, восполнять компоненту значением из множества . В результате восполнения нулевых компонент векторов строятся векторы, которые могут быть использованы вместо векторов при вычислении значений . Аналогично для артистов, жанров используются оценки связанных треков и альбомов. Для пользователя выбираются треки, которые в дальнейшем могут быть включены в рекомендацию. В первую очередь согласно формулам, определяются множества альбомов, связанных хотя бы с одним треком, которые нравятся пользователю, не нравятся и которые он не оценивал, соответственно. Для каждого альбома определяется число похожих альбомов, которые нравятся пользователю и не нравятся, соответственно, . На основе этих чисел предсказывается бинарная оценка . Если оба эти числа равны нулю, то оценка не предсказывается. Для артистов, жанров, связанных хотя бы с одним треком, аналогично. Для пользователя случайно выбираются треков, связанных с альбомами, артистами, жанрами, которые предположительно нравятся ему согласно или . В первую очередь для каждого пользователя строится вектор . Компонента соответствует объекту и содержит значение из множества в зависимости от того, оценивал ли пользователь объект, и если оценивал, то понравился ли объект ему. Далее, для каждой пары пользователей на основе векторов и вычисляется значение коэффициента схожести Чем ближе значение к, тем больше пользователи, похожи. Чем ближе значение к, тем больше они различны. Если значение близко к, то схожесть не определена. Если хотя бы один пользователь не оценивал ни один объект, то считается, что . Далее, для каждого пользователя на основе значений определяется множество похожих пользователей . Для этого выбираются пользователей с наибольшими положительными значениями . Для пары пользователь, трек вычисляются значения признаков . В качестве признаков выбраны средние взвешенные значения нормализованных оценок, поставленных похожими пользователями из множества объектам из множеств табл. 1. Признаки и соответствующие множества объектов Features and Corresponding Sets of Items Признак Множество Объекты множества Трек Альбом, связанный с треком Треки, связанные с альбомом Артист, связанный с треком Треки и альбомы, связанные с артистом Жанры, связанные с треком Треки и альбомы, связанные с жанрами Идея заключается в том, что если похожие пользователи не оценивали трек это вероятно из-за проблемы разреженности пользовательских оценок, то, возможно, они оценивали связанные альбом, артиста, жанры. В этом случае значение не определено, но хотя бы одно из значений, можно вычислить. Если похожие пользователи не оценивали и связанный альбом, то, возможно, они оценивали другие треки, связанные с ним. В этом случае значение не определено, но значение можно вычислить. Аналогично для связанных артиста, жанров. Более того, когда значение можно вычислить, использование значений может способствовать увеличению эффективности предсказания оценок треков. Множества объектов см. табл. 1 определены согласно формулам, Значения признаков вычисляются по формулам, Если, то значение не определено. В этом случае считается, что . На этапах определения похожих пользователей и вычисления значений признаков подготавливаются тренировочное, валидационное для выбора модели и тестовое множества. Эти множества содержат кортежи пользователь, трек, значения признаков, оценка или . Важно, чтобы при подготовке этих множеств используемые оценки не пересекались. С использованием тренировочного множества обучается модель модели для предсказания оценок треков или . В качестве входных данных модель использует предварительно обработанные значения . Обученная модель предсказывает оценки для предварительно выбранных треков. Для пользователя составляется список треков, которые, предположительно, нравятся ему. Для этого из предварительно выбранных треков выбираются треков с наибольшими предсказанными нормализованными оценкам, достигающими в порядке убывания предсказанной нормализованной оценки. Если предсказываются бинарные оценки, то трек включается в рекомендацию, если предсказанная бинарная оценка . Для реализации МРС выбран набор данных C15 Yahoo Music user ratings of musical tracks, albums, artists and genres, v 1.0 тренировочное подмножество большого поднабора данных, табл. 2. Пользователи и объекты треки, альбомы, артисты, жанры представлены в виде целочисленных идентификаторов. Для треков опционально определены связанные альбом, артист, жанры для альбомов связанные артист, жанры. Пользовательские оценки представлены в виде целочисленных значений из множества, хотя 97,69 оценок кратны 10. Основные характеристики используемой части набора данных Characteristics of the Datasets Applied Part Показатель Значение Число пользователей 1000990 Число объектов 624961 Число треков 507172 Число альбомов 88909 Число артистов 27888 Число жанров 992 Число пользовательских оценок 252800275 Разреженность согласно формуле 1 99,96 Оценки при помощи деления на 100 приведены к значениям из отрезка . Выбрано пороговое значение нормализованной оценки . Это наибольшее значение, которое достигается как минимум половиной нормализованных оценок 58,67, при 47,44 . Недостатком набора данных является то, что не все альбомы, артисты, жанры связаны с треками. Поэтому на этапах определения похожих альбомов, артистов, жанров и предварительного выбора треков рассматривались 52 187 альбомов 58,7 от числа всех альбомов, 19 691 артист 70,61, 205 жанров 20,67 . На основе оценок пользователей из множества определены множества похожих альбомов, артистов, жанров. Для этого использовались значения, вычисленные на основе векторов, и пороговые значения 0.01, 0.05, 0.1, 0.15, 0.2, 0.25 12 подходов, для каждого подхода множества определены по отдельности. Для альбомов выбирается подход, при котором достигается наибольшая точность предсказания бинарных оценок. Для артистов, жанров аналогично. Для пользователя с применением выбранных подходов предварительно выбираются треков. Для каждого пользователя из множества оценки треков разделены на тренировочные, валидационные и тестовые в долях 75, 12,5, 12,5 соответственно. Все оценки альбомов, артистов, жанров использовались как тренировочные. Для построения векторов и вычисления значений использовались только тренировочные оценки. Для пользователей из множества хотя бы с одной оценкой трека 123 пользователя вычислены значения относительно пользователей из множества . Для определения множеств похожих пользователей выбирались пользователей с наибольшими положительными значениями . В результате для 119 из 123 пользователей определена 1 000 похожих пользователей для остальных 4 пользователей меньшее число. В среднем по 123 множествам среднее значение составило 0,1481, а среднее квадратичное отклонение значений внутри множества 0,03. Для оценок треков, поставленных пользователями из множества, вычислены значения признаков . В результате подготовлены тренировочное, валидационное и тестовое множества с мощностями 16769, 2797, 2787 соответственно табл. 3. Доли пропусков значений признаков, Features Missing Parts, Множество Признак Тренировочное 32,55 20,6 17,87 13,71 13,36 4,94 2,17 Валидационное 33,25 20,38 17,73 14,48 13,55 4,83 2,32 Тестовое 32,15 19,27 17,19 13,17 12,67 5,06 1,94 В тестовом множестве значение признака среднее взвешенное значение нормализованных оценок трека, поставленных похожими пользователями не определено в 32,15 случаев. Доли пропусков значений признаков значительно меньше. Отметим, что в используемой части набора данных 8,33 треков не связаны ни с одним альбом, 12,52 ни с одним артистом, 6,15 ни с одним жанром в коммерческих музыкальных каталогах эта проблема отсутствует. Для реализации модели выбран метод машинного обучения случайный лес 17. Метод применен со значениями параметров число деревьев 10, 20, 30, 40, 50, 60, 70 минимальное число элементов в листе 1, 5, 10, 15, 20 35 вариантов. Пропуски в значениях признаков заменяются средним значением признака в тренировочном множестве для признаков эти значения равны 0,5747, 0,5593, 0,547, 0,6021, 0,5579, 0,6243, 0,573 соответственно. С использованием тренировочного множества обучены модели для предсказания нормализованных и бинарных пользовательских оценок треков. С использованием валидационного множества выбираются модели с наибольшей эффективностью предсказания оценок. С использованием выбранной для нормализованных или бинарных оценок модели выбираются треков для рекомендации. Для оценки эффективности предсказания бинарных оценок альбомов, артистов, жанров использовались оценки пользователей из множества . На основе оценок пользователей из множества выявлено, что в случаев, когда пользователь оценивал как альбом, так и хотя бы один связанный трек, бинарная оценка альбома совпадает с приведенным к бинарному значению с использованием порогового значения средним значением нормализованных оценок связанных треков. Для артистов, жанров совпадения выявлены в и случаев соответственно. Это означает, что если пользователю нравится альбом, артист или жанр, то с большой вероятностью с меньшей для жанра ему нравятся связанные треки. Таким образом, при высокой точности предсказания бинарных оценок альбомов, артистов, жанров предварительный выбор треков является эффективным. Для каждого пользователя из множества с двумя и более оценками альбомов 4 652 пользователя оценки альбомов случайно разделены пополам на оценки, которые предсказываются и которые используются для предсказания. Всего предсказывалось 223 639 оценок, значение 0 принимают 46,3, значение 1 53,7 . Для каждого подхода получены точность по формуле 2 и доля не предсказанных оценок табл. 4. Результаты предсказания бинарных оценок альбомов все подходы Albums Binary Ratings Prediction All Approaches ACC, Доля, 0,01 78,51 78,62 0,85 0,47 0,05 79,57 1,61 1,33 0,1 76,96 76,61 6,47 7,25 0,15 66,1 63,39 20,55 24,16 0,2 49,49 44,15 41,32 48,13 0,25 34,91 28,17 59,27 67,47 Выбран подход с использованием векторов и значения . По сравнению с аналогичным подходом на основе векторов доля альбомов с хотя бы одним значением, достигающим, увеличилась с 93 до 95,86 для этих альбомов потенциально может быть предсказана бинарная оценка. Для выбранного подхода получены доли, в которых для бинарных оценок со значениями 0 и 1 предсказаны значения 0, 1 и табл. 5. Результаты предсказания бинарных оценок альбомов со значениями 0 и 1 выбранный подход Albums Binary Ratings Equal to 0 and 1 Prediction Selected Approach Для артистов аналогично табл. 6. Всего предсказывалось 359 378 оценок 9 831 пользователь, значение 0 принимают 39,39, значение 1 60,61 . Результаты предсказания бинарных оценок артистов все подходы Artists Binary Ratings Prediction 31,5 33,61 Выбран подход с использованием векторов и значения . По сравнению с аналогичным подходом на основе векторов доля артистов с хотя бы одним значением, достигающим, увеличилась с 91,13 до 94,57 . Для выбранного подхода получены доли, в которых для бинарных оценок со значениями 0 и 1 предсказаны значения 0, 1 и табл. 7. Результаты предсказания бинарных оценок артистов со значениями 0 и 1 выбранный подход Artists Binary Ratings Equal to 0 and 1 Prediction Selected Approach, 75,46 23,42 1,12 9,39 89,8 0,81 Для жанров аналогично табл. 8. Всего предсказывалось 32 596 оценок 6 498 пользователей, среди которых значение 0 принимают 38,92, значение 1 61,08 . Результаты предсказания бинарных оценок жанров все подходы Genres Binary Ratings Prediction All Approaches ACC, Доля, 0,01 84,35 83,91 0,01 0 0,05 84,95 84,17 0,05 0 0,1 85,89 84,85 0,23 0,05 0,15 86,09 0,85 0,52 0,2 86,09 86,03 1,93 1,94 0,25 84,62 84,9 4,08 3,82 Выбран подход на основе векторов и значения . Доля жанров с хотя бы одним значением, достигающим, составляет 100 . Для выбранного подхода получены доли, в которых для бинарных оценок со значениями 0 и 1 предсказаны значения 0, 1 и табл. 9. Результаты предсказания бинарных оценок жанров со значениями 0 и 1 выбранный подход Genres Binary Ratings Equal to 0 and 1 Prediction Selected Approach, 86,02 13,53 0,44 12,26 86,63 1,11 На основе оценок пользователей из множества с хотя бы одной оценкой трека 123 пользователя и похожих пользователей из множества подготовлены валидационное и тестовое множества с мощностями 2 797, 2 787 соответственно табл. 10. Доли оценок кратных 0,1 в валидационном и тестовом множествах, Parts of Ratings that Are Multiples of 0.1 in the Validation and the Test Sets. Метод случайный лес применен со значениями параметров число деревьев 10, 20, 30, 40, 50, 60, 70 минимальное число элементов в листе 1, 5, 10, 15, 20. Для обученных моделей с использованием валидационного множества получены значения RMSE табл. 11 RMSE предсказания нормализованных оценок треков из валидационного множества все модели Tracks Normalized Ratings Prediction RMSE for the Validation Set All Models Ч. д. Минимальное число элементов в листе 1 5 10 15 20 10 0,3133 0,3071 0,309 0,3107 0,3119 20 0,3065 0,3035 0,3048 0,3095 0,3106 30 0,3043 0,3028 0,3059 0,3083 0,311 40 0,3026 0,3014 0,3049 0,3084 0,3097 50 0,303 0,3018 0,3049 0,3075 0,3103 60 0,3036 0,30101 0,3048 0,3075 0,3099 70 0,3018 0,3042 0,3079 0,3104 Выбрана модель, для которой метод случайный лес применен со значениями параметров число деревьев 70, минимальное число элементов в листе 5. Также рассмотрен коллаборативный метод, в котором значение признака среднее взвешенное значение нормализованных оценок трека, поставленных похожими пользователями используется в качестве предсказания. В тех случаях, когда значение не определено для тестового множества в 32,15 случаев, используется среднее значение в тренировочном множестве. Для выбранной модели и коллаборативного метода с использованием тестового множества получены значения RMSE и MAE табл. 12 Результаты предсказания нормализованных оценок треков из тестового множества Tracks Normalized Ratings Prediction for the Test Set RMSE MAE Выбранная модель 0,3037 0,2354 Зн. пр. или ср. зн. 0,3946 0,3177 Выбранная модель превосходит коллаборативный метод. Также значения RMSE и MAE получены для подмножества тестового множества, для которого значения определены табл. 13. Результаты предсказания нормализованных оценок треков из подмножества тестового множества, для которого значения определены Tracks Normalized Ratings Prediction for the Part of the Test Set where Is Calculated RMSE MAE Выбранная модель 0,3093 0,2419 Зн. пр. 0,374 0,2808 Даже в тех случаях, когда коллаборативный метод предсказывает нормализованную оценку значение определено, выбранная модель предсказывает ее с меньшими значениями ошибок RMSE и MAE. Для выбранной модели получены значения важности признаков табл. 14. Для этого для каждого дерева вычисляется среднее взвешенное значение уменьшения неопределенности англ. impurity в вершинах, где используется признак. В качестве весов используются доли элементов тренировочного множества, достигающих вершины. Важность признака это среднее этих значений, вычисленных для каждого дерева. При обучении моделей в качестве меры неопределенности используется среднеквадратичная ошибка MSE. Важность признаков для предсказания нормализованных оценок треков выбранная модель Features Importance for the Normalized Ratings Prediction Selected Model 0,0986 0,0655 0,1166 0,1168 0,1106 Наиболее важными являются признаки и средние взвешенные значения нормализованных оценок, поставленных похожими пользователями трекам и альбомам артиста трекам и альбомам жанров соответственно. Аналогично обучены модели для предсказания бинарных оценок. Среди бинарных оценок из валидационного множества значение 0 принимают 43,15, значение 1 56,85 . Среди бинарных оценок из тестового множества значение 0 принимают 43,09, значение 1 56,91 . Для обученных моделей с использованием валидационного множества получены значения точности согласно формуле 2, табл. 15. Точность предсказания бинарных оценок треков из валидационного множества все модели, Tracks Binary Ratings Prediction Accuracy for the Validation Set All Models, Ч. д. Минимальное число элементов в листе 1 5 10 15 20 10 76,87 76,83 76,69 76,94 76,08 20 77,55 77,51 77,08 76,51 75,94 30 77,4 77,51 77,26 77,05 76,22 40 77,51 77,69 77,08 76,62 76,44 50 78,01 77,69 77,08 76,73 76,51 60 77,94 77,65 77,01 76,76 76,44 70 77,87 77,37 77,15 76,51 Выбрана модель, для которой метод случайный лес применен со значениями параметров число деревьев 70, минимальное число элементов в листе 1. Аналогично рассмотрен коллаборативный метод, в котором приведенное к бинарному значение признака используется в качестве предсказания. В тех случаях, когда значение не определено для тестового множества в 32,15 случаев, используется предопределенное значение бинарной оценки 0 или 1. Для выбранной модели и коллаборативного метода с использованием тестового множества получены значения точности и TPR, TNR, PPV, NPV табл. 16, . Результаты предсказания бинарных оценок треков из тестового множества Tracks Binary Ratings Prediction for the Test Set ACC, TPR TNR PPV NPV Выбранная модель 0,8045 0,7252 0,7945 0,7375 Зн. пр. или 0 64,08 0,8815 0,3231 0,6323 0,6736 Зн. пр. или 1 65,81 0,6141 0,7161 0,7407 0,5842 Выбранная модель превосходит коллаборативный метод. Также значения точности и TPR, TNR, PPV, NPV получены для подмножества тестового множества, для которого значения определены табл. 17. Результаты предсказания бинарных оценок треков из подмножества тестового множества, для которого значения определены Tracks Binary Ratings Prediction for the Part of the Test Set where Is Calculated ACC, TPR TNR PPV NPV Выбранная модель 76,04 0,8124 0,6776 0,8007 0,6938 Зн. пр. 72,03 0,8382 0,5322 0,7407 0,6736 Даже в тех случаях, когда коллаборативный метод предсказывает бинарную оценку, выбранная модель предсказывает ее с большей точностью и значениями TNR, PPV, NPV. Для выбранной модели аналогично получены значения важности признаков при обучении моделей используется неопределенность Джини, табл. 18. Важность признаков для предсказания бинарных оценок треков выбранная модель Features Importance for the Binary Ratings Prediction Selected Model 0,0971 0,1132 0,1258 Наиболее важными являются признаки, среднее взвешенное значение нормализованных оценок, поставленных похожими пользователями трекам и альбомам артиста трекам и альбомам жанров трекам альбома треку соответственно. В статье предложен подход для решения проблемы разреженности пользовательских оценок в исследованиях МРС. Он заключается в использовании оценок связанных согласно метаданным контента объектов как похожих. На основе предложенного подхода разработана и реализована МРС. Выполнена оценка реализованной МРС. Выявлено, что если пользователю нравится альбом, артист или жанр, то с большой вероятностью в меньшей степени для жанра ему нравятся и треки, связанные с ним. При этом получена точность предсказания бинарных пользовательских оценок альбомов, артистов, жанров 79,99, 84,15 и 86,39 соответственно. Это означает, что предварительный выбор треков, реализованный в МРС, является эффективным. Метод предсказания пользовательских оценок треков, реализованный в МРС, превосходит коллаборативный метод использующий оценки похожих пользователей, поставленные треку как на всем тестовом множестве в тех 32,15 случаев, когда коллаборативный метод не может предсказать оценку, используется предопределенное значение, так и на его подмножестве, для которого коллаборативный метод может предсказать оценку. При этом наиболее важными являются признаки, значения которых вычислены на основе оценок похожих пользователей, поставленных объектам, связанным с артистом и жанрами трека. Это означает, что использование оценок связанных объектов в реализованной МРС действительно способствует решению проблемы разреженности пользовательских оценок. 