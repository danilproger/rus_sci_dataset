ПРИМЕНЕНИЕ МОДЕЛЬНО-ОРИЕНТИРОВАННОГО ПРОЕКТИРОВАНИЯ   К СОЗДАНИЮ АСУ ТП ОПАСНЫХ ПРОМЫШЛЕННЫХ ОБЪЕКТОВ  

 Представлена реализация подхода «модельно-ориентированного проектирования» для решения задачи создания автоматизированных систем управления технологическими процессами (АСУ ТП) горнодобывающих предприятий.  Подход «модельно-ориентированного проектирования» заключается в организации контура тестирования,  в котором испытуемый объект функционирует в среде, идентичной реальному процессу по входным сигналам. Подход основан на использовании математических моделей, имитирующих протекание технологического процесса под управлением АСУ ТП. Математические модели используются для формирования наборов тестовых данных.  Разработан имитационный программно-аппаратный комплекс. Основными частями комплекса являются: рабочая станция оператора SCADA, рабочая станция оператора модели, среда передачи данных, блок формирования физических сигналов, блок дублирования физических сигналов и программируемые логические контроллеры АСУ ТП. В качестве среды имитационного моделирования применена система MTSS. Предложен и реализован вариант развития способа Hardware-in-the-loop, обеспечивающего создание совместимых компонентов систем автоматизации.  Приведено описание методики тестирования АСУ ТП. Данная методика успешно применена для разработки, отладки и тестирования АСКУ ТО М (Автоматизированная система контроля и управления технологическим объектом во взрывозащищенном исполнении).  : модельно-ориентированное проектирование, автоматизированная система управления технологическими процессами, промышленные системы управления, тестирование, прикладное программное обеспечение.  Работа выполнена при частичной поддержке РФФИ (проект № 16-07-01179).  О промышленной безопасности опасных производственных объектов // Федеральный закон № 116-ФЗ  от 21.07.1997 (с изм. и доп. от 07.03.2017); Приказ федеральной службы по экологическому, технологическому  и атомному надзору от 19 ноября 2013 г. № 550 «Об утверждении Федеральных норм и правил в области промышленной безопасности «Правила безопасности в угольных шахтах» (с изм. от 8.08.2017)». 

Создание автоматизированных систем управления технологическими процессами для опасных промышленных объектов требует не только строгого соблюдения стандартов в этой области, но и принятия дополнительных мер со стороны изготовителя для обеспечения повышенной надежности систем . Ошибки, допущенные на этапе проектирования системы и разработки прикладного программного обеспечения, могут приводить на этапах пусконаладки и опытной эксплуатации к увеличению сроков и стоимости ввода системы автоматизации в работу на этапе эксплуатации к возникновению нештатных и аварийных ситуаций. В связи с этим возникает задача проверки надежности прикладного программного обеспечения АСУ ТП на предприятии изготовителе на всех этапах разработки. Это позволяет повысить безотказность системы и, соответственно, безопасность технологического процесса снизить расходы на пуско-наладку и опытно-промышленную эксплуатацию упростить сопровождение, модернизацию и оптимизацию прикладного программного обеспечения. Для тестирования прикладного программного обеспечения на всех этапах создания систем применяют подход МОП модельно-ориентированное проектирование, англ. modelbased design approach, который основан на использовании моделей проектируемой системы и модели контролируемого процесса 1 2. Эти модели являются спецификацией проектируемой системы, которая актуализируется во время выполнения разработки. Данная спецификация позволяет выполнить анализ корректности и возможности выполнения требований посредством моделирования . Применение подхода МОП обеспечивает повышение надежности создаваемых программных, аппаратных и программно-аппаратных систем . Появлению этого подхода предшествовали этапы становления общей теории систем, создание CASE Computer-Aided Software Engineering совокупность средств автоматизации разработки программного обеспечения, разработка языка UML Unified Modeling Language в 1990-х гг., обеспечивающего проектирование систем на разных уровнях абстракций и появление в 2001 г. MDA Model Driven Architecture . Подход МОП основан на применении концепции in-the-loop testing 2. Существуют следующие основные способы тестирования на базе подхода МОП, в которых в качестве объекта тестирования может выступать модель Model-in-the-loop MiL, программное обеспечение Software-in-the-loop SiL, прототип устройства Processor-in-the-loop PiL, готовое устройство Hardware-in-the-loop HiL. В способе HiL используется система целиком или ее компонент данный способ применяется для организации приемочных тестов оборудования. Как правило, подход МОП используется совместно с V-подходом разработки программного обеспечения . Подход МОП получил широкое распространение, особенно в сфере автоматизации, его применяют известные во всем мире компании Ford, Tesla, Festo и др. Также подход МОП или его элементы MiL, SiL, PiL, HiL, отдельно или совместно в разных комбинациях активно применяется исследователями, например, в разработке генератора случайных чисел 3 одновременном применении способов SiL и HiL для разработки программного обеспечения манипуляторов для роботов 4 моделировании канала связи командно-измерительной системы космического аппарата 5 модельно-ориентированном проектировании системы автоматического управления температурой с циркуляцией промежуточного теплоносителя 6 разработке системы управления электроприводом на основе метода модельно-ориентиро ванного программирования 7 быстром прототипировании систем управления как части модельно-ориентированной разработки теплового насоса сушилки 8 управлении встроенной моделью в полунатурном моделировании для индустриальных беспроводных сетей предприятий с применением WirelessHART стандарта 9, разработке сервиса задания сценариев предъявления стимулов с использованием модельно-ориентированного подхода 10 и др. В Институте вычислительных технологий СО РАН ИВТ СО РАН разрабатываются автоматизированные системы управления технологическими процессами для шахт, рудников, объектов нефтегазовой отрасли и др. 11. Функционально системы автоматизации, создаваемые в институте 12 для объектов горнодобывающей отрасли, можно разделить на две части подземную нижний уровень, обеспечивающую контроль, управление и сбор информации от различных технологических объектов шахты, и наземную верхний уровень, выполняющую функции центрального вычислительного комплекса и рабочего места диспетчера. С развитием систем автоматизации в ИВТ СО РАН 1214 на контроллеры АСУ ТП стали возлагаться все более сложные алгоритмические и функциональные задачи. Разработка новой системы автоматизации, в которую планируется включить компоненты, разработанные ранее для других систем или функционирующие на объекте, требует проведения проверки совместимости компонентов в рамках созданной единой системы автоматизации. Интеграция новой системы автоматизации или ее компонентов требует внесения изменений в программное или аппаратное обеспечение существующей АСУ ТП, что во время пуско-наладочных работ на объекте замедляет процесс внедрения этих систем, а также может привести к аварийным ситуациям. В связи с этим на этапе проверки АСУ ТП необходимы не только отладка и тестирование, но и контроль совместимости созданных компонентов системы автоматизации с компонентами других версий и исполнений, функционирующих на действующем объекте. Разработка систем автоматизации требует выполнения тестов и проверок уже на этапе проектирования и разработки элементов системы. Выявленные на этих этапах недочеты и ошибки могут быть исправлены с минимальными дополнительными затратами. Сложность комплексной отладки и тестирования программ управления АСУ ТП заключается в трудоемкости искусственного формирования полного набора согласованных сигналов технологического оборудования. Для разработки, отладки и тестирования прикладного программного обеспечения АСУ ТП применяют такие средства, как программные и физические имитаторы сигналов и интерфейсов. Но более эффективно применять специализированные комплексы, содержащие в своей структуре проблемно-ориентированные математические модели автоматизируемых технологических процессов, обеспечивающих согласованную генерацию сигналов датчиков и управляющих сигналов. Существуют различные специализированные комплексы, например имитационная модель гидроагрегата для тестирования АСУ ТП 15, тренажерно-управляющий программнотехнический комплекс для объектов химической технологии 16, стенд для отладки ПО бортовой авиационной аппаратуры 17, продукт xPC Target Matlab, продукт WinMOD и др. К специализированным комплексам относится и разработка ИВТ СО РАН имитационный программно-аппаратный комплекс для тестирования прикладного программного обеспечения АСУ ТП шахт и рудников 18. Комплекс осуществляет тестирование программ управления прикладного программного обеспечения по принципу замещения реальных сигналов от датчиков существующего технологического оборудования и диспетчерских команд управления на виртуальные сигналы, сформированные на основе моделируемых параметров технологического оборудования. Комплекс имеет двухуровневую структуру, содержащую программный и аппаратный уровни. Внешний вид комплекса изображен на рис. 1. Программный уровень содержит SCADA от англ. Supervisory Control And Data Acquisition диспетчерское управление и сбор данных систему БЛАКАРТ 19, среду имитационного моделирования MTSS 20, менеджер связи, модели технологических процессов, модели технологического оборудования, программы управления АСУ ТП. Аппаратный уровень комплекса содержит рабочую станцию оператора модели, рабочую станцию оператора SCADA, среду передачи данных, блок формирования физических сигналов и оборудование АСУ ТП контроллеры, устройства ввода и вывода сигналов, датчики и т. п.. Блок формирования физических сигналов генерирует на основе модельных данных соответствующие аналоговые или дискретные электрические сигналы. Имитационная модель учитывает особенности предметной области, а именно параметры технологического оборудования и его составных частей насосов, двигателей и т. п., проектные данные о конфигурации технологического оборудования настройки и уставки, набор датчиков и сигналов управления, параметры реальных технологических процессов. Процесс разработки модели технологического оборудования МТО для среды моделирования MTSS заключается в создании концептуальной модели и ее переводе в машинное представление, а именно набор Java классов. В общем виде МТО представлена набором множеств взаимосвязь между ними изображена на рис. 2 MTO SUBM,KTO,KACS,PIC,PORT,PARAM,VAR,M,COM,SIG,MS,I,STAT, где MTO объект, представляющей собой модель технологического оборудования с интегрированным прикладным программным обеспечением АСУ ТП SUBM набор моделей составных частей технологического оборудования например, двигатель, редуктор и гидромуфта приводной станции конвейера и т. п., детализирующий функционирование моделируемого объекта KTO алгоритм функционирования технологического оборудования, представляющий собой конечный автомат, описывающий состояния, в которых МТО может находиться в процессе имитации, KACS конечный автомат программы управления АСУ ТП PIC условное графическое обозначение МТО PORT входные и выходные порты каналы передачи данных, имеющие графическую часть на условном графическом обозначении модели, связывающую данную модель с другими МТО, входящими в имитационную модель системы PARAM параметры моделируемого объекта VAR переменные состояния объекта M математическое описание зависимостей между переменными и параметрами моделируемого объекта COM список команд управления технологическим оборудованием, при выполнении которых МТО переходит из одного состояния в другое, и сигналов управления составными частями технологического оборудования например, двигатель приводной станции конвейера SIG хранилище сигналов датчиков и команд управления MS модели аналоговых датчиков, выполняющие функцию преобразования модельных сигналов к сигналам датчиков I интерфейсная часть, обеспечивающая взаимодействие между МТО и интерфейсной частью комплекса, где выполняется формирование цифровых тестовых сигналов в соответствии с конфигурацией АСУ ТП STAT интерфейс сбора статистики о функционировании МТО. Значения сигналов датчиков формируются в процессе взаимодействия блоков конечных автоматов, описывающих алгоритмы функционирования технологического оборудования и АСУ ТП, и математического описания взаимосвязей между параметрами и переменными. Физические сигналы формируются алгоритмом интерфейсной части МТО, обеспечивающим сопряжение между моделью и преобразователями блока формирования физических сигналов. Этот алгоритм преобразует виртуальное значение переменной например, скорость конвейерной ленты из физической величины в кодовое значение, нормированное в диапазон значений датчика. Нормированное значение впоследствии преобразуется соответствующим преобразователем в физический сигнал, поступающий на вход тестируемой АСУ ТП. Основная задача имитационного программно-аппаратного комплекса это создание среды функционирования контроллеров полностью идентичной реальной по внешним сигналам. Это достигается путем замены сигналов датчиков технологического оборудования на физические аналоги, численные значения которых формируются имитационной моделью. Тестирование осуществляется подачей последовательности сигналов с заданными порядком, временными задержками, длительностями и амплитудами. Тестовую последовательность можно формализовать выражением, где -я тестовая последовательность сигналов -е множество состояний сигналов датчиков -е множество команд управления длительность -го состояния порядковый номер тестового набора данных, в котором 0... количество тестовых наборов данных набор сигналов, задающий начальное состояние системы, на боры сигналов, приводящие систему к тестовому состоянию, набор сигналов на входе системы, находящейся в тестовом состоянии. Адекватность сгенерированной тестовой последовательности сигналов обусловливается точностью формирования этого набора сигналов и его временных параметров. Точность формирования сигналов определяется погрешностью вычисления виртуальных сигналов, преобразованием значений виртуальных сигналов в код, преобразованием кода в реальный сигнал в соответствующем блоке формирования физических сигналов и влиянием схемы коммутации комплекса и контроллера АСУ ТП. Применительно к токовому сигналу 020 мА, относительная погрешность генерации тестового сигнала составила не более 2 . Точность задания временных параметров важна с точки зрения выполняемых проверок АСУ ТП, которые в рассматриваемой предметной области сводятся к контролю пороговых значений например, для параметра время разгона конвейера необходимо задавать значения задержки меньше и больше уставки. Описанный выше комплекс применяется в ИВТ СО РАН при тестировании прикладного программного обеспечения систем автоматизации угольных шахт. На созданном комплексе поставленная в статье задача была решена путем модификации способа HiL. Способ HiL заключается в автономном тестировании оборудования АСУ ТП сигналами, числовые значения которых формируются с использованием математической модели, а преобразование модельных сигналов в физические осуществляется соответствующими преобразователями 21. Способ модифицирован таким образом, что для тестирования контроллера наряду с математической моделью используется параллельно подключенный контроллер другой версии или модели. Это позволяет выполнить проверку и добиться идентичного функционирования тестируемого и эталонного контроллеров на одних и тех же входных сигналах и командах управления. На рис. 3 приведена схема усовершенствованного имитационного программноаппаратного комплекса. Модель системы генерирует виртуальные сигналы, которые поступают в блок формирования физических сигналов по интерфейсу RS-485 в формате строкового протокола. Блок, в свою очередь, формирует электрические аналоги сигналов датчиков и преобразует в цифровую форму сигналы управления тестируемого оборудования. Модуль дублирования физических сигналов обеспечивает дублирование сигналов аналоговых и дискретных датчиков. После чего сигналы датчиков синхронно подаются в Контроллер 1 тестируемый и Контроллер 2 эталонный. Управляющие команды верхнего уровня АСУ ТП передаются в контроллеры через интерфейс RS-485 по протоколу Modbus. Преобразованные в цифровую форму сигналы управления передаются в модель системы, где в специализированном модуле осуществляется сравнение сигналов от Контроллера 1 и Контроллера 2, который в данном случае играет роль эталонного. Модель технологического процесса интерпретирует сигналы управления, полученные от тестируемого контроллера Контроллер 1. В отличие от классической реализации HiL в данной схеме добавлены модули дублирования физических сигналов и модуль сравнения управляющих воздействий, формируемых тестируемым и эталонным контроллерами. Анализ идентичности функциональных возможностей контроллеров состоит из следующих шагов запуск имитационной модели, генерирующей управляющие команды для контроллеров и сигналы датчиков формирование управляющих сигналов, которые поступают непосредственно в контроллеры, и сигналов датчиков, которые дублируются и после этого поступают в контроллеры сопоставление управляющих сигналов контроллеров в модуле сравнения управляющих воздействий. При идентичных входных воздействиях и различных выходных управляющих сигналах фиксируется ошибочная ситуация. Осуществляется дублирование дискретных кабель-троссовый выключатель, контроль схода ленты, устройство автоматического пожаротушения и т. п. и аналоговых датчик скорости ленты или барабана, датчик температуры, датчик заштыбовки и т. п. сигналов. Реализовано дублирование частотных и токовых сигналов. Проверки при создании АСУ ТП делятся на несколько этапов, соответствующих стадиям проектирования АСУ ТП контроль проектных данных, отладка прототипов программноаппаратных средств на уровне разработчика, первичное тестирование крупномасштабное, приемочное тестирование проверка серийного образца перед выпуском продукции, пусконаладочные работы, опытно-промышленная эксплуатация. Стадии создания АСУ ТП проектирование, разработка, отладка и тестирование включают в себя создание модели функционирования системы автоматизации и модели технологического процесса, выполнение отладки и первичных тестов опытных образцов оборудования. Контроль проектных данных это проверка перед началом разработки прототипа на соответствие описания программно-аппаратных средств требованиям задачи достаточна ли функциональность для выполнения задач автоматизации, корректно ли заданы параметры сигналов, корректно ли сформулированы требования для выполнения первичного и приемочного тестирований и др. Отладка прототипов программно-аппаратных средств на уровне разработчика осуществляется с помощью локальных тестов, нацеленных на проверку корректности алгоритма управления. Первичное тестирование крупномасштабное осуществляется в соответствии с разработанной программой и методикой испытаний. Выявленные ошибки или недочеты устраняются, и проводится повторное испытание. Программа и методика испытаний разработана в соответствии с требованиями нормативных стандартов и учетом условий эксплуатации АСУ ТП. Созданный документ регламентирует содержание тестовых испытаний и содержит следующие основные пункты. 1. Общесистемное тестирование, включающее проверку цепей электропитания, прохождения отдельных сигналов, исправное функционирование информационных линий, корректную работу индикации. 2. Проверка карты регистров протокола MODBUS 22, в том числе корректное отображение данных у диспетчера SCADA. 3. Контроль выполнения команд, заданных локально с пульта контроллера и удаленно со SCADA или модели. 4. Контроль корректной идентификации контроллером состояний дискретных и аналоговых сигналов в каждом режиме работы, формирования соответствующих выходных управляющих сигналов и соответствующей записи состояния контроллера в карту MODBUS. 5. Проверка технологических ситуаций и достижимость состояний контроллера, включающая контроль типовых ситуаций например, пуск и останов конвейера, контроль уставок контроллера затянувшиеся разгон и торможение, пробуксовка, минимальная и максимальная скорости и др., подача нештатных например, сброс датчиков контроля двигателя и тормоза, разрешающего сигнала от предыдущего конвейера и др. и некорректных сигналов например, при рабочем значении скорости ленты заданы нулевые показания датчика скорости приводного барабана. 6. Проверка циклической подачей тестовых наборов сигналов в разных режимах и состояниях контроллера. 7. Тестирование интерфейса пользователя. 8. Технологический прогон 72 часа. Приемочное тестирование направлено на контрольную проверку серийных изделий перед выпуском продукции, выявление сбоев программного обеспечения, вызванных причинами, не зависящими от разработчиков. Такие тесты в рамках текущей работы выполняются по сокращенной программе, содержащей пункты 1, 3, 4 и 8 разработанной методики. По разработанной программе и методике испытаний проводилось тестирование совместимости созданной системы АСКУ ТО М Автоматизированная система контроля и управления технологическим объектом во взрывозащищенном исполнении и АСКУ ТО 2 Автоматизированная система контроля и управления технологическим оборудованием. В рамках работ по созданию автоматизированной системы конвейерной линии шахты Грамотеинская выявлено более 30 ошибок и замечаний к созданному прикладному программному обеспечению АСУ ТП. Выявленные ошибки в прикладном программном обеспечении исправлены до начала пуско-наладочных работ на объекте. Подход МОП получил широкое распространение, особенно в сфере автоматизации. Наиболее часто он применяется для узкоспециализированных задач, таких как стендовые испытания, верификация программного обеспечения, проектирование алгоритмов и др. Применение совокупности классических способов разработки, отладки и тестирования MiL, SiL, PiL и HiL подхода МОП наиболее эффективно для крупномасштабных систем. Такой вариант комплексного применения подхода МОП в основном используется крупными предприятиями. Применение подхода МОП позволяет упростить контроль над созданием программноаппаратных систем на протяжении всего жизненного цикла разработки. Это сокращает время выпуска новой продукции, повышает ее качество и безопасность. Предложен вариант развития способа HiL, позволяющий выполнять не только проверку создаваемых систем на наличие ошибок проектирования и разработки, но также обеспечить контроль совместимости компонентов двух разных систем одинакового назначения. Программы тестов, входящих в созданную методику, разработаны с учетом охвата типовых технологических ситуаций при функционировании АСУ ТП, обеспечивая этим полноту тестирования контроллера. Наиболее значительной по влиянию на безопасность АСУ ТП является проверка достижимости состояний контроллера, так как она позволяет выяснить, все ли состояния и переходы между ними заданы корректно. Созданный комплекс с модифицированной структурой применен при разработке и тестировании системы АСКУ ТО М. Контроллеры нового поколения внедрены в состав действующей системы АСКУ ТО 2 и успешно эксплуатируются на шахте Грамотеинская. Применение функции дублирования также позволяет при соответствующем расширении аппаратной части комплекса обеспечить серийное тестирование нескольких контроллеров АСУ ТП, что, в свою очередь, ускорит выполнение приемочных тестов. 