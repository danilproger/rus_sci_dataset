СИСТЕМА ИНФОРМАЦИОННОЙ ПОДДЕРЖКИ ХИРУРГА  ПРИ ПРОВЕДЕНИИ ТРАНСУРЕТРАЛЬНОЙ РЕЗЕКЦИИ  ПРЕДСТАТЕЛЬНОЙ ЖЕЛЕЗЫ  

Представлена система информационной поддержки хирурга при выполнении трансуретральной резекции предстательной железы, основанная на методах обработки сложных биомедицинских изображений. Рассмотрены подходы к обработке изображений предстательной железы методами согласованной и инверсной фильтрации.

Значительный объем в структуре медико-биологических исследований составляют изображения, представляющие двумерные случайные поля 1. Система анализа подобных биомедицинских изображений включает, как правило, три сопряженных блока оптическое устройство, формирующее изображение блок передачи и хранения информации и ЭВМ. С помощью оптического устройства изображение снимается с поверхности образца. Поскольку отражение и поглощение света для различных областей изображения вследствие особенностей в плотности, толщине и химическом составе различное, изображение получается полутоновое. Видеокамерой оно передается в персональный компьютер, где и анализируется программой. Сущность методики трансуретральной резекции предстательной железы заключается в удалении некоторого объема простаты в целях восстановления мочеиспускательной функции. Выполнение подобных операций затруднено отсутствием достаточной видимости оперируемого поля. Поэтому стоит задача создания объективных методов контроля над положением хирургического инструмента 2. В работах 24 представлен подход к обработке изображений предстательной железы при проведении трансуретральной резекции. Под обработкой изображений для целей навигации во время операции понималось прослеживание траектории движения хирургического инструмента в теле предстательной железы. Прослеживание траектории движения сводится к решению задачи обнаружения одноименных фрагментов в соседних кадрах изображений предстательной железы. При этом производится оценка параметров смещения фрагмента в плоскости кадра и изменения масштаба 3, 4. Задачу поиска одноименных фрагментов в соседних кадрах изображения, можно рассматривать как частный случай обнаружения изображения объекта. Задача обнаружения изображения объекта формулируется следующим образом на вход обнаружителя подается либо зашумленное, либо шумовое изображение и на основании априорной информации о статистических свойствах шума исходного и зашумленного сигналов, а также величины меры схожести зашумленного и эталонного сигналов решающее устройство обнаружителя принимает решение. Структура биотехнической системы для трансуретральной резекции предстательной железы, осуществляющей этапы подготовки и проведение операции, представлена на рис. 1. На этапе подготовки к операции выполняется описание истории болезни, обследование пациента, предусматривающее анализ структуры предстательной железы при помощи интроскопических методов исследования, например компьютерной томографии. Далее осуществляется построение трехмерной модели капсулы предстательной железы на основе данных компьютерного томографа или анализа размеров и формы простаты на УЗ-изображениях. В формирователе 3D-модели осуществляется анализ границ исследуемого органа методами контурного анализа в каждом отдельном срезе. С учетом расстояния между срезами производится расчет координат каждой точки, принадлежащей капсуле предстательной железы, в трехмерном пространстве. Во время хирургического вмешательства существует обратная связь с пациентом. Контролируют проведение операции программно, используя построенную виртуальную модель предстательной железы. В режиме реальной операции изображение с микроскопической видеокамеры подается на монитор. Здесь также анализируется местоположение резектоскопа при помощи модуля определения координат. В данном режиме модуль сравнения анализирует разницу между координатами резектоскопа и капсулы предстательной железы, которые вычисляются при построении виртуальной модели органа. Если разница достигает критического уровня, модуль формирования сигнала оповещения извещает хирурга о достижении им критической зоны. Модуль определения координат является одним из ключевых узлов биотехнической системы информационной поддержки хирурга при проведении операции. В основу работы данного модуля заложены методы обработки и анализа изображений предстательной железы, сформированные видеокамерой резектоскопа. Общее решение задачи оптимальной обработки зашумленных изображений предполагает наличие следующих априорных данных законов распределения вероятностей значений шума, зашумленного и эталонного исходного изображений, их числовых характеристик, значений штрафов за вынесенные правильные и ложные решения, значений априорных вероятностей наличия или отсутствия искомого фрагмента в сцене, а также допустимых значений вероятностей ложных тревог. Наличие всей информации при решении реальных задач, связанных с обработкой изображений, представляет собой редкую ситуацию. Обычно в первую очередь жертвуют знанием априорных вероятностей, предполагая их равными друг другу, и исключают штрафы за правильные решения. В любом случае, корректное и эффективное решение задачи невозможно без учета статистических свойств мешающих факторов. Когда шум имеет равномерную спектральную плотность и распределен по нормальному закону, алгоритм обработки оказывается довольно простым. Достаточная статистика для принятия решения при этом вырабатывается линейным фильтром, характеристики которого согласованы с характеристиками обрабатываемого изображения. При обнаружении роль шума выполняют отсчеты яркостей фона, окружающего обнаруживаемое изображение объекта. Сложность решения задачи обнаружения применительно к рассматриваемой в работе задаче определяется плохо структурированным фоном. Его статистика отличается большой пространственной неоднородностью, по крайней мере, относительно первого начального и второго центрального моментов. Данное обстоятельство приводит к необходимости разбивать анализируемую сцену на ряд непересекающихся областей, для которых характерна статистическая однородность. Таким образом, задача обнаружения становится нерегулярной по изображению, которое разбивается на ряд статистических локально-однородных областей. Работа обнаружителя также затрудняется отсутствием априорной информации об обнаруживаемых объектах. В работах 3, 4 представлен подход к решению задачи обнаружения фрагмента изображения по результатам работы согласованного фильтра. Для этого на изображении, полученном в момент времени, выбирается фрагмент и в режиме обнаружения производится обработка текущего изображения . В режиме поиска окно фильтра перемещается в пределах изображения и на каждом шаге производится вычисление отклика согласованного с фрагментом фильтра . 1 В случае если отклик согласованного фильтра больше его значения, рассчитанного в предыдущем такте сравнения, то он будет записан в память, а также координаты, соответствующие этому значению. Эти координаты далее используются для расчета смещения фрагмента в плоскости кадра. На рис. 2, представлен пример изображения предстательной железы, а на рис. 2, отклик согласованного с фрагментом изображения фильтра в некоторый фиксированный момент времени . Выходной сигнал фильтра, сравнивается с пороговым уровнем, и если, то принимается решение об обнаружении изображения объекта заданного класса. Величина порогового уровня определяется принятым критерием обнаружения и в самом общем случае определяется вероятностями наличия и отсутствия в кадре изображения обнаруживаемого объекта и значениями допустимых вероятностей правильных и ложных решений. Таким образом, задача обнаружения изображения фрагмента заданного класса сводится к синтезу согласованного фильтра, формирующего достаточную статистику меру схожести, и к сравнению этой статистики с пороговым уровнем. Анализируя результат, представленный на рис. 2, можно отметить, что область, примыкающая к пиковому отсчету согласованного фильтра, является сглаженной. Воздействие шума может привести к возникновению погрешности оценки координат смещения фрагмента от кадра к кадру, которая, в свою очередь, приводит к неправильному прослеживанию траектории движения хирургического инструмента. Для устранения указанного недостатка предлагается использовать метод инверсной фильтрации на том основании, что искомый фрагмент и окружающий его фон являются сходными в энергетическом смысле. В соответствии с определением, данным в работе 5, сходными в энергетическом смысле являются объекты, функции которых имеют пропорциональные или равные распределения спектральной плотности мощности по частотам. В этом случае передаточная функция оптимального фильтра будет равна 2 где множитель, характеризующий интенсивности фона и случайного шума спектральная плотность фрагмента, . В отличие от обычного согласованного фильтра, имеющего передаточную функцию, прямо пропорциональную комплексно-сопряженному спектру объекта 3 фильтр с передаточной функцией вида 2 осуществляет пропускание пространственно-частотных спектральных составляющих по кривой, обратной к спектру опознаваемого объекта, и поэтодвижения резектоскопа в теле предстательной железы рис. 4. Современные методы слежения за хирургическим инструментом в теле органа при выполнении малоинвазивных операций требуют применения дополнительных навигационных устройств, которые осложняют процесс выполнения хирургического вмешательства. В данной работе представлена система информационной поддержки хирурга при выполнении трансуретральной резекции предстательной железы, основанная на методах обработки сложных биомедицинских изображений. Интраоперационная навигация при трансуретральной резекции, основанная на совмещении 3D-изображения предстательной железы с видеоэндохирургическими данными, позволяет повысить точность манипуляций хирурга и тем самым снизить число операционных осложнений. Представленная в работе система прошла апробацию в урологическом отделении Республиканской клинической больницы Республики Марий Эл г. Йошкар-Ола. му называется инверсным 5. Из сопоставления выражений 2 и 3 видно, что амплитудно-частотная характеристика инверсного фильтра обратно пропорциональна амплитудно-частотной характеристике согласованного фильтра, а их фазочастотные характеристики совпадают. Теоретически инверсный фильтр дает бесконечное значение отношения сигналпомеха, так как отклик на полезный сигнал у него равен -функции. Бесконечное значение отношения сигналпомеха получается из-за того, что передаточная функция 2 соответствует фильтру с бесконечно широкой полосой пропускания. На практике ширина полосы пропускания всегда конечна, что является следствием конечной области интегрирования, которая, в свою очередь, ограничена размерами апертуры пространственного фильтра. На рис. 3 представлен отклик инверсного фильтра при обработке изображения, показанного на рис. 2, . По результатам обработки изображений на экране видеомонитора отображается траектория 