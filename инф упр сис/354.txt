ИЗМЕРЕНИЕ СКОРОСТЕЙ АВТОМОБИЛЕЙ   ПУТЕМ АНАЛИЗА ВИДЕОПОСЛЕДОВАТЕЛЬНОСТИ 

Проведен краткий обзор дистанционных измерителей скоростей автомобилей, выявлены основные недостатки современных решений. Предложен новый телевизионный метод измерения скорости движущихся объектов на основе анализа видеоряда. Даны результаты экспериментальных исследований.

В настоящее время активно развивают системы транспортного мониторинга, которые служат для контроля магистралей, сбора параметров автомобильного потока состава, средней скорости, плотности потока и т. п., фиксации фактов нарушения скоростного режима и других правил дорожного движения 1. Самыми распространенными устройствами для измерения скоростей автомобилей являются локационные радары и лазерные измерители. Преимуществами данных устройств принято считать высокую точность определения скорости ошибка не более 2 кмч и дальность действия 300500 м. Однако нужно иметь в виду, что радары и лазерные измерители обеспечивают декларируемые параметры, если транспортное средство ТС движется точно по направлению на них. При установке приборов над магистралью или сбоку от нее необходимо учитывать их угловые положения. Видеокамеры являются неотъемлемой частью приборов мониторинга транспортных потоков, так как без фоторегистрации результаты измерения скорости, каким бы методом они ни были получены, не являются легитимными. Недостатком комбинированных приборов фоторегистратор плюс радиолокационный измеритель скорости является отсутствие жесткой связи между результатами измерения и ТС, которое фотографируют видеокамерой. Излучение СВЧ-энергии легко обнаруживается антирадарами. Для повышения достоверности измерений формируют плоскую диаграмму направленности радара шириной 3,6 2. Узкие диаграммы направленности радаров вынуждают устанавливать приборы индивидуально для каждой полосы движения и проводить измерения в локальных зонах на магистрали на расстоянии порядка 5060 м. Это приводит к повышению сложности и общей стоимости стационарного поста. Сказанное справедливо и для лазерных измерителей скорости. Включение в состав аппаратуры видеокамер не дает возможности реализовать важные преимущества радаров независимость от погодных условий и высокую дальность действия, так как качественную фотографию ТС, пригодную для его идентификации и определения номерного знака, можно получить в условиях достаточной освещенности на расстоянии 50100 м. Применение телевизионных методов позволяет исключить дополнительную аппаратуру, одновременно измерять скорости всех автомобилей в поле зрения камеры и обеспечить однозначную связь между результатом измерения и конкретным объектом. Автомобили двигаются в мировой координатной системе, ориентированной так, что ось расположена вдоль дорожной полосы, ось ей ортогональна, а координата отображает высоту рис. 1. Скорость ТС это вектор, . Поперечная и вертикальная составляющие скорости обычно малы и не представляют особого интереса. Необходимо измерить скорость . В объектной системе координат камеры, с центром в точке фокуса см. рис. 1 поступательное движение автомобиля вдоль дорожной полосы приводит к изменению всех трех координат. За время сопровождения объект перемещается в пространстве из точки в точку . Тогда скорость может быть рассчитана как евклидово расстояние между векторами, и, деленное на время 1 Современные видеокамеры преобразуют 3D-пространство в 2D и дают изображение в экранной системе координат на плоскости, см. рис. 1. Если известны координаты объекта, то при центральной проекции и расположении центра проекции точки фокуса между объектом и плоскостью матрицы ПЗС экранные координаты По известным координатам в экранной плоскости, и координате, которая отражает расстояние до объекта и должна быть получена косвенным методом, рассчитывают значения С помощью краски на дороге отмечают контрольную зону с фиксированными линейными размерами. Этот участок автоматически определяют на видеокадре, формируют зону в плоскости растра с установленными размерами и осуществляют привязку координат растра камеры к реальным координатам на дороге. Скорость определяют с помощью измерения времени в кадрах, за которое автомобиль пересек размеченную зону 3. Вариант данного подхода 4 нанесение серии линий разметки в плоскости телевизионного кадра рис. 2. Определяют расстояние, пройденное автомобилем за фиксированное время с момента начала сопровождения. Необходимость нанесения маркеров на дорожное полотно и привязки камеры к местности усложняет процесс установки системы. На момент фиксации пересечения автомобилем границы контрольной зоны влияет высота ТС. Высокий грузовик покинет зону контроля раньше, чем это зафиксирует камера, в связи с тем, что некоторое время оптическая ось камеры будет пересекать верхнюю часть автомобиля, который уже выехал за пределы контрольного участка. Динамические тени и блики от фар автомобилей также негативно влияют на точность измерений. Другими причинами погрешностей являются ошибки дискретизации во времени и пространстве. Современные видеокамеры обычно работают с частотой кадров 25 Гц. При фиксации момента пересечения линии разметки возможна ошибка до 40 мс. Вследствие пространственной дискретизации телевизионного изображения момент пересечения линии разметки пикселя можно зафиксировать с точностью 1 пиксель. При установке камеры над магистралью из последовательности видеокадров, помимо информации о пройденном расстоянии, можно извлечь данные об увеличении размера ТС. Для вычисления составляющей скорости ТС в направлении на камеру необходимо зафиксировать начало дистанции сопровождения и получить данные об относительном увеличении размера изображения автомобиля за время . Автомобиль, имеющий горизонтальный размер, приближается к камере. На расстоянии до камеры горизонтальный размер его проекции на матрице ПЗС, на расстоянии . Очевидны следующие соотношения 2 где фокусное расстояние объектива коэффициент увеличения размера проекции автомобиля преодоленное автомобилем со скоростью см. выражение 1 расстояние за некоторое время . Тогда Сбор данных об увеличении размера проекции и траектории движения ТС начинают с момента пересечения им линии визирования, установленной в экранной плоскости. Началу дистанции сопровождения соответствует расстояние от камеры до проекции линии визирования на местности в объектных координатах. Значение находят по выражению 2, зная фокусное расстояние объектива, фактические и экранные размеры автомобиля. Экранные размеры изображения автомобиля оценивают в пикселях. Для расчетов требуется знать геометрические размеры пикселя цену пикселя. При размещении камеры над многополосной магистралью изображения автомобилей, движущихся по соседним полосам, имеют различные траектории, с характерными для каждой полосы горизонтальными и вертикальными составляющими скорости в объектной системе координат см. рис. 1. Телевизионные изображения рис. 3 содержат всю необходимую для этого информацию 5. Составляющие скорости 3 где, смещения экранных координат объекта в пикселях за время сопровождения коэффициент увеличения размера объекта в конце сопровождения дистанция начала сопровождения цена пикселя дистанция окончания сопровождения скорость автомобиля находят по выражению 1. Значение можно найти другим способом. В ходе эксперимента оценивают изменения размера проекции автомобиля в каждом кадре телевизионной развертки раз, где частота кадров. По экспериментальным точкам, подверженным ошибкам измерения, методом наименьших квадратов строят усредненную функциональную зависимость рис. 4. Далее находят сглаженное значение при фиксированном или наоборот. Тогда из выражений 3 следует 4 так как . Второй способ предпочтительнее, так как дает более точные результаты за счет использования накопления результатов измерений за время сопровождения . В ходе эксплуатации системы значение вновь рассчитывать не нужно, важно лишь поддерживать положение линии визирования и начинать сопровождение ТС с одной и той же позиции. На точность измерения скорости влияют несколько факторов. 1. Даже при весьма тщательной настройке системы в ходе эксплуатации сопровождение может быть начато с ошибкой относительно установленного значения, которая приводит к пропорциональной ошибке в оценке скорости. Например, при 2 м ошибка в дистанции начала сопровождения приводит к ошибке в оценке скорости 1,44 кмч. 2. В силу дискретности телевизионного изображения значения и могут быть измерены с точностью 1 пиксель. В результате значения могут быть измерены неточно, что приведет к ошибке в оценке скорости 3 кмч. 3. В силу дискретности телевизионной развертки по времени значения могут быть измерены с точностью 1 кадр или 0,0333 с, что дает ошибку в оценке скорости порядка 0,85 кмч для скорости 60 кмч и 1,7 кмч для скорости 120 кмч. Если считать, что приведенные ошибки независимы, то ожидаемая точность системы в указанных условиях 3,74 кмч. Возможности повышения точности измерения скорости следующие. Увеличение размера изображения объекта происходит при приближении к камере, причем зависимость всегда одинакова для конкретной дистанции сопровождения. Необходимо начинать сопровождение с одного и того же расстояния, которое было использовано при определении опорной кривой в ходе контрольного прохождения автомобилем дистанции сопровождения при настройке системы. Если сопровождение начато с большего или меньшего расстояния, зависимость относительного увеличения размера от времени будет отличаться от опорной рис. 5, . В ходе сопровождения одновременно измеряют экранную координату . Графики аппроксимируют прямыми линиями. Если сопровождение автомобиля начато позже или раньше, угол наклона прямой будет отличаться от аналогичной величины для опорной зависимости рис. 5, . При определении скорости угол наклона линии сопровождаемого объекта сравнивают с углом наклона опорной линии. Результат сравнения учитывают в качестве поправки при определении скорости где скорость ТС с учетом коррекции ошибки дистанции начала сопровождения угол наклона зависимости относительного увеличения размера проекции от координаты угол наклона опорной прямой. Принцип измерения скорости ТС монокамерой основан на его сопровождении на дистанции порядка 2030 м. Повышение точности измерения скорости достигают за счет использования накопления по времени и пространству. За время сопровождения получают данные о размерах изображения в пределе в каждом кадре телевизионной развертки. Объект проходит дистанцию сопровождения за время порядка 12 с, что позволяет произвести измерения в 2550 кадрах. На основании результатов измерения, подверженным ошибкам за счет дискретности растра и шумов, методом наименьших квадратов строят регрессионные кривые на основе полиномов второй или третьей степени см. рис. 4. Анализ полученных кривых позволяет получать оценки размеров изображения объектов с точностью, лучшей одного пикселя субпиксельная оценка, и измерять временные промежутки с точностью, лучшей времени одного кадра телевизионной развертки. Тем самым ошибки и могут быть снижены приблизительно в раз, где число обработанных кадров, т. е. в 5 7 раз. Если проводить сбор данных об объектах вплоть до увеличения коэффициента, например в 1,5 раза см. рис. 4, то значения и, подставленные в выражение 3, дадут оценки скоростей и . Можно использовать другой подход. Коэффициент увеличения размера объекта зависит только от его расстояния до камеры. Это означает, что кривые и на рис. 4 могут быть совмещены путем варьирования одного параметра масштаба времени. Совмещение кривых контролируют по всей их длине, а не в одной точке, как это было в предыдущем случае. Это позволяет дополнительно сгладить ошибки измерений. Для сбора необходимой для расчетов информации проводят сегментацию 6, 7 и сопровождение изображений движущихся объектов с помощью корреляционно-экстремального алгоритма 8, 9. Относительное увеличение размера проекции объекта находят с помощью маски масштабирования, которую создают в начале сопровождения объекта. Алгоритм состоит из следующих шагов представление текущей маски масштабирования объекта в нескольких масштабах с заданным шагом корреляционное сравнение текущего бинарного изображения объекта и сформированного набора масок масштабирования и определение лучшего соответствия модификация маски масштабирования. Набор масок в разном масштабе получают с помощью аффинных преобразований текущей маски объекта. Вектор однородных координат пикселя увеличенной маски объекта где вектор однородных координат пикселя исходной маски коэффициент масштабирования. Каждую маску из полученного набора сравнивают с изображением объекта и по минимуму меры различия подбирают наиболее подходящую где, размеры маски в пикселях пиксели бинарного изображения объекта пиксели маски. Маска с наименьшей становится новой текущей маской масштабирования объекта, а соответствующий коэффициент считают увеличением объекта в данном кадре видеопоследовательности. Модификацию маски масштабирования проводят для соответствия текущему изображению объекта. В ходе модификации из маски исключают лишние пиксели, полученные в результате масштабирования, которых нет в реальном изображении рис. 6. Для оценки точности измерителя скорости использовали четыре видеофрагмента дорожного наблюдения длительностью около 3500 кадров каждый, полученных в различных условиях и местах съемки. Для всех автомашин, попавших в поле зрения видеокамеры, в ручном режиме были тщательно измерены скорости посредством определения числа кадров, которое потребовалось автомобилю для преодоления известного расстояния на местности . Видеофрагменты подобраны таким образом, чтобы присутствовали разнообразные типы ТС легковые, грузовые, автобусы и т. д., а интенсивность дорожного движения была примерно одинаковой для всех полос наблюдаемой магистрали. Для дополнительной проверки достоверности измерений в каждый видеофрагмент включены несколько автомобилей с известной скоростью движения. Суммарное число ТС, для которых была проведена оценка скорости, 104. По результатам моделирования для всего массива данных рассчитаны следующие статистические характеристики среднеквадратическое отклонение 1,91 кмч среднее значение ошибки 1,49 кмч для 97 ТС максимальная ошибка не превышает 3 кмч максимальное смещение оценки 0,4 кмч. На основании полученного массива данных рассчитаны статистические характеристики для отдельных полос движения таблица. Проведенное моделирование позволяет сделать вывод о достаточно высокой точности телевизионной системы измерения скорости. Результаты исследований по полосам движения подтверждают возможность измерения скорости телевизионным методом на многополосной магистрали. Статистические оценки точности измерения мало отличаются по полосам движения и практически не смещены. Основной недостаток телевизионных измерителей зависимость от погодных условий компенсируется введением подсветки вблизи стационарного поста в видимом или инфракрасном диапазонах излучения. Точность измерения скорости с помощью одной видеокамеры 3 кмч уступает радарам, где достигнута точность 1 2 кмч. Вполне возможно, что эта точность несколько завышена в рекламных целях, так как неизвестно, каким образом учитывают угловые положения приборов и учитывают ли вообще. В условиях, когда водители не могут измерить скорость точнее, чем одно деление шкалы спидометра 10 кмч, точности, достигнутой телевизионным измерителем, вполне достаточно для практического применения. Предложенный метод измерения скорости ТС на основе анализа видеопоследовательности обладает следующими характерными преимуществами. Использование накопления данных по времени и пространству путем учета модификации всей площади изображения автомобиля на интервале сопровождения позволило повысить точность измерения по сравнению с известными телевизионными методами. При реализации алгоритма измерения нет нужды в трудоемкой калибровке камеры и привязке ее местоположения к мировым координатам. При установке и первоначальной настройке системы достаточно в автоматическом режиме получить опорную зависимость коэффициента увеличения размера изображения контрольного автомобиля при известной скорости его движения и траекторию его движения. Другим вариантом настройки является анализ в ручном режиме фрагмента видеопоследовательности, отображающей движение объекта с известными размерами на дистанции сопровождения. Располагая данными о скоростях и траекториях движения сопровождаемых автомобилей, получают все основные параметры транспортного потока интенсивность, среднюю скорость. Дополнительно можно судить о нарушениях выезде на встречную полосу, нарушении рядности движения, остановке в неположенном месте и т. п. 