МОДЕЛИРОВАНИЕ ТРЕХМЕРНЫХ СЦЕН  ЛЕСНЫХ УЧАСТКОВ ПО ДАННЫМ  ЛАЗЕРНОГО СКАНИРОВАНИЯ И АЭРОФОТОСНИМКАМ 

визуализация растительности в трехмерных ландшафтных сценах является нетривиальной задачей в силу сложной структуры ветвления у различных пород деревьев. Пакеты общего назначения не позволяют разрабатывать модели растительности без определенных навыков работы. Специальные пакеты, такие как геоинформационные системы, используют укрупненные графические примитивы для описания формы крон деревьев. В связи с этим возникает задача разработки правил ветвления как для хвойных, так и для широколиственных пород деревьев. Результаты: описан процесс моделирования трехмерных сцен лесных участков по данным лазерного сканирования и аэрофотоснимкам, которые дают информацию о форме кроны дерева, высоте лесного полога и типе ландшафта с применением правил классификации лазерных данных. Правила построены на разбиении исходного облака точек на трехмерные кубы — вокселы. Разработаны правила ветвления для различных пород деревьев на основе L-систем, которые используются для прорисовки базового каркаса модели дерева. Для детального построения кроны дерева используется алгоритм Space Colonization. Практическая значимость: полученные правила классификации данных лазерного сканирования позволяют создавать высокоточные модели естественных ландшафтных сцен лесной растительности для визуализации данных.

Моделирование трехмерных сцен лесных участков является современной технологией анализа множественных морфологических показателей леса при мониторинге и планировании лесохозяйственных работ. Такая технология объединяет достижения лазерного сканирования, аэрофотосъемки, цифровой обработки изображений и методов 3D-моделирования. К известным подходам трехмерного моделирования относятся подход на основе математического описания с использованием различных грамматик, в том числе и -системы 13 подход на основе восстановления сцены по ряду изображений 46, а также многочисленные эвристические подходы, требующие моделирования отдельных элементов сцены или участков сцены вручную с использованием известных пакетов трехмерного моделирования, как коммерческих Maya, 3dsMax, Cinema 4D, ZBrush, VuexStream, так и свободно распространяемых Blender, Sculptor, или редакторов собственной разработки 7, 8. Исходными данными при моделировании ландшафта выступают данные воздушного лазерного сканирования Light Detection And Ranging LiDAR, наземного лазерного сканирования Terrestrial LiDAR TLiDAR, аэрофотосъемки и таксации лесных массивов обмеры стволов деревьев, карта высот лесного участка и др.. Трехмерная сцена лесного ландшафта, как правило, включает в себя следующие объекты деревья различных пород, кустарники, подлесок и участки Земли. В данной работе используется информация воздушного лазерного сканирования. Лазерная съемка лесного участка позволяет получить массив трехмерных координат точек лазерного сканирования. Для последующего моделирования сцены необходимо классифицировать исходное облако точек на точки, принадлежащие поверхности Земли, и точки, относящиеся к растительности. Существует несколько методов классификации исходного облака точек 9. Метод определения минимумов ячеек сетки основан на том, что точки земной поверхности имеют наименьшие значения координаты относительно других объектов. Метод целесообразно использовать для прореживания облака точек в качестве предварительной обработки данных. Метод линейного вычисления превышений построен на предположении, что две точки принадлежат к профилю Земли в случае, если наклон, а следовательно, и высота между двумя соседними точками не превышают некоторого заданного порогового значения. Интерполяционный метод итеративный предполагает подбор интерполяционной поверхности к исходному облаку точек. Пусть это множество трехмерных точек воздушного лазерного сканирования участка лесной поверхности где 1, общее количество точек лазерного сканирования. Множество включает множество точек, относящихся к растительности моделируемой сцены где количество объектов-деревьев в сцене, и множество точек поверхности Земли где 1, общее количество точек лазерного сканирования, относящихся к поверхности Земли. Таким образом, множества и являются непересекающимися подмножествами множества где множество ошибочных измерений шумы и помехи. Необходимо из исходного облака точек воздушного лазерного сканирования множества выделить подмножества и множество точек поверхности Земли и множество точек растительности соответственно и по полученным множествам построить трехмерную модель лесного участка. Известны два основных способа лазерного сканирования ландшафта воздушное LiDAR и наземное TLiDAR. Воздушное лазерное сканирование выполняется с какого-либо воздушного судна, обычно самолета или вертолета. Принцип функционирования воздушных лазерных сканеров основан на излучении лазерного луча до объекта местности и регистрации отраженных сигналов в обратном направлении. Сканирование поперек направления движения носителя выполняется путем отклонения лазерного луча при помощи сканирующего механизма, а вдоль направления движения вследствие перемещения носителя. Сущность наземного лазерного сканирования заключается в регистрации с высокой скоростью расстояния от сканера до поверхности объекта и регистрации соответствующих направлений вертикальных и горизонтальных углов с последующим формированием трехмерного изображения скана в виде облака точек. Обработка данных лазерного сканирования проводится в следующей последовательности 1-й этап предварительная обработка исходных данных, удаление шумов и избыточной информации 2-й этап классификация исходного облака точек на точки, принадлежащие поверхности ландшафта, и точки, относящиеся к растительности 3-й этап моделирование поверхности ландшафта и лесной массы деревьев и кустарника. На точность лазерного сканирования влияет большое количество факторов динамический характер съемки сканирование осуществляется с воздушного средства передвижения, погрешности определения геодезических координат точек, ошибки пересчета в различные системы координат и высот и др. Наличие избыточной информации связано с тем, что современные сканеры позволяют получить очень высокую плотность точек. На рис. 1 представлен продольный профиль длиной 100 м, ширина полосы 1 м. Существует достаточно большое количество алгоритмов, позволяющих проанализировать исходное облако точек лазерного сканирования и отфильтровать шумовые и ошибочные точки. Анализ инструментов, предоставленных для выполнения этих задач в различных программных продуктах компаний-лидеров по разработке программного обеспечения в данной отрасли, таких как Autodesk, Terrasolid, ESRI и др., показал, что необходим комплексный подход к реализации алгоритма, при этом применение имеющихся инструментов без доработки не позволит достичь желаемого результата. Наложим на исходное облако точек вокселную сетку voxel grid с шагом . Воксел volume element это трехмерное представление пиксела, куб с достаточно малой длиной ребра размерность воксела. Таким образом, все трехмерное пространство в системе координат разбивается на множество кубов вокселов, где 0, общее количество вокселов в пространстве размерность воксела. Для каждого воксела вычислим количество точек, содержащихся внутри данной области и на ее границе, удовлетворяющих логическому выражению Предположим, что если количество точек в вокселе превышает некоторый заданный порог и координата находится в диапазоне высот полога леса от до, то данный воксел располагается в пространстве границы кроны деревьев. Если количество точек в вокселе близко или равно нулю, то считается, что в данном вокселе нет никаких объектов моделируемой сцены. Если количество точек в вокселе превышает некоторое заданное значение порога и координата находится ниже полога леса, то данный воксел относится к поверхности Земли или к стволу дерева. Определим правила классификации вокселов Определим диапазон высоты полога леса и . Верхний порог является глобальным максимумом координаты для всего множества точек Для определения минимального значения высоты полога леса необходимо иметь информацию о типе ландшафта равнина, горы, холмы для данного региона. Увеличим размерность воксела многократно, вычислим параметр, определяющий перепад высот и, соответственно, тип местности Здесь остаточная сумма квадратов разностей и общая сумма квадратов разностей где количество точек в вокселе среднее значение координаты в вокселе минимальное значение, которое принимает координата в вокселе. Параметр принимает значения от 0 до 1, при этом чем ближе значение к единице, тем равниннее считается ландшафт. Для всех регионов, где больше либо равно 0,75, точки с минимальным значением классифицируются как точки Земли. Минимальные значения, не классифицированные как точки Земли, определяют минимальное значение порога как среднеквадратичное значение координат . Прежде чем перейти к третьему этапу моделирование ландшафтной сцены, необходимо собрать дополнительную информацию о моделируемых объектах-деревьях по данным аэрофотосъемки региона. Таким образом, алгоритм совмещения данных лазерного сканирования и аэрофотоснимков в задаче моделирования растительности включает следующие шаги 1. Определение породы дерева по аэрофотоснимку. В зависимости от породы дерева выбирается тип ветвления для работы алгоритма -систем моноподиальное, симподиальное или тернарное. 2. Локализация формы крон деревьев. Поиск корневой точки точки начала ствола дерева из исходного облака данных лазерного сканирования стартовой точки работы алгоритма -систем 56 итераций и определение формы кроны дерева 10. 3. Окончательное моделирование кроны дерева с использованием алгоритма Space Colonization 11. Использование только одного типа данных точек лазерного сканирования не позволяет определить породу дерева по предварительно сегментированному облаку точек. Данные лазерного сканирования можно использовать только для определения формы кроны дерева. Для определения класса объекта береза, сосна, пихта, ель, кедр, осина и пр. необходимо осуществить аэрофотосъемку региона. Отметим, что деревья на аэрофотоснимках древостоя относятся к малым и слабоконтрастным изображениям, границы контуров объектов представляют собой не контрастные линии, а размытые переходные полосы. В каждом конкретном случае возможности дешифрования аэрофотоснимков определяются природой сканируемых объектов, тем не менее существует относительно стабильная группа дешифровочных признаков, позволяющих причислить объекты к тому или иному классу хвойному лесу, лиственному лесу, земледельческому полю, реке, озеру и т. п.. К прямым признакам относят размеры, форму, тени, цвет и текстуру изображения объектов на аэрофотоснимке. Критерием отнесения дерева к тому или иному классу в нашем случае является цветовая составляющая объекта на аэрофотоснимке яркостная компонента изображения в цветовом пространстве где, интенсивности цветов красного, зеленого и синего. Цвета изображений топографических объектов на аэрофотоснимках, а также соответствующая им яркостная характеристика представлены в табл. 1. Яркостная характеристика определяется эвристическим способом, путем анализа нескольких фрагментов аэрофотоснимков. В табл. 1 приведены типы лесов, которые встречаются в Сибирском федеральном округе. Также стоит отметить, что при сканировании поздней весной или в начале лета в связи с неполным развитием крон у лиственных пород, а также поздним летом или в начале осени когда лиственные деревья фиксируются на аэрофотоснимках более светлым цветом, чем темнохвойные задача кластеризации решается эффективнее. Таким образом, для каждого участка аэрофотоснимка вычисляется яркостная компонента, на основании которой происходит кластеризация. Следующим этапом является локализация крон деревьев. Сегментацию деревьев предваряет этап нормализации данных. Нормализация данных заключается в вычитании из каждой точки облака значения высоты Земли в данной координате, для чего необходимо знать значение высоты Земли в каждой точке. Алгоритм включает следующие шаги 1. Используя облако точек, классифицированных как поверхность Земли множество, строим двумерный массив значений высот в каждой точке. 2. Проверяем массив высот на отсутствие значений высоты в отдельных ячейках. Если таковые находятся, используем линейную интерполяцию для заполнения пустоты. 3. Обрабатываем каждую точку сегментируемого облака точек растительности множество . Вычитаем из значения высоты обрабатываемой точки значение высоты из массива высот. Далее, имея нормализованное облако точек, можно приступать к сегментации. Сегментация всего множества на подмножества, состоит из следующих шагов 1. Сортируются в массиве облака точек значения высот точек от большего к меньшему. 2. Берется первая точка массива и считается верхушкой дерева. 3. Обрабатывается каждая точка. Выявляется ее принадлежность к данному дереву. 4. После обработки всех точек из массива облака точек удаляются все точки, принадлежащие данному дереву. 5. Если точек в облаке больше нет, обработка завершается, иначе осуществляется переход к шагу 2. Таким образом получается сегментированное облако точек. Принадлежность точки к тому или иному дереву выявляется на основе следующих классификационных правил. 1. Учитывается относительное расстояние между кронами деревьев, форма дерева для простоты вычислений представляется в виде конуса. Данное предположение работает в разреженных участках леса, где расстояние между основаниями конусов деревьев будет меньше, чем расстояние между вершинами конуса. 2. При перекрытии крон деревьев точки классифицируются последовательно сверху вниз. Подбирается фиксированный порог примерный радиус кроны дерева, и в зависимости от этого порога точка относится к тому или иному объекту. Результаты сегментирования аэрофотоснимка представлены на рис. 2. Таким образом, деревья сегментируются на основе порогового расстояния фиксированный или адаптивный порог и правила минимального расстояния. Наибольшее распространение получило описание модели дерева в виде простейших геометрических примитивов, таких как сфера или конус 12. Существуют два основных метода описания процесса роста дерева методы на основе различных грамматик в том числе и -систем и метод Монте Карло по схеме марковских цепей. Будем считать, что дерево представляет собой некий фрактал, структурной единицей которого является побег. Для описания фрактальных структур используются грамматики -систем. В общем виде -системы представляют собой грамматику где набор переменных набор команд набор формальных параметров набор аксиом множество продукций правил ветвления. Изначально алгоритм использовался в 2D-пространстве. Для визуализации используются принципы черепашьей графики, когда для вычисления положения черепахи в 3D-пространстве определяются векторы, вдоль направления осей в системе координат . Изменение направления черепахи в пространстве вычисляется с помощью матриц поворота, и, где угол поворота Список команд представлен в табл. 2. В зависимости от типа ветвления моноподиальное, симподиальное и тернарное используются различные правила ветвления, разработанные Линденмайером 13. Приведем усовершенствованное описание модели роста деревьев разных пород. Для каждого типа ветвления были подобраны различные углы ветвления во всевозможных направлениях, а также коэффициенты пропорциональности дочерних и материнской ветвей табл. 3. Предполагается, что на каждой последующей итерации 1 длина побега уменьшается с удалением от вершины на -й итерации. Зависимость длины побега от расстояния до вершины описывается следующим образом где длина побега длина побега на вершине оси скорость уменьшения длины побега расстояние от вершины оси 1 итерации до основания оси -й итерации. 1, 2 3 4 5 6 7 8 9 10 11 12 14 15 Таким образом, имитировать воздействие внешних факторов на рост дерева можно путем изменения параметра, причем значение этого параметра может изменяться не только на разных итерациях периодах роста дерева, но и варьироваться по всему объему кроны, обеспечивая бесконечное множество форм моделируемых деревьев. Для каждого правила ветвления из табл. 3 приведены результаты моделирования табл. 4. Однако для моделирования кроны дерева заданной асимметричной формы разработанные правила ветвления на основе -систем не подходят они хороши для разработки ветвления внутри кроны дерева в пространстве, где достаточно малое количество регистрируемых лазером точек для визуализации кроны дерева необходимо в дальнейшем использовать алгоритм Space Colonization. Данный алгоритм изначально был предложен Рунионом 11 для предсказания движения человека в толпе и позже стал использоваться для визуализации различных ветвящихся структур. Основная идея также заключается в итеративном добавлении новых элементов ветвей к существующей геометрической структуре объекта дерева, сформированного на предыдущих шагах. Данный алгоритм является адаптивным, т. е. процесс роста зависит от следующих параметров близлежащего присутствия объектов окружающего мира, соседства с другими деревьями. Пусть имеется некоторая корневая точка, из этой точки может выходить несколько ветвей, т. е. в окрестности данной точки имеется множество точек, находящихся на расстоянии меньшем, чем параметр, задаваемый пользователем параметр управления. Если множество непустое, то новая точка присоединяется к общей структуре дерева путем построения сегмента, . Причем новая точка находится на расстоянии от исходной точки в направлении средненормированного вектора по отношению ко всем источникам . Данный алгоритм использовался для детальной прорисовки кроны дерева. На рис. 3, показана визуализация исходного облака точек фрагмент на рис. 3, отображено разбиение пространства облака точек на вокселы на рис. 3, для каждого воксела находим центр масс. Полученное облако точек является исходным облаком для работы алгоритма Space Colonization на рис. 3, представлена работа правил ветвления на основе -систем около трех итераций. Конечные позиции работы правил ветвления -систем являются стартовыми точками работы алгоритма Space Colonization. Каждая последующая ветвь вычисляется таким образом где расстояние между точками и, точка начала новой ветви, конечная точка новой ветви средненормированный вектор направления роста ветви Данный процесс заканчивается при прохождении всех точек кроны дерева или при выполнении заданного пользователем количества итераций. Некоторые узловые точки удаляются. Это называется прореживанием, иными словами, при построении нового сегмента происходит проверка все точки, находящиеся на расстоянии kill distance, входной параметр от точки, удаляются. Результатом исследовательской работы, описанной в статье, является трехмерная модель участка леса, представленная на рис. 4. На рис. 4, приведены данные аэрофотосъемки моделируемого региона на рис. 4, представлена визуализация данных лазерного сканирования исходного облака точек трехмерных данных на рис. 4, показаны результаты процесса локализации кроны деревьев, определения радиуса кроны дерева и на рис. 4, представлена трехмерная модель ландшафтной сцены с использованием графических примитивов в качестве представления кроны дерева. В работе приведены правила классификации исходного облака точек данных лазерного сканирования на различные группы точки растительности, точки поверхности Земли и точки с избыточной информативностью, а также шумы и ошибочные измерения. Экспертная оценка качества построенных моделей поверхности и растительности была выведена путем визуального сравнения и оценки множества моделей, полученных в результате работы алгоритмов с различными входными параметрами. В результате можно сделать вывод, что построение модели зависит от настройки параметров алгоритмов для конкретного облака точек. Однако зная дополнительную информацию о территории, можно улучшить результаты моделирования лесной растительности. 