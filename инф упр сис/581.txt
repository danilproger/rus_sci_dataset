КОММУТАТИВНЫЕ ШИФРЫ НА ОСНОВЕ  ТРУДНОСТИ ОДНОВРЕМЕННОГО РЕШЕНИЯ ЗАДАЧ  ФАКТОРИЗАЦИИ И ДИСКРЕТНОГО ЛОГАРИФМИРОВАНИЯ 

известны построения криптосхем с открытым ключом, при которых их взлом требует одновременного решения двух независимых вычислительно трудных задач, за счет чего обеспечивается повышение уровня их безопасности, однако аналогичные построения для алгоритмов коммутативного шифрования не известны. Практическая значимость задачи повышения безопасности используемых криптографических механизмов защиты информации обусловливает актуальность проблемы уменьшения вероятности взлома алгоритмов коммутативного шифрования за счет появления прорывных результатов в области решения вычислительно трудных задач. Целью работы является разработка алгоритмов коммутативного шифрования, взлом которых требует одновременного решения двух независимых вычислительно трудных задач. Методы: расщепление шифруемых сообщений и использование разовых ключей шифрования. Результаты: впервые предложен метод расщепления сообщений для расширения класса вычислительно трудных задач, которые могут быть положены в основу коммутативных шифров, разработан алгоритм коммутативного шифрования, основанный на трудности задачи факторизации, а также алгоритм коммутативного шифрования, стойкость которого основана на вычислительной трудности одновременного решения задач факторизации и задачи дискретного логарифмирования в конечном поле. Сформулированы необходимые требования к выбору параметров для предложенных алгоритмов. Практическая значимость: существенное повышение уровня безопасности процедуры коммутативного шифрования.

Коммутативное шифрование применяется для решения ряда специфических задач, таких как электронная жеребьевка, протоколы бесключевого шифрования и игра в покер по телефону 1. Самым известным представителем алгоритмов коммутативного шифрования АКШ является алгоритм Полига Хеллмана 2. Для повышения производительности процедур коммутативного шифрования в работе 3 была предложена его реализация над конечным расширенным полем, заданным в явной векторной форме. Это достигается благодаря сравнительно низкой сложности операции умножения и возможности эффективного распараллеливания в полях указанного типа. Относительно безопасности криптосхем ранее 4 было предложено рассматривать понятие безопасности как характеристику, учитывающую стойкость криптографических механизмов и вероятность появления в обозримом будущем эффективных способов их взлома, основанных на прорывных достижениях в области решения вычислительно трудных задач. Таким образом, отношение вводится как некоторый интегральный параметр безопасности. Снижение указанной вероятности может быть достигнуто разработкой криптосхем, взлом которых требует одновременного решения двух независимых трудных задач. В подобных криптосхемах вероятность взлома равна произведению малых вероятностей появления прорывного решения каждой из указанных двух задач, благодаря чему вероятность взлома криптосхем заметно снижается, что означает существенное повышение их безопасности. В данной статье предлагается механизм расщепления сообщений, позволяющий снять ограничения на шифруемые сообщения при использовании вычислительной трудности задачи факторизации ЗФ, и АКШ, основанный на трудности одновременного решения ЗФ и задачи дискретного логарифмирования ЗДЛ, обеспечивающий более высокий уровень безопасности. Механизм коммутативного шифрования работает следующим образом. Для всех сообщений, значения которых выражаются числами mod, где 1, 2, используя известное значение, каждый пользователь генерирует случайное значение и вычисляет mod . Пара значений и составляет ключ зашифрования и расшифрования соответственно. Отметим, что в отличие от схем шифрования с открытым ключом, значения обоих ключей держатся в секрете. При этом шифрование обладает свойством коммутативности, что позволяет зашифровывать и расшифровывать сообщение на различных ключах в различном порядке. В случае построения АКШ с использованием вычислений по трудно разложимому модулю, представляющему собой произведение двух больших сильных простых чисел и 5, вычисления по различным модулям не обладают свойством коммутативности. Следовательно, значение составного модуля не может быть секретным, как в схеме Полига Хеллмана 2, и должно быть общесистемным параметром, т. е. должно быть известно всем пользователям, поскольку предполагается, что если стойкость алгоритма основывается на ЗФ, то значение должно вырабатываться некоторым доверительным центром, который уничтожит сгенерированные им сильные простые числа и после вычисления значения модуля. Из-за этого для пользователей становится вычислительно невыполнимым нахождение функции Эйлера 1 1 от модуля, что является необходимым условием для генерации пары значений и таких, что 1 mod . Наличие такой пары значений позволяет построить АКШ. Однако знание значения, которое могло бы предоставляться пользователям доверительным центром, позволит легко факторизовать модуль методом, описанным в работе 1. Если значения и будут генерироваться доверительным центром, то два различных пользователя могут обменяться своими секретными значениями и найти и, т. е. взломать такую систему коммутативного шифрования 1. В качестве механизма, использующего известные параметры, зависящие от множителей модуля, который не позволит пользователям использовать вышеописанные атаки, можно применить следующую схему 6 формирования числа, порядок которого равен достаточно большому простому числу . Генерируются простые и такие, что достаточно большое простое делит оба числа 1 и 1. Число, имеющее порядок по модулю, выбирается в качестве . В этом случае значение будет несекретным. Данные условия позволяют сохранить высокую трудность ЗФ модуля при известных значениях, и 4. При этом обеспечение практической невозможности факторизации модуля задается тем, что значения, и генерируются некоторым доверительным центром. Отметим, что процедуры АКШ корректно работают только для тех сообщений, которые представимы в виде значений mod . При практическом применении требуется выполнять шифрование самых различных сообщений, в том числе и случайных битовых строк, которые могут быть не представимы в виде степени числа, т. е. не все сообщения можно зашифровать данным способом. Схожая проблема имеется и при разработке АКШ с использованием эллиптических кривых ЭК, заданных над конечными полями. Причиной этому служит то, что координаты ЭК должны удовлетворять некоторому уравнению третьей степени. Это значит, что не все пары значений соответствуют точкам ЭК. Легко видеть, что построение АКШ в обоих случаях требует решения задачи кодирования сообщений либо точками ЭК, либо значениями из некоторого ограниченного множества. Подходы к решению данной задачи не очевидны. В частных случаях приложений коммутативных шифров требуется зашифровать сравнительно небольшое число заранее известных сообщений например, в протоколе игры в покер по телефону. В этих случаях можно закодировать известные сообщения значениями вида mod . Однако для построения АКШ случайных сообщений, основанного на трудности ЗФ, данный подход не применим непосредственно. Для того чтобы с помощью предлагаемого механизма можно было выполнить коммутативное шифрование произвольных сообщений, требуется использовать дополнительный механизм расщепления сообщений, который описан далее. Число значений вида mod равно 2 для обеспечения 80-битовой стойкости т. е. стойкости, равной 2 операций модульного умножения. Эти значения практически невозможно перебрать, поэтому их можно использовать в качестве ключа шифрования. Пусть требуется зашифровать сообщение . Сгенерируем случайное число и вычислим значение mod . Зашифруем сообщение в зависимости от по модулю, например, по достаточно простой формуле mod, которая обеспечивает возможность безопасного шифрования коротких сообщений. Более простые формулы mod и mod допускают раскрытие коротких сообщений или сообщений из заранее известного ограниченного набора, используя в качестве критерия распознавания истинного сообщения равенство порядка значений и mod соответственно числу т. е. проверяя выполнимость соотношения 1 mod . Сообщение легко восстанавливается из пары значений, поэтому можно говорить о расщеплении сообщения на два значения и, причем число произвольного вида, а число принадлежит множеству значений mod, mod, mod . После расщепления сообщения его зашифрование расшифрование можно выполнить как зашифрование расшифрование значения . Последнее можно выполнить путем возведения в степень по модулю по формуле mod . Расшифрование выполняется как возведение криптограммы в степень по модулю, т. е. по формуле mod . Значение, по которому можно восстановить сообщение, не подвергается какому-либо преобразованию в процессе шифрования. Получаем следующую схему коммутативного шифрования АКШ1. 1. При первичном шифровании сообщения выполняется его расщепление, т. е. представление сообщения в виде, и шифрование значения mod . На выходе первичной процедуры шифрования имеем пару значений, . 2. Последующие шаги зашифрования расшифрования выполняются над значением . 3. Завершающий шаг расшифрования выполняется как расшифрование значения, приводящее к восстановлению значения, выбранного на шаге первичного шифрования сообщения, и вычисление значения по формуле mod . Данный АКШ позволяет выполнить шифрование сообщений произвольного вида за счет применения механизма расщепления шифруемого сообщения представления сообщения в виде пары других сообщений, одно из которых представляет собой число вида mod при некотором значении 1, 2, . Для его взлома потребуется решить ЗДЛ по составному модулю, что требует решения ЗФ, ЗДЛ по модулю и ЗДЛ по модулю . При выборе числа ограниченного размера например, 1024 бит безопасность данного АКШ определяется только ЗФ, поскольку при таком размере числа сложность указанных двух вариантов ЗДЛ является достаточно низкой. Нетрудно заметить, что алгоритм Полига Хеллмана может быть естественным образом встроен в описанный ранее АКШ при использовании в первом простого числа . Это реализуется путем одновременного шифрования обоих значений, представляющих сообщение в расщепленном виде. Для этого каждый пользователь выбирает две пары ключей, и, удовлетворяющих условиям 1 mod и 1 mod 1. Шифрование первого значения в паре расщепления выполняется по первой паре подключей как возведение в степень зашифрование или расшифрование по модулю . Шифрование второго значения в паре расщепления выполняется по второй паре подключей как возведение в степень зашифрование или расшифрование по модулю . Получаем следующую схему коммутативного шифрования АКШ2. 1. Первичное зашифрование сообщения выполняется как представление в виде, зашифрование по формуле mod и зашифрование по формуле mod На выходе первичной процедуры шифрования имеем пару значений, . 2. Последующие шаги зашифрования расшифрования выполняются как шифрование значения путем выполнения операции возведения в степень по модулю и шифрование значения путем выполнения операции возведения в степень по модулю . 3. Завершающий шаг расшифрования выполняется как расшифрование значения, приводящее к восстановлению значения расшифрование значения, приводящее к восстановлению значения, и вычисление значения по формуле mod . Нетрудно видеть, что взлом данного АКШ требует одновременного решения ЗФ и ЗДЛ в конечном простом поле. Шифрование второго элемента пары расщепления осуществляется как возведение в секретную степень по модулю, поэтому можно говорить не о ЗФ, а о ЗДЛ по трудно разложимому модулю . Причем последняя задача принципиально отличается от ЗДЛ по простому модулю. В частности, алгоритм решения ЗДЛ по модулю может быть использован для факторизации значения модуля 7, что показывает существенную связь ЗФ и ЗДЛ по составному модулю 5. В работах 4, 7, 8 предложено использовать связь ЗФ и ЗДЛ по составному модулю . Если вычислительная сложность решения ЗФ и ЗДЛ при использовании лучших известных алгоритмов решения этих задач больше необходимого уровня стойкости, то взлом криптосхем, основанных на сложности решения ЗДЛ по составному модулю, потребует одновременного решения двух трудных задач ЗФ и ЗДЛ. Таким образом, выбор достаточно больших размеров простых делителей и числа в алгоритме, описанном в предыдущем разделе, превращает последний в АКШ АКШ3, основанный на трудности одновременного решения ЗФ и ЗДЛ по простому модулю, т. е. без дополнительного использования алгоритма Полига Хеллмана. Задача дискретного логарифмирования по составному модулю mod может быть решена путем факторизации модуля и решения ЗДЛ по множителям и 5 mod mod Очевидно, что решение является одинаковым для обоих уравнений, так как порядок по модулям и одинаков и равен . В случае выбора одинаковой длины делителей и вычислительная сложность ЗФ модуля примерно в 2 раза превышает сложность ЗДЛ по простому модулю или . Поэтому взлом криптосхемы требует одновременного решения ЗФ и ЗДЛ, если вычислительная сложность решения каждой из этих задач обеспечивает уровень стойкости, превышающий заданный. При этом за стойкость криптосхемы следует принять меньшее из значений трудоемкости решения ЗФ и ЗДЛ. С учетом этого размер минимального из делителей составного числа должен быть выбран таким, чтобы трудоемкость ЗДЛ по модулю этого делителя соответствовала заданному уровню стойкости, например, 1024 бит при 80-битовой стойкости. Впервые предложены АКШ, основанные на трудности ЗФ это расширяет арсенал коммутативных шифров, в том числе алгоритмы, стойкость которых основана на трудности одновременного решения ЗФ и ЗДЛ это значительно повышает интегральный показатель безопасности. Существенным элементом предложенных алгоритмов является механизм расщепления сообщений, который позволяет снять ограничение на шифруемые сообщения, накладываемое ЗФ при ее использовании для построения АКШ и состоящее в том, что сообщения должны иметь значения из циклической подгруппы, генерируемой заданным порождающим элементом. Сравнение предложенных АКШ с базовым алгоритмом Полига Хеллмана приведено в таблице. Алгоритмы шифрования, использующие механизм расщепления сообщения, могут быть отнесены к классу вероятностных шифров, так как в них при шифровании используются случайные значения, вследствие чего размер шифртекста превышает размер исходного сообщения. В предложенных алгоритмах шифрования размер зашифрованного текста примерно в 2 раза больше размера шифруемого сообщения. Однако это позволяет построить АКШ на основе трудности одновременного решения ЗФ и ЗДЛ в конечном поле, за счет чего решается задача повышения уровня безопасности процедур коммутативного шифрования. Исследование выполнено при финансовой поддержке РФФИ в рамках научного проекта 14-07-00061-а. 