АВТОМАТИЧЕСКОЕ ВЫДЕЛЕНИЕ   УЧАСТКОВ ЭЛЕКТРОКАРДИОСИГНАЛА   С НОРМАЛЬНЫМ СИНУСОВЫМ РИТМОМ 

1 Предложен самонастраивающийся алгоритм выделения фрагментов с нормальным синусовым ритмом в длинных записях ЭКГ, численные параметры которого рассчитаны по результатам анализа записей Физиобанка (PhysioBank).

Массовое обследование населения холтеровским мониторированием, нацеленное на выявление ранних стадий кардиологических заболеваний с бессимптомным течением, является одной из важнейших задач современной медицины. Очевидно, что поточная обработка 24-часовых записей электрокардиосигналов невозможна без средств автоматизации. Ясно также, что полная автоматизация диагностики ритма сердца нереальна, поскольку нечеткие медицинские знания не поддаются необходимой формализации. Известно 1, что профессиональная деятельность специалиста всегда опережает возможности автоматических систем. Поэтому перспективным решением задачи медицинской диагностики по длинным записям ЭКГ является создание интерактивных систем, предполагающих участие врача в принятии решения. При построении интерактивной системы представляется целесообразным выделение участков записей с повторяющимися с заданной точностью фрагментами сердечного цикла например, P-RS--комплексами в норме или -RS--комплексами в пароксиз-RS--комплексами в пароксиз-комплексами в пароксизмах мерцательной аритмии. В результате автоматической обработки выделенных участков врачу должны предъявляться графическая информация в виде усредненного повторяющегося фрагмента, ритмограммы и т. п. и численные оценки разброса параметров повторяющихся фрагментов. Одной из важнейших задач интерактивной системы обработки ЭКГ, не имеющей до настоящего времени окончательного решения, является надежное выделение участков с нормальным синусовым ритмом. Актуальность этой задачи обусловлена тем, что для большинства обследуемых в том числе страдающих различными видами аритмий участки с нормальным синусовым ритмом составляют основную часть записи ЭКГ. Так, более 99 записи 105 M-----H Arrhythmia DataM-----H Arrhythmia Data---H Arrhythmia Data--H Arrhythmia Data Arrhythmia DataArrhythmia Datahythmia Data DataDatabase имеет нормальный синусовый ритм, преры имеет нормальный синусовый ритм, прерываемый эктопическими вентрикулярными ударами, средняя длительность участка с нормальным синусовым ритмом составляет около 6 мин Можно ожидать, что при поточном обследовании в основном здорового населения участки с нормальным синусовым ритмом будут более продолжительными. Выделение участков с нормальным синусовым ритмом позволит, во-первых, локализовать аномальные фрагменты и, во-вторых, провести анализ и выявление патологий при сохранении синусового ритма к которым относятся, например, синусовые брадикардия и тахикардия, ишемия и т. п.. Основная сложность задачи автоматического выделения участков с нормальным синусовым ритмом в записях амбулаторных суточных ЭКГ заключается в большом разбросе параметров длительностей PR-, RRи R--интервалов по множеству записей ЭКГ и нестационарности обрабатываемых процессов в рамках каждой записи. Для обработки таких записей необходимы самонастраивающиеся алгоритмы. Основой выбора параметров самонастройки, таких как длительность адаптации, ширина зон поиска и т. п., являются априорные знания. Другая сложность рассматриваемой задачи состоит в обеспечении надежного обнаружения -RS-комплексов и P и --волн в зашумленных записях амбулаторных суточных ЭКГ с низкой частотой дискретизации ЧД. Многочисленные известные методы и алгоритмы обнаружения -RS-комплексов непрерывно пополняются новыми 3. Известны различные методы автоматического обнаружения характерных точек Pи --волн и выделения интервалов, характеризующих длительности предсердных и желудочковых систол. Большинство методов основано на предварительном выделении зон поиска относительно опорных точек вершин R-волн см., например, 4 и ссылки в ней. Целью настоящей работы является разработка самонастраивающегося алгоритма выделения участков с нормальным синусовым ритмом в длинных записях ЭКГ. Первым этапом разработки является анализ записей Physio-ank 2 для извлечения априорной информации, необходимой при проектировании самонастраивающегося алгоритма. Для расчета численных параметров алгоритма анализируются записи банков Fantasia и M----H Normal Sinus Rhythm, исследуются стати, исследуются статистические характеристики длительностей PR-, RRи R--интервалов по множеству записей, а также в рамках отдельных записей временные свойства последовательностей измерений PRи R--интервалов как случайных рядов. На следующем этапе разработки предлагаются 1 новый простой эвристический алгоритм распознавания -RS-комплексов, обладающий высокой эффективностью, и 2 самонастраивающийся алгоритм автоматического обнаружения максимальных точек Pи --волн на длительных интервалах времени, основанный на непрерывно уточняющемся вычислении зоны поиска вершин этих волн и использующий результаты первого этапа разработки. В качестве экспериментальных данных были использованы 50 записей ЭКГ из банков Fantasia Database FD и M-----H Normal Sinus Rhythm Database MNSRD Physio-ank 2. Рассчитывались средние значения и среднеквадратические отклонения СКО интервалов RR, R, P и P R на одноминутных фрагментах записей в различное время суток всюду далее в обозначениях интервалов индексы max опускаются например, запись Rозначает интервал между вершинами Rи --волн. Рассчитывались также коэффициенты корреляции между изменениями во времени RR-интервалов и изменениями всех остальных перечисленных выше интервалов на HF-, LF-, VLFи ULF-частотах. Для расчетов этих коэффициентов на VLF-частотах использовались одночасовые фрагменты записей, на ULF-частоте полные записи. СКО и коэффициенты корреляции вычислялись по формулам где дисперсия последовательности интервалов, 1, 2, число циклов работы сердца на обрабатываемом фрагменте записи электрокардиосигнала 6 суммарная дисперсия ошибки дискретизации на двух концах интервала 5 период дискретизации при частоте дискретизации ЧД 128 Гц 6 10,2 мс, при ЧД 250 Гц 6 2,7 мс ковариация последовательностей и здесь, е значения длительности интервалов RR, Rи т. д., мс, средние значения длительности, мс. Анализ одноминутных записей нормальных ЭКГ Физиобанка осуществлялся с помощью интерактивного алгоритма, включающего распознавание -RS-комплексов методом, предложен-RS-комплексов методом, предложен-комплексов методом, предложенным в работе 5, определение координат вершин Pи Т-волн в заданной окрестности вершины R -RS-комплекса и статистический анализ масси-комплекса и статистический анализ массивов RR-, -P-, R-и PR-интервалов. Для обработRR-, -P-, R-и PR-интервалов. Для обработ-, -P-, R-и PR-интервалов. Для обработ-P-, R-и PR-интервалов. Для обработ-, R-и PR-интервалов. Для обработR-и PR-интервалов. Для обработи PR-интервалов. Для обработPR-интервалов. Для обработ-интервалов. Для обработки выбирались фрагменты записей, на которых выделение вершин -RS-, Pи --волн осуществля-RS-, Pи --волн осуществля-, Pи --волн осуществляPи --волн осуществляи --волн осуществлялось без ошибок. Настройка программы по уровню -RS и параметрам зоны поиска Pи --волн проводилась вручную отдельно для каждой записи. Для обработки часовых фрагментов и суточных записей использовалась программа, составленная по приведенному ниже алгоритму. Признаками нормальной кардиограммы является наличие Pи --волн с интервалами P и -, лежащими в пределах 120200 и 350 420 мс соответственно 6. В настоящей работе принято, что P --волна обнаружена, если разP --волна обнаружена, если раз --волна обнаружена, если разность между потенциалом в момент P и средним значением потенциала в окрестностях этого момента 60 мс, 100 мс 150 мс, 400 мс превышает разность между потенциалом в момент P и средним значением потенциала в 0, 60 мс 0, 150 мс-окрестности этого момента не менее чем в 1,5 раза. Для анализа статистических и динамических свойств -P-, PRи R--интервалов на HFи LFчастотах обрабатывались одноминутные фрагменты записей в различное время суток. Обследуемые были ранжированы по частоте сердечных сокращений ЧСС, и в табл. 13 приведены результаты расчетов для среднего и двух крайних обследуемых. В нижних графах таблиц приведены пределы изменения, средние значения и СКО рассчитанных по формулам параметров по выборке 50 записей. На рис. 1 представлены ритмограмма и интервалограммы одной из записей. Видно, что 1 кривая изменения -P-интервала практиче-P-интервала практиче-интервала практически повторяет RR-ритмограмму, тогда как PR и R--интервалы изменяются мало и связь этих изменений с изменениями RR не заметна 2 изменение знака отклонения RR от среднего значения происходит на LF-частоте, и, следовательно, коэффициенты корреляции, рассчитанные по формуле, характеризуют взаимосвязи интервалов на частоте LF. В табл. 1 и 2 приведены 3 примера расчетов коэффициентов корреляции, средних значений, СКО и отношений R-RR и PRRR для записей, имеющих минимальное, среднее и максимальное значение ЧСС по обрабатываемой выборке. Такие расчеты были проведены для каждой записи выборки, содержащей более 50 записей банков FD и MNSRD Physio-ank. Согласно результатам расчетов, приведенным в табл. 1 1 коэффициенты корреляции между RR и -P близки к единице, откуда следует, что вариабельность сердечного ритма в диапазоне LF-частот осуществляется в основном за счет изменения длительности сердечной диастолы -P-интервала 2 коэффициенты корреляции между RR и PR, а также между RR и Rблизки к нулю, и, следоRR и Rблизки к нулю, и, следо и Rблизки к нулю, и, следоRблизки к нулю, и, следо близки к нулю, и, следовательно, последовательности PRи R--интервалов практически не содержат LF-частот, свяLF-частот, свя-частот, связанных с сердечным ритмом. Многие исследователи отмечают наличие в спектральных плотностях R--интервалограмм пиков на LF-частоте, мощность которых соответствует колебаниям со среднеквадратическими значениями, приблизительно равными 0,6 мс 4 и ссылки в ней. Однако столь малые колебания можно обнаружить только в записях ЭКГ с ЧД, превышающей 600 Гц напомним, что СКО дискретизации при ЧД 128 Гц равна и при ЧД 250 Гц 1,6 мс. Авторы 4 обрабатывали электрокардиосигналы, записанные с ЧД 1000 Гц. По результатам расчетов, приведенным в табл. 2, могут быть сделаны следующие выводы 1 средние по выборке обследуемых СКО R- и PR-интервалов приблизительно на порядок меньше СКО RRи -P-интервалов 2 максимальные по выборке записей СКО R-интервала составляют 14,6 мс, PR-интервала 10,9 мс Хорошо известна формула Базетта, связывающая средние значения RRи --интервалов - 0,4 RR . Так как в алгоритме обнаружения Pи --волн предполагается находить вершиPи --волн предполагается находить вершии --волн предполагается находить верши--волн предполагается находить верши-волн предполагается находить вершины этих волн, были рассчитаны и сведены в таблицу значения отношений RRR и P R RR обозначенные в таблице как R-RR и PRRR соответственно и оценены средние значения этих отношений. Полученные значения R-RR 0,30 0,03, PRRR 0,16 0,025. Вычислить коэффициенты корреляции на частоте HF можно различными способами, например, выбирая небольшие участки записи в окрестностях экстремумов LF-колебаний, содержащие достаточное количество HF-колебаний, или отфильтровав LF-колебания низкочастотным фильтром. В настоящей работе для анализа связей между интервалами RR, -P, Rи PR на HF-частотах использовались разности между значениями этих интервалов в очередном м сердечном цикле и их значениями в предыдущем 1-м цикле, обозначенные ниже как dRR, dRи dPR. ИсслеdRR, dRи dPR. Иссле, dRи dPR. ИсслеdRи dPR. Иссле и dPR. ИсслеdPR. Иссле. Исследование таких разностей рекомендовано в работе 7. Результаты расчетов коэффициентов корреляций и СКО последовательностей dRR, dR и dPR интервалов сведены в табл. 3. Расчеты поdPR интервалов сведены в табл. 3. Расчеты по интервалов сведены в табл. 3. Расчеты показывают 1 коэффициенты корреляции между RR и -P на HF-частотах так же, как на LF-частотах, близHF-частотах так же, как на LF-частотах, близ-частотах так же, как на LF-частотах, близLF-частотах, близ-частотах, близки к единице, откуда следует, что вариабельность сердечного ритма в диапазонах высоких HF чаHF ча частот осуществляется в основном за счет изменения длительности сердечной диастолы -P-интервала 2 коэффициенты корреляции между RR и PR, а также между RR и Rблизки к нулю. Согласно многим исследованиям спектральные плотности последовательностей PRи R--интервалов содерPRи R--интервалов содери R--интервалов содерR--интервалов содер-интервалов содержат пики в области HF-частот, превышающие по амплитуде пики на LF-частотах. Однако сущеLF-частотах. Однако суще-частотах. Однако существует мнение 4, что колебания PRи R--интервалов на частоте дыхания являются артефактами, вызванными изменениями формы грудной клетки и входного сопротивления измерительной аппаратуры при дыхании обследуемого. Наши результаты подтверждают такое предположение 3 СКО первых разностей R-и PR-интервалов в 67 раз меньше СКО первых разностей RRинтервалов, что говорит о незначительном присутствии колебаний HF-диапазона в последоваHF-диапазона в последова-диапазона в последовательностях R-и PR-интервалов. Ритмои интервалограммы на VLFи ULFчастотах исследовались с помощью программы, реализующей приведенный ниже алгоритм. Для анализа связей ритмои интервалограмм на VLFчастотах использовались одночасовые фрагменты записей, не содержащие заметных суточных дрейфов. Из последовательностей RR-, R-и PRинтервалов удалялись HFи LF-частоты путем осреднения на текущем окне длиной 25 мс один период граничной гармоники между VLFи LFчастотами 0,04 Гц 7. Рассчитанные осредненные по множеству записей коэффициенты корреляции составляют RR, R- 0,78 0,12 и RR, РR 0,75 0,07. На рис. 2 представлены графики зависимостей средних значений интервалов от времени для записи банка MNSRD. Для лучшеMNSRD. Для лучше NSRD. Для лучшеNSRD. Для лучше. Для лучшего восприятия связей между кривыми интервалограмма Rизображена в масштабе 31, интерRизображена в масштабе 31, интер изображена в масштабе 31, интервалограмма PR в масштабе 31 и смещена вверх на 200 мс. Высокие значения коэффициентов корреляции RR, R- и RR, РR показывают, что одновременные изменения RR-, R-и PR-интервалов вызваны одной причиной, связанной с работой сердца. Следует отметить различные знаки корреляций RR, R- и RR, РR при возрастании ЧСС уменьшении RR-интервала время поляриRR-интервала время поляри-интервала время поляризации и реполяризации желудочков сокращается, тогда как скорость проведения возбуждения через AV-узел увеличивается. Исследования характера ритмои интервалограмм на ULF-частотах проводились с использованием только банка данных MNSRD. ЗначеMNSRD. Значе NSRD. ЗначеNSRD. Значе. Значения RR-, PRи R--интервалов усреднялись текуRR-, PRи R--интервалов усреднялись теку-, PRи R--интервалов усреднялись текуPRи R--интервалов усреднялись текуи R--интервалов усреднялись текуR--интервалов усреднялись теку-интервалов усреднялись текущим окном длительностью 333 с, равной периоду граничной частоты между VLFи ULF-диапазонами. На рис. 3 изображены ритмои интервалограммы для записи 16773 указанного банка интервалограмма Rизображена в масштабе 21 и смещена вверх на 100 мс, интервалограмма PR в масштабе 31. Рассчитаны коэффициенты корреляции RR, R- 0,96, RR, РR 0,79. На рисунке видно, что все три интервала RR, R и РR одновременно возрастают в ночное время. Проведенный анализ приводит к следующим утверждениям, принятым за основу при построении алгоритма выделения вершин Pи --волн наиболее сложной части общего алгоритма выделения участков с нормальным синусовым ритмом. 1. При построении алгоритмов автоматического поиска вершин Pи --волн последовательности изPи --волн последовательности изи --волн последовательности из--волн последовательности из-волн последовательности измерений PRи R--интервалов могут рассматриватьPRи R--интервалов могут рассматриватьи R--интервалов могут рассматриватьR--интервалов могут рассматривать-интервалов могут рассматриваться как случайные временные ряды, содержащие а высокочастотные составляющие HFи LFчастоты, которые могут быть отнесены к внешним помехам без существенного ущерба истине б низкочастотные составляющие VLFи ULFчастоты, коррелированные с медленными изменениями RR-интервала и отражающие работу сердца. 2. Граничным значением между высокочастотными и низкочастотными составляющими колебаний PRи R--интервалов можно считать граничную частоту между LFи VLF-диапазонами, равную 0,04 Гц 7. 3. Среднеквадратические отклонения R-и PRинтервалов на одноминутных записях приблизительно на порядок меньше СКО RR-интервала, а средние за 1 мин значения R-и PR-интервалов изменяются в 6 8 раз медленнее соответствующих средних значений RR-интервала. 4. Максимальные значения СКО по множеству одноминутных записей составляют 125 мс, 11 мс, 15 мс. 5. Средние по выборке записей отношения длин интервалов Rи PR к среднему за 25 с значению длины интервала RR составляют R-RR 0,30 0,03, PRRR 0,16 0,025. Такой алгоритм включает алгоритм распознавания -RS-комплексов и алгоритм идентифика-RS-комплексов и алгоритм идентифика-комплексов и алгоритм идентификации координат вершин Pи Т-волн. Оба алгоритма работают в едином цикле по времени, и временная координата вершины R каждого -RS-комплекса является опорной точкой обнаружения Pи Т-волн. Самонастройка алгоритма распознавания -RSкомплексов осуществляется на первых 25 с записи, на которых определяется максимальное по абсолютной величине значение первой разности сигнала dR и приближенно оценивается среднее значение RR-интервала RR мс. Подавляющее большинство -RS-комплексов об-RS-комплексов об-комплексов обнаруживается простейшим методом по превышению абсолютного значения первой разности сигнала величины 0,6 dR . Если -RS-комплекс не обнаружен на временном интервале, превышающем RR мс, производится углубленный поиск низкоамплитудного -RS-комплекса путем снижения порога по первой разности в 1,6 раза и введения дополнительных ограничений на ширину комплекса и временные интервалы между соседними комплексами. Оценка эффективности алгоритма проведена на произвольно выбранных фрагментах записей базы данных MNSRD Physio-ank, содержащих в общей сложности более 2 10 -RS-комплексов. Чувствительность алгоритма составляет 99,8, избирательность 99,7 . Такая высокая эффективность алгоритма может быть объяснена, на наш взгляд, малой вероятностью появления низкоамплитудных -RS-комплексов в условиях повышенной мышечной активности обследуемого. Представление последовательности PRи R-интервалов в виде низкочастотных временных рядов, зашумленных высокочастотными помехами см. выше п. 1 результатов анализа записей Physio-ank, делает целесообразным построение алгоритма поиска вершин Р Т-волн, основанного на прогнозе центра зоны поиска очередной вершины по низкочастотной составляющей последовательности PR R--интервалов и вычислении ширины зоны поиска по оценкам СКО этих интервалов. Итеративное вычисление низкочастотной составляющей PR R--последовательности может быть осуществлено с помощью какоголибо дискретного низкочастотного фильтра например, фильтра Баттерворта или осреднением в текущем окне. Согласно п. 2 представленного выше анализа, граничной частотой между высокочастотными и низкочастотными составляющими колебаний PRи R--интервалов можно считать граничную частоту между LFи VLFдиапазонами, равную, согласно 7, 0,04 Гц. Поэтому при расчете низкочастотного фильтра частота среза выбрана равной 0,04 Гц. Частота дискретизации PRи R--последовательностей приближенно равна средней ЧСС здорового человека, равной 68 удмин 1,14 Гц 6. При фильтрации PRи R--последовательностей методом текущего окна длина окна выбирается равной периоду частоты среза 1 25 с, что приближенно соответствует длительности 28 -RSком плексов здорового человека. Самонастраивающийся алгоритм выделения фрагментов с нормальным синусовым ритмом включает следующие шаги. 1. Предварительная грубая обработка первых 25 с файла данных. Работает только алгоритм поиска -RS-комплексов, вычисляются dR и RR . 2. Определение начальных значений порога поиска -RS-комплексов по первой разности 0,6 dR центров зон поиска вершин Pи -волн в отPи -волн в оти -волн в от-волн в отволн в отсчете от опорных точек R PR 0,16 RR мс и R 0,3 RR мс согласно п. 5 результатов анализа записей Physio-ank ширины зоны поиска вершин Pи --волн 3 для Pи 3 для --волны, где 11 мс и 15 мс согласно п. 4 результатов анализа записей Physio-ank. 3. Далее по шагам 1, 2, идентификация временной координаты вершины R -го -RS-комплекса идентификация временных координат вершин -х Pи --волн обновление средних значений и СКО RR-, PRи R--интервалов с учетом найденных -х значений этих интервалов прогноз 1-х центров зон поиска P и --волн уточнение ширины 1-х зон поиска P и --волн по обновленным СКО PRи R--интервалов контроль длины RR-интервала и наличия P и - -волн по признаку выпуклости окрестностей найденных вершин P и переход к следующему шагу п. 3 1. Признаком конца фрагмента с нормальным синусовым ритмом и условием обнаружения аномального удара являются 1 отклонение длительности RR-интервала от текущего среднего более чем на три 2 отсутствие локального максимума на интервалах поиска вершин Pили --волн или 3 отсутствие выпуклой волны в окрестности P или . В работе предложен самонастраивающийся алгоритм выделения фрагментов с нормальным синусовым ритмом в длинных записях ЭКГ. Алгоритм включает поиск опорных точек вершин R -RS-комплексов и последующий поиск вершин Pи --волн, основанный на обновлении зон поиси --волн, основанный на обновлении зон поис--волн, основанный на обновлении зон поис-волн, основанный на обновлении зон поиска на каждом шаге. Для автоматического обнаружения вершин -RS-комплексов предложен эвристический алго-комплексов предложен эвристический алгоритм, показавший при испытаниях на базе данных MNSRD Physio-ank высокую эффективMNSRD Physio-ank высокую эффектив NSRD Physio-ank высокую эффективNSRD Physio-ank высокую эффективRD Physio-ank высокую эффективD Physio-ank высокую эффектив Physio-ank высокую эффективPhysio-ank высокую эффектив высокую эффективность чувствительность алгоритма превышает 99,8, избирательность 99,7 . Для проектирования самонастраивающегося алгоритма поиска вершин Pи --волн проведен анализ более 50 записей Физиобанка с нормальным синусовым ритмом. Проведенный анализ показал, что последовательности измерений PR и R--интервалов могут рассматриваться как слуR--интервалов могут рассматриваться как слу-интервалов могут рассматриваться как случайные временные ряды, содержащие а низкочастотные составляющие 0,04 Гц, коррелированные с медленными изменениями RR-интервала, и б высокочастотные помехи с частотой, превышающей 0,04 Гц. Такое рассмотрение стало основой построения самонастраивающегося алгоритма, а численные результаты анализа позволили рассчитать параметры самонастройки алгоритма. Программа, реализующая предложенный алгоритм, надежно обрабатывает 24-часовые записи ЭКГ. В заключение отметим также интересный результат, полученный в процессе анализа записей Физиобанка и не известный автору из литературных источников значительные по абсолютной величине коэффициенты корреляции между RR и PR-интервалами 0,8 имеют различные знаки на VLFи ULF-частотах. Этот результат может говорить о различных физиологических механизмах регулирования проводимости AV-узла при суточных колебаниях и колебаниях на VLFчастоте. 