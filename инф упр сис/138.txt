КОДИРОВАНИЕ И ПЕРЕДАЧА ИНФОРМАЦИИ ОСОБЕННОСТИ ОЦЕНКИ СОДЕРЖИМОГО   СЖАТОГО ВИДЕОПОТОКА 

1 2 Вводятся понятия первичной и вторичной информации применительно к цифровым изображениям. Рассматриваются особенности проявления вторичной информации в последовательностях сжатых изображений.

В наше время наблюдается постоянный рост объема обрабатываемой информации, в результа те чего становится все труднее с ней работать. Кроме того, появляются новые виды информа ции, эффективных алгоритмов анализа которой еще не существует. К ним можно отнести и циф ровой видеопоток. В данной работе рассмотрена уязвимость потоков видеоинформации, переда ваемых внутри систем видеоконтроля. В многофункциональных системах регистра ции существует проблема передачи графической информации между элементами системы. Для передачи телевизионного сигнала в системах ви деоконтроля могут использоваться как провод ные каналы связи, так и беспроводные радио канал или ИКканал. Для передачи сигнала на большие расстояния применяют видеоусилители и модемы передатчикимодуляторы и приемники демодуляторы. При этом видеосигнал с помощью специальной аппаратуры преобразуется, запоми нается и передается в линию связи. Время пере дачи может составлять от долей секунды до ми нуты, в зависимости от требований к качеству картинки. В настоящее время наиболее широ ко используются три системы передачи изобра жений по цифровым линиям 1 1 с компрессией изображений по принципу условного обновления CR, предназначенные для передачи только информации об изменении изображения от кадра к кадру 2 с MPEGкомпрессией, где используют спе циальные алгоритмы компрессии изображений движущихся объектов 3 с JPEGкомпрессией, обеспечивающие не зависимое сжатие кадра изображения. Современные системы передачи ориентированы на использование цифровых технологий и умень шение за счет их загрузки канала. Зачастую дан ные могут передаваться по сетям общего пользо вания как проводным, так и беспроводным, что накладывает дополнительные требования к кон фиденциальности информации. Как правило, данные передаются в маскируемом виде, при этом метод кодирования значительно не изменя ет размера маскируемого файла или битовой ско рости его передачи. Различают несколько классов изображений 2, которые обладают своими особенностями. Классификация основывается на размере палит ры, а также на внешних характеристиках обла стей изображения. 1. Деловая графика большие области одного цвета, плавные и резкие переходы, мало цветов. 2. Фотореалистичные изображения большое количество цветов 2, плавные переходы. 3. Фотореалистичные изображения с наложе нием деловой графики например, логотипа, даты, времени и другой служебной информации. Эти особенности должны учитываться при разработке алгоритмов защищенного кодирова ния и не должны приводить к снижению каче ства маскирования видеоинформации. По харак теру можно выделить два основных типа изобра жений статические картинки и динамиче ские видео. Формат предполагает структурированное опи сание изображения в цифровой форме. Это позво ляет упростить отображение графики и видео в вычислительной технике. Можно выделить два основных типа форматов, характеризующихся объемом данных, сжатые и несжатые. К несжатым относятся форматы, которые хра нят в себе структурированные данные, позволя ющие упростить отображение графики и видео в вычислительной технике. Информация, как правило, хранится попиксельно, типичным при мером является формат BMP. Изображения и видео обладают большой из быточностью, поэтому для уменьшения объема передаваемой информации применяют сжатие. Изображение может сжиматься целиком формат PCX либо блоками формат JPEG. Сжатие гра фических данных возможно без потерь или с по терями. Большинство методов кодирования ви део для достижения эффекта сжатия используют два типа избыточности временную и простран ственную. Во временной области имеется значи тельная корреляция между видеокадрами, за фиксированными в близкие моменты времени. Смежные по времени кадры имеют высокую сте пень корреляции, особенно при высокой частоте кадров. В пространственной области также на блюдается высокая зависимость величин пиксе лей, лежащих близко друг к другу. Наибольшее распространение получили мето ды компрессии видео и изображений с потерей качества, которые основаны на психовизуальных особенностях зрительной системы человека и по зволяют достичь высоких степеней сжатия. Не всегда применение сжатия дает уменьшение размера файла по сравнению с несжатым форма том, неоптимальные условия и неправильный вы бор алгоритма могут дать увеличение объема. Под первичной мы будем понимать информа цию, характеризующую саму картинку незави симо от формата данных. При рассмотрении ра стровых изображений это будут массивы пиксе лей. По ним можно охарактеризовать фон, конту ры и границы объектов, произвести поиск объек тов и распознавание их образов. Первичная информация нашла свое отраже ние в растровых форматах, не использующих сжатие, например BMP. Под вторичной мы будем понимать инфор мацию, по которой не прямо, а косвенно можно охарактеризовать изображение. Применительно к цифровым данным такой информацией будет размер файла и статистические данные, связан ные со структурой файла. Для защиты от раскрытия информации об изображении по размеру передаваемых данных предлагается перед маскированием дописывать к коротким кадрам случайную информацию, это позволит поддерживать размер передаваемых кадров на постоянном уровне. В то же время по требуется следить за максимальным размером кадра и обрезать лишнее, как правило, эта обя занность возложена на кодер. Основная страте гия сокрытия поддержание некоего постоян ного эффективного размера кадра. Для форматов, не использующих сжатие дан ных, по вторичной информации можно опреде лить физические размеры изображения при на личии знаний об объемах данных, необходимых для описания заголовка и одного пикселя. У сжатых форматов такого недостатка нет, так как степень сжатия заранее не известна. Однако если рассматривать последователь ность из нескольких изображений, полученных из одного источника и имеющих одинаковые раз меры, можно выделить следующие особенности 1 применение форматов без сжатия даст нам несколько одинаковых порций данных 2 при сжатии абсолютно одинаковые изобра жения будут иметь одинаковый размер 3 в зависимости от графической сложности избыточности изображения при сжатии размер файла будет изменяться. Таким образом, в случае применения покадро вого сжатия изображений с видеокамеры можно получить файлы кадров разной длины. Это свя зано с такой особенностью подавляющего боль шинства сжатых форматов, как отсутствие воз можности задавать строго определенную степень сжатия. В них задается верхняя граница степени сжатия, а нижней не придается значение в ре зультате изображения разных классов будут иметь разный размер. Применение других стратегий сжатия также дает появление вторичной информации. Основным параметром для анализа данных при их передаче с камеры будет являться битовая скорость 3, на прямую связанная с частотой кадров. Паузы меж ду порциями данных, возникающие при неполной загрузке канала, дают возможность отделить один кадр от другого. Изменение размера порций дан ных характеризует работу кодера при удалении определенной избыточности в исходном материа ле. При этом объем соседних порций данных мо жет незначительно различаться например, по при чине внутренних шумов видеокамеры, поэтому для получения информации о характере изобра жения необходимо проводить анализ кадров, не много отстоящих друг от друга. Таким образом, можно провести анализ любого сжатого видеопо тока на наличие в нем вторичной информации. Применение маскирования изменяет общий характер и распределение сжатых данных, что позволяет определить сам факт маскирования, однако не мешает провести анализ вторичной ин формации. В системах видеонаблюдения такая информация даст возможность сделать выводы о наличии или отсутствии движения в наблюдае мой области, о ее освещенности и контрастности, что крайне нежелательно. Рассмотрим возможные методы анализа вто ричной информации, остающейся после выпол нения процедуры маскирования изображения, применяя для этого классические уровни атак. 1. . В этом случае, используя доступную, преобра зованную в результате процедуры маскирования видеоинформацию, можно оценить насыщен ность передаваемого изображения или наоборот однотонность изображения и отсутствие большо го числа различных фрагментов. Например, лег ко определить, имеем ли мы дело с видеофраг ментом, представляющим хорошо освещенную сцену со множеством деталей, или это подвергну тый маскированию однотонный темный кадр. В первом случае размер маскированного кадра будет практически совпадать со стандартным размером видеоизображения, а во втором случае будет существенно меньше. В качестве примера приведем стадии заверше ния рабочего дня в помещении, снятые IPкамерой видеонаблюдения Genius IPCam Secure300R. Для различных ситуаций парами показаны исход ный и специально подготовленный кадр, запол ненный аналогичным объемом случайных дан ных рис. 1, см. с. 3 обложки. Заполнение шумом является моделированием маскированно го файла с восстановленной заголовочной частью. Наблюдается блоковый шум и зависимость числа блоков от размера файла. Настройки каме ры во время работы были неизменными разре шение 640 480 точек, степень сжатия макси мальная. Типичные кадры имеют следующие размеры, Б ярко освещенное помещение 26 150 в основном помещении погашен свет 11 208 в дальнем помещении свет погашен 8 990 освещение отключено 6 950. 2. . При возможности получить доступ к большо му числу разнообразных обработанных и исход ных видеофрагментов можно более точно прове сти классификацию маскированных изображе ний по их размеру, соотнеся размер анализируе мого кадра формата JPEG и возможное исходное изображение. Так, например, имея набор кадров одного и того же места в различных ситуациях наличие машин, людей или их полное отсут ствие, можно с высокой степенью достоверности соотнести размер доступного маскированного кадра с ситуацией на месте, изображение которо го передается. Пары кадров с различной активно стью в помещении представлены на рис. 2 см. с. 3 обложки. Размер файла кадра в первом случае составил 28 011 Б, а во втором 26 495 Б и 7,1 и 1,3 со ответственно относительно размера изображения пустого помещения. 3. . Эффективность и оперативность анализа вто ричной информации существенно повышаются, если интересует только наличие или отсутствие конкретной ситуации на месте, маскированное изображение которой удалось получить. Следует также отметить, что при анализе вто ричной информации могут использоваться два подхода. Так как маскированные, т. е. фактиче ски случайные данные стандартным декодером декодируются и отображаются без ошибок, воз можен визуальный анализ по непрорисованной части изображения. Второй подход детальный разбор каждого блока MCU Minimum Coded Unit, входящего в кадр, без визуального сравнения и анализа бит, требуемых для заполнения кадра. Формат JPEG предназначен для описания от дельных изображений, он не предусматривает однозначного предсказания размера файла после сжатия. Таким образом, размер файла будет не сти вторичную информацию об общих характе ристиках изображения. Другим распространенным форматом в систе мах видеонаблюдения является MJPEG, который был разработан для подвижных видеоизображе ний. В его основе лежит сжатие JPEG. Фактиче ски формат MJPEG рассматривает цифровой ви деопоток как последовательность отдельных кад ров, сжимаемых независимо друг от друга со гласно схеме компрессии JPEG. Данный формат хорошо подходит для систем видеонаблюдения, так как в нем кадры обрабатываются по отдельно сти, что позволяет осуществлять быстрый покад ровый поиск, получать качественные стопкадры и отображать покадровое видео с регулируемой скоростью воспроизведения. Таким образом, от дельные кадры в формате MJPEG будут обладать всеми особенностями JPEGформата. Если пропу стить видеопоток за некий фиксированный про межуток времени, зная частоту кадров, можно получить представление о среднем размере кадра в группе. Проведя несколько таких измерений, получим информацию об изменении размера кад ров в потоке, следовательно, определим каче ственные изменения передаваемого видео. Рассматривая кадр в формате JPEG, со сторо ны декодера можно представить его размер, изме ряемый не только единицами информации бай тами, но и числом блоков данных. Их появление связано с тем, что JPEG является блоковым коде ком, и данные в нем обрабатываются поблочно. Согласно спецификации 4, формат JPEG име ет четкую структуру, определяемую маркерами, при этом блоки, содержащие данные, описываю щие само изображение scan, являются самыми крупными. Изза использования энтропийного ко дирования на последнем этапе сжатия данных ито говый размер этих блоков и степень сжатия изо бражения нельзя предсказать. Такая особенность позволяет проявиться вторичной информации. Следует отметить, что маркеры в файле JPEG могут идти в различной последовательности и по вторяться например, для задания двух таблиц квантования. Несмотря на то что кодеры дают на выходе заголовок фиксированного размера, для вычисления его размера, т. е. длин всех марке ров, необходимо просмотреть файл и суммиро вать длины всех сегментов маркеров. В изображении, до маскирования, сжатом по стандарту JPEG, при отображении проявляются однотонные полосы, которые периодически до вольно резко меняют свой цвет. Кроме того, не редко при заданном разрешении изображения отображается не вся область, а только некоторая часть, пример такого изображения в укрупнен ном виде показан на рис. 3 см. с. 3 обложки. Для объяснения данных эффектов в маскиро ванных т. е. фактически для случайных данных необходимо подробно описать этапы разбора слу чайных данных кодером. JPEG является блоко вым кодеком, на выходе мы получаем блоковые искажения. Для рассмотрения интерпретации шума применительно к разбору JPEGдекодером блока MCU нужна математическая модель, опи сывающая средний размер MCU для случайных значений коэффициентов. В ходе работы были проведены анализ струк туры JPEGфайлов, оценка поведения декодера при разборе шума. JPEGдекодер способен осмыс ленно разбирать шум, при этом искажение кар тинки будет блоковым. При разборе шума в теле JPEGфайла кодер сможет графически отобра зить все данные при условии, что в них нет двух байтовых блоков, похожих на маркер, т. е. начи нающихся с FF и не содержащих 00. Возможно неполное отображение маскированной картин ки, вероятно использование этой информации для анализа последовательностей изображений. Качественные характеристики изображения влияют на размер конечного файла. Таким обра зом, существует возможность определять общие особенности картинки по изменению битовой ско рости видеопотока. Резкое изменение скорости передачи данных с камеры видеонаблюдения мо жет свидетельствовать о серьезном изменении картинки, например таком, как появление но вых объектов или движение в наблюдаемой обла сти, даже в том случае, когда сам поток передает ся в маскированном виде. 