МЕТОДИКА СИНТЕЗА СТРУКТУРЫ ВИТРИНЫ ДАННЫХ МЕДИКО-ГЕНЕТИЧЕСКОГО МОНИТОРИНГА 

В статье описаны основные положения методики проектирования структуры единой витрины данных медико-генетического мониторинга, осуществляемого в медико-генетическом центре на основе сведений, аккумулируемых в эксплуатируемых информационных системах учетного типа. The article treats the principles of design of a common data mart for medical genetic monitoring. The medical genetic monitoring is carried out at a medical genetic centre which uses data accumulated in informational systems of registration type.

Систематическое наблюдение за состоянием генофонда популяции, которое дает возможность оценивать существующий мутационный процесс и прогнозировать его изменения, представляет собой процесс медико-генетического мониторинга МГМ, осуществляемого медико-генетической службой МГС. В соответствии с приказом Министра здравоохранения РФ 316 от 30.12.1993 г. Одальнейшем развитии медико-генетической службы Министерства здравоохранения Российской Федерации организация работы МГС РФ строится по территориальному признаку, а ее структура имеет три основных уровня районный городской, региональный межрегиональный и федеральный. Региональный уровень МГС представлен региональными и межрегиональными медико-генетическими консультациями центрами, которые формируются как самостоятельные учреждения или в составе лечебно-профилактических учреждений ЛПУ. Одним из важнейших направлений деятельности медико-генетического центра МГЦ является комплексный анализ медико-генетического состояния популяции, своевременное выявление тенденций его развития, оценка влияния на него различных факторов. Источниками данных МГМ для МГЦ являются как ЛПУ региона, так и его собственные подразделения. Общая информатизация общества затронула и деятельность МГЦ в целом и их организационно-методических отделов в частности. Ее проявлением стало внедрение в МГЦ информационных систем ИС различного назначения, среди которых с позиций сбора данных МГМ можно выделить автоматизированные регистры, ориентированные на персональный учет соответствующих пациентов и по своей сути представляющие электронные хранилища разновидностей медико-генетических карт пациентов ИС, по своим возможностям в большой степени аналогичные автоматизированным регистрам, решающие задачи учета либо всех пациентов МГЦ ИС типа Регистратура, либо отдельной категории с учетом выполняемого специфического обслуживания этих пациентов ИС типа Пренатальная диагностика, Инвазивные операции и т. д.. Тем самым, большинство данных, собираемых в интересах МГМ а в идеальном случае все данные, могут быть аккумулированы в базах данных БД ИС МГЦ. Для решения частных задач анализа данных МГМ возможностей этих ИС обычно достаточно, по крайней мере, для формирования отчетных документов, предусмотренных федеральными нормативами. Однако комплексный анализ данных МГМ с использованием только ИС учетного типа крайне затруднен по следующим причинам отсутствие единого информационного поля по понятийному аппарату в частности, по классификаторам, по способам учета пациентов и событий по идентификаторам объектов мониторинга, по реализации автономные БД различного формата фиксированные и крайне ограниченные возможности по формированию отчетно-статистических документов, отсутствие аналитической обработки собираемых данных разнородность форматов электронного представления формируемых отчетно-статистических документов, невозможность их совместной автоматизированной обработки. Существенное повышение эффективности комплексного анализа данных МГМ может быть достигнуто за счет применения современных аналитических технологий оперативной аналитической обработки данных OLAP и интеллектуального анализа данных ИАД g 1. В свою очередь, применение указанных технологий для комплексного анализа данных МГМ предполагает наличие в МГЦ витрины данных ВД реляционной БД, предназначенной для централизованного накопления данных МГМ, собираемых в региональном МГЦ, и предоставления доступа к этим данным со стороны средств OLAP и ИАД рис. 1. На создание и заполнение ВД важнейшее влияние оказывают структура и содержание БД ИС-источников, так как содержимое ВД является производным от возможностей этих ИС по сбору и хранению данных МГМ ориентация ВД на поддержку применения OLAP-технологий, предусматривающих переход от реляционного представления и хранения данных к многомерному. Проведенный анализ позволил выделить следующие особенности ИС-источников и их БД, существенные с позиций построения и заполнения ВД МГМ 1 БД ИС-источников помимо данных МГМ содержат множество данных, к нему непосредственно не относящихся таблицы пользователей, журналы учета работы и т. д. 2 для ИС возможны разного рода ошибки данных недопустимые значения, нарушения логических связей и уникальности, целостности ссылок и т. д. 3 наличие малоинформативных и неинформативных полей, когда, например, при проектировании ИС предусмотрен некий атрибут сущности, но на практике его значение никогда или почти никогда не задается 4 в любой ИС учетного типа используются справочники и классификаторы, которые в большинстве своем уникальны практически единственным унифицированным классификатором является Международный классификатор болезней МКБ 5 в учетных ИС практически никогда не ведется протокола истории изменений карта пациента, извещение о врожденном пороке развития ВПР могут быть изменены в любой момент во время или после приема, при поступлении новых сведений из ЛПУ и т. д.. Аналогичная ситуация имеет место и по отношению к справочникам перечень ЛПУ, наименования улиц и т. д. корректируются пользователями произвольно по мере необходимости без протоколирования изменений 6 имеются принципиальные объективные сложности с идентификацией объектов мониторинга. Причинами тому могут служить возможные изменения фамилий, адресов проживания и т. д. Генезис вышеперечисленных проблем достаточно очевиден ошибки проектирования и программной реализации ИС, недостатки организации применения ИС, ошибки персонала, недостаточная развитость классификационно-справочной базы, системы учета населения, объективные обстоятельства. Ориентация ВД на поддержку применения OLAP-технологий приводит к тому, что в настоящее время широко используется размерная модель и соответствующая методология проектирования 24, предусматривающая использование трех типовых структур топологий денормализованной таблицы топологии схемы звезда s топологии схемы снежинка . В то же время отсутствуют формальные процедуры синтеза структур ВД выбор схем, определение состава и связей таблиц производится эвристически 4, и в конечном итоге все сводится к нахождению компромисса между временем выполнения запросов и затратами дисковой памяти и сложностью заполнения хранилища. Для упрощения решаемой задачи построения ВД с учетом ориентации на OLAP в рамках описываемой методики приняты следующие правила в таблицу фактов помещаются временные метки событий если они есть, а также уникальные и псевдоуникальные атрибуты например, фамилия пациента таблицы размерности используются для линейных измерений, иерархических несбалансированных измерений и нижнего уровня иерархии сбалансированных измерений консольные таблицы используются для иерархических сбалансированных измерений кроме нижнего уровня. Таким образом, в основе построения ВД лежит формирование ее структуры в виде композиции таблиц фактов, таблиц размерности и консольных таблиц, пригодных для размещения результатов очистки и преобразования первичных данных МГМ с учетом возможностей объединения этих данных по измерениям справочникам и классификаторам. Синтез структуры ВД должен выполняться в три этапа рис. 2 1 построение концептуальной модели первичных данных как множества моделей данных всех БД ИС-источников 2 синтез интегральной концептуальной модели доступных собираемых данных МГМ, учитывающей пересечения сведений в моделях первичных данных 3 синтез структуры ВД по содержимому интегральной модели на базисе типовых структур, специфичных для ВД в том числе из-за ориентации на применение OLAP. предполагает выполнение следующих действий. 1. Определение множества первичных БД. Для определения множества БД, которые будут выступать в качестве источников первичных данных МГМ при создании и использовании ВД, необходимо составить список БД информационных систем, эксплуатируемых в МГЦ, и исключить из него те БД, которые не имеют отношения к решению задач комплексного анализа данных МГМ, а также те БД, доступ к которым не обеспечивается телекоммуникационной платформой вычислительной сетью МГЦ, а перенос данных из них в ВД посредством машинных носителей нецелесообразен если в МГЦ осуществляется регулярный экспорт всех данных МГМ из одной ИС в другую, исключить из списка те БД, которые являются источниками для процессов экспорта. Базы данных, оставшиеся в списке, образуют множество, над которым выполняются дальнейшие действия. 2. Специфицирование физической модели данных для БД первичных источников. У каждой БД, входящей в, имеется физическая модель данных, благодаря чему можно получить ее формальные спецификации. Получение спецификаций в данном случае представляет собой часть процесса реинжиниринга БД s g g, методы и средства которого описаны, в частности, в работах 46. Результатом реинжиниринга существующей БД являются спецификации ее физической модели данных,1 где спецификации таблиц -й БД, 1, имя -й таблицы -й БД,1, количество таблиц характеристики столбцов -й таблицы -й БД имя -го столбца 1 тип данных -го столбца признак ключевого столбца признак обязательности значений спецификации связей таблиц -й БД спецификации -й связи -й БД имя родительской таблицы -й связи имя дочерней таблицы -й связи тип -й связи 11, 1 признак обязательности связи. 3. Сокращение физической модели с учетом семантики и информативности данных. В спецификации каждой таблицы из и каждого столбца необходимо добавить вербальный атрибут описания и соответственно, значением которого должно быть описание семантики данной таблицы атрибута, например, список обследований, фамилия, диагноз и др. Для определения семантики могут использоваться различные приемы анализ мнемоники имен таблиц и колонок, анализ хранимых данных, сопоставление содержания записей таблиц и сведений в экранных формах и т. д. В процессе определения семантики таблиц из множества должны быть удалены описания всех таблиц, не содержащих данных МГМ, а из каждого множества всех столбцов, не представляющих интерес с позиций комплексного анализа данных МГМ на региональном уровне. Для каждой -й таблицы, оставшейся в, необходимо получить значение количества имеющихся в ней записей, а для каждого -го столбца, оставшегося в, количество уникальных значений и количество значений NULL . Для тех столбцов, количество уникальных значений которых не превышает некоторой пороговой величины, целесообразно выполнить частотный анализ этих значений включая NULL. Результаты этого анализа имеют вид, где -е значение -го столбца -й таблицы -й БД количество появлений значения в -м столбце -й таблицы -й БД. Помимо семантики столбцов зачастую необходимо определять и семантику значений, так как в БД для обозначения символьных значений часто используются числовые и логические значения. Например, для столбца пол может быть принято, что значение 0 означает мужской, 1 женский или же наоборот. Для подобных столбцов необходимо строить таблицу соответствия вида, где -е значение -го столбца -й таблицы -й БД символьное значение, соответствующее . Полученные количественные характеристики дают возможность выполнить используя значения показателя информативности колонки max, необходимо исключить столбцы, для которых больше некоторого порогового значения. Завершающим этапом действий по сокращению физической модели является удаление из описаний всех связей, родительская иили дочерняя таблица которых исключена из множества описаний таблиц. После выполнения всех указанных выше действий формальные спецификации 1 с учетом введенных обозначений приобретают вид, где, и множества, могут быть пустыми. 4. Специфицирование логической модели данных для БД-источников первичных данных. Для каждой БД, входящей в, спецификации ее логической модели получаются по путем формирования множеств имен сущностей, имен атрибутов сущностей и отношений между сущностями, а также задания отображений, где имя сущности имя атрибута сущности имя отношения между сущностями. Таким образом, получение спецификаций логической модели данных для БД для БД ИС-источников заключается в переходе от таблиц, столбцов и связей к соответствующим сущностям, атрибутам и отношениям, а отображения, фиксируют содержание этого перехода. Это действие обратное переходу от логической структуры к физической структуре БД. Следует учитывать, что одна таблица физической структуры может не соответствовать ни одной сущности таблица-справочник, используемая для хранений значений атрибута атрибутов и появившаяся в физической структуре как результат нормализации, например наименования улиц соответствовать одной сущности пациент, диагностическая процедура, беременность и т. д. соответствовать двум и более сущностям. доступных данных МГМ заключается в преобразовании множеств, в множества, соответственно путем выполнения приведения логической структуры БД к первой нормальной форме, сопровождаемого элиминацией атрибутов, служащих для реализации соответствующих реляционных отношений в результате денормализации исходные множества, преобразуются в множества, соответственно объединения множеств, в множества, соответственно, при выполнении которого всем идентификаторам сущностей, атрибутов и отношений приписывается квалификационное имя, идентичное имени соответствующей базы данных выделения идентичных и подобных атрибутов. Если первое и второе действия элементарны, то на третьем следует остановиться более подробно. Пусть имеются два атрибута и со своими множествами допустимых значений и соответственно. Если для столбца, соответствующего атрибуту, множество не пусто, то в качестве домена этого атрибута следует использовать символические имена . Будем считать, что эквивалентен, если они семантически идентичны и при этом множества их значений и совпадают подобен, если они семантически идентичны и при этом . Для обработки идентичных и подобных атрибутов до тех пор, пока, необходимо выполнить следующие действия добавить в новую сущность для хранения значений атрибута добавить новое отношение характеризует типа 1 между добавленной сущностью и всеми сущностями, которые содержат атрибут или атрибуты и исключить из . Данный алгоритм неприменим к атрибутам, являющимся временными метками или количественными характеристиками. по содержимому интегральной модели. Применение в ВД типовых схем данных звезда и снежинка накладывает определенные ограничения на логическую структуру ВД. Основные правила ее синтеза достаточно просты каждой сущности интегральной концептуальной модели, соответствующей событию МГМ и как правило содержащей атрибут временную метку этого события, ставится в соответствие таблица фактов сущности, непосредственно связанные с сущностями-фактами, образуют таблицы измерений, а остальные сущности консольные таблицы. Однако необходимо учитывать иерархические измерения, неопределенность исходных данных и требования к топологии ВД. Иерархические измерения могут быть естественными как, например, в случае МКБ или искусственными. Искусственное измерение образуется во время синтеза структуры ВД путем анализа семантики атрибутов сущностей. Так, например, если сущность пациент МГЦ имеет атрибуты проживание с доменом в Санкт-Петербурге, в области и район города, то очевидно, что можно построить простое иерархическое измерение, разместить его в отдельной таблице измерений, а оба атрибута исходной сущности заменить идентификатором записи в построенной таблице измерений. Иерархические измерения могут быть сбалансированными и несбалансированными 7. Сбалансированное измерение например, ЛПУ район следует размещать в связанных таблицах, а несбалансированное измерение в одной таблице, в которой для обозначения иерархии вводится атрибут предок. Если некоему атрибуту сущности ВД соответствует столбец таблицы БД-источника, для которого разрешена необязательность значений 0, даже если 0, то в соответствующее измерение должно добавляться значение нет данных или что-то, ему аналогичное. Для иерархического измерения возможна ситуация, когда значение нет данных нужно вводить на нескольких уровнях иерархии. Основное требование к топологии ВД можно сформулировать так от каждой таблицы фактов может быть один и только один путь по отношению дочерняя родительская к каждой таблице измерений или консольной таблице от каждой консольной таблицы или таблицы измерений должен быть путь по отношению родительская дочерняя, по крайней мере, к одной таблице фактов. При этом следует учитывать, что в принципе возможна ситуация, когда некая таблица выступает в качестве таблицы фактов и одновременно является таблицей измерений для другой таблицы фактов. Так, на рис. 3 схематично изображена логическая структура ВД, в которой таблица Беременность является и самостоятельной таблицей фактов, и таблицей измерений для таблицы Обследование. Результат синтеза логической структуры ВД можно формально представить в виде, 2 где множество таблиц ВД множество отношений между таблицами в ВД имя -й таблицы множество имен атрибутов -й таблицы описание связи типа от таблицы к таблице . Наличие логической структуры позволяет осуществить построение физической структуры ВД в виде, где множество таблиц ВД множество отношений между таблицами в ВД идентично в 2 имя -й таблицы множество описаний столбцов -й таблицы имя -го столбца -й таблицы тип данных -го столбца -й таблицы признак ключевого столбца описание связи типа 11, 1 от таблицы к таблице . учитывает специфику системы управления базой данных, под управлением которой создается и будет функционировать ВД. В частности, это относится к правилам назначения записи имен таблиц и столбцов и поддерживаемым типам данных. Завершающим действием, выполняемым при синтезе структуры ВД, является определение подмножества фиксированных таблиц измерений и консольных таблиц, где имя таблицы из числа множество значений полей всех записей таблицы . К числу таких таблиц относятся таблицы с искусственными измерениями как линейными, так и иерархическими. Эти таблицы являются неизменными по крайней мере до перепроектирования ВД и могут быть заполнены сразу после разметки. Тем самым, конечным практическим результатом синтеза структуры ВД являются SQL-скрипты для разметки ВД и заполнения ряда ее таблиц. Работа выполнена при поддержке Фонда содействия отечественной науке, РФФИ проект 05-07-90088. 