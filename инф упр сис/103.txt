КОДИРОВАНИЕ  И  ПЕРЕДАЧА  ИНФОРМАЦИИ ПРОТОКОЛЫ КОЛЛЕКТИВНОЙ ПОДПИСИ НА ОСНОВЕ СВЕРТКИ ИНДИВИДУАЛЬНЫХ ПАРАМЕТРОВ 

Предлагается новый протокол коллективной подписи, устраняющий недостаток ранее известных протоколов такого типа, заключающийся в участии в протоколе доверенной стороны, которой передаются личные секретные ключи пользователей, подписывающих электронный документ.

В основе процедур аутентификации электронной информации лежат алгоритмы электронной цифровой подписи ЭЦП, при разработке которых обычно используются три вычислительно сложные задачи 1 факторизация составных чисел вида, где и два больших простых числа, удовлетворяющих специальным требованиям 1 2 нахождение дискретного логарифма по простому модулю 2 3 нахождение дискретного логарифма на эллиптической кривой ЭК специального вида 3. Предложенная недавно 4 в качестве нового криптографического примитива трудная вычислительная задача извлечения корней большой простой степени по большому простому модулю специального вида дала возможность построить алгоритмы ЭЦП, позволяющие осуществить свертку индивидуальных параметров, генерируемых при вычислении подписи, в некоторые коллективные значения, по которым формируется коллективная ЭЦП КЭЦП малого размера. В отличие от известных протоколов аналогичного типа 5, 6 протокол на основе свертки индивидуальных параметров устраняет необходимость передачи индивидуальных секретных ключей некоторой доверенной стороне, что делает его весьма перспективным для практического применения. В настоящей работе рассматривается механизм формирования КЭЦП на основе процедур свертки индивидуальных параметров, показывается возможность его переноса на схемы ЭЦП, основанные на трудности дискретного логарифмирования, предлагаются протоколы КЭЦП, использующие алгоритмы генерации ЭЦП, специфицируемые ГОСТ Р 34.1094 и ГОСТ Р 34.102001, и формально доказывается стойкость предложенных протоколов КЭЦП. Рассмотрим схему КЭЦП, использующую трудность извлечения корней большой простой степени по простому модулю вида 1, где четное число, 2 и простое число достаточно большого размера. Открытый ключ вычисляется по формуле mod . Подписью является пара чисел и . Формирование подписи к сообщению выполняется следующим образом. 1. Выбрать случайное значение 1 и вычислить mod . 2. Используя некоторую специфицированную хэш-функцию, вычислить и значение некоторой сжимающей функции, в качестве которой можно использовать, mod, где большое простое число, например, имеющее длину 160бит. 3. Вычислить второй элемент ЭЦП mod . Соотношением проверки подписи является уравнение mod Реализация единой подписи, принадлежащей одновременно двум пользователям и, обладающим открытыми ключами mod и mod соответственно, выполняется следующим образом. 1. Пользователь генерирует mod, где случайное число. 2. Пользователь генерирует mod, где случайное число. 3. Вычисляют mod . 4. вычисляет mod 5. вычисляет mod 6. Вычисляют общую подпись, mod Проверка такой коллективной подписи осуществляется по уравнению mod, в котором произведение может быть заменено сверткой индивидуальных открытых ключей пользователей mod . Из приведенной процедуры генерации КЭЦП, принадлежащей двум пользователям, вытекают следующие свойства подписи 1 общая подпись имеет размер обычной подписи 2 подписи, и, недействительны к 3 можно сформировать коллективную подпись для произвольного числа пользователей 2, 3, 4. При реализации протокола КЭЦП на основе свертки индивидуальных параметров, генерируемых подписывающими сторонами в процессе формирования подписи, обеспечиваются следующие важные для практики свойства. Целостность из КЭЦП, принадлежащей заданному подмножеству пользователей, нельзя вычислить правильную подпись, соответствующую другому подмножеству пользователей. Независимость от пользователей КЭЦП может сформировать любая группа пользователей, независимо от их числа и состава. Одновременность генерации КЭЦП все значения, возникающие на промежуточных этапах процедуры генерации КЭЦП, не являются правильными подписями к каким-либо сообщениям, и из них не могут быть вычислены индивидуальные секретные ключи или значения. Возможность обнаружить нарушителя умышленные или неумышленные отклонения от процедур, специфицируемых протоколом, обнаруживаются по проверочному уравнению, причем анализ индивидуальных параметров позволяет установить, кто из пользователей осуществил неправильные действия. Использование стандартной инфраструктуры открытых ключей никакие дополнительные изменения в используемые на практике процедуры распределения открытых ключей не требуются. В качестве базовой для протокола коллективной подписи была принята идея использования коллективного открытого ключа, являющегося функцией открытых ключей подписывающих. Коллективный открытый ключ некоторой произвольно задаваемой совокупности пользователей, каждый из которых является владельцем соответствующего открытого ключа из множества, представляет собой некоторое значение . Общая схема формирования коллективной подписи представлена на рис.1, а процедура проверки подлинности КЭЦП на рис. 2. Представленная выше общая схема формирования КЭЦП была реализована в виде конкретных алгоритмов и протоколов, удовлетворяющих перечисленным требованиям. Использовались следующие трудные вычислительные задачи извлечение корней большой простой степени по большому простому модулю дискретное логарифмирование в мультипликативной группе большого простого порядка дискретное логарифмирование в группе точек эллиптической кривой специального вида. Наибольший интерес представляют алгоритмы, основанные на последней задаче, поскольку в этом случае обеспечивается наибольшая производительность процедур генерации и проверки подписи. Достоинство предложенной идеологии КЭЦП состоит в использовании стандартной инфраструктуры открытых ключей и возможности реализации с применением процедур генерации и проверки, регламентируемых российскими стандартами ЭЦП. Рассмотрим реализацию описанной идеологии построения протоколов КЭЦП на основе трудности задачи дискретного логарифмирования в конечной мультипликативной группе на примере использования ЭЦП Шнорра и ГОСТ Р34.1094 в качестве базовой схемы и трудности логарифмирования на ЭК на примере использования ГОСТ Р34.102001. Как указано выше, схема Шнорра основывается на сложности задачи дискретного логарифмирования. Общими параметрами являются и большие простые числа такие, что делит 1 число, относящееся к показателю по модулю, т. е. mod 1. Секретный ключ представляет собой случайно генерируемое число, 1 . Формирование открытого ключа осуществляется путем возведения числа в степень по модулю mod . Вычисление подписи к сообщению включает следующие шаги. 1. Генерируется случайное число, 1, играющее роль разового секретного ключа. 2. Вычисляется значение mod . 3. К сообщению присоединяется число, и вычисляется хэш-функция от значения . Значение является первой частью подписи. 4. Вычисляется вторая часть подписи mod, где секретный ключ. Процедура проверки подлинности ЭЦП. 1. Вычисляется значение mod . 2. К сообщению присоединяется число, и вычисляется хэш-функция от значения . 3. Сравниваются значения и . Если, то подпись признается верной. Протокол коллективной подписи на основе схемы Шнорра реализуется следующим образом. Каждый -й пользователь формирует открытый ключ вида mod, личный секретный ключ, 1,2, . 1. Каждый подписывающий генерирует разовый случайный секретный ключ число, затем вычисляет mod и предоставляет это значение для коллективного использования. 2. Вычисляется произведение mod 3. Вычисляется . 4. Каждый -й пользователь вычисляет свою долю второй части подписи mod . Коллективной подписью является пара чисел, где вычисляется по формуле mod . Проверка подписи осуществляется по алгоритму, описанному выше. Покажем корректность алгоритма Стандарт ЭЦП ГОСТ Р 34.1094 регламентирует использование простого числа такого, что 510 512 бит либо 1022 1024бит, где разрядность в двоичном представлении, причем число 1 содержит большой простой делитель 2 2 либо 2 2 соответственно. Специфицируемые алгоритмы генерации и проверки ЭЦП используют число 1 такое, что mod 1. Вычисление ЭЦП осуществляется следующим образом. 1. Генерируется случайное число, 1 . 2. Вычисляется значение mod mod, являющееся первой частью подписи. 3. По ГОСТ Р34.1194 вычисляется хэш-функция от подписываемого сообщения. 4. Вычисляется вторая часть подписи mod . Если 0, процедура генерации подписи повторяется. Процедура проверки подлинности ЭЦП. 1. Проверяется выполнение условий и . Если они не выполняются, то подпись недействительна. 2. Вычисляется значение mod mod . 3. Сравниваются значения и . Если, то подпись признается действительной. Рассмотрим реализацию КЭЦП на основе этого стандарта. Каждый -й пользователь формирует открытый ключ вида mod, где генератор подгруппы достаточно большого простого порядка т.е. mod 1. Коллективным открытым ключом является произведение mod . Коллективная подпись формируется следующим путем. Каждый подписывающий выбирает разовый случайный секретный ключ число, затем вычисляет mod mod и предоставляет это значение для коллективного использования. Далее вычисляется произведение mod Затем каждый пользователь по своему значению и величине вычисляет свою долю подписи mod . Коллективной подписью является пара чисел, где вычисляется по формуле mod . Проверка коллективной подписи осуществляется по проверочной формуле mod mod . Если, то КЭЦП совокупности пользователей 1,2, является подлинной, так как она могла быть сформирована только при участии каждого пользователя из этой группы, поскольку для ее формирования требуется использование секретного ключа каждого из них. Отметим, что аутентификация значений осуществляется автоматически при проверке подлинности коллективной ЭЦП. Если нарушитель попытается подменить какоелибо из этих значений или заменить ранее использованными значениями, то факт вмешательства в протокол будет сразу же выявлен при проверке подлинности ЭЦП, т.е. будет получено . Легко видеть, что размер КЭЦП не зависит от . Покажем корректность предложенного алгоритма КЭЦП. Подставив подпись, в проверочное уравнение mod mod, где и убеждаемся, что оно выполняется Стандарт ЭЦП ГОСТ Р 34.102001 регламентирует использование простого числа модуля ЭК, которая задается в декартовой системе координат уравнением mod с коэффициентами и простого числа порядка циклической подгруппы точек ЭК точки с координатами, такой, что . Секретным ключом является достаточно большое целое число, а открытым ключом точка . Формирование подписи, осуществляется в соответствии со следующим алгоритмом. 1. Генерируется случайное целое число, 0 . 2. Вычисляется точка ЭК и определяется значение mod, где координата точки . 3. Вычисляется значение mod, где mod, значение хэш-функции от подписываемого сообщения. Подписью является пара чисел и . Проверка подписи заключается в вычислении координат точки ЭК mod mod, 1 определении значения mod и проверке выполнения равенства . Протокол КЭЦП реализуется следующим образом. Каждый -й пользователь формирует открытый ключ вида . Коллективным открытым ключом является сумма . Коллективная подпись формируется следующим путем. Каждый подписывающий выбирает разовый случайный секретный ключ число, затем вычисляет и предоставляет это значение для коллективного использования. Далее вычисляется сумма всех точек, по которой вычисляется значение mod . После этого каждый -й пользователь по своему секретному ключу, значению и величине вычисляет свою долю подписи mod . Коллективной подписью является пара чисел и, где вычисляется по формуле mod . Проверка коллективной подписи осуществляется по проверочной формуле. Если mod, где точка вычисляется по проверочному соотношению 1, то КЭЦП совокупности пользователей 1,2, является подлинной, так как она могла быть сформирована только при участии каждого пользователя из этой группы, поскольку для ее формирования требуется использование секретного ключа каждого из них. При разработке криптографических протоколов важным вопросом является доказательство их стойкости. В предлагаемых протоколах КЭЦП это может быть сделано путем формального доказательства того факта, что если протокол КЭЦП не является стойким, то тогда может быть взломан базовый алгоритм ЭЦП. Из этого доказательства вытекает безопасность протокола при использовании стойкой базовой схемы ЭЦП. Если в протоколе использовать стойкие апробированные алгоритмы ЭЦП, например стандарты ЭЦП, то и сам протокол будет стойким. Рассмотрим формальное доказательство стойкости протокола КЭЦП при использовании проверочного уравнение mod mod, регламентируемого стандартом ЭЦП ГОСТ Р 34.1094. При доказательстве следует рассмотреть две возможности подделки КЭЦП и вычисления секретного ключа одного из пользователей, являющегося совладельцем коллективной подписи, объединенными усилиями остальных совладельцев КЭЦП. Рассмотрим первый вариант. Очевидно, что для посторонних нарушителей, не являющихся абонентами рассматриваемой системы ЭЦП, подделка КЭЦП так же сложна, как и подделка индивидуальной подписи некоторого отдельного пользователя. Новые возможности возникают у пользователей, объединяющих свои усилия, чтобы сформировать КЭЦП, относящуюся к коллективу, в который кроме них входит еще один или несколько других пользователей, которые об этом не оповещаются доказательство для обоих случаев аналогично. Пусть 1 пользователей хотят сформировать КЭЦП, проверяемую по коллективному открытому ключу mod, где т.е. 1 пользователей объединяют свои усилия, чтобы сформировать пару чисел, такую, что mod mod . Это означает, что они могут подделать подпись под открытый ключ mod, т.е. вычислить значения и, которые удовлетворяют уравнению mod mod . Из интуитивных соображений ясно, что последнее означает возможность подделать цифровую подпись в базовой схеме ЭЦП, поскольку открытый ключ имеет случайное значение, так же как и открытый ключ, принадлежащий какому-то отдельному пользователю. Рассмотрим формальное доказательство этого факта. Используя предполагаемую возможность, коллективный нарушитель формирует КЭЦП, соответствующую коллективному открытому ключу mod, где в качестве взято значение mod . Коллективная подпись удовлетворяет соотношению Последнее выражение показывает, что, является подлинной индивидуальной ЭЦП -го пользователя. Таким образом, мы формально показали, как возможность подделать коллективную подпись может быть легко использована для подделки подписи в базовой схеме ЭЦП. Рассмотрим атаку, осуществляемую объединенными усилиями подмножества совладельцев коллективной подписи и направленную на вычисление секретного ключа другого совладельца КЭЦП. Рассмотрим случай, связанный с наибольшими возможностями у атакующих. Покажем, что если 1 совладельцев КЭЦП могут вычислить секретный ключ -го совладельца, против которого направлена атака, то тогда они могут вычислить секретный ключ по индивидуальной ЭЦП, сформированной по базовому алгоритму ЭЦП. Пусть, это ЭЦП, сформированная -м пользователем к документу, соответствующему хэш-функции . Тогда выполняется mod mod . 2 Атакующие генерируют случайные значения и вычисляют mod mod для 1, 2, 1. После этого они вычисляют параметры и, удовлетворяющие уравнениям 3 где 1,2, 1. Вводя обозначение 4 из 3 и 4 получаем mod mod, где и Это означает, что атакующие получили правильное значение коллективной подписи, в которой участвуют они и еще один пользователь, обладающий открытым ключом Согласно допущению, из полученной коллективной подписи атакующие могут вычислить секретный ключ . Из 4 легко получить mod . Таким образом, атакующие вычислили секретный ключ -го пользователя по его индивидуальной ЭЦП, сформированной в рамках базового алгоритма ЭЦП. То есть было формально доказано, что если протокол КЭЦП допускает вычисление секретного ключа одного из пользователей, то по индивидуальной ЭЦП, сформированной по базовому алгоритму ЭЦП, также можно вычислить секретный ключ. Это означает, что предложенный протокол КЭЦП не снижает стойкости базового алгоритма ЭЦП. С интуитивной точки зрения, доказанное утверждение изначально очевидно. Однако ценность данного доказательства состоит в том, что оно является формальным. В данной работе показана возможность применения подхода к построению протокола КЭЦП на основе процедур свертки индивидуальных параметров отдельных пользователей в коллективные значения с использованием алгоритмов на основе сложности задачи дискретного логарифмирования в конечной мультипликативной группе и в группе точек ЭК, включая использование стандартов ЭЦП, действующих в России. Показана сводимость безопасности предложенных протоколов КЭЦП к безопасности алгоритмов ЭЦП, на основе которых строятся данные протоколы. Работа выполнена при поддержке гранта РФФИ 08-07-00096-а. 