СРЕДНИЕ ВРЕМЕНА ОЖИДАНИЯ И ПРЕБЫВАНИЯ В МНОГОКАНАЛЬНЫХ ПРИОРИТЕТНЫХ СИСТЕМАХ 

Предлагается способ расчета средних времен ожидания и пребывания заявок в n-канальной системе с относительным, абсолютным и смешанным приоритетами при произвольных и различных по типам заявок распределениях длительностей чистого обслуживания. Точность расчетов иллюстрируется сопоставлением с результатами имитационного моделирования и пересчетов на основе «инвариантов отношения». Обсуждается расчет «замкнутых» приоритетных систем. A method is proposed to compute mean waiting and sojourn times for -channel system with preemptive, non-preemptive and mixed priorities. Service time distributions are supposed to be distinct and arbitrary. The precision of the algorithm is demonstrated by a comparison with the results of imitation and calculations on the basis of “relation invariants”. Closed priority systems are discussed.

Задачи управления сложными техническими комплексами в реальном времени обычно требуют использования многомашинных или многопроцессорных систем как из соображений производительности, так и с учетом требований надежности и организации технического обслуживания последних. Различия в важности задач, их трудоемкости и требованиях к оперативности решения приводят к введению дисциплин обслуживания. Методы анализа одноканальных систем c приоритетами разработаны достаточно хорошо см., например, работы 1, 4, 5, 11, хотя численная их реализация при необходимости получения преобразований Лапласа иили высших моментов ставит ряд непростых проблем, отчасти решенных 10, 12, 17. Однако сложность анализа приоритетных дисциплин обслуживания резко возрастает при переходе к системам. Такие задачи обычно решаются лишь в простейшем экспоненциальном случае, причем средние длительности обслуживания предполагались различными буквально в единичных работах 7, 20, 23, 24. К тому же решение методом производящих функций оказывалось весьма громоздким. В статье А. Д. Хомоненко 21 предлагается фазовая аппроксимация системы с абсолютным приоритетом и двумя классами заявок с экспоненциальным обслуживанием, рассчитываемая итерационным методом ТакахасиТаками 13, 14, 25. Для распределений длительности обслуживания, отличных от показательных, диаграммы переходов существенно усложняются. Еще сложнее анализ многоканальных систем в случае относительных приоритетов. Здесь редуцированная схема требует учета трех потоков данного -го и двух объединенных потоков высших и низших приоритетов соответственно. Группирование типов заявок требует перехода к средневзвешенному распределению обслуживания, которое при различных экспоненциальных составляющих уже не может быть аппроксимировано показательным законом с приемлемой погрешностью. Практическую ценность могут иметь только алгоритмы, обобщенные в указанных направлениях. С другой стороны, все попытки создания реально применимых методик, учитывающих находящиеся в каналах и в очередях количества заявок каждого вида, заведомо обречены на неудачу в связи с непомерным разрастанием пространства состояний. Ниже предлагаются приближенные, но, как показали машинные эксперименты, достаточно точные способы расчета средних времен ожидания заявок в -канальной системе с относительным, абсолютным с дообслуживанием и смешанным статическими приоритетами при пуассоновских входящих потоках и произвольных различных распределениях длительностей чистого обслуживания. Режим работы системы предполагается стационарным. Сразу же отметим, что для всех обсуждаемых дисциплин обслуживания средние времена пребывания заявки в системе получаются добавлением к первых моментов распределения длительностей обслуживания . Поставленные задачи сводятся к расчету среднего времени недоступности системы для обслуживания меченой заявки типа типы заявок упорядочены по убыванию приоритетов. В случае приоритета с прерыванием к нему добавляется произведение среднего числа прерываний меченой -заявки на среднюю длительность каждого прерывания. Решения этих задач для одноканальной системы элементарны. Попытаемся найти их аналоги для -канальной. Выпишем известные выражения для первых двух моментов распределения времени ожидания меченой -заявки в одноканальной системе 1 2 Здесь кумулянтный коэффициент загрузки системы заявками до -го типа включительно. Заметим, что формула 2 в наиболее доступных источниках 4, 6, 8, 11 дана с различными ошибками. Приводимый здесь вариант 3, c. 168, согласуется с результатами имитационной модели. Предполагается, что расчеты по этой системе 1, 2 будут выполняться при интенсивностях исходных потоков, пересчитанных на один канал. Для -заявки, прибывающей в многоканальную систему, период общей недоступности заканчивается при завершении таковой хотя бы в одном из каналов. Соответственно дополнительная функция распределения недоступности 3 Здесь для упрощения обозначений индекс указывает число каналов тип заявок подразумевается. Интересующее нас среднее значение можно найти по хорошо известной формуле из теории надежности Простейшей реализацией этого подхода является экспоненциальная аппроксимация распределения времени ожидания в одном канале, для чего достаточно первого момента. Это допущение автоматически приводит к средней длительности ожидания, обратно пропорциональной числу каналов, что заметно расходится с экспериментальными данными см. ниже. Для аппроксимации распределения по моментам удобно воспользоваться распределением Вейбулла 4 с моментами 5 Определим параметры последнего приравниванием его моментов, найденными из системы 1, 2. Тогда отношение 6 где 1 Воспользовавшись формулой удвоения аргумента гамма-функции см. 22, c. 55, можно переписать 6 в виде откуда следует обеспечивающая быстро сходящийся итерационный процесс уточнения переменной формула 7 Начальное приближение 8 Решив уравнение 7, вычисляем 1, Применяя формулу 3 к распределению Вейбулла, убеждаемся, что она приводит к распределению того же типа с пересчитанным параметром и прежним . Соответственно интересующее нас среднее время ожидания в канальной системе В случае абсолютных приоритетов с прерываниями меченая -заявка просто не замечает присутствия в системе заявок типов . Здесь следует в уравнениях для моментов распределения ожидания заменить на все верхние пределы суммирования, равные количеству типов заявок . Описанный выше подход естественно применить и к аппроксимации распределения периода непрерывной занятости ПНЗ -канальной системы для начала применительно к потоку однородных заявок. Тогда средняя длина ПНЗ 9 где средняя длительность обработки головной заявки периода занятости. В имитационном эксперименте эта зависимость подтвердилась только для показательно распределенной длительности обслуживания, а в остальных случаях могла рассматриваться лишь как грубое приближение. В связи с этим было решено искать аппроксимацию упомянутой зависимости в виде 10 где коэффициент загрузки канала коэффициент вариации обслуживания. Необходимая поправка вычислялась через наблюденное в имитационном эксперименте среднее значение периода непрерывной занятости по формуле Отмеченное выше нулевое значение поправки для показательного распределения обслуживания определило ее мультипликативное строение и необходимость обращения в нуль при 1. Кроме того, в широком диапазоне коэффициентов вариации зависимость от при прочих равных условиях оказалась близка к линейной. Далее, модуль поправки был приблизительно пропорционален . Наконец, поправка росла по числу каналов обнаруживая тенденцию к насыщению, и, по определению, равнялась нулю при 1 последнее требование еще один аргумент за мультипликативную форму поправки. В итоге оказалось, что для использования в 10 можно принять числовой множитель 4 подобран экспериментально. Результаты вычисления средней длины периода непрерывной занятости на имитационной модели И и по расчету Р представлены в табл. 1. Распределением заменялось гамма-распределение с коэффициентом вариации 2. Во всех случаях полагалось 1. Вновь поровну разделим входящий поток между каналами обслуживания. Для одноканальной системы ожидаемое число прерываний где есть интенсивность потока заявок с правом прерывания -й. В -канальном случае заявка, прибывшая во время обслуживания й, может вообще ее не прерывать если хотя бы один канал свободен или занят обслуживанием менее приоритетной заявки. С другой стороны, меченую заявку могут прервать и те, которые изначально пришлись бы на другие каналы. Ясно, что первый эффект будет преобладать для заявок относительно высокого приоритета, а второй для низкого. Прерывание обслуживаемой -заявки может произойти, если все остальные каналы заняты обслуживанием не менее приоритетных заявок вероятность Потенциальные прерывания распределяются равновероятно между всеми -заявками, одновременно находящимися на обслуживании. В среднем их будет Таким образом, в многоканальном случае Эта формула при 1 является точной. В табл. 2 результаты расчета сопоставляются с полученными на имитационной модели. Рассматривалась система с тремя типами заявок при средних длительностях обслуживания 0,45, 0,90, 1,35 и интенсивностях потоков на канал 0,2, 0,3, 0,4 коэффициент загрузки 0,9. Поскольку обнаружилось, что типы распределений длительности обслуживания на кратность прерываний практически не влияют, объем таблицы, соответственно, сокращен. Таблица иллюстрирует качественное соответствие результатов ожидаемым и неплохое согласие полученных кратностей для низкоприоритетных заявок, т. е. как раз там, где прерывания могут дать заметную дополнительную задержку. Для заявок высокого приоритета согласие заметно хуже, но сами кратности весьма малы, да и длительности прерываний тоже будут малыми. Здесь итоговая погрешность суммарной средней длительности прерываний заведомо несущественна. Для расчета средних времен ожидания в многоканальных приоритетных системах предлагалось 1 использование символической пропорции вида Таким образом, средние времена ожидания в системе должны вычисляться по формуле Здесь 1 определяются по формуле 1. Дробь в правой части последнего равенства есть отношение средних времен ожидания в однои многоканальных системах с однородными потоками заявок суммарной интенсивности и средневзвешенными по интенсивностям моментами распределений длительности обслуживания. Эта дробь для наиболее интересного практически диапазона 5 хорошо аппроксимируется формулой 11 С помощью инвариантов отношения можно рассчитывать и системы с абсолютным приоритетом. В этом случае в пересчете должны участвовать начала обслуживания и общей длительности прерываний. К результатам пересчета следует добавить чистую длительность обслуживания. Предложенные подходы были запрограммированы на Фортране 77. Необходимые для работы с инвариантами отношения расчеты бесприоритетных и одноканальных приоритетных систем выполнялись на расширенной и переведенной на Фортран версии пакета МОСТ 10. За эталон были взяты результаты имитационного моделирования многоканальных систем при 200 тыс. наблюдений по заявкам высшего приоритета. Результаты счета выводились в точках логарифмической шкалы 1, 2, 5, 10, 20, 50, 100, 200 тыс. заявок этого типа. К указанному граничному значению они стабилизировались в трех старших знаках. При моделировании системы с абсолютным приоритетом длительность обслуживания заявки определялась в момент ее постановки в очередь при входе в систему с помощью соответственно настроенного датчика случайных чисел, после прерывания с остатком ранее сформированной длительности. Для относительного приоритета определялось более чувствительное к ошибкам время ожидания, для абсолютного полное время пребывания. Модели верифицировались на одноканальной задаче при исходных данных, приведенных в разделе о кратности прерываний. Достаточно большой суммарный коэффициент загрузки 0,9 обеспечивал существенную роль длительностей ожидания и прерываний низкоприоритетных заявок. В многоканальных случаях тот же коэффициент загрузки поддерживался умножением интенсивностей потоков на Результаты расчета сведены в табл. 3 и 4. Данные для каждого распределения представлены по схеме митацияинвариант тношения асчет по предлагаемым методикам. Анализ результатов показывает, что оба обсуждаемых подхода имеют право на применение. Однако погрешность инвариантов отношения для немарковских распределений может быть недопустимо велика, тогда как методики данной статьи приемлемую точность обеспечивают во всем исследованном диапазоне параметров. Их результаты не обнаруживают тенденций к росту относительных погрешностей при приближении к границам упомянутого диапазона. С другой стороны, в тех случаях, когда инварианты отношения лучше согласуются с имитацией, погрешность обоих подходов вполне допустима. Если в схеме абсолютных приоритетов имеется типов заявок, то наивысшая кратность прерывания составляет 1. В частности, для работы вычислительной системы необходимо иметь столько же областей сохранения запоминания состояния прерванной заявки. При больших имеет смысл группировать типы заявок в классы с общим абсолютным приоритетом и относительными приоритетами внутри классов 2. Такой подход снижает суммарную частоту прерываний и количество потребных областей сохранения, оставляя по одной на каждый класс, кроме первого. В то же время он способен обеспечить бо льшую дифференциацию оперативности обслуживания, чем схема относительного приоритета. Рассмотрим расчет среднего времени ожидания для заявки -го типа. Обозначим через наибольший индекс заявок, прерывающих -ю, т. е. нижнюю границу предшествующего класса, а через нижнюю границу класса, содержащего -заявки. Заявка -го типа будет ждать завершения начатого обслуживания, если она не имеет права его прерывания. Следовательно, в формулах для расчета времени ожидания начала обслуживания наибольший индекс должен быть заменен на . Период недоступности канала для -заявки может быть начат любой заявкой, имеющей право ее прерывания т. е. индекс до включительно. Соответственно интенсивность потока прерываний и средневзвешенные моменты распределения длительности обслуживания считаются по этому множеству индексов. Если разрешить присоединяться к прерываниям более приоритетным заявкам одного класса с -й, то коэффициент загрузки по прерывающим заявкам останется . Рассмотренная схема охватывает как частные случаи абсолютный приоритет один тип заявок в каждом классе, относительный единственный класс и стандартный вариант смешанного все типы заявок с абсолютным приоритетом образуют отдельные классы, заявки с относительным приоритетом объединяются в самый младший класс. В приложениях часто встречаются приоритетные системы замкнутого типа с конечными объемами источников, Рассмотрим технику их приближенного расчета. Прежде всего отметим, что полный цикл оборота -заявки составляет где средняя задержка в источнике среднее время ожидания обслуживания. Соответственно средняя интенсивность их потока 12 она максимальна при нулевых . Умножая обе части этого равенства на и суммируя по, получаем условие корректности исходных данных в форме тогда гарантируется отсутствие перегрузки разомкнутой системы. Поскольку, согласно 12, интенсивности входящих потоков зависят от искомых средних длительностей ожидания, последние приходится определять методом итераций 1 задаться начальными значениями 0 2 для всех вычислить согласно 12 3 для всех применяя приведенные формулы в зависимости от типа приоритета, рассчитать средние времена ожидания и согласно 12 новые интенсивности 4 если заменить на Перейти к этапу 3 5 конец алгоритма. Итерации по этой схеме оказались неустойчивыми с явными признаками слишком энергичной пошаговой коррекции. Поэтому интенсивности потоков во всех итерациях, начиная со второй, определялись через полусумму средних времен ожидания -заявки на двух последних шагах. Стабилизация пяти значащих цифр наступала примерно за 10 шагов практически независимо от исходных данных. Расчет выполнялся для трех типов заявок при средних длительностях обслуживания 0,45 0,90 1,35 и задержках в источнике 50, 30, 10. Численность популяций при 3 и 1, удовлетворяющих условию 12, составила 4, 13, 21 и 1, 4, 7 соответственно. При обслуживании с коэффициентом вариации 2 были получены средние времена ожидания 0,526 0,647 3,254 и 2,056 2,328 6,517, а при детерминированном обслуживании с теми же средними 0,251 0,290 1,506 и 0,510 0,581 2,773. Предложенная методика позволяет, наконец, сравнительно просто рассчитывать на уровне средних многоканальные приоритетные системы с произвольными и различными распределениями времени обслуживания. В отличие от метода инвариантов, она не требует сложного программирования и трудоемкого расчета многоканальных систем с немарковским обслуживанием и дает достаточную точность. В сравнении с имитационным моделированием методика существенно выигрывает в простоте программирования и объеме вычислений. Кстати, отметим, что с помощью популярной системы GPSS нужную модель не построить, поскольку названная система допускает лишь однократные прерывания, причем исключительно для одноканальных устройств. 