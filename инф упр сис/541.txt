РЕГРЕССИОННЫЙ АНАЛИЗ ВО ВЗАИМОСВЯЗАННЫХ  ЭЛЕКТРОМЕХАНИЧЕСКИХ СИСТЕМАХ  НА БАЗЕ МЕТОДА ОПОРНЫХ ВЕКТОРОВ 

в ряде случаев при управлении автоматизированными электромеханическими системами необходимо устанавливать регрессионные связи между управляемыми координатами. Метод опорных векторов может успешно применяться не только для решения задач классификации и диагностирования, но и для выполнения регрессионного анализа. Целью работы является обоснование возможности применения метода опорных векторов для установления соотношений между управляемыми координатами во взаимосвязанном электроприводе с дискретными временными эквалайзерами. Методы: исследованы особенности и преимущества регрессии на опорных векторах, возможности применения метода опорных векторов во взаимосвязанном электроприводе. Результаты: проанализировано математическое описание и аналитическая структура регрессионного алгоритма на базе опорно-векторной машины; предложена функциональная схема электромеханической системы со взаимосвязанным управлением на базе дискретных временных эквалайзеров, целевая функция управления в которой формируется с помощью регрессионной модели; приведен пример выполнения регрессионного анализа программным путем с помощью MatLab SVM Toolbox. Установлено, что эталонная целевая функция, которая формируется в результате SVR-анализа, может быть изменена путем выполнения переобучения алгоритма SVR и не требует подбора специальных регрессионных зависимостей. Практическая значимость: результаты исследований могут быть применены при проектировании взаимосвязанных электромеханических систем, целевая функция которых формируется с помощью регрессионного анализа.

Во взаимосвязанных электроприводах, реализующих некоторую целевую функцию управления технологическим процессом, часто возникает вопрос установления функциональных, корреляционных или регрессионных связей между управляемыми координатами. При функциональной связи каждому значению одной из координат ставится в соответствие только одно значение другой. Такую связь целесообразно использовать в детерминированных системах, подлежащих формализации с помощью математического аппарата элементарных функций. Корреляционные связи между управляемыми координатами используются при наличии статистических взаимосвязей между ними, которые иллюстрируются корреляционным полем или коэффициентом корреляции. Регрессионный анализ, в отличие от корреляционного, не определяет, насколько существенной является связь между величинами, а выполняет поиск модели этой связи в виде некоторой функции регрессии. Регрессионную связь между управляемыми координатами удобно использовать, когда отношение между ними количественно выражается в виде многочисленных комбинаций. Это могут быть как экспериментально полученные данные, так и некоторые расчетные точки, характеризующие соотношение между управляемыми координатами. Метод опорных векторов, общие подходы относительно возможностей использования которого в электроприводе рассмотрены в работе 1, можно применять не только для решения задачи классификации или диагностирования, но и для выполнения регрессионного анализа, что дает ряд преимуществ перед традиционными подходами. Поставим задачу применения метода опорных векторов для установления соотношений между управляемыми координатами во взаимосвязанном электроприводе с дискретными временными эквалайзерами 2 в качестве регуляторов. В своем нынешнем виде метод опорных векторов, или опорно-векторная машина support vector machine SVM, был разработан в 1995 г. в американской корпорации ATT Bell Laboratories под руководством выдающегося ученого в сфере машинного обучения В. Н. Вапника. Изначально SVM позиционировался как алгоритм для решения классификационной задачи, однако с конца 90-х годов XX века его начали использовать и для выполнения регрессионного анализа. Для подчеркивания того, что решается именно регрессионная задача, аббревиатуру метода опорных векторов меняют с SVM на SVR support vector regression 3. Преимуществом SVR перед другими методами регрессионного анализа является определение параметров регрессионной модели путем решения задачи квадратичного программирования, имеющей только одно решение. При использовании SVM нелинейная регрессия в исходном пространстве может рассматриваться как задача построения линейной регрессии в некотором расширенном пространстве, которое имеет большее количество измерений, чем . Это преобразование выполняется за счет нелинейного отображения . В отличие от формулировки SVM, где гиперплоскость должна была отделять одну группу признаков от другой, в SVR гиперплоскость строится таким образом, чтобы как можно больше точек попали на нее в качестве опорных векторов или хотя бы оказались в некоторой доверительной зоне регрессии. Точки, лежащие на этой плоскости, будут удовлетворять условию 4 где нормальный к гиперплоскости вектор. Перпендикуляр, определяющий расстояние от гиперплоскости до начала координат, находится как где выражение называют евклидовой нормой или длиной 5 вектора . Исходной информацией для выполнения регрессионного анализа по SVM является обучающая выборка вида, . Тогда задача линейной SVR-регрессии состоит в нахождении функции При нелинейной регрессии, используя нелинейное отображение, эту функцию можно представить в виде Задачу поиска оптимальной гиперплоскости SVR-анализ сводит к квадратичной задаче минимизации функционала при действии ограничений где положительная константа, чем больше ее значение, тем больше будет штраф ошибки, переменные, определяющие соответственно верхнюю и нижнюю границы погрешности обучения функция потерь чаще всего она является кусочно-линейной рис. 1. Векторы выборки входят в задачу регрессии только через скалярные произведения, поэтому можно использовать отображение в пространство признаков и перейти к ядерной версии SVM 5. На практике зачастую решается так называемая двойственная задача 5, а функция регрессии представляется в следующем виде где и двойственные переменные, удовлетворяющие условию, ядерная функция. Разности представляют собой весовые коэффициенты, характеризующие вклад соответствующих опорных векторов в формирование функции регрессии. Наиболее распространенными ядерными функциями являются следующие линейная, гауссова радиально-базисная, полиномиальная, сигмоидальная, экспоненциальная радиальнобазисная. Исходя из практического смысла применения SVR-анализа для установления соотношений между управляемыми координатами электромеханической системы, можно порекомендовать применение линейной ядерной функции в том случае, когда является очевидной линейная связь между величинами, а для всех остальных случаев качественные результаты анализа обеспечивает гауссова радиально-базисная функция 1 где параметр, от величины которого зависит ширина размаха функции. Преимуществом регрессионного анализа с использованием SVM является возможность задавать сразу величину, формируя таким образом соответствующую доверительную зону, оказываясь в которой можно считать погрешность соотношения между управляемыми координатами допустимой. Аналитическая структура регрессионного алгоритма на базе SVM представлена на рис. 2 6. Она иллюстрирует основные этапы обработки данных задание значений тестового вектора, нелинейное отображение или маппинг векторов, вычисление скалярного произведения или ядерной функции, суммирование полученных результатов с учетом весовых коэффициентов и параметра . Для программной реализации SVR-анализа чаще всего используют язык программирования C или Python. Наиболее распространенным программным продуктом для реализации как классификационных, так и регрессионных задач с помощью SVM является SVMlight 7, имеющий интерфейсы для Perl, Python, Ruby, Java, .NET и других языков программирования. Также существуют дополнения к программному пакету MatLab, которые расширяют его функциональные возможности, добавляя поддержку SVM. Среди таких дополнений можно отметить LIBSVM 8, PRTools 9, MatLab SVM Toolbox 10. Работа MatLab SVM Toolbox хорошо документирована в руководстве 11. MatLab SVM Toolbox предоставляет возможности для решения классификационных и регрессионных задач в программном пакете MatLab, который широко используется для моделирования автоматизированных электромеханических систем. Пользователь программного обеспечения при этом избавляется от необходимости выполнять рутинное программирование и работает с алгоритмом, реализующим SVM через графический интерфейс или через командную строку главного окна MatLab. Во взаимосвязанном электроприводе с помощью SVM можно построить регрессионную эталонную модель поведения многомерного объекта управления таким образом, как показано на рис. 3. В данном случае под многомерным объектом управления подразумевается сложный технический объект, имеющий некоторое количество неотделимых и взаимосвязанных частей, например моталка прокатного стана, система наведения радиолокационной станции, испытательный стенд механических трансмиссий вертолетов и т. п. Элементы таких объектов связываются между собой различного рода упругими связями и зачастую описываются линейной или линеаризованной системой дифференциальных уравнений. Объект управления имеет входов и должен реализовывать некоторую -мерную целевую функцию . За формирование каждой из входных координат объекта управления отвечает отдельный автоматизированный электропривод с дискретным временным эквалайзером 2. Таким образом, на объект управления поступают сигналы, от локальных электроприводов, а на его выходе образуется некоторая целевая функция, . При этом под действием возмущений, значения целевой функции могут отличаться от желаемых. Электроприводы, формирующие сигналы, реализованы на базе дискретного временного эквалайзера с модифицированным принципом симметрии объекта управления 12. Каждый из них состоит из следующих элементов см. рис. 3 программы формирования задания и настройки эквалайзера дискретного временного эквалайзера, который отвечает за формирование динамических и статических характеристик привода двух квантователей с периодом экстраполятора нулевого порядка, выполняющего цифроаналоговое преобразование и согласовывающего между собой дискретные и аналоговые элементы схемы исполнительной подсистемы двигателя и управляемого преобразователя обратной эталонной модели исполнительной подсистемы блока модификации обратного преобразования датчика обратной связи. Каждая из исполнительных подсистем получает свой сигнал управления, . Также на каждую исполнительную подсистему действует ряд возмущений, . Датчики обратных связей выполняют измерение координат, и преобразуют их в сигналы обратных связей, которые подаются на входы сумматоров, где вычитаются от соответствующих входных сигналов, . Значение целевой функции зависящей от вектора выходных координат измеряется на выходе объекта управления с соответствующим датчиком когда целевая функция характеризуется физической величиной, которая поддается измерению или вычисляется с помощью соответствующего устройства или программного обеспечения когда целевая функция не является физической величиной, которую можно непосредственно измерить. В результате измерения или вычисления получаются значения которые с определенной точностью воспроизводят реальные значения целевой функции Для того чтобы оценить отклонения измеренных значений целевой функции от эталонных используется эталонная модель объекта управления и регулятор значения целевой функции. Эталонная регрессионная модель объекта управления, выполненная с помощью SVR, принимает на вход вектор расчетных или экспериментально полученных значений входов объекта управления и соответствующие исходные значения регрессионная связь между которыми устанавливается путем выполнения SVR-анализа. Эталонная целевая функция может формироваться на подготовительном этапе перед началом функционирования электромеханической системы в соответствии с технологическими требованиями или изменяться в процессе работы, что требует некоторого времени на переобучение алгоритма SVR. Регулятор целевой функции принимает на свой вход измеренную или вычисленную целевую функцию все сигналы обратных связей с датчиков локальных электроприводов, эталонную целевую функцию и выполняет вычисления отклонений, поступающих в соответствующие программы для задания входных сигналов и настройки дискретных эквалайзеров. Проиллюстрируем возможности MatLab SVM Toolbox по формированию регрессионных зависимостей на примере отработки некоторой эллиптической траектории в относительных единицах двухкоординатным приводом, считая, что нужная траектория была получена эмпирическим путем с некоторой погрешностью по обеим управляемым координатам. Выбор эллиптической траектории обусловлен особенностями функционирования многомерных автоматизированных электромеханических систем, взаимосвязь между управляемыми координатами которых чаще всего описывается в виде непрерывных многомерных функций. Тем не менее существуют современные модификации алгоритма SVR, позволяющие работать с разрывными и кусочно-монотонными функциями, например, разработанный в 2010 г. метод многофазной регрессии на опорных векторах mp-SVR 13. Пусть при изменении параметра олицетворяет время были получены следующие эмпирические значения 0 0,98, 4 0,72, 2 0,03, 3 4 0,69, 0,98, 3 2 0,07, 2 1,04 и 0 0,05, 4 0,37, 2 0,53, 3 4 0,36, 0,05, 3 2 0,51, 2 0,02. Ограничения, действующие на управляемые координаты, учитываются с помощью регулятора значений целевой функции см. рис. 3, а регрессионная траектория строится в области допустимых значений координат. Эллиптическая траектория с эмпирическими значениями опорных точек показана на рис. 4. Результаты регрессионного анализа в MatLab SVM Toolbox методом опорных векторов с использованием гауссовой радиально-базисной ядерной функции Gaussian RBF представлены на рис. 5, . Выбранные настройки 1 стандартное значение для Gaussian RBF погрешность для задания функции потерь 0,05. Выбранная эллиптическая траектория построена совместно с результатами, полученными после применения SVR-анализа к эмпирическим точкам рис. 6. Для получения результатов регрессионного анализа, показанных на рис. 5 и 6, использовались следующие операторы MatLab и MatLab SVM Toolbox uiregress предоставляет графический интерфейс для выполнения SVR-анализа в среде MatLab svrplot строит линию регрессии для решения двухмерных регрессионных задач plot предоставляет возможности для построения траекторий в координатах, . Положительной стороной SVR-анализа является однозначная сходимость регрессионного алгоритма, а получаемая ошибка зависит как от точности экспериментальных данных, так и от ширины размаха ядерной функции 1. Уменьшение следует выполнять при повышении точности экспериментов. Траектория, полученная по результатам SVRанализа см. рис. 6, воспроизводит исходную эллиптическую траекторию с некоторой погрешностью наблюдается сдвиг вверх и вправо. Выполним повторное обучение алгоритма на более точных экспериментальных данных рис. 7. Результаты уточненного регрессионного анализа в MatLab SVM Toolbox методом опорных векторов с использованием Gaussian RBF показаны на рис. 8, . Выбранные настройки 1 стандартное значение для Gaussian RBF погрешность для задания функции потерь 0,01. Выбранная эллиптическая траектория построена совместно с результатами, полученными после применения SVR-анализа к уточненным эмпирическим точкам рис. 9. Сравнив результаты SVR-анализа, представленные на рис. 6 и 9, можно сделать вывод, что увеличение точности экспериментальных данных и переобучение алгоритма на уточненных значениях при уменьшении зоны нечувствительности функции потерь в 5 раз от 0,05 до 0,01 приводит к уменьшению отклонения регрессионной траектории от исходной эллиптической. Зависимости абсолютных значений ошибок от времени, построенные по результаПроанализировав эти рисунки, можно заключить, что максимальные значения ошибок по результатам SVR-анализа составят 0,14, 0,15 см. рис. 10, . После уточнения экспериментальных данных соответствующие ошибки составят значения 0,0303, 0,0303 см. рис. 10, . Таким образом, после переобучения алгоритма для выполнения SVR-анализа по координате погрешность сократилась в 4,62 раза, а по в 4,95 раза. Следовательно, повышение точности экспериментальных данных и сокращение зоны нечувствительности функции потерь способствует уменьшению ошибки регрессионного анализа после выполнения соответствующего переобучения алгоритма SVR. В тех случаях, когда необходимо использовать регрессионную связь между управляемыми координатами во взаимосвязанных электромеханических системах, значительные перспективы имеет применение SVR-анализа, обладающего следующими преимуществами перед другими методами параметры регрессионной модели определяются с помощью решения задачи квадратичного программирования, имеющей только одно решение можно задавать доверительную зону вокруг основной линии регрессии, оказываясь в которой ошибка соотношения между управляемыми координатами считается допустимой эталонная целевая функция, которая формируется в результате SVR-анализа, может быть легко изменена путем выполнения переобучения алгоритма SVR и не требует подбора специальных регрессионных зависимостей, поскольку весь необходимый функционал уже заложен в ядерной функции в случае нелинейной регрессии лучшие результаты дает ядерная функция Gaussian RBF. там SVR-анализа, и абсолютные значения ошибок после переобучения на уточненных экспериментальных данных, которые использовались для построения линии регрессии, показаны на рис. 10, и соответственно. 