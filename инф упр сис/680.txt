БАЗОВЫЕ МЕТОДЫ И ПРИНЦИПЫ ПОСТРОЕНИЯ  АЛГОРИТМОВ ВОССТАНОВЛЕНИЯ РЕГИОНОВ ИЗОБРАЖЕНИЙ 

в ряде случаев обработка (маскирование) визуальных искажений, возникающих вследствие потерь пакетов данных в сетях с негарантированной доставкой, осуществляется на приемной стороне. Данная задача решается с помощью алгоритмов восстановления изображений. классификация методов и принципов восстановления изображений, выделение достоинств и недостатков существующих подходов, а также актуальных проблем и способов их решения. Результаты: рассмотренные подходы и принципы, положенные в основу работы алгоритмов восстановления регионов изображений, разделены на следующие классы: структурные, текстурные и основанные на разреженном представлении данных. Представлены способы борьбы с высокой вычислительной сложностью рассмотренных методов с применением подоптимальных процедур. Отображена связь между текстурными методами восстановления и методами, основанными на разреженном представлении данных. Приведен анализ качества восстановления различных типов регионов на изображениях. Практическая значимость: на базе рассмотренных подходов возможна разработка приложений, критичных к повторной передаче данных по сетям с негарантированной доставкой.

В настоящее время большое внимание уделяется разработке эффективных методов передачи визуальных данных по сетям связи. Возникновение ошибок или перегрузок при передаче данных по сети приводит к ухудшению качества обрабатываемого изображения. Среди наиболее частых причин потерь пакетов в сети можно выделить перегрузки промежуточных узлов передачи данных получение пакета после требуемого момента его обработки на декодере актуально для приложений, работающих в режиме реального времени. Среди существующих методов борьбы с потерями пакетов, возникающими при передаче данных по сети, можно выделить две основные повышение устойчивости передаваемого сигнала к внешним воздействиям error resilience реконструкцию маскирование в целях максимизации степени похожести с оригинальным сигналом error concealment. При использовании первого подхода наиболее широко распространенным способом борьбы с ошибками является применение помехоустойчивого кодирования. Если возникшие ошибки не удается полностью исправить, то используется ретрансляция данных, т. е. повторное отправление источником данных, не дошедших до приемника. При этом необходимым условием является существование обратной связи между передатчиком кодером и получателем декодером данных. Однако такой подход не всегда практически осуществим, особенно в системах, которые критичны к повторным передачам, ввиду увеличения задержки получения данных. Кроме того, в некоторых случаях обратной связи не существует, или по ряду причин воспользоваться ею не представляется возможным. В связи с этим актуальной задачей является обработка вызванных такими потерями искажений только на приемной стороне, т. е. так называемая процедура маскирования искажений. Исследованию методов и принципов восстановления изображений и посвящена данная работа. В основу рассмотренной классификации положены определяющие принципы построения алгоритмов восстановления регионов изображений, изложенные в базовых работах 14. Дальнейшие публикации 57 подтверждают актуальность изложенных принципов. Рассмотрим задачу восстановления регионов изображений на стороне приемника на примере типовой системы передачи данных. На основе блоковой обработки изображения осуществляется формирование сжатого битового потока, который впоследствии разбивается на пакеты в целях дальнейшей передачи по сети. Будем считать, что в процессе передачи произошло некоторое событие, в результате которого часть пакетов не была получена приемником, из-за чего он не смог восстановить на изображении некоторые области. Назовем подобные области искаженными регионами. Обозначим множество пикселей в искаженных регионах через, а множество корректно полученных пикселей через Процесс восстановления значений интенсивностей пикселей из при известных значениях пикселей из будем называть маскированием искажений. Обозначим пиксель изображения, находящийся на пересечении -й строки и -го столбца, как, а квадратную область размером блок на изображении, центральный пиксель которого имеет координату, как, . Введем ряд допущений применительно к рассматриваемой системе обработки и передачи данных рис. 1 1 приемник всегда может определить факт потери пакета 2 блоки на стороне передатчика кодируются независимо 3 в каждом пакете передается информация только об одном блоке 4 искаженные блоки не могут находиться на краях изображения. Будем считать, что потеря пакета приводит к появлению черного квадрата по координатам, соответствующим координатам потерянного блока. Следует отметить, что приведенные допущения не отражают реальную природу визуальных искажений в восстановленном на приемнике изображении, так как, как правило, блоки кодируются зависимо, и потеря пакета на практике может привести к искажению нескольких блоков в любой позиции изображения. Однако приведенные выше допущения вполне достаточны для рассмотрения базовых принципов и методов восстановления искаженных регионов на изображениях, что и является основной целью данной работы. Рассмотрим базовые принципы восстановления изображений 1. 1. Данные, применяемые для маскирования, должны определяться всем изображением в целом. Восстановление данных внутри искаженного региона должно производиться данными, являющимися естественным продолжением информации, содержащейся в доступном регионе 2. Структура синтезированных для восстановления данных должна отражать структуру неискаженных данных. Как правило, это достигается путем интерполяции контуров объектов, обнаруженных на границе Обозначим через подмножество пикселей из смежных с пикселями из, а через подмножество пикселей из, смежных с пикселями из При этом конкретный состав этих подмножеств зависит от используемого алгоритма восстановления. 3. Цветовая составляющая восстановленного региона должна определяться анализом интенсивностей пикселей, окружающих искаженный регион . 4. Восстановленные данные должны учитывать локальные особенности обрабатываемого изображения, например текстуру объектов. В зависимости от того, как указанные принципы учитываются при восстановлении искаженных регионов, каждый класс применяет свой метод восстановления структурный, шаблонный или гибридный. Методы восстановления изображений, рассматриваемые далее, на рис. 2 выделены серым цветом. Использование структурных методов для восстановления регионов изображений подразумевает применение процедуры, которая опирается на некоторую априорную информацию о структуре данных в искаженном блоке. Как правило, для определения априорной информации выполняется анализ блоков, смежных с искаженным. В результате искаженные блоки относят к одному из двух типов блоки гладкого типа блоки, содержащие контуры объектов. Данная классификация блоков по типам обусловлена тем, что визуальное восприятие человека крайне чувствительно к контурам объектов 8. Поэтому одной из важных задач любого алгоритма восстановления визуальных данных является как точное восстановление нарушенных контуров, так и минимизация вероятности формирования ложных контуров, отсутствующих на исходном изображении. Кроме того, восстановление границ объектов в расплывчатом или неявном виде также крайне негативно сказывается на восприятии визуальных данных в целом. Структурные методы восстановления можно разделить на два подкласса 1 на основе взвешенного усреднения значений пикселей weighted averaging 2 на основе направленного восстановления контуров directional interpolation. Первые, как правило, применяются для восстановления блоков гладкого типа. Например, в работе 9 предлагается производить восстановление искаженных пикселей путем взвешенного усреднения значений пикселей на границе Значения весовых коэффициентов обратно пропорциональны расстоянию между интерполируемым пикселем, из искаженного блока, и пикселями, значения интенсивности которых известны где, и расстояния между интерполируемым пикселем и ближайшими пикселями на границе известных соседних блоков 1, 1, и, значения ближайших пикселей, расположенных на границе потерянного блока по четырем направлениям размер потерянного блока. В большинстве методов, где применяется восстановление блоков, содержащих контуры, можно выделить три основных этапа 1 оценка направления контуров в искаженном блоке за счет анализа пикселей из неискаженных блоков 2 восстановление контуров на основе информации, содержащейся в соседних блоках данных региона 3 восстановление оставшихся пикселей изображения, а также постобработка всего восстановленного региона целиком. В работах 10, 11 предлагается восстанавливать контуры, содержащие разрывы, используя билинейную интерполяцию, опирающуюся на данные об уже обнаруженных контурах в соседних блоках. Алгоритм предполагает разбиение потерянного блока, на несколько регионов в зависимости от произведенной оценки направления контура, при этом предлагается проводить такое разбиение, которое учитывает как направление доминирующего контура, так и направления возможных менее ярко выраженных контуров. Таким образом, алгоритмы на базе взвешенного усреднения способны хорошо восстанавливать гладкие области на изображении, а методы на базе направленного восстановления контуров области, содержащие контуры. Основная идея работы алгоритмов этого класса основана на предположении о наличии повторяющихся фрагментов данных на изображении, которые в дальнейшем будем называть шаблонами. Восстановление целевого региона производится по частям путем копирования значений пикселей из наиболее похожего шаблона. Как правило, в методах этого класса можно выделить два основных этапа. На первом осуществляется расстановка приоритетов для пикселей, из . Затем вокруг пикселя с наибольшим приоритетом строится блок, На втором проводится поиск наиболее похожего блока, из доступного набора данных на основе выбранного критерия схожести, например, суммы абсолютных разностей или суммы квадратов разностей 12 вычисляемой только для пикселей из . Восстановление пикселей из, выполняется путем копирования значений пикселей из найденного блока, на соответствующих позициях. Описанная процедура итеративно повторяется до тех пор, пока целевая область не будет восстановлена полностью. Глобальный алгоритм поиска, основанный на принципе наибольшей окрестной схожести best neighborhood matching, был впервые предложен в работе 2. Поскольку рассмотренные далее в данном разделе алгоритмы являются его модификациями, то приведем шаги этого алгоритма подробнее. 1. Инициализация искаженной целевой области . 2. Расстановка приоритетов восстановления пикселей из целевой области . В начале каждой новой итерации алгоритма производится расчет порядка заполнения целевых пикселей с помощью применения заданной функции расстановки приоритетов, . 3. Поиск шаблона и интерполяция. Поврежденный блок данных извлекается вместе с окружающими его известными пикселями из Предлагается использовать глобальный поиск для анализа всех блоков-кандидатов из 4. Обновление списка целевых пикселей, а также прочей информации, требуемой для выставления приоритетов целевым пикселям. Недостатком алгоритма 2 является использование глобального поиска, имеющего высокую вычислительную сложность. В связи с этим в работе 13 рассмотрены ключевые параметры, используемые в подоптимальном поиске процедура поиска и порядок восстановления пикселей, которые влияют как на качество восстановления, так и на скорость работы алгоритма. В работах 1416 рассмотрено применение подоптимальных алгоритмов для ускорения работы. В работах 14, 15 предложена модификация методики поиска на основе применения идеи градиентного спуска. Обозначим квадратный регион на изображении, центральным элементом которого является пиксель, как окно поиска, . В работе 15 выбор области поиска уменьшается путем установки шага сдвига окна поиска, в значение, превышающее один пиксель. В работе 14 предложено осуществлять выбор на основе анализа соседних регионов, используя спиралевидную траекторию поиска. В работе 16 предложено производить поиск в компонентах, полученных в результате вейвлет-преобразования. Поскольку вопрос расстановки приоритетов для пикселей является специфическим для задачи восстановления регионов изображений, то рассмотрим его подробнее. Искаженный регион изображения может содержать как текстурную, так и структурную информацию. В статье 3 было показано, что для достижения высокого качества восстановления алгоритм должен уметь находить и разделять эти составляющие в целях приоритетного восстановления именно структурной части потерянных данных. В результате проведенных исследований авторы предложили подход, восстанавливающий в первую очередь данные, характеризующие именно структуру потерянного региона . Для каждого пикселя, на границе выставляется приоритет восстановления путем анализа блока, центральным элементом которого является пиксель, . Функция расстановки приоритетов определена следующим образом, . Первый сомножитель доверительный confidence term, задает степень уверенности в восстановленных данных путем анализа соотношения количества известных пикселей к количеству неизвестных в рассматриваемом блоке. Второй сомножитель информационный data term, отражает количество структурных данных, содержащихся в обрабатываемом блоке. Значение информационного сомножителя зависит от изофоты силы контура, пересекающей границу неизвестного региона . Благодаря описанной функции расстановки приоритетов в первую очередь осуществляется интерполяция пикселей на границах объектов, а только затем в однородных блоках данных. Согласно исследованиям 17, описанный алгоритм обладает одним существенным недостатком. В процессе заполнения целевых пикселей региона степень уверенности в интерполируемых данных неуклонно падает. Это выражается в том, что значение доверительного сомножителя, в функции расстановки приоритетов, с ростом количества итераций стремится к нулю, способность же роста значения информационного сомножителя, сильно ограничена. Эти факторы могут привести к неправильному порядку восстановления целевых пикселей региона, поскольку в этом случае результат, выдаваемый функцией, перестает зависеть от входных данных. Для устранения этого недостатка в работе 18 была предложена модифицированная функция расстановки приоритетов, в которой умножение было заменено сложением, что позволило сделать ее более устойчивой к шумовым воздействиям. Авторами также модифицирована функция расчета уверенности путем оценивания степени размытости кривой, 1, . В итоге функция выставления приоритетов определена следующим образом, 1, где 0 1 весовой коэффициент. Шаблонные методы восстановления способны показывать хорошие результаты при обработке текстурных областей на изображении, поскольку те содержат множество повторяющихся фрагментов. Однако они не предоставляют наилучшего способа обработки регионов, содержащих большое количество контуров объектов, которые лучше восстанавливаются структурными методами. В связи с этим ряд исследований посвящен разработке алгоритмов, позволяющих производить эффективное восстановление как текстурных, так и структурных регионов изображения. Такие алгоритмы формируют класс гибридных методов восстановления. Одно из наиболее перспективных направлений в этом классе основывается на использовании разреженного кодирования для восстановления регионов изображений. В связи с этим в данной статье центральное внимание будет уделено гибридным методам восстановления, основанным на разреженном представлении данных. Главная идея разреженного кодирования заключается в представлении исходного сигнала размерности другим сигналом размерности, где . Представление сигнала при этом должно содержать малое количество ненулевых коэффициентов. Разреженное представление сигнала можно получить с помощью разложения исходного сигнала по расширенному базису, который принято называть словарем. Словарь содержит все базисные векторы, а также некоторое число их линейных комбинаций, т. е. число векторов, содержащихся в нем, превышает размерность исходного сигнала. Именно благодаря такому расширенному базису можно получать разреженное представление сигнала. Обозначим одномерное представление как правило, в виде вектора-столбца конкретного блока c центральным пикселем, изображения как, Далее будем называть, патчем Таким образом, соотношение между патчем, и блоком, можно выразить следующим равенством где функция обхода блока в сканирующем порядке. Существует два основных подхода, которые применяют методы разреженного кодирования данных для построения алгоритмов восстановления изображений cинтез потерянного региона на основе анализа линейных зависимостей, обнаруженных на изображении 19 использование словарей для восстановления патчей изображения словарный метод 4. Авторы работы 19 предлагают использовать принцип, который основан на предположении о том, что потерянный патч может быть представлен линейной комбинацией нескольких других патчей, сформированных из Для того чтобы определить, содержит ли восстанавливаемый патч текстурную или структурную информацию, было предложено анализировать количество соседних патчей, необходимых для его аппроксимации. При этом было установлено, что структурные патчи имеют более разреженную степень представления требуют меньшее количество патчей-кандидатов для точного представления по сравнению с текстурными патчами. Предлагается 19 в первую очередь восстанавливать структурные патчи. По аналогии с шаблонными методами восстановления алгоритм состоит из двух основных шагов рис. 3 1 расстановка приоритетов восстановления для патчей 2 восстановление искаженных патчей. Рассмотрим процедуру расчета приоритета для произвольного патча, . Для этого определим множество патчей-кандидатов, где некоторая заранее определенная константа радиус. Таким образом, множество, содержит патчи из неискаженной области отстоящие не более чем на пикселей по горизонтали и вертикали от координаты, . Функция расстановки приоритетов выглядит следующим образом где функция приведения числовых данных в требуемый диапазон, 1 L2-норма вектора содержит весовые коэффициенты, характеризующие степень похожести между исходным патчем, и патчами-кандидатами, мощность множества размер патча, функция выставления уверенности по аналогии с шаблонными методами восстановления. Восстановление искаженного патча, достигается путем построения линейной комбинации из нескольких наиболее похожих патчей, найденных на изображении. Вопросы, связанные с влиянием количества патчей для аппроксимации, а также выбор способа расчета вектора детально рассмотрены в работе 19. Таким образом, высокое значение функции, указывает на то, что рассматриваемый патч является структурным, поскольку его представление сильно разрежено. Текстурные же патчи таким свойством не обладают, что приводит к низким значениям функции, . Перейдем к методам восстановления на основе использования функции для аппроксимации изображения. В качестве примера рассмотрим словарный метод 4, в котором разреженное кодирование применяется для выделения слоев на изображении, содержащих текстурные и структурные элементы. Основная идея данного подхода заключается в использовании двух заранее подготовленных словарей, один из которых позволяет получить разреженное представление текстурной информации, а другой структурной. Такой подход принято называть морфологическим анализом компонент morphological component analysis. В таком случае изображение рассматривается как поэлементная сумма двух составляющих морфологических слоев, где текстурная, а структурная составляющая. Для упрощения дальнейшего изложения будем полагать, что, и представлены в виде векторов в пространстве, где величина, равная произведению ширины исходного изображения на его длину. Поскольку в ходе работы алгоритма морфологические компоненты представляются в разреженном виде, то окончательное изображение строится по следующему принципу где словарь, позволяющий получить разреженное представление текстурного слоя и структурной компоненты изображения соответственно. Поиск оптимальных коэффициентов, предлагается осуществлять путем решения следующей оптимизационной задачи где и принадлежат пространству вектор, содержащий единицы на позициях с доступными пикселями, а нули на позициях с искаженными, принадлежит пространству и весовые коэффициенты дополнительные ограничения, способствующие кусочно-гладкому восстановлению структурного слоя 20. Решение данной оптимизационной задачи можно находить, используя метод преследования базисов basis pursuit 21. Хотелось бы отметить, что методы, основанные на разреженном представлении данных, во многом схожи с шаблонными методами по принципу обработки отдельных блоков, взятых с изображения. Однако алгоритмы, применяющие шаблонные методы восстановления, в процессе своей работы не создают новых шаблонов, а используют только уже существующие. Алгоритмы восстановления регионов изображений, основанные на разреженном представлении данных, за счет комбинирования базисных векторов словаря способны создавать новые шаблоны. В связи с этим, как будет показано ниже, в ряде случаев они способны показывать более хорошие результаты при восстановлении искаженных регионов. Результат анализа эффективности восстановления различных типов регионов на изображениях с помощью рассмотренных в данной работе методов представлен в таблице. Примеры типов рассматриваемых регионов изображений приведены на рис. 4. В таблице приняты следующие условные обозначения в абсолютном большинстве случаев восстановленное изображение не содержит серьезных визуальных искажений в большинстве случаев восстановленное изображение не содержит серьезных визуальных искажений в некоторых случаях восстановленное изображение не содержит серьезных визуальных искажений в абсолютном большинстве случаев восстановленное изображение может содержать заметные визуальные искажения. Алгоритмы восстановления, основанные на взвешенном усреднении, способны качественно восстанавливать области изображений, не содержащие каких-либо особенностей. К таким регионам можно отнести гладкие области, а также области, содержащие градиенты. В отличие от них методы направленного восстановления контуров способны качественно восстанавливать и регионы, содержащие внутри себя незначительные вариации. Таким образом, помимо вышеперечисленных регионов они способны корректно обрабатывать и области, содержащие изофоты, и регулярные текстуры, если те в свою очередь состоят из изофот. Алгоритмы, основанные на применении глобального или локального поиска, осуществляют восстановление путем использования готовых шаблонов данных на изображении. Принцип их работы не предусматривает модификацию или изменение таких шаблонов. Таким образом, они способны корректно восстанавливать потерянные регионы, содержащие информацию, которая обладает значительной корреляцией с той, что содержится в доступной области Алгоритмы на основе разреженного представления данных для восстановления используют свойство словарей запоминать повторяющиеся особенности данных на изображении. При этом такие алгоритмы способны генерировать блоки данных, содержащие информацию, отсутствующую в явном виде в доступной области Таким образом, самыми сложными регионами для восстановления будут те, что содержат нерегулярную текстуру. В работе выделены и проанализированы классы алгоритмов восстановления изображений, которые основаны на структурных и шаблонных методах, а также на разреженном кодировании данных. Проведен анализ эффективности восстановления различных типов регионов на изображениях с помощью рассмотренных алгоритмов, в результате которого определены достоинства и недостатки рассмотренных подходов. Рассмотренные методы восстановления изображений исключительно на стороне получателя данных могут быть применены в задаче маскирования искажений, возникающих в результате потерь пакетов в сети передачи данных. Анализ и разработка методов маскирования искажений визуальных данных является актуальной задачей для различных прикладных областей и требует дальнейших исследований. Работа выполнена при финансовой поддержке Минобрнауки в рамках базовой части государственного задания вузу на 2015 год проект 2452. 