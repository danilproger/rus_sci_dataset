ПРЕДВАРИТЕЛЬНАЯ  КЛАССИФИКАЦИЯ  ИЗОБРАЖЕНИЯ В  ЗАДАЧАХ  СЕГМЕНТАЦИИ  ОБЪЕКТОВ 

Рассматривается алгоритм предварительной классификации изображения с целью выделения областей, содержащих с высокой вероятностью объекты интереса. Классификация областей изображения выполняется по уровню высокочастотной энергии. Приведены результаты сравнительного анализа различных способов, подчеркивающих высокочастотные составляющие изображения, и выбран способ, обеспечивающий наиболее высокий уровень качества классификации. Подробно рассмотрена процедура пороговой обработки. A method of preliminary image classification is considered. The aim of the analysis is to distinguish the areas containing, with high probability, the objects of interest. Image classification is carried out according to the level of high-frequency energy. The results of the comparative analysis for various methods emphasizing the high-frequency image components are given and the method providing the highest quality of classification is chosen. A threshold processing procedure is considered in detail.

Реализовать автоматический захват и сопровождение нескольких объектов, разрешить ситуацию окклюзии перекрытия объекта интереса фоном или другим объектом, сегментировать неподвижные объекты, а также исключить потерю объекта при его остановке позволяет метод сегментации по совокупности признаков 1. Основными процедурами метода являются предварительная классификация изображения с целью выделения областей, в которых с высокой вероятностью возможно присутствие объектов интереса сегментация объектов по признакам временной и пространственной корреляции 2, 3 сопровождение объектов путем определения вероятности принадлежности фрагмента изображения объекту на основе математического аппарата теории нечетких множеств. Метод разработан для сегментации и сопровождения объектов размером в пересчете к плоскости кадра от 4 4 до 100 100 пикселей, обладающих жестким движением со скоростью от 0 до 20 пикселей за кадр. Жестким non-rigid движением называется движение, при котором все части объекта движутся в соответствии с основным направлением движения. Наиболее часто объектами с такими характеристиками являются объекты искусственного происхождения автомобили и другие транспортные средства, летательные аппараты, морские цели. Существенной задачей при сегментации объектов по совокупности признаков является предварительная классификация изображения. Ее цель выделение областей, в которых возможно присутствие объектов интереса. Именно эти области подвергаются дальнейшей обработке. Соответственно, предварительная классификация, не потеряв объект интереса или какую-либо его часть, должна уменьшить объем обрабатываемого далее материала. Проведение предварительного анализа на основе таких признаков как движение, форма или яркость не решает указанной выше задачи. Признак движения исключает из дальнейшего рассмотрения все неподвижные и медленно движущиеся маневрирующие объекты. Признак формы требует существенных априорных знаний об объектах интереса и, соответственно, неприемлем для первоначальной классификации. При работе по яркостному признаку на объект накладывается требование однородной яркости, что достаточно часто нарушается в реальных условиях видеонаблюдения для протяженных объектов интереса. Отличительной особенностью областей изображения, включающих описанные выше объекты интереса, является большое количество перепадов яркости детальность на границах объектфон, на внутренних контурах объекта и др. Для оценки этого признака введем понятие уровня детальности где перепад яркости в пикселе координаты левого верхнего угла фрагмента блока изображения число пикселей по вертикали и горизонтали во фрагменте. Поверхности, описывающие изменения уровней детальности по плоскости кадра, показаны на рис. 1. Области, которые должны быть оставлены для дальнейшей обработки, характеризуются высоким уровнем детальности. Этот признак и положен в основу предварительной классификации. Для ее реализации предложен следующий алгоритм обработка изображения с целью усиления перепадов яркости разбиение изображения на фрагменты заданного размера блоки 8 8 и определение числа перепадов яркости в каждом фрагменте пороговая обработка. Первый шаг может быть реализован большим количеством способов методами линейного и нелинейного контрастирования, морфологической обработкой, вейвлет-преобразованием. При этом способ обработки непосредственно определяет качество предварительной классификации. Для оценки эффективности различных способов обработки в рамках решаемой задачи был проведен их сравнительный анализ. Из каждой группы выбран метод, максимально учитывающий особенности видеоматериала существенная часть используемых для тестирования изображений имеет фон с выраженными горизонтальными структурами береговая линия, линия горизонта, поэтому подчеркивание перепадов яркости по вертикали заведомо приведет к включению больших фрагментов фона в области для дальнейшей сегментации. Таким образом, рассматривались следующие методы. Линейная обработка пространственное дифференцирование в горизонтальном направлении где яркость пикселя в кадре координаты пикселя приращение координаты для блока 8 8 равна 5 Нелинейная обработка выделение контуров с помощью оператора Превитта 4 Морфологическая обработка многомасштабный градиент 5 где исходное изображение и морфологические операции наращивания и эрозии 3 квадратная группа структурных элементов. Размер равен 2 12 1 пикселей для 0 3. В соответствии с этим выражением значения градиентов рассчитывают трижды с использованием структурных элементов различной размерности, а затем результаты складывают. Вейвлет-преобразование вейвлет Добеши Д4 6, 7. Для анализа используются коэффициенты вейвлет-разложения матрицы, полученные операцией свертки с коэффициентами фильтра высоких частот. Коэффициенты фильтра для вейвлет Добеши Д4 Для оценки эффективности различных способов обработки сформулированы следующие критерии. первый и наиболее важный критерий. Области изображения, исключенные на этапе предварительной классификации, далее вообще не рассматриваются, поэтому присутствие в них объекта интереса или его части грубая ошибка. Значительно безопаснее включение в дальнейшую обработку фрагментов изображения, не содержащих объекты интереса, так как эти области будут отсегментированы в ходе дальнейшего анализа. Для оценки критерия предлагается использовать отношение площадей где площадь объекта, сегментированного одним из методов истинная площадь объекта на изображении. Соответственно, чем ближе коэффициент к единице, тем эффективнее применяемый метод обработки. Этот критерий показывает, какова площадь изображения, выделенного для дальнейшего анализа, но не содержащая объектов интереса. Его оценка где площадь фона в выделенных для дальнейшего анализа областях изображения площадь всего изображения. Соответственно, чем ближе коэффициент к единице, тем эффективнее применяемый метод обработки. критерий уровня полезной информации в данных, оставленных для дальнейшего анализа в результате классификации критерий устойчивости значений коэффициентов и для различных изображений разная степень присутствия фона, различный диапазон перепадов яркости и др.. Для проведения экспериментов были выбраны четыре тестовые последовательности. Их основные характеристики сведены в табл. 1. С помощью специально разработанного программного обеспечения были получены значения коэффициентов, для 100 кадров каждой тестовой последовательности. В полученных выборках были определены средние значения коэффициентов, . Полученные результаты представлены на рис. 2. По этим данным была проведена ранговая оценка методов табл. 2. Соответствие рангов и численных значений критериев, очевидно, ранжирование методов по критерию было выполнено следующим образом. Наиболее устойчивым является метод пространственного дифференцирования. Это единственный метод, успешно справившийся со всеми тестовыми последовательностями, включая последовательность Туман. Критерий степень выделения фона у него на всех последовательностях колеблется около 0,985. Все другие методы на последовательности Туман имеют значение критерия в 34 раза больше, что приводит к неудовлетворительному результату существенному выделению фона. Наибольшей чувствительностью к характеру изображения обладает вейвлет-фильтр Добеши. Для последовательностей Корабль и Катер его характеристики близки к характеристикам остальных методов, а для последовательности Самолеты и Туман результат классификации практически отсутствует, что отражает и значения коэффициентов, . Соответственно, по критерию ранги распределились следующим образом 1 пространственное дифференцирование, 2 морфологический градиент, 3 оператор Превитта, 4 вейвлет-фильтр Добеши. Таким образом, по сумме оценок наиболее эффективным способом обработки является пространственное дифференцирование. Результаты предварительной классификации на его основе представлены на рис. 3. Следует отметить, что по значениям критериев, обработка с помощью пространственного дифференцирования близка к обработке на основе морфологического градиента исключая последовательность Туман. Соответственно, при достаточных соотношениях контраста этот подход также обеспечивает весьма эффективное подчеркивание высокочастотной составляющей при предварительной классификации. Последним шагом алгоритма предварительной классификации является пороговая обработка на основании полученной оценки детальности блок должен быть оставлен или исключен из дальнейшего анализа. Процедура формирования порога базируется на двух основных положениях. 1. Совокупность оценок детальности, полученных для всех блоков кадра, является выборкой случайной величины. Анализ и исследование ее гистограмм позволяет утверждать, что это случайная величина, описываемая распределением Релея Гистограммы распределения оценок детальности, полученные в ходе исследования, и теоретический вид функции распределения Релея при 3 показаны на рис. 4. 2. Задача предварительной обработки изображения является задачей бинарной классификации, что позволяет использовать критерий НейманаПирсона. Первый класс D блоки изображения с высокой вероятностью, содержащие объекты интереса. Второй класс D блоки, не подлежащие дальнейшей обработке. Ошибкой первого рода в данном контексте является отнесение блока изображения, содержащего объект интереса, к классу D, ошибкой второго рода отнесение к классу D блока, не подлежащего дальнейшей обработке. Суть стратегии НейманаПирсона состоит в следующем задают допустимое значение вероятности ошибки первого рода, а затем классификатор строят таким образом, чтобы обеспечить минимум вероятности ошибки второго рода Решением является классификатор вида значение пороговой величины определяется, исходя из условия и функции правдоподобия классов D и D 4. Соответственно, в нашем случае пороговое значение где оценка . Из теории известно, что максимальная плотность при распределении Релея достигается при . Эта особенность позволяет предложить быстрый и удобный для практической реализации способ оценки параметра по экспериментальной гистограмме где min минимальное значение оценки детальности nummax номер интервала гистограммы с максимальной частотой попадания случайной величины int величина интервала. Предложенный алгоритм предварительной классификации позволяет выделить области изображения с заданной вероятностью, содержащие объекты интереса. Как показали экспериментальные исследования, это дает возможность исключить из последующей обработки до 80 кадра, тем самым резко снизить вычислительную и алгоритмическую сложность последующих процедур. Значимым достоинством предлагаемого алгоритма является отсутствие существенных ограничений на скорость, линейные размеры и яркостные характеристики объектов интереса. 