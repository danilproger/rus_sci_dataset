МОДЕЛИРОВАНИЕ  СИСТЕМ  И  ПРОЦЕССОВ ПОСТРОЕНИЕ  ОПТИМАЛЬНЫХ  ТРАЕКТОРИЙ В  МНОГОМЕРНЫХ  ПРОСТРАНСТВАХ НА  ОСНОВЕ  ФИЗИЧЕСКИХ  МОДЕЛЕЙ 

Получено одинаковое выражение для радиуса малой дуги оптимальной траектории в двух физических моделях — движения точки с единичной скоростью и распространения луча света. Принцип минимального времени распространения света в трехмерном физическом пространстве обобщается и на многомерное пространство и используется для разработки соответствующего численного метода пристрелки при построении оптимальных многомерных траекторий. Оптимальность траекторий, найденных методом пристрелки, подтверждена формальным, но строгим математическим градиентным методом. We derive an expression for the radius of a small arc of the optimal trajectory in two physical models: the motion of a point with unit velocity and the propagation of a light ray. The principle of minimal propagation time in three-dimensional physical space is generalised to high-dimensional space and is used for the elaboration of the corresponding digital method of fire adjustment in contstructing the optimal high-dimensional trajectories. The optimality of the obtained trajectories is justified by a formal mathematical gradient method.

Пусть заданы некоторая положительная функция потерь или затрат от переменных а также начальная и конечная точки и соответственно. Оптимальной траекторией является линия, соединяющая эти две точки, такая, что криволинейный интеграл вдоль этой линии от заданной функции минимален 1 В статье описывается метод поиска оптимальной траектории, разработанный на основе использования физических моделей. Аналогичный подход использовался и в работе 1 для оптимизации по времени двумерных задач. В монографии 2 отмечается, что физический подход к решению некоторых геометрических задач использовался выдающимися учеными прошлых столетий. Авторами этот подход развивается и производится обобщение понятия центра тяжести твердого тела и на многомерные пространства. Обобщение физических моделей и аналогий на многомерные пространства зачастую позволяет эффективно и наглядно решать задачи, решение которых чисто математическими методами затруднительно и неочевидно. Так, например, в методе наискорейшего спуска для поиска экстремума овражных функций составляются дифференциальные уравнения безынерционного движения материальной точки в многомерном пространстве 3. Известны многомерные сферические координаты 4, 5. Эти координаты задаются углами, которые являются обобщенными физическими аналогами углов широты и долготы. В статье развивается ранее означенный и нами подход 6 с обобщением физических аналогий на многомерные пространства для поставленной оптимизационной задачи. Допустим, что координаты некоторой текущей точки в многомерном пространстве являются функциями времени. Тогда малый вектор перемещения ложим начало и конец малой дуги траектории лежащими на касательной оси 0 в фиксированных, равноотстоящих от нуля точках с координатами, соответственно 7 Тогда отрезок прямой, соединяющий по оси 0 эти точки с координатами 7, является хордой дуги. Так как любое малое перемещение с точностью до 2-го порядка малости раскладывается по двум ортогональным базисным векторам и, малую дугу траектории можно считать плоской, т. е. лежащей в плоскости рисунка 0 . Радиус кривизны траектории и модуль нормального ускорения связаны общеизвестным соотношением, которое при единичной скорости записывается так 8 При этом векторы скорости и ускорения в проекциях на координатные оси 9 10 откуда уравнения траектории относительно середины дуги с точностью до 2-го порядка малости при равны 11 где высота параболического сегмента дуги 12 Вместо функции от переменных рассмотрим соответствующее ей сечение в плоскости 0 . При фиксированных концах 7 элементарная дуга окружности полностью определяется радиусом кривизны. Определим оптимальный радиус кривизны этой малой дуги такой, что криволинейный интеграл 13 зависящий от параметра, будет минимален, т.е. 14 С точностью до 2-го порядка малости 15 уравнение траектории в котором произведена замена переменной, 16 дифференциал длины дуги. этой точки при разложении в ряд Тейлора с точностью до 2-го порядка малости по времени записывается так 2 где 3 4 векторы первых и вторых производных координат по времени соответственно и где приняты обозначения и Вектор по своему физическому смыслу является вектором скорости, а вектор вектором ускорения в многомерном пространстве. Наложим ограничение, что модуль вектора скорости всегда имеет единичное значение 5 Дифференцируя 5 по времени, получаем, что скалярное произведение векторов скорости и ускорения тождественно равно нулю 6 Условие 6 означает ортогональность векторов скорости и ускорения, при этом можно положить, что и в многомерном пространстве при постоянной скорости движения полное ускорение является только нормальным, аналогично как и в трехмерном. Направим касательную ось 0 параллельно вектору скорости на середине дуги, а нормальную ось 0 по вектору ускорения рис. 1, распоС целью упрощения и удобства дальнейшей разработки метода и соответствующего алгоритма поиска оптимальной траектории зададим начальную точку от середины дуги, оставив конечную точку прежней 17 и перейдем к задаче определения оптимального радиуса кривизны, который минимизирует криволинейный интеграл, рассчитанный только для правой половинки дуги элементарной траектории 18 19 В этой новой задаче, как и прежде, зафиксирована конечная точка. Для новой начальной точки зафиксирована координата 0, а координата, рассчитываемая как 12, является варьируемой по радиусу кривизны. При этом векторы скорости и ускорения, записанные в проекциях на координатные оси как и имеют постоянные направления, независимые от радиуса кривизны. Для старой начальной точки направления векторов скорости и ускорения варьируются в зависимости от радиуса кривизны, что существенно усложняет задачу оптимизации. Этим и объясняется переход ко второй постановке задачи, решение которой, строго говоря, является квазиоптимальным, так как новая начальная точка не зафиксирована по координате . Разложим подынтегральную функцию в ряд Тейлора относительно нулевой точки с точностью до 2-го порядка малости 20 где численные значения функции и ее соответствующих частных производных берутся в нулевой точке в начале координат 0 0, 0. Положим, что 1 и запишем минимизируемый по параметру интеграл в виде суммы двух интегралов 21 которые берутся соответственно от нулевого и 2-го членов ряда Тейлора 20 22 23 Подставляя в формулы для интегралов 22 и 23 уравнения траектории 15 и дифференциала дуги 16, производя интегрирование по и затем дифференцирование по, из условия 24 находим радиус кривизны малой дуги оптимальной траектории как 25 где производная по нормальному направлению. При решении уравнения 24 был учтен 3-й порядок малости в интегралах и, берущихся от нулевого и 2-го членов ряда Тейлора 20. Остальные члены ряда Тейлора, имеющие более высокие порядки малости, отбрасываются. Итак, чтобы найти надо задать координаты и вектор единичной скорости или единичный вектор касательного направления . Если модуль некоторого вектора скорости не нормирован к единице то следует перейти к единичной скорости или единичному вектору направления 26 Далее необходимо найти вектор нормальной составляющей градиента функции 27 рассчитать производную по направлению нормали 28 и, подставляя 28 в 25, определить оптимальный радиус кривизны 29 При этом единичный вектор нормали 30 Движение по оси 0 является заданным, или вынужденным, а по оси 0 варьируемым, выбранным из условия минимума 1. Результат имеет очевидный смысл при увеличении радиуса кривизны слагаемое 21 растет, так как увеличивается длина дуги, а слагаемое убывает, так как дуга выгибается в сторону меньших значений функции, и при условии 29 достигается минимум. Определим радиус кривизны малой дуги оптимальной траектории на основе известного факта, что свет в оптической среде с переменной оптической плотностью распространяется из начальной точки в конечную по некоторой траектории, такой, что время распространения минимально. Допустим, что свет распространяется по некоторой кривой, приходя из некоторой начальной точки в конечную рис. 2. Разобьем кривую на малых отрезков так, что Обозначая модуль скорости света на малом отрезке и учитывая, что время распространения света на отрезке запишем суммарное время распространения по линии как предельный переход к соответствующему криволинейному интегралу 31 где модуль скорости света в оптической среде как функция положения в зависимости от текущей длины на траектории . Запишем известное соотношение в виде 32 где абсолютный показатель преломления оптической среды модуль скорости света в вакууме. Тогда, подставляя 32 в 31, запишем принцип минимума времени распространения света 33 где некоторая варьируемая траектория траектория луча света, вдоль которой автоматически достигается минимум интеграла от функции переменного показателя преломления оптической среды. Из курса оптики известна соответствующая закону Снеллиуса 7 простая иллюстрация преломления луча света при прохождении через границу двух слоев с разными показателями преломления и рис. 3, дополненный необходимыми построениями. Луч света при переходе границы Г уменьшает скорость со значения до значения так как нормаль к граничной поверхности, разделяющей слои с различной оптической плотностью градиент направлен по нормали угол падения угол преломления длина фронта падающей волны, а преломленной точки и середины этих фронтов соответственно. Прямые углы отмечены точками. Правый крайний падающий луч за время проходит малый путь 34 Левый крайний преломленный луч проходит путь 35 Очевидно, что через точки и можно провести дугу окружности касательно к векторам скоростей. Тогда радиус кривизны этой дуги 36 где точка Ц образуется пересечением продолженных прямых линий фронтов и угол между прямыми Ц и Ц длина дуги, приходящей из точки в точку . C точностью до 1-го порядка малости заменим длину дуги на путь крайнего правого падающего луча 37 Прямая Ц параллельна прямой Ц, тогда с точностью до 1-го порядка малости см. треугольник 38 где 39 40 где приращение показателя преломления вдоль линии 41 Расписывая 38 далее, имеем 42 Отношение в пределе при 0 представляет собой производную по направлению по касательной оси 0, которая равна проекции градиента на это направление 43 а проекция градиента на нормальное направление 0 равна частной производной по этому направлению 44 Тогда, подставляя 44 и 43 в 42, а 42 в 36, после несложных преобразований окончательно имеем 45 То есть и во второй физической модели, независимо от первой, получен тот же самый результат 29, что подтверждает правильность физических моделей и математических выкладок. Соответствие критерия оптимальности траектории минимуму времени прохождения света по этой траектории дает возможность применить принцип пошаговой оптимизации если каждый шаг оптимален, то оптимальна и вся траектория в целом. При пошаговом движении необходимо попасть из начальной точки в конечную. Входными величинами на каждый -й шаг являются местоположение текущей точки и заданное направление движения в виде вектора единичной скорости или в виде единичного вектора направления Кроме того, должны быть рассчитаны радиус кривизны и вектор нормали по формулам 27 30. Далее рассчитываются соответствующие выходные величины -го шага 46 где малое перемещение по касательной которое задается одинаковым для всех шагов 47 малое перемещение по нормали. 48 где 49 угол раствора -й дуги траектории. Таким образом, если в заданной начальной точке задать и некоторое начальное направление, то текущая точка, перемещаясь по шагам, будет двигаться по определенной траектории, которая в общем случае пройдет мимо заданной конечной точки Поэтому надо скорректировать начальное направление движения так, чтобы попасть в конечную точку. Условием окончания пути движущейся текущей точки является условие пересечения сферы радиусом 50 где 51 На этой сфере должны заканчиваться все пробные или пристрелочные траектории. При выполнении условия 51, решая уравнение 52 найдем экстраполированную точку траектории которая лежит на этой сфере. Траектория экстраполируется рядом Тейлора до 5-го порядка малости 53 где соответствующие производные от радиуса вектора рассчитываются как для четных порядков 54 так и для нечетных 55 где, и радиус кривизны, касательный и нормальный векторы, соответственно, в предпоследней точке траектории, от которой производится экстраполяция. Далее уравнение 52 решается методом последовательных приближений 56 где номер итерации 57 квадратический путь экстраполируемой точки 58 производная квадратического пути 59 производная экстраполируемого радиуса-вектора. Определив конечную точку некоторой пристрелочной траектории, лежащую на сфере где время на последней итерации, при котором экстраполируемая точка достигает сферы, рассчитаем направляющие косинусы прямой линии, соединяющей начало траектории и точку -й пристрелки 60 при этом направляющие косинусы прямой линии, соединяющей начало и конец требуемой оптимальной траектории 61 Этим векторам направлений и некоторым образом соответствуют векторы начальных касательных направлений и пристрелочной траектории Т и требуемой оптимальной траектории Т рис. 4, где траектория Т условно наклонена к нам, а Т от нас. Вектор касательного направления оптимальной траектории пока не известен. Следовательно, надо в вектор вносить такие поправки, чтобы вектор совместился с вектором . Это проделаем таким образом. Рассчитаем поправку на плоскости П, натянутой на два вектора и 62 Пусть ненормированный вектор направления пристрелки продолжен по нормированному вектору пристрелки таким образом, что проекция вектора на плоскость П есть вектор . В соответствии с этим модуль ненормированного вектора 63 Вектор свяжем с векторами и аналогичными построениями, модуль этого вектора 64 Ненормированный 1-й вектор пристрелки сформируем как 65 Тогда с учетом подобия треугольников, образованных парами векторов и, нормированный 1-й вектор пристрелки сформируем так 66 Условием окончания итераций пристрелки 66 можно выбрать уменьшение угловой ошибки на сфере ниже минимального заданного предела 67 либо задавать заведомо большее количество циклов пристрелки, чем необходимо для выполнения условия 67. Чтобы не накапливались погрешности, единичный вектор направления, рассчитываемый по формулам 47 и 49, следует нормировать на каждом шаге вновь по формуле 26. Заметим, что, строго говоря, точка начала координат 0, относительно которой рассчитывается радиус кривизны, нам неизвестна, а фактически известна точка начала дуги с координатами 0, . Как показало промежуточное моделирование результаты которого здесь не приводятся, процесс итерационного поиска точки начала координат от точки начала дуги через радиус кривизны не всегда приводит к необходимому уменьшению интеграла. Поэтому в формулах 29 и 45 следует рассчитывать постоянное значение функции и ее производной по нормали относительно доступной точки начала дуги по приближенным формулам 68 Этот интеграл требуется не только для проверки различных траекторий на оптимальность, но также и для оценивания затрат или потерь наблюдателем. При выводе формулы 29 при разложении в ряд Тейлора были учтены варьируемые составляющие в интегралах и, которые оказывают наибольшее влияние на минимизацию интеграла вдоль малой дуги. Однако при большей протяженности траектории следует учесть и составляющие и, которые вносят хотя и менее варьируемый более постоянный, но зато существенный вклад в минимизируемый интеграл. Зафиксировав найденный оптимальный радиус 45, определим длину дуги как, где угол раствора дуги. Далее, опуская индекс, возьмем четыре учтенные до 3-го порядка малости составляющие интеграла вдоль дуги окружности 69 70 71 72 Составляющая имеет 1-й порядок малости. Несложно показать, что составляющие и имеют 2-й и 3-й порядки малости соответственно На последнем шаге траектории, при котором пересекается сфера, в формулы 6972 следует подставлять . Итоговый криволинейный интеграл вдоль оптимальной траектории 73 где номер предпоследней точки траектории, лежащей еще внутри сферы, определяется из условия 50. Второе слагаемое в 73 рассчитывается для интегралов при уменьшенном времени движения от предпоследней точки до заданной конечной . В качестве тестовой функции затрат была задана нетривиальная функция пяти переменных, составленная по типу квадратической формы, которая функция, однако, является формой 4-й степени 74 где матрица формы 4-й степени аргументов вектор квадратических отклонений от центра осевой симметрии функции вектор смещения центра осевой симметрии функции, 1000 постоянная составляющая функции. Эта составляющая задана для положительной определенности тестовой функции и соответственно для устойчивости численных методов в окрестности, близкой к центру . Начальная и конечная точки задавались соответственно так В табл. 1 приводятся относительные минимальные значения криволинейного интеграла вдоль траекторий, найденные методом пристрелки при увеличении элементарного шага с 2 до 2 при количестве циклов пристрелки 48. Количество итераций для определения времени пересечения конечной сферы, отсчитываемого от предпоследней точки траектории, было выбрано равным 16. При 2 получается минимальное значение 44 284,808, которое и принимается за абсолютный минимум при еще меньших значениях уже сказываются погрешности вычислений, которые искажают истинную картину. Относительные превышения абсолютного минимума Отношение относительных превышений минимума при уменьшении шага в единицах количество раз Так, например, число 2,07 в 6-й строке табл.1 следует понимать так при увеличении элементарного шага с 2 1128 до 2 164 относительное превышение увеличивается в 0,3520,170 2,07 раз. Из 4-й колонки видно, что чем меньше элементарный шаг, тем точнее траектория приближается к минимальному значению интеграла, что и должно быть при правильной работе алгоритма. При увеличении элементарного шага в два раза относительные превышения увеличиваются также примерно в два раза. То есть превышение абсолютного минимума почти линейно зависит от элементарного шага, из чего следует, что порядки малости учитываемых и отбрасываемых величин во всех предшествующих выводах вполне согласованы. Здесь автор не рассматривает неоднозначные решения задачи оптимальных траекторий методом пристрелки. Неоднозначность возникает, например, когда максимум функции потерь находится достаточно близко к прямой, соединяющей заданные начальную и конечную точки, и возможно попадание в конечную точку методом пристрелки двумя или более траекториями, проходящими по разные стороны от максимума. Также неоднозначность траекторий может быть при многоэкстремальных функциях. В этом случае следует задать некоторое упорядоченное множество начальных приближений векторов направления, например, с использованием многомерных сферических координат 5, и далее из полученных квазиоптимальных траекторий выбрать оптимальную. Выше для построения оптимальной траектории был обобщен принцип минимума времени распространения света на многомерное пространство. Однако для подтверждения достоверности поставленную задачу необходимо также решить формальным, но строгим математическим методом без каких-либо допущений. Этот метод разработан только для тестирования метода пристрелки и не имеет самостоятельного значения, поэтому освещается более кратко, чем основной материал. В качестве тестовой была задана функция 74. Траектория задавалась полиномами 8-й степени таким образом, что координаты, являются функциями координаты собственно аргумента где 2, 3, 4, 5. Начальная точка 0,000 0,567 0,268 0,345 0,191, а конечная точка 0,400000 0,748993 0,472549 0,563411 0,418735. При таком задании траектории 28 коэффициентов, свободно варьируются, а 4 коэффициента, являются зависимыми от всех предыдущих коэффициентов и рассчитываются соответствующим образом так, что траектория всегда приходит в конечную точку. Криволинейный интеграл, рассчитанный вдоль траектории по несложным, но громоздким формулам, которые здесь не приводятся, минимизируется по тем же 28 коэффициентам градиентным методом. Прежде всего, проверим соответствие решений, получаемых методом пристрелки и градиентным методом непосредственной минимизации криволинейного интеграла. Для вышеприведенных данных вначале была построена траектория методом пристрелки и рассчитано минимальное значение криволинейного интеграла которое и принимается за абсолютное или истинное. Далее в качестве начального приближения для градиентного метода было задано четыре девятки отсчетов по координатам Эти отсчеты рассчитаны как точки пересечения траектории с девятью гиперплоскостями. Гиперплоскости через равные промежутки перпендикулярно пересекают ось аргументов Градиентный метод после 8 итераций выходит на квазиминимальное значение интеграла В табл. 2 приводятся относительные отклонения текущего значения интеграла от абсолютного минимального значения. Так, например, число 3,32 в 5-й колонке рассчитано так Из табл. 1 видно, что градиентный метод практически не отклоняется от минимального значения интеграла, найденного методом пристрелки. Незначительное относительное отклонение объясняется погрешностями вычислений. В табл. 3 приводятся относительные расхождения по координатам, где 1, 2, 3, 4 в сечении гиперплоскостями где 1, 2, 7, квазиоптимальной траектории найденной градиентным методом и оптимальной построенной методом пристрелки. Начальные и конечные точки обеих траекторий не варьируются и всегда совпадают 0 и 8. Для большей наглядности и критичности этих оценок из всех координат вычтены постоянная и линейная составляющие, т. е. сравнивались относительные разности координат дуговых сегментов траекторий где и координаты дуговых сегментов квазиоптимальной и оптимальной траекторий соответственно. Как упоминалось выше, в проверочном градиентном методе линейные составляющие выбираются так, что начало и конец траектории всегда проходят через заданные начальную и конечную точки. Из табл. 3 следует, что квазиоптимальная траектория, найденная градиентным методом, практически совпадает по своим координатам с оптимальной траекторией, найденной методом пристрелки. Далее в качестве начального приближения для градиентного метода была задана прямая, соединяющая начальную и конечную точки траектории. Градиентный метод за 13 итераций от начального значения интеграла сошелся к квазиминимальному значению В табл. 4 отражены эти итерации. Во 2-й колонке записано итерационное уменьшение минимизируемого интеграла, в 3-й колонке абсолютное отклонение от квазиминимального значения, в 4-й колонке абсолютное отклонение от абсолютного минимального значения . Целая десятичная часть всех интегралов равна 10 711, а целые десятичные части величин и на всех итерациях равны нулю. Из табл. 4 видно, что в начале итераций отклонения от квазиминимального значения и от абсолютного минимального значений практически равны. Затем градиентный метод имеет неустранимые ошибки, которые, однако, примерно в 150 раз меньше начальных отклонений. В итоге результаты проверки метода пристрелки тестовым методом следует признать вполне удовлетворительными. Еще раз подчеркнем, что тестовый метод не имеет самостоятельного значения и не рекомендуется к практическому использованию, так как сходится к минимуму лишь для малых длин траекторий, много меньших, чем для метода пристрелки. При больших длинах траекторий тестовый метод либо теряет устойчивость, либо сходится к локальным неоптимальным минимумам, и квазиоптимальная траектория получается извилистой. Полученные результаты можно рекомендовать, например, для оптимизации управления систем в многомерном обобщенном пространстве состояний или параметров 8, где необходимо перевести систему из заданного начального состояния в заданное конечное с минимальными затратами, потерями и т. д. При этом системы могут быть не только технические но и, например, экономические и другие. Оптимальная траектория вышеописанным методом пристрелки получается в виде множества координат точек 0, 1, 2, которые разработчик или исследователь при необходимости может, например, аппроксимировать удобными для дальнейшего использования функциями. Кроме того, должна быть задана или известна функция потерь или затрат. Если эта функция не задана, то ее следует либо вывести аналитически, либо рассчитать численно, либо получить экспериментально. Далее найденное оптимальное движение системы в многомерном пространстве состояний следует пересчитать в программу управления если это требуется. Однако все эти задачи уже выходят за рамки статьи и здесь не рассматриваются. 