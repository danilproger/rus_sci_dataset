ИДЕНТИФИКАЦИЯ СМАРТ-КАРТ   НА ОСНОВЕ ОДНОСТОРОННИХ ПРЕОБРАЗОВАНИЙ 

1 Рассматривается подход к построению системы идентификации для устройств с ограниченными ресурсами и памятью, таких как смарт-карты, брелоки, устройства RFID и т. п. Стойкость протокола основывается на стойкости используемых криптопримитивов, а также на предполагаемой возможности стойкого объединения логики при проектировании схем устройства терминала.

Стандартным и широко распространенным способом реализации процедуры идентификации являются так называемые парольные системы 1, 2, в которых каждому участнику системы соответствует пара имя, пароль. Для прохождения идентификации пользователь должен назвать себя сообщить имя и назвать правильный пароль, соответствующий этому имени. Очевидный недостаток данной системы состоит в том, что для прохождения идентификации терминал должен знать все секретные пароли всех пользователей. Таким образом, требуется построение системы, в которой терминал способен проверить наличие у пользователя, выдающего себя за, секрета, не зная этого секрета. В работе 3 Шамир предложил идею использования в качестве открытого ключа пользователя непосредственно данных об идентичности этого пользователя или значения, напрямую вычисляемого из этих данных. Помимо удобства, достоинством этого подхода является то, что решается проблема аутентичности открытого ключа. Такой подход получил название основанного на идентичности ID-based или личностного. Стоит отметить, что личностная криптография особенно удобна в задаче идентификации, так как в любом протоколе идентификации пользователь вначале должен сообщить терминалу, за кого он себя выдает в личностной криптографии это позволяет одновременно передать открытый ключ. Автор построил систему личностной идентификации, которая может быть использована на смарт-картах как устройствах с ограниченными ресурсами. Рассмотрим подход к организации идентификации между картой и терминалом, основанный на так называемом изолировании запроса. Предположим, что мы рассматриваем карту, принадлежащую пользователю . В дальнейшем не будем различать пользователя и его карту и будем называть карту картой . Предположим далее, что мы рассматриваем личностную криптографию, и открытый ключ пользователя получается из данных об идентичности данного пользователя. Будем считать в связи с этим, что . Секретный ключ вычисляется авторизованным центром с помощью секретного преобразования . Фактически это означает, что при вычислении используется дополнительный секретный аргумент. Будем считать, что авторизованный центр вычисляет секретный ключ пользователя как где секретный ключ центра . Структура карты изображена на рис. 1. Здесь несекретное одностороннее преобразование. Карта способна сообщать свой открытый ключ, а также вычислять функцию для некоторого входа . Отметим, что сама архитектура карты, представленная на рис. 1, не является новой например, она используется в микрочипах ST1335 и SLE4436 карт оплаты телефонии T2G. Функциональная структура терминала изображена на рис. 2. Важнейшим условием предлагаемой системы является то, что устройство, реализующее данную функциональность и предоставляемое авторизованным центром всем терминалам, является для них черным ящиком. Оно принимает на вход два аргумента и и вычисляет и, но не может быть за приемлемое время разложено на составляющие, и или эквивалентные им. На практике это может быть осуществлено на уровне логики интегральной схемы. Таким образом, на рис. 2 показана именно функциональность блока на стороне терминала, а не действительная архитектура. Блоки и открытые, но односторонние преобразования, а секретное преобразование авторизованного центра см. рис. 2. Вследствие предполагаемой невозможности обратного инжиниринга преобразование а также все промежуточные значения внутри изображенного блока остаются недоступными извне. При этом само устройство, как некоторое отображение из двух входов в два выхода, может рассматриваться как общедоступное и служить аналогом открытого ключа авторизованного центра . Теперь рассмотрим осуществление протокола идентификации между картой и терминалом. 1. На первом шаге протокола карта называет себя и таким образом передает терминалу свой открытый ключ . 2. Терминал подает на вход своего устройства и, где случайное число, получая на выходе и . Значение передается карте. 3. Карта подает на вход своего устройства полученное значение и вычисляет соответствующий, который передает терминалу. 4. Терминал проверяет и в случае равенства считает идентификацию успешной. В противном случае идентичность карты отвергается. Рассмотрим описанный протокол более подробно. Фактически, он представляет собой протокол типа оклик-отзыв 1, 2, в котором терминал задает вопрос случайное число, а карта должна правильно на него ответить, используя свой секретный ключ. Терминал при этом должен иметь возможность проверить правильность ответа карты. В данном случае в качестве критерия правильности служит выработка картой и терминалом общего значения. Однако в качестве оклика используется не само случайное число, а его образ, вычисляемый с помощью односторонней функции . Мотивация этого будет приведена ниже. Легко видеть, что значение, вычисляемое картой, представляет собой, а значение, вычисляемое терминалом, Таким образом, при правильном функционировании и обладании картой знанием, должно выполняться, что и проверяет терминал. Отметим, что основными строительными блоками схем карты и терминала на рис. 1 и 2 являются секретная однонаправленная функция и две открытые однонаправленные функции и при этом нет необходимости специально публиковать и . Можно заметить, что требования однонаправленности функций и удовлетворяются использованием бесключевых криптографических хэш-функций, а требование секретной односторонней функции может быть реализовано с помощью симметричного блочного шифра или ключевой хэш-функции например, кода аутентификации сообщения MAC 1, 2. Рассмотрим различные свойства полученного протокола. . По построению данный протокол является основанным на идентичности пользователя, что являлось желаемым свойством, сформулированным выше. . Протокол использует эффективно реализуемые криптопримитивы хэш-функции и симметричный блоковый шифр, что дает значительный выигрыш по ресурсоемкости в сравнении с теоретико-числовыми протоколами идентификации. Для многих практических систем этот выигрыш может достигать тысяч раз. . Терминал пересылает карте значение, являющееся выходом . Карта пересылает терминалу идентичность и значение, являющееся выходом . Если предположить, что в качестве однонаправленных функций используются хэш-функции ГОСТ Р 34.1194 с 256-битными выходами, то терминал передает карте 256 бит, и карта передает 256 бит плюс размер . Если считать, что размер не превышает 256512 бит, получаем общий трафик не более 1024 бит. Это соответствует всего лишь среднему размеру одного числа в теоретико-числовом протоколе идентификации например, ФиатаШамира 1, 4, при этом в протоколе количество подобных передаваемых чисел оценивается примерно как 2, где количество раундов, обычно выбираемое порядка нескольких десятков. . Представленная на рис. 1 карта является универсальной в том смысле, что при смене пользователя или даже алгоритма преобразования авторизованного центра нет необходимости проектировать новую карту достаточно перезаписать хранимые в ней значения и конечно, аппаратное обеспечение терминала при этом все же придется проектировать заново. . Сначала рассмотрим необходимость использования одностороннего преобразования . В самом деле, в его отсутствие можно было бы описать схожий протокол следующим образом. 1. Карта называет себя и передает терминалу свой открытый ключ . 2. Терминал отправляет карте случайное число, одновременно вычисляя при этом, . 3. Карта подает на вход своего устройства полученное значение и вычисляет соответствующий, который передает терминалу. 4. Терминал проверяет и в случае равенства считает идентификацию успешной. В противном случае идентичность карты отвергается. Легко видеть, что описанный протокол также работает с точки зрения легальных пользователей в том смысле, что если все участники честны, то действительно выполняется . Однако вспомним, что мы считали устройство терминала доступным всем участникам как своеобразный открытый ключ авторизованного центра . В этом случае ничто не мешает злоумышленнику, не обладающему картой, но желающему себя выдать за, воспользоваться точно таким же устройством, что и у терминала, подать на его вход известные ему и и вычислить то же самое, что и значение, полученное терминалом. Для предотвращения такой атаки случайный оклик терминала закрывается с помощью односторонней функции. Стойкость данной системы основывается на стойкости используемых функций хэширования необходима устойчивость к вычислению второго прообраза 3 и шифрования. В статье рассмотрена схема идентификации, использующая в качестве базовых блоков эффективно реализуемые и не требовательные к ресурсам симметричные алгоритмы, применяемая в устройствах с ограниченными ресурсами, в которых затруднено использование традиционной теоретико-числовой криптографии с открытым ключом. 