СРАВНЕНИЕ АЛГОРИТМОВ ДЕШИФРАЦИИ  АЭРОФОТОСНИМКОВ ЗЕМЕЛЬ  СЕЛЬСКОХОЗЯЙСТВЕННОГО НАЗНАЧЕНИЯ 

Проводится сравнение алгоритма расчета евклидова расстояния и алгоритма расчета расстояния Махаланобиса для целей повышения точности дешифрации аэрофотоснимков сельскохозяйственных земель и оценки состояния зеленой растительности. Показано, что для повышения точности классификации изображений, сделанных сверхлегкими аппаратами с высоты 1–3 км и имеющих три канала видимого спектра без использования инфракрасного канала, необходимо учитывать влияние спектральных характеристик соседних точек, окружающих анализируемый пиксель, а также включать в класс более одной обучающей выборки с использованием нескольких эталонных областей.

В последнее время возросла потребность в современной и достоверной информации по оценке состояния земель сельскохозяйственного назначения и их использованию как для обеспечения деятельности агропромышленных предприятий, так и для целей охраны окружающей среды. Многие хозяйства по-прежнему отдают предпочтение полевым исследованиям и ручной дешифрации снимков, однако эти методы имеют целый ряд недостатков, к основным из которых можно отнести высокий субъективизм результатов, зависящих от опыта и предпочтений дешифровщика низкую скорость получения результатов дешифрации неизбежные ошибки дешифрации, связанные с человеческим фактором постоянно возрастающую стоимость дешифрации с увеличением площади сельскохозяйственных земель или количества снимков 1. На сегодняшний день алгоритмы автоматизированной дешифрации средствами вычислительной техники облегчают обработку информации, содержащейся в изображении. Автоматизированная дешифрация аэрофотоснимков позволяет устранить указанные недостатки и поэтому является более перспективным способом обработки снимков. Чтобы выделить на аэрофотоснимке структуры площадей или обнаружить изменения, необходимо провести анализ характеристик пространственного распределения пикселей изображения. В настоящее время одним из наиболее разработанных методов такого анализа является классификация. Существует много различных алгоритмов для проведения классификации снимков, полученных из космоса, и они подробно описаны в литературе. На основе этих алгоритмов разработано программное обеспечение ПО, которое широко применяется в различных областях хозяйственной деятельности. В настоящее время это ПО не доступно малым и средним сельскохозяйственным предприятиям из-за высокой стоимости и низкого разрешения снимков. Целый ряд исследований в литературе и Интернете посвящен оценке точности классификации изображений, в основе которых лежат данные мультиспектральных снимков из космоса. Использование таких снимков небольшими сельскохозяйственными предприятиями невозможно, так как их разрешение не позволяет оценить состояние конкретных земель исследуемые участки могут быть восприняты как шум или неверно классифицированы. Применение сверхлегких летательных аппаратов и относительно дешевой фотоаппаратуры позволяет снизить стоимость работ по дистанционному зондированию земной поверхности и дает возможность использовать эти данные для нужд средних и малых предприятий. Учитывая все вышесказанное, определим основную задачу данного исследования оценить точность классификации снимков, сделанных со сверхлегких летательных аппаратов мотодельтапланов, беспилотных летательных аппаратов с высоты 13 км и имеющих всего три канала видимого диапазона спектра, и . Задача классификации формализованная задача, в которой имеется множество объектов, разделенных некоторым образом на классы. Задано конечное множество объектов выборка, для которых известно, к каким классам они относятся. Классовая принадлежность остальных объектов неизвестна. Требуется построить алгоритм, способный классифицировать произвольный объект из исходного множества. Алгоритм расчета расстояния между объектами является ключевым моментом задачи классификации, так как от него зависит, к какому классу будет отнесена исследуемая точка аэрофотоснимка. Принимая решение, алгоритм оценивает несходство или расстояние между объектами 2. При съемке со сверхлегких летательных аппаратов, как правило, используется только три канала информации в видимом диапазоне спектра, но разрешение этих снимков значительно выше, чем при съемке из космоса. Поэтому далее в статье будут рассмотрены два алгоритма классификации именно таких аэрофотоснимков алгоритмы расчета евклидова расстояния и расстояния Махаланобиса. Выбор данных алгоритмов обусловлен тем, что формула расчета евклидова расстояния одна из самых простых и широко применяемых для расчета расстояния в -мерном пространстве, а формула расчета расстояния Махаланобиса одна из самых сложных. Первый алгоритм требует значительно меньше вычислительных ресурсов, чем второй. Далее рассмотрим недостатки и преимущества обоих алгоритмов. Для классификации аэрофотоснимков будем использовать метод классификации с обучением. Перед проведением классификации необходимо выбрать на исходном снимке эталонные области обучающие выборки и назначить им класс. Количество классов зависит от того, сколько областей необходимо получить на результирующем снимке. Такой подход позволяет не учитывать при сравнении алгоритмов расчета режимы съемки. Для каждой обучающей выборки предварительно рассчитывается центр тяжести по формуле 1 где количество точек в обучающей выборке канал аэрофотоснимка. При расчете расстояния между обучающей выборкой и исследуемой точкой аэрофотоснимка используется расстояние между центром тяжести обучающей выборки и исследуемой точкой 3. Евклидово расстояние вычисляется по формуле 2 где размерность пространства значения объектов и в -м измерении. Для снимков с тремя каналами имеем 3 где значения каналов, объектов и . Алгоритм расчета евклидова расстояния, как видно из формулы, не учитывает ориентацию точек обучающей выборки в пространстве 4. Для обучающих выборок, которые состоят из точек, равноудаленных от центра тяжести, это не имеет значения. Но для реальных обучающих выборок, в которых присутствуют точки с разными значениями цветовых составляющих это приводит к увеличению количества неверно классифицированных областей аэрофотоснимков. В качестве примера возьмем две обучающие выборки и . Взаимное расположение точек обучающей выборки в трехмерном пространстве и показано на рис. 1. Точка аэрофотоснимка и два расстояния, и, на рисунке вычислены по формуле 3. Так как расстояние, меньше расстояния, то точка будет классифицирована как класс . Но визуально точка находится ближе к классу и должна быть отнесена к нему. Такая ошибка классификации вызвана тем, что обучающие выборки имеют эллипсоидное распределение точек в пространстве. Для более точной классификации аэрофотоснимков необходимо учитывать размеры области, занимаемой точками обучающей выборки, и ориентацию этой области в пространстве. Такой алгоритм был впервые сформулирован индийским статистиком Махаланобисом в 1936 г. и называется 5. Формально расстояние Махаланобиса от многомерного вектора, до множества со средним значением, и матрицей ковариации определяется следующим образом 4 где расстояние Махаланобиса. Ковариационная матрица в теории вероятностей это матрица, составленная из попарных ковариаций элементов двух случайных векторов. Матрица ковариации является обобщением дисперсии для многомерной случайной величины. Собственные векторы и собственные числа этой матрицы позволяют оценить размеры и форму облака распределения такой случайной величины, аппроксимировав его эллипсоидом. На рис. 1 видно, что аппроксимация эллипсоидом очень хорошо описывает массив точек обучающих выборок и . Расстояние Махаланобиса это просто расстояние между заданной точкой и центром тяжести, деленное на ширину эллипсоида в направлении заданной точки. Если матрица ковариации является единичной матрицей, то расстояние Махаланобиса становится равным расстоянию Евклида. Если матрица ковариации диагональная но необязательно единичная, то получившаяся мера расстояния равна нормализованному расстоянию Евклида. Реальные обучающие выборки, которые используются при классификации снимков, имеют распределение в пространстве, отличное от правильного эллипсоида кроме того, области обучающих выборок могут частично перекрываться, особенно для снимков, имеющих только три канала видимого спектра. Это потенциально может служить источником ошибок при проведении классификации. Для уменьшения таких ошибок необходимо тщательно выбирать обучающие выборки, а также предлагается использовать два дополнительных способа при классификации выбранной точки на исходном снимке учитывать спектральные характеристики соседних точек включать в класс более одной обучающей выборки. Это позволит относить к одному классу разные эталонные области. Например, отнести к классу Нет зелени различные виды почв и строений. Для оценки эффективности двух рассмотренных алгоритмов автором разработана программа, которая позволяет производить классификацию аэрофотоснимков с использованием вышеописанных алгоритмов и оценивать точность распознавания классов. Ограниченный размер статьи не позволяет более подробно остановиться на описании возможностей этого ПО. Новизна представленного исследования заключается в том, что анализируются возможности использования снимков, сделанных с высоты 13 км и имеющих только каналы видимого спектра. То есть, с одной стороны, имеется разрешение снимков, значительно превышающее разрешение космических аппаратов, а с другой стороны, эти снимки имеют только три канала информации, что исключает использование при проведении классификации инфракрасного канала, который несет значительную часть информации о зеленой растительности. Перед проведением классификации на исходном снимке были заданы три эталонные области обучающие выборки, которые были отнесены к трем классам Лес, Сухая трава, Луг. Результаты классификации по двум алгоритмам показаны на рис. 2, . Для оценки точности классификации исходный снимок был обработан в программе MultiSpec с применением тех же обучающих выборок. Обработанное фото было использовано в качестве эталона при оценке точности классификации по двум алгоритмам, построении матрицы ошибок и расчете индекса каппа-статистики, приводимого ниже. Матрица ошибок формируется следующим образом элемент матрицы ошибок равен числу пикселей класса, распознанных как класс . Элемент матрицы равен числу пикселей класса, распознанных как класс . Число правильно классифицированных пикселей располагается на диагонали матрицы. На основе матрицы ошибок при обобщении результатов правильно классифицированных точек был использован так называемый индекс каппа-статистики, вносящий поправку на случайность. Он вычисляется по формуле 6 5 где общее число пикселей число классов сумма элементов -й строки сумма элементов -го столбца. Дополнительно рассчитывается и общая точность распознавания классов по следующей формуле . 6 Кроме этого используется степень согласованности сравниваемых снимков на основе индекса каппа-статистики табл. 1. Результаты оценки точности классификации по двум алгоритмам представлены на рис. 3, . Анализ матрицы ошибок показывает, что точность распознавания класса Сухая трава при использовании алгоритма расчета евклидова расстояния составляет всего 3,74, при использовании алгоритма Махаланобиса точность повышается до 75,11 . Точность распознавания классов Лес и Луг при использовании алгоритма Махаланобиса также выше. Для алгоритма Махаланобиса индекс каппастатистики составил 0,93, а для евклидова расстояния всего 0,73. Следовательно, при обработке аэрофотоснимка алгоритмом Махаланобиса точность распознавания классов на 20 лучше, чем при использовании алгоритма расчета евклидова расстояния. Для исследования влияния точек окружения анализируемого пикселя был использован фрагмент снимка, который был дешифрирован ручным способом в графическом редакторе. Для дешифрации в программе выбраны две обучающие выборки, которым присвоены классы Зелень и Почва. Также была проведена классификация снимка и оценка точности с использованием в качестве эталона результатов ручной дешифрации. Первый раз классификация проводилась без учета окружения анализируемой точки матрица 1 1. Второй раз классификация выполнялась с размером окна 3 3. Результаты приведены в табл. 2. Из таблицы видно, что точность классификации повысилась при использовании матрицы 3 3 и, следовательно, применение данного метода целесообразно также при классификации аэрофотоснимков. Для оценки использования нескольких эталонных областей в одном классе в класс Почва была добавлена еще одна эталонная область, которая была выбрана на исходном снимке потому, что почва имеет различные вкрапления. При проведении классификации получены результаты, которые приведены в табл. 3. Из этой таблицы видно, что использование двух обучающих выборок в классе Почва позволяет классифицировать участки исходного снимка и также может служить для повышения точности дешифрации. Таким образом, можно сделать вывод о том, что алгоритм Махаланобиса является более эффективным алгоритмом классификации аэрофотоснимков, сделанных сверхлегкими летательными аппаратами с небольшой высоты без использования специальной аппаратуры. Этот алгоритм позволяет значительно повысить точность дешифрации различных объектов при прочих равных условиях проведения аэрофотосъемки. Использование при классификации нескольких эталонных областей одного класса и учет окружения классифицируемых точек также повышает точность дешифрации снимков. 