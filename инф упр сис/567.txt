АДАПТИВНЫЕ АЛГОРИТМЫ ФИЛЬТРАЦИИ  И ФРАГМЕНТАЦИИ ЭЛЕКТРОКАРДИОГРАММ  ВЫСОКОГО ВРЕМЕННОГО РАЗРЕШЕНИЯ  ЧАСТЬ 1: ИСХОДНЫЕ СВЕДЕНИЯ И АНАЛИЗ ПОДХОДА  К РЕШЕНИЮ ПРОБЛЕМЫ 

 анализ и разработка подхода к решению проблемы адаптивной фильтрации ЭКГ, совмещенной с обнаружением и измерением параметров и характеристик фрагментов ЭКГ, ориентированных на повышение уровня и качества диагностики. Результаты: на основе анализа проблемы адаптивной фильтрации, использующей фрагментарную структуру ЭКГ, разработан подход и предложен метод синтеза адаптивных алгоритмов измерения ЭКГ, ориентированных на реализацию в современных аналого-цифровых микропроцессорных структурах. В основу метода положен принцип синтеза линейных композиционных операторов с управляемыми параметрами в зависимости от динамики фрагментов ЭКГ. Благодаря этому с учетом высокого временного разрешения при аналого-цифровом преобразовании в условиях воздействия помех обеспечивается измерение ЭКГ с контролируемой погрешностью. Действительно, характеристики помехи не зависят ни от измеряемого цикла, ни от фрагмента ЭКГ, а степень искажения ЭКГ из-за воздействия помех изменяется дифференцированно, в зависимости от вида фрагмента ЭКГ. Повышение качества фильтрации и тем самым цифрового измерения ЭКГ можно достичь за счет изменения параметров композиционного оператора фильтрации в соответствии с адаптивным алгоритмом в реальном масштабе времени, приспосабливая оператор фильтрации к текущему фрагменту ЭКГ. Поэтому предложен синтез такого оператора, параметры которого можно было бы перестраивать в зависимости от текущего фрагмента ЭКГ. Практическая значимость: применение предложенного метода и алгоритма фрагментарной фильтрации и измерения ЭКГ с высоким временным разрешением в современных аналого-цифровых микропроцессорных электрокардиографах позволит повысить достоверность измерения ЭКГ и тем самым улучшить качество решения проблемы автоматизации диагностики по электрофизиологическим показателям.

Наличие высокопроизводительных микроконтроллеров в сочетании с постоянно развивающейся теорией нелинейных систем 1, 2 создает техническую и теоретическую базу для разработки средств функциональной диагностики с широкими функциональными возможностями. В частности, при разработке электрокардиографов ориентируются не только на измерение электрокардиограммы ЭКГ в условиях помех, но и на поиск алгоритмов, способствующих автоматизации диагностики для сокращения объема рутинной работы врача-кардиолога. Широко известны адаптивные методы и способы измерения ЭКГ в условиях воздействия помех 3. Данные методы разработаны непосредственно для подавления сетевой помехи при измерении ЭКГ и не связаны с фрагментацией ЭКГ и решением задачи автоматизации диагностики. Представляют интерес методы и алгоритмы адаптивного измерения для решения комплексной задачи, в которой были бы связаны адаптивные алгоритмы цифровой фильтрации ЭКГ с обнаружением и измерением параметров и характеристик фрагментов ЭКГ для повышения достоверности диагностики. Как показано в статье, разработка подобных методов и алгоритмов возможна на базе ранее предложенного и практически апробированного вероятностного метода адаптивной дискретизации 4, 5. Варианты реализации этого метода могут осуществляться как посредством аналоговых схемотехнических решений, так и в цифровых аппаратно-программных приборах и системах. В последнем случае реализация вероятностного метода адаптивной дискретизации обеспечивается применением специальных итерационных алгоритмов при исходной частоте временной дискретизации ЭКГ, значительно превышающей принятую частоту дискретизации в соответствии с известной теоремой отсчетов 4, 5. Основным положительным эффектом применения итерационных алгоритмов вследствие их дискретной природы является возможность полного перехода к цифровым методам фильтрации при существенном снижении требований к аналого-аппаратным способам борьбы с помехами. Необходимо отметить, что использование аналоговых методов фильтрации в аппаратуре приводит к искажениям исходного электрокардиосигнала и к схемотехнической избыточности при их реализации, в то время как постоянно возрастающая производительность микроконтроллеров при улучшении метрологических характеристик аналого-цифровых преобразователей АЦП расширяет возможности программно-цифровой реализации цифровых алгоритмов обработки информации, к которым относятся и адаптивные алгоритмы измерения, фильтрации и диагностики. В настоящее время методы и алгоритмы борьбы с помехами разработаны без учета фрагментированной структуры ЭКГ 3 или путем дополнительной обработки в интерактивном режиме 6, поэтому наряду с решением поставленной задачи, например фильтрации ЭКГ от помех, они искажают частотный спектр полезного сигнала. Главным назначением предлагаемых в статье адаптивных метода и алгоритмов является измерение ЭКГ в условиях воздействия помех с контролируемой погрешностью. Вместе с тем рассматриваемый адаптивный метод обеспечивает возможность получения необходимой для диагностики информации о динамических свойствах ЭКГ и ее фрагментах. В основу предлагаемого метода синтеза операторов, ориентированных на реализацию в современных аналого-цифровых микропроцессорных структурах адаптивных алгоритмов фильтрации ЭКГ при воздействии помех, совмещенных с обнаружением и измерением параметров и характеристик фрагментов ЭКГ, положена следующая исходная модель, описывающая ЭКГ с учетом ее аналого-цифрового преобразования с предварительной временной дискретизации на выходе АЦП с фиксированным или постоянным временным интервалом шагом временной дискретизации, 0, 1, 2., 1 где результат цифрового измерения на выходе АЦП, представленного в виде дискретных значений исходного сигнала ЭКГ с помехами дискретные значения реальной или искомой ЭКГ сетевая помеха широкополосный шум или помеха общего вида интервал дискретизации исходного или входного сигнала, который выбирается с учетом высокого временного разрешения при временной дискретизации ЭКГ частота дискретизации превышает частоту дискретизации по Котельникову в 810 раз. Искомая ЭКГ формируется в результате электрической активности сердца. При измерении ЭКГ возможен также и специфический вид помех, возникающих, например, из-за низкочастотного мышечного тремора с частотой в пределах 1030 Гц. Первостепенной задачей при измерении ЭКГ является получение искомого сигнала ЭКГ с минимальной или заданной погрешностью в условиях воздействия помех. Адекватность математической модели 1 реальному сигналу соответствует поставленной задаче фильтрации ЭКГ от помех. Недостатком известных способов фильтрации является то, что принятый алгоритм фильтрации, который в общем случае представим в виде оператора, воздействует на весь сигнал и в одинаковой степени преобразует все его составляющие. Поэтому в результате применения оператора получаем . Поиск оператора фильтрации, при котором достигался бы эффект минимального искажения сигнала при максимальном подавлении суммарной помехи, затруднен из-за противоречивости сформулированного требования и особенностей искомого сигнала . В связи с этим стремятся синтезировать такой оператор, для которого выполняется для всех при 1, 2, условие 2 где критерий, характеризующий меру отклонения от . Синтез оператора, удовлетворяющего критерию 2, при котором осуществляется поиск нижней границы отклонения от в смысле критерия, является достаточно сложной задачей. Ее решению посвящено большое число работ см., например, 3 и приведенную в ней библиографию. Если подходить к решению поставленной задачи с точки зрения измерения, то условие 2 может быть представлено, например, в виде, 3 где, вероятность того, что отклонение сигналов и в соответствии с критерием функцией меры, не превысит априорно заданную величину . Обычно оценка погрешности осуществляется в виде систематической и случайной составляющих, характеристики которых оцениваются на основе оператора определения математического ожидания от, . Средний квадрат объединяет обе составляющие погрешности. Требование 3 к измерению ЭКГ оказывается достаточно жестким, так как полная информация о виде сигнала отсутствует. Поэтому реально получают только зарегистрированную оценку ЭКГ. Основной задачей статьи является поиск и исследование на базе критерия 3 с учетом современных информационных технологий методов и алгоритмов измерения и структуризации ЭКГ в условиях воздействия помех, доступных для реализации на основе последних достижений в области цифровой микроэлектроники. В соответствии с поставленной задачей, включая структуризацию ЭКГ, целесообразно из всевозможных операторов в качестве выбирать класс операторов, обладающих свойством линейности, т. е. . 4 Равенство 4 позволяет видоизменить 2 и приблизиться к условию 3 за счет выполнения следующих требований где функция меры, характеризующая отклонение результата измерения ЭКГ от его действительного значения заданная или допустимая величина отклонения ЭКГ от результата ее измерения в соответствии с установленной функцией меры некоторый априори задаваемый критерий, в смысле которого осуществляется поиск минимума при воздействии оператором на соответствующую составляющую сигнала . Рассматривать оценку как результат измерения можно лишь в том случае, когда величина не превышает допустимую для измерений величину. Известно, что сигнал ЭКГ описывают в виде зубцов и интервалов, т. е. по существу проводят структуризацию ЭКГ для решения задачи диагностики рисунок. Например, ЭКГ разделяют на циклы, соответствующие -интервалам это интервал времени между двумя соседними зубцами, установленный в определенном смысле. В пределах каждого цикла или интервала ЭКГ разбивается на фрагменты зубцы, которые выделяются по установленным признакам. Обычно ЭКГ разбивается на фрагменты в пределах интервала в соответствии с установленными параметрами и характеристиками, которые являются отличительными признаками для выделенного фрагмента 7. В дальнейшем, в целях унификации, введем последовательность обозначений фрагментов в порядке их следования в виде Ф, 1, 2, 3, или, что идентично, Ф, Ф, Ф . Помимо признаков для выделения фрагментов ЭКГ каждому фрагменту свойственен перечень признаков, по которым осуществляется постановка диагноза в случае отклонения параметров и характеристик этих признаков от некоторых номинальных значений. Поскольку ЭКГ относится к электрофизиологическому показателю, представленному для анализа изменяющимся во времени электрическим сигналом, то этот сигнал можно разбить в соответствии с перечнем фрагментов и порядком их следования на временные интервалы, к каждому из которых относится надлежащий фрагмент. Границы интервалов для каждого фрагмента целесообразно определить по его так называемым реперным или характерным временным точкам. Очевидно, что любой фрагмент имеет две реперные временные точки, одна из которых соответствует началу фрагмента, а вторая его окончанию см. рисунок. В пределах -го цикла фрагментарное представление ЭКГ математически целесообразно описать в виде где предполагаемая истинная ЭКГ без помех в пределах -го цикла, причем идентифицируется с Ф независимо от цикла и так называемые начальные и конечные реперные точки Ф -го фрагмента в -м цикле ЭКГ. Длительность цикла ЭКГ обычно находится по первому или главному фрагменту ЭКГ, соответствующему -зубцу. Поэтому длительность цикла или -й -интервал ЭКГ определяется разностью, 7 где и временные отсчеты с момента начала измерения ЭКГ одноименных реперных точек -го и -го зубцов, которые соответствуют в 6 фрагментам и . В общем случае для ЭКГ временные длительности -го фрагмента в каждом цикле ЭКГ не совпадают, и их числовые значения в 1-м цикле по результату измерения в предыдущем -м цикле можно предсказать только с некоторой вероятностью, поэтому длительности -го фрагмента описываются случайными числами. Причем каждое из значений или их совокупность содержит определенный диагностический смысл. Поэтому важно измерять реперные точки с требуемой для достоверной диагностики точностью. Из равенства 7 следует, что первая реперная точка последующего и вторая реперная точка предыдущего фрагмента совпадают. В соответствии с 6 длительность цикла ЭКГ можно найти в результате суммирования временных длительностей фрагментов из равенства 8 Длительность наблюдаемой ЭКГ, как это следует из 8, в пределах циклов находится с точностью до цикла или фрагмента из равенств 9 С учетом помех в пределах -го цикла система 6 преобразуется к виду 10 Для диагностики применяются признаки как отдельных фрагментов, так и их совокупности с учетом различных способов их объединения во множество подмножеств отдельных признаков. Например, широко используется только основной фрагмент Ф, идентичный -интервалу, выделение которого осуществляется по признакам, соответствующим реперным точкам, или длительности интервала . В результате воздействия оператора на ЭКГ при ее временной дискретизации выражение 10 уточняется в виде 11 где и числа, кратные интервалу, определяющие реперные точки -го фрагмента в -м цикле ЭКГ. Из 10 и 11 следует, что помеха не зависит ни от измеряемого цикла ЭКГ, ни от его фрагмента. Поэтому для повышения качества воздействия оператора на ЭКГ необходимо его видоизменить, приспосабливая его к текущему фрагменту, т. е. изменяя его в зависимости от вида Ф го фрагмента. В этом случае преобразование 11 в пределах каждого цикла 1, 2, принимает следующий вид 12 где оператор, воздействующий на -й фрагмент так, чтобы для него выполнялся критерий 5. Очевидно, что решение задачи с учетом 12 возможно лишь при условии, если оператор воздействия будет обладать адаптивными свойствами, т. е. если оператор в этом случае изменяется в реальном масштабе времени в зависимости от текущего фрагмента для выполнения условий критерия 5. Для выполнения этих условий необходимо синтезировать такой оператор, который можно было бы перестраивать в зависимости от текущего фрагмента определить вид и момент возникновения соответствующего фрагмента ЭКГ в целях инициализации перестройки оператора найти способ воздействия на оператор таким образом, чтобы его перестроить в зависимости от текущего фрагмента найти вид воздействия на оператор для достижения минимизации помехи по критерию 5 при всех вариантах перестройки оператора в реальном масштабе времени в зависимости от вида текущего фрагмента установить априорно интервал дискретизации сигнала с учетом требуемой погрешности определения реперных точек фрагментов ЭКГ, что и обусловливает исходное измерение или аналого-цифровое преобразование ЭКГ с высоким временным разрешением. Синтезировать оператор по измеренной ЭКГ, который удовлетворял бы перечисленным требованиям при отсутствии достаточной для этого априорной информации о сигнале, затруднительно для каждого фрагмента, тем более с учетом требований, сформулированных в 5. Истинное значение сигнала неизвестно и к тому же вариативно от цикла к циклу, а проверка первого условия в 5 эмпирически невозможна. В этом случае представляет интерес, как теоретически, так и практически, метод решения данной задачи на основе композиционного оператора, представленного в виде, 13 где . Выполнение требований 5 для каждого фрагмента ЭКГ можно осуществить на основе использования свойства линейности композиционного оператора 13. Подходящими операторами для реализации этого свойства являются, например, операторы интегрирования и дифференцирования или операторы, в силу дискретного представления ЭКГ, близкие к ним. Тем не менее остается вопрос о возможности выполнения на основе операторов и требований в виде 2 и 5. Поиск положительного ответа на этот вопрос должен учитывать дискретность представления ЭКГ после ее аналого-цифрового преобразования, поэтому необходимо перейти к синтезу дискретных операторов, аппроксимирующих непрерывные операторы и в виде суммы и конечных разностей. В соответствии с работой 8 обоснованный переход к дискретному варианту синтеза искомых операторов возможен на основе дифференциального уравнения первого порядка следующего вида 14 где коэффициент пропорциональности некоторое подлежащее определению или синтезу преобразование результата цифрового измерения ЭКГ, включая помехи. Дифференциальное уравнение 14 отвечает балансу в текущий момент времени между скоростью изменения результата измерения ЭКГ электрокардиографом и видом реализуемого в электрокардиографе преобразования . Коэффициент пропорциональности может зависеть от времени, а его вид, значение и размерность либо задаются априорно, либо подстраиваются на основе дополнительных алгоритмов, т. е. адаптивно. Искомый результат преобразования сигнала в момент времени 1 следует из непрерывного аналога 14 в следующем виде 15 где определяется в соответствии с 1. Сравнивая 15 с 13, нетрудно убедиться в том, что правая часть 15 удовлетворяет свойствам композиционного оператора, если преобразование обладает линейностью и соответствует оператору, так как сумма в 15 аппроксимирует интегральный оператор . Таким образом, синтез оператора сводится к установлению конкретного вида преобразования . При этом свойство линейности выполняется, если преобразование аппроксимирует оператор дифференцирования через конечные разности. С учетом линейности композиционного оператора каждый фрагмент ЭКГ в соответствии с 12 можно рассматривать в отдельности на предмет выполнения для него критерия 5. Аппроксимация оператора дифференцирования через конечные разности в условиях воздействия помех 9 оптимизируется по критерию минимума среднего квадрата для ЭКГ, заданной в дискретных отсчетах. Рассмотрим следующую модификацию аппроксимации оператора дифференцирования по конечным разностям в виде преобразования 16 ЭКГ условия подавления помех существенно меняются. Например, в области изменения зубца мощность ЭКГ значительно превышает мощность суммарной помехи. В связи с этим становится очевидной возможность повышения эффективности фильтрации ЭКГ от помех при сохранении формы его фрагментов по критерию 5 за счет адаптации указанного выше параметра преобразования к фрагментам ЭКГ. Прежде чем рассмотреть подробно возможность синтеза адаптивного алгоритма, проанализируем предварительно общие вопросы, связанные с фрагментацией ЭКГ. Сам факт фрагментации ЭКГ возник, во-первых, для установления связи между фазами сокращения сердца и, во-вторых, из-за необходимости диагностики нарушения самого процесса сердечной деятельности. При этом, учитывая требование диагностики, важной ее составляющей стал поиск и формирование для каждого фрагмента таких признаков, по которым можно было бы ставить нужный диагноз по измеренной и отфильтрованной ЭКГ 3, 7, 10, 11. Таким образом, выделение фрагментов и измерение тех или иных его параметров и характеристик для формирования признаков, устанавливающих связь между динамикой или вариабельностью форм фрагментов и патологическими изменениями сердечной деятельности, в основном осуществлялись только в интересах постановки диагноза. Соответствие той или иной группы признаков поставленному диагнозу устанавливалось преимущественно эмпирически с последующим поиском необходимого обоснования. Учет влияния искажения реальной ЭКГ на достоверность диагностики в результате ее измерения и фильтрации также выполнялся эмпирически без дополнительного анализа погрешностей измерения и фильтрации каждого фрагмента в результате установленных в электрокардиографе общих для измерения всей ЭКГ, т. е. не адаптивных, алгоритмов измерения и фильтрации. Поэтому необходимо перейти к решению задачи адаптивной фильтрации на основе выделения фрагментов ЭКГ по их признакам в целях повышения качества и достоверности диагностики по электрофизиологическим показателям. Метод решения данной задачи рассмотрен во второй части статьи. 