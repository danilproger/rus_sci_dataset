СИСТЕМА МОДЕЛИРОВАНИЯ СЕТЕВЫХ ПОМЕХ  МУЛЬТИМЕДИЙНЫХ ПОТОКОВ 

Представлена система моделирования сетевых помех, влияющих на качество мультимедийных потоков, передаваемых в IP-сети. Данная система предназначена для исследования и тестирования новых мультимедийных сервисов и систем, а также проверки создаваемых критериев оценки качества мультимедийных потоков. Показано, что для определения результирующего качества мультимедийных потоков, передаваемых в реальном режиме времени, можно использовать параметры, полученные от плееров удаленных пользователей. Для оценки качества использовались время начала воспроизведения, минимальное количество кадров в секунду, максимальный скачок потери кадров и минимальный размер буфера в секундах, который был зафиксирован в течение всего воспроизведения мультимедийного потока.

Мультимедийные потоки в режиме реального времени сегодня активно транслируются через Интернет. Потоки передаются как между двумя точками сети, так и в режиме многоточечной связи. Передача мультимедийных потоков применяется в образовании и бизнесе. Видеотрансляции конференций, лекций и других мероприятий становятся обыденным делом 1. Для создания он-лайн трансляции необходимо иметь три основных элемента системы видеокодер, медиа-сервер и приложение плеер на стороне клиента. В свою очередь, во время передачи мультимедийных потоков через сеть Интернет, а именно при взаимодействии медиа-сервера с клиентами, на качество мультимедийных потоков оказывают влияние различные сетевые помехи, поэтому качество изображения и звука на стороне клиента в некоторых случаях не достаточно хорошее. Если для передачи мультимедийного трафика на транспортном уровне сетевой модели OSI используется протокол UDP, то ухудшение видео на стороне клиента может выглядеть в виде рассыпания изображения на мелкие квадраты по причине потери отдельных видеокадров. При использовании протокола транспортного уровня TCP ухудшения, как правило, выражены в задержках и замирании изображения. В случае большой потери пакетов воспроизведение видео перестанет проигрываться при использовании обоих протоколов. Задача повышения и анализа качества передаваемого видеопотока является весьма актуальной. Для ее решения требуется изучить влияние различных сетевых параметров на качество передаваемых мультимедийных потоков. Особенно востребованы подобные исследования при создании и тестировании новых мультимедийных сервисов и систем. Данные о влиянии сетевых помех на качество видеопотока могут быть получены с помощью пассивного эксперимента, т. е. путем наблюдения за реальными потоками. Более перспективным выглядит проведение активного эксперимента, т. е. моделирование помех искусственным образом с помощью программного обеспечения ПО или специального оборудования. На сегодняшний день существует оборудование и ПО для эмулирования сетевых помех, например, устройство Linktropy 5500 WAN Emulator или ПО WANem Wide Area Network Emulator. Оборудование Linktropy 5500 WAN Emulator, предлагаемое компанией Apposite Technologies, позволяет эмулировать ширину сетевого канала, задержку пакетов, джиттер, потерю пакетов, перегрузку сетевого канала в лабораторных условиях 2. Одно из основных предназначений устройства это тестирование разрабатываемых клиент-серверных приложений, мониторинг трафика. Например, Linktropy 5500 WAN Emulator может эмулировать сетевую задержку от 1 мс до 10 с. Настройка и управление устройством осуществляются через веб-интерфейс. Программное обеспечение WANem тоже позволяет эмулировать различные характеристики сети 3. Преимущество WANem перед Linktropy 5500 WAN Emulator заключается в том, что это ПО распространяемое бесплатно. В качестве недостатков можно отметить необходимость использования дополнительного компьютера для установки WANem, а также меньшую функциональность, например, отсутствие интерфейса мониторинга передаваемого трафика. Представленные сетевые эмуляторы не содержат инструментов для оценки параметров состояния плеера и качества мультимедийных потоков на стороне клиента. Созданная система имитационного моделирования мультимедийных потоков с сетевыми помехами позволяет не только эмулировать различные типы мультимедийных потоков, но и оценивать их качество. Предлагаемая система включает в себя инструменты оценки результатов экспериментов. Система моделирования сетевых помех рис. 1 включает следующие элементы веб-интерфейс управления Management базу данных Mysql Database и веб-сервер Apache Web Server медиа-сервер и видеокодер Streaming Server и WireCast соответственно сетевой эмулятор WANem Flash-медиа-плеер и компьютер клиента Player. Для установки и использования системы достаточно одного рабочего стола. Размеры стола напрямую зависят от размеров используемых для экспериментов компьютеров. Веб-интерфейс управления это набор PHPскриптов, хранящихся на веб-сервере. Функционал данного элемента системы обеспечивает просмотр списка проведенных экспериментов в веббраузере с возможностью получения детальной информации о каждом проделанном эксперименте. Информация по каждому эксперименту выводится в виде интерактивных графиков, отражающих изменения различных параметров состояния воспроизведения плеера рис. 2. Также в этот элемент входит веб-интерфейс настройки и запуска сетевого эмулятора WANem рис. 3. Данный элемент системы позволяет добавлять описания эксперимента в базу данных. При этом существует разработанное стандартное описание экспериментов по умолчанию, в котором необходимо только указать значения эмулируемых сетевых параметров будущего эксперимента. Для запуска эксперимента необходимо выбрать и загрузить через веб-интерфейс управления HTMLстраницу со встроенным Flash-плеером. Flashплеер запускается на компьютере клиента. Сразу после загрузки данной страницы интернет-браузером Flash-медиа-плеер начинает автоматически отсылать параметры состояния воспроизведения мультимедийного потока в удаленную базу данных Mysql. База данных системы моделирования сетевых помех состоит из двух таблиц и . Таблица включает информацию об экспериментах и содержит три столбца идентификатор эксперимента, название эксперимента и описание эксперимента. Таблица содержит значения параметров воспроизведения мультимедийных потоков, полученные от Flash-медиа-плеера например, количество потерянных видеокадров, текущий размер буфера плеера и др. Таблицы и связаны между собой через идентификатор эксперимента Компьютерная программа WireCast 4 выступает в роли видеокодера и предназначена для передачи на сервер мультимедийных потоков с разными битовыми скоростями в реальном режиме времени. Видеокодер WireCast установлен и работает на отдельном компьютере. На медиа-сервере применяется ПО Flash Media Streaming Server. Для передачи мультимедийных потоков в режиме реального времени используется протокол RTMP Real Time Messaging Protocol. Разработанная система моделирования сетевых помех позволяет задействовать разные медиа-серверы, например Wowza Media Server. Таким образом, возможно исследовать зависимость качества принимаемых мультимедийных потоков не только от сетевых ухудшений, но и от используемого в экспериментах медиа-сервера. Сетевой эмулятор WANem установлен и настроен на сервере, который расположен между медиа-сервером и клиентом. Для того чтобы сетевой мультимедийный трафик передавался не напрямую от сервера к клиенту, а через WANem, необходимо прописать соответствующие маршруты в таблицах маршрутизации медиа-сервера и клиента. В предлагаемой системе используется расширенный режим настроек эмуляции Advanced Mode ПО WANem. В этом режиме доступно эмулирование различных характеристик сети, а также создание своих собственных правил. Рассмотрим реальный пример того, как осуществляются настройка сетевого трафика и перенаправление его от медиа-сервера к клиенту и наоборот через сетевой эмулятор WANem рис. 4. Ниже представлены IP-адреса медиасервера, сетевого эмулятора WANem и компьютера клиента медиа-сервер Flash Media Streaming Server 10.33.17.243 сервер с сетевым эмулятором WANem 10.33.17.81 клиентский компьютер с Flash-медиа-плеером 10.33.17.242. Сервер, на котором установлен сетевой эмулятор WANem, в представленной системе имеет только один сетевой интерфейс. Все три компьютера находятся в одной локальной сети и имеют IP-адреса из одной подсети. Для того чтобы пакеты с клиентского компьютера до сервера проходили через сетевой эмулятор WANem, а не напрямую, необходимо прописать маршрут в таблице маршрутизации клиентского компьютера. На компьютере с операционной системой Windows нужно открыть консоль командная строка и выполнить команду Для того чтобы пакеты с сервера до клиентского компьютера проходили через сетевой эмулятор WANem, на сервере необходимо выполнить следующую команду В данной схеме Flash-медиа-плеер подключается к серверу, получает и воспроизводит мультимедийный поток в реальном режиме времени. Таким образом, у экспериментатора есть возможность эмулировать различные сетевые помехи с помощью WANem и влиять на качество передаваемых мультимедийных потоков. Flash-медиа-плеер это программный видеоплеер, который используется для воспроизведения мультимедийных потоков. Компьютер, на котором запускается Flash-медиа-плеер, обозначается как компьютер клиента и предназначается для визуального мониторинга качества воспроизводимых мультимедийных потоков. Параллельно с визуальным наблюдением экспериментатором качества воспроизводимого мультимедийного потока Flash-медиа-плеер отправляет свои собственные параметры состояния воспроизведения мультимедийного потока в удаленную базу данных. Для созданной системы в качестве плеера используется Strobe Media Playback 5 свободно распространяемый Flash-медиа-плеер с открытым исходным кодом. Для экспериментов плеер был запрограммирован таким образом, чтобы перед началом воспроизведения мультимедийного потока он накапливал буфер данных, равный 10 с, и затем начинал отображение видеопотока. В данной системе реализовано два варианта отправки плеером параметров в базу данных Mysql. Первый способ посредством самого плеера, запрограммированного специально для этих целей, и второй способ с помощью ПО, написанного на Java Script, которое в данном случае выступает в роли посредника меду плеером и базой данных. Интервал отправки параметров в базу данных считается в секундах и может изменяться экспериментатором. В качестве интернет-браузера используется Internet Explorer 9.0. Последовательность проведения эксперимента состоит из следующих шагов в первую очередь, в веб-интерфейсе управления создается эксперимент и его описание, которые сохраняются в таблице базы данных Mysql. Описание эксперимента включает в себя информацию об эмулируемых сетевых параметрах, характеристиках передаваемого потока и др. Далее задается номер предстоящего эксперимента. Все операции взаимодействия с базой данных осуществляются через веб-интерфейс администратора. На следующем шаге происходит настройка видеокодера и сетевого эмулятора WANem. В настройках видеокодера устанавливается битовая скорость транслируемого мультимедийного потока, например 1500 Кбитс, а также остальные параметры кодирования потока рис. 5. В качестве источника сигнала на входе видеокодера используется образовательное видео, созданное для экспериментов. Продолжительность видео составляет 182 с. Через веб-интерфейс сетевого эмулятора WANem задаются значения сетевых параметров, которые будут выступать в роли сетевых помех. После этого необходимо запустить трансляцию мультимедийного потока с видеокодера на сервер и загрузить HTML-страницу со встроенным Flash-плеером. Время проведения эксперимента чуть больше или равно продолжительности видеофайла. По окончании проведения эксперимента с помощью веб-интерфейса управления можно посмотреть графики изменения параметров воспроизведения мультимедийных потоков. Предусмотрена функция получения сводных оценок проведенных экспериментов при выборе и загрузке веб-страницы Results результаты. Определение величины битовых потоков, удовлетворяющих конечных пользователей, основано на анализе параметров, полученных от плееров удаленных пользователей. Были выбраны следующие четыре характеристики. время начала воспроизведения время, при котором первое значение количества воспроизводимых видеокадров в секунду больше 24. минимальное количество кадров в секунду, которое было зафиксировано в течение воспроизведения мультимедиа-потока. Стандартное значение FPS 25 кадрам в секунду для оригинального потока, но в некоторых случаях оно может уменьшаться например, если процессор компьютера загружен и не успевает отображать все кадры, тогда происходит потеря кадров. максимальный скачок потери кадров, который был зафиксирован в течение воспроизведения мультимедийного потока. минимальный размер буфера в секундах, который был зафиксирован в течение всего воспроизведения мультимедийного потока. Была поставлена задача можно ли по этим четырем характеристикам определить качество мультимедийного потока. Разработанная система применялась для планирования и проведения ряда экспериментов. На основе проведенных экспериментов были сформированы две выборки обучающая и контрольная. Обучающая выборка включала данные по 129 экспериментам, а контрольная по 66. Все эксперименты проводились для пяти потоков с разными битовыми скоростями. Подбор вида функции основывался на физических соображениях об исследуемом процессе. На основе обучающей выборки было обнаружено, что дискриминантная функция вида обладает требуемым качеством. Из 129 экспериментов в 128 сравнение показало совпадение результатов обоих используемых подходов оценки качества. В ходе проведения 66 экспериментов контрольной выборки результаты всех экспериментов, полученные с помощью критерия оценки, совпали с визуальным наблюдением 6. Полученный критерий оценки качества используется в разработанной системе. Создана система моделирования сетевых помех, которая применяется для эмулирования сетевых параметров и оценки качества образовательных мультимедийных потоков, передаваемых в режиме реального времени в IP-сети. Под оценкой качества в данном случае понимается определение величины битового потока битрейта, удовлетворяющего конечных пользователей. Система может использоваться для исследования и тестирования новых мультимедийных сервисов и систем, выявления сетевых проблем и проверки создаваемых критериев оценки качества мультимедийных потоков. Система уже была успешно апробирована при решении проблем, возникших в реальных условиях во время трансляции мультимедийных потоков в сети ПетрГУ. Как выяснилось, в ходе использования системы наиболее существенное влияние на качество передаваемых мультимедийных потоков оказывают потери сетевых пакетов. При этом, чем больше битрейт мультимедийного потока, тем меньшее количество потерянных пакетов требуется для ухудшения качества видеопотока при заданной ширине сетевого канала. На основе разработанной системы предполагается создание ПО, реализующего распределенную сеть оценки качества мультимедийных потоков, передаваемых между университетами. Работа выполнена при финансовой поддержке Программы стратегического развития ПетрГУ в рамках реализации комплекса мероприятий по развитию научно-исследовательской деятельности. 