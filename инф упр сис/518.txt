МЕТОДЫ КЛАССИФИКАЦИИ В ДИАГНОСТИКЕ  УРОЛИТИАЗА С ПРИМЕНЕНИЕМ НЕЧЕТКОЙ ЛОГИКИ  ДЛЯ ПРЕДОБРАБОТКИ ДАННЫХ 

Рассматривается задача построения классификатора для диагностики уролитиаза с предварительной обработкой данных, включающей снижение размерности и применение нечеткого вывода. Классифицирующие правила выбираются из деревьев решений, фаззифицируются и валидируются медиком-экспертом. Полученные результаты показывают, что предлагаемые методы предварительной обработки данных улучшают точность диагностики уролитиаза.

Выявление и адаптация приемлемого подхода для анализа многомерной медицинской информации непростая задача. Рассматривается диагностика уролитиаза по данным общего и биохимического анализа мочи и крови. Уролитиаз является распространенным заболеванием, им страдают более 38 пациентов уролитических стационаров. Несмотря на современные эффективные и дорогостоящие методы лечения, очень часто возникает рецидив заболевания. Стандарты уролитической помощи не содержат методов ранней диагностики урологических заболеваний, и настоящее исследование направлено на заполнение этого пробела. В работе использовались методы классификации, доказавшие свою состоятельность при построении систем поддержки принятия решений в медицине и биологии 1, 2. Предобработка данных заключалась в снижении размерности методом главных компонент и конструировании атрибута с применением нечеткой логики. Исходные данные состоят из количественных и порядковых атрибутов шкалу порядка см. в работе 3. Множество значений порядкового атрибута не отражает результат подсчетов или измерений, но на нем введен порядок, соответствующий уровням, степеням, стадиям и т. п. Формирование области значений порядкового атрибута связано с загрублением соответствующей характеристики исследуемого объекта. Например, атрибут холодовая проба имеет два значения 0 не выпал осадок, 1 выпал осадок. В пограничных ситуациях специалист вынужден выбрать одно из этих значений, хотя вербально он бы сформулировал мутная жидкость, небольшой осадок и т. п. Введение лингвистических переменных позволяет описать пограничные состояния, увеличив количество информации по сравнению с порядковой шкалой. В настоящем исследовании подтверждается, что применение лингвистических и нечетких правил повышает качество диагностики уролитиаза. В качестве атрибутов многомерной медицинской информации выступали 18 показателей общего и биохимического анализов крови и мочи, наиболее применимые в медицинской практике 4, 5 относительная плотность, Ph, фосфор неорганический 0,831,48 ммольл крови, осмолярность мочи 500900, цитрат, оксалат, холодовая проба, калий в моче, альбумин в крови, кальций ионизированный 1,061,32 ммольл, экскреция тируемых кислот ммольл, мочевина мочи, соли, С-реактивный белок 0,007,5 мгл, цвет, прозрачность, белок гл, бактерии. Исходные данные представлены в виде как порядковых холодовая проба, цвет, прозрачность, бактерии, так и количественных остальные 14 показателей атрибутов. В исследовании применялись пять классификаторов метод опорных векторов, метод -ближайших соседей, наивный байесовский классификатор, нейронные сети и метод деревьев решений. В задаче диагностики рассматривается два класса здоров и болен уролитиазом. Для предобработки данных использовались метод главных компонент, нечеткие правила и выводы. Исследуемая выборка состояла из двух групп. Группа больных уролитиазом составила 45 чел. 22 женщины, 23 мужчины в возрасте от 25 до 60 лет. При обучении классификатора эта группа была сопоставлена с классом здоровые. Группа контроля была сформирована из 35 практически здоровых добровольцев, сопоставленная с классом больные. Группа контроля сопоставима с группой больных по полу и возрасту. Классификаторы были построены с помощью программного обеспечения Rapid Miner. Для вычислений методом главных компонент использовалась программа MatLab версия 5. Разработка нечетких правил осуществлялась в пакете Fuzzy Logic Toolbox. Нечеткие рассуждения основаны на понятии лингвистической переменной, которое будет использоваться для всех порядковых атрибутов. Применение нечетких правил к полученным лингвистическим переменным даст нечеткую оценку наличия заболевания для каждого пациента, которая затем дефаззифицируется в выходную переменную с целочисленной областью значений на отрезке от 0 до 10. В результате генерируется новый атрибут, добавляемый к исходным. Основной набор правил выбирается из деревьев решений при помощи эксперта и фаззифицируется. Деревья решений строятся на порядковых атрибутах при помощи известных алгоритмов классификации. Классов, как и в основной задаче диагностики уролитиаза, два здоров, болен. В нечеткой модели предполагается использовать 4 входные переменные и одну выходную переменную рис. 1, табл. 1. В качестве в форме соответствующей системы нечеткого вывода. При построении нечеткой модели оценки вероятности обнаружения у пациента наличия уролитиаза была использована шкала в баллах в интервале от 0 до 10. Следующим этапом построения модели является построение базы нечетких правил. Для этой цели использовались четкие правила, сгенерированные на основе деревьев решений. Стандартные деревья решений построены на всех атрибутах и только на порядковых имеют небольшую точность согласно кросс-валидации. Поэтому эксперту было предоставлено дерево решений, построенное на порядковых атрибутах рис. 2, и набор деревьев решений, полученных согласно процедуре классификации случайный лес. Эксперт выбирал правила из деревьев решений и на их основе формулировал собственные нечеткие правила. Всего экспертом была сформулирована 71 нечеткая продукция табл. 2. На рис. 2 жирными стрелками выделены два правила, которые эксперт использовал явным образом в нечеткой системе правила 16, 26. Метод Мамдани использован в качестве схемы нечеткого вывода, методом активации является MIN. Во всех шагах в качестве логической связки для подусловий применяется только нечеткая конъюнкция операция И, поэтому в качестве метода агрегирования использовалась операция min-конъюнкции. Для аккумуляции заключений входных переменных используются только качественные параметры многомерных медицинских данных. В качестве выходной переменной используется вероятность обнаружения у пациента наличия мочекаменной болезни. После определения содержательной постановки задачи была построена ее нечеткая модель -ближайших соседей, наивный байесовский классификатор, нейронные сети. Оценка классификаторов производилась с помощью методов кросс-валидации. В качестве примера на рис. 3 показано различие между точностью классификации пациентов согласно кросс-валидации с использованием метода опорных векторов. Результаты точности работы всех классификаторов без предобработки и с предобработкой сведены в табл. 3. Классификаторы без предобработки показали довольно посредственный результат точность определения наличия заболевания с помощью процедуры кросс-валидации составила в среднем 57,19 . Уровень точности после снижения размерности повысился в среднем на 2,19, данное значение остается посредственным 59,38 . Такой результат можно объяснить загрубленной оценкой порядковых атрибутов. Фаззифицируя эти атрибуты с помощью лингвистических переменных, эксперты могут дать больше информации о градации соответствующих данных. В результате использования нечетких правил набор исходных атрибутов дополнился новым атрибутом, отражающим вероятность наличия заболевания по порядковым атрибутам. Уровень точности после добавления нового атрибута в среднем увеличился на 3,13 и составил правил использовался метод max-дизъюнкции. В качестве метода дефаззификации планируется использовать метод центра тяжести. Для определения уровня точности использовались метод опорных векторов, метод 60,31 . Такой уровень уже можно признать удовлетворительным. В данной статье приведен пример использования нечеткой логики в совокупности с методами интеллектуального анализа данных Data Mining и привлечением эксперта. Нечеткие правила были сформулированы с применением деревьев решений и привлечением эксперта заведующего кафедрой клинической лабораторной диагностики с курсом молекулярной СПбГМУ им. академика И. П. Павлова, доктора медицинских наук, профессора В. Л. Эмануэля. Совместное применение нескольких математических методов обработки данных позволило повысить точность классификации, согласно результатам кросс-валидации, в среднем на 4,06 . Максимальное увеличение точности было достигнуто с использованием классификатора на основе метода опорных векторов и составило 8,75 . 