ИНФОРМАЦИОННО-ИЗМЕРИТЕЛЬНЫЕ СИСТЕМЫ ОЦЕНИВАНИЕ РЕЗУЛЬТАТОВ ИЗМЕРЕНИЙ   ПО МАЛЫМ ВЫБОРКАМ 

Описаны классические средние и их обобщения, сформулированы ограничения на функцию оценивания. Приведены сведения о средних по Коши, Колмогорову и квазисредних. Дана геометрическая интерпретация функций оценивания и предложены новые алгоритмы оценивания на основе методов технической диагностики.

Один из важных разделов метрологии связан с обработкой результатов многократных измерений неизвестной величины. В частности, речь может идти о выходных сигналах нескольких датчиков, измеряющих одну и ту же величину, например температуру, давление или навигационные параметры. Алгоритм обработки измерительных данных существенно зависит от размера полученной выборки. Во многих практически важных случаях эта выборка оказывается слишком малой для применения статистических методов обработки, которые могут быть использованы только при 4 1. Примером служит измерение параметров уникальных процессов и явлений, таких как характеристики ядерного взрыва. Другим примером является сличение национальных измерительных эталонов в целях установления степени их эквивалентности. В них участвует сравнительно небольшое число лабораторий, причем для некоторых видов измерений число участников сличений ограничивается двумятремя. В технике для повышения надежности аппаратуры часто используют параллельное включение трех однотипных блоков с последующим осреднением их выходных сигналов. Подобный подход широко применяется для улуч шения надежности бортовой аппаратуры сервоприводов, автопилотов, измерительных датчиков, бортовых цифровых вычислительных машин. Во всех случаях возникает задача математической обработки полученных измерений, и формирования оценки При 3 она известна как задача о трех измерениях. Ее отличает простота формулировки в сочетании с глубиной содержания и нетривиальностью результатов. В простейшей постановке эта задача сводится к следующему. Имеются результаты трех измерений, неизвестной величины . Требуется на их основе сформировать по возможности более точную оценку величины . При этом центральной задачей является выбор вида функциональной зависимости Один из естественных способов вычисление среднего арифметического вполне удовлетворителен, когда все три показания близки. Если же одно из трех показаний содержит грубую ошибку, то средняя арифметическая оценка дает неадекватный результат. Более надежной в этом смысле является оценка типа выборочной медианы, согласно которой крайние измерения отбрасываются, а за оценку принимается оставшееся измерение. В статье описываются методы оценивания на основе классических средних и предлагаются новые алгоритмы, опирающиеся на использование принципов технической диагностики. В настоящее время известно множество алгоритмов оценивания результатов измерений, обладающих различными точностными, надежностными и другими характеристиками. Рассмотрим наиболее известные из них, начиная с классических методов осреднения. Средним арифметическим чисел, называется величина Для случая двух и трех измерений среднее арифметическое определяется формулами Среднее арифметическое самое известное и распространенное из всех средних. Его название связано с тем, что каждый член арифметической прогрессии, начиная со второго, равен среднему арифметическому его соседних членов. Средняя арифметическая оценка является оптимальной по квадратическому критерию. В соответствии с ним минимизируется сумма квадратов расстояний от точки до точек В этом можно убедиться, выполняя дифференцирование и приравнивая производную нулю. Среднее арифметическое является наилучшей оценкой по методу максимального правдоподобия при равноточных измерениях с гауссовыми погрешностями. Оба эти факта, в сочетании с вычислительной простотой оценки, обусловили ее широкое практическое распространение. Средним геометрическим нескольких положительных чисел, называется величина Для случая двух и трех измерений среднее геометрическое определяется формулами Название этого среднего связано с тем, что каждый член геометрической прогрессии с положительными членами, начиная со второго, равен среднему геометрическому его соседних членов. Средняя геометрическая оценка минимизирует сумму квадратов логарифмических уклонений В прикладной статистике среднее геометрическое полезно при нелинейной шкале измерений. Чаще всего среднее геометрическое находит свое применение при определении средних темпов роста средних коэффициентов роста, когда индивидуальные значения признака представлены в виде относительных величин. При анализе систем управления используется понятие о среднем геометрическом корне характеристического уравнения. Средним гармоническим чисел, называется величина Таким образом, среднее гармоническое это число, обратная величина которого является средним арифметическим обратных величин данных чисел. По этой причине его называют еще обратным средним арифметическим. Название среднее гармоническое связано с хорошо известным в математике гармоническим рядом. Для случая двух и трех измерений среднее гармоническое определяется формулами Оно минимизирует сумму квадратов уклонений обратных величин С помощью среднего гармонического вычисляется средняя скорость на эстафете, если известны скорости на отдельных этапах и длины всех этапов. Оно используется также при расчете средней продолжительности жизни, средней цены продукции при известных объемах продаж в нескольких торговых точках. Заметим, что вид, близкий к среднему гармоническому, имеют формула фокусного расстояния линзы, формула параллельного соединения сопротивлений и формула жесткости последовательно соединенных пружин. Средним квадратическим чисел, называется величина Для случая двух и трех измерений среднее квадратическое определяется формулами Оно минимизирует критерий Среднее квадратическое находит применение во многих приложениях. В частности, через него определяются такие понятия теории вероятностей и математической статистики, как дисперсия и среднее квадратическое отклонение. К перечисленным средним тесно примыкают еще две оценки и из полученных измерений. Для случая трех измерений они имеют вид и т. е. в качестве оценки берется наименьшее или наибольшее из трех значений измерений. В совокупности получаем шесть классических средних, широко применяющихся при обработке измерений. Для случая двух измерений классические средние допускают красивую геометрическую интерпретацию. Пусть среднее арифметическое двух положительных чисел и, их среднее геометрическое, среднее гармоническое, среднее квадратическое, минимальное и максимальное из чисел и . Геометрическая интерпретация этих средних как некоторых отрезков в трапеции с основаниями и представлена на рис. 1. Все отрезки, параллельны основаниям трапеции. Отрезок, длина которого равна среднему гармоническому, проходит через точку пересечения диагоналей трапеции. Отрезок, соответствующий среднему геометрическому, делит трапецию на две подобные части. Отрезок это средняя линия трапеции, ее длина равна полусумме оснований, т. е. их среднему арифметическому. Отрезок, длина которого равна среднему квадратическому, делит трапецию на две равновеликие по площади части. Наконец, сами основания, равные максимальному и минимальному из чисел, представляют собой крайние случаи средних значений. Другой способ графического представления средних двух чисел показан на рис. 2, где приведены графики кривых для всех шести средних. Они построены в предположении, что число постоянно, а число принимает различные положительные значения. При все кривые пересекаются. Штриховкой выделены запрещенные области, в которых никакое среднее двух чисел не может находиться по определению, среднее должно находиться между числами и . Среднему арифметическому на рис. 2 отвечает прямая, среднему геометрическому парабола, повернутая на 90, среднему гармоническому гиперболическая кривая. Кроме рассмотренных классических средних существует много других. В частности, любая монотонная кривая, лежащая в незаштрихованном секторе рис. 2, будет соответствовать некоторому среднему. Цепочка неравенств, связывающих средние значения справедлива для любого числа измерений. минимизирует который равен сумме модулей расстояний, от значений измерений до оценки рис. 3. Минимум этого критерия достигается, если совместить со средним из трех значений измерения, т. е. если взять Такая оценка называется используются также названия мажоритарная функция или функция голосования и обладает многими любопытными свойствами. В частности, она малочувствительна к возможным вариациям законов распределения помех, т. е. является робастной. Важно, что эту оценку можно использовать и при погрешностях промахах, ошибках высокого уровня, например, при однократных отказах датчиков, когда одно из измеренных значений сильно отличается от двух других. Подобное свойство называют надежностью или устойчивостью оценки. Отметим, что ранее приведенные оценки таким свойством не обладают., или параметра имеет вид Эта оценка называется минимаксной, так как она минимизирует критерий т. е. максимальное из трех уклонений, . Минимум этого критерия представляется оценкой, расположенной ровно посредине интервала измерений. Средняя точка при этом игнорируется отбрасывается подобно тому, как в предыдущей оценке отбрасывались крайние точки. Отдельный класс оценок задается формулой где любое число, 0. В случае трех измерений получаем оценку которая минимизирует критерий К классу средних степенных принадлежат и некоторые из приведенных выше оценок в частности, при 1 получаем среднее арифметическое, при 1 среднее гармоническое, при 2 среднее квадратическое. При и в качестве оценки берется наименьшее или наибольшее из значений измерений. Все средние оценки, рассмотренные выше, обладают свойством симметрии по отношению к значениям измерений. Перестановка аргументов, в этих средних не меняет итоговой оценки. На практике такие средние можно применять в случае равноточных измерений. Если же измерения неравноточные, то их следует включать в формулы, домножая на соответствующие весовые коэффициенты, учитывающие значения погрешности отдельных измерений. Получаемые при этом оценки называются взвешенными и уже не обладают свойством симметрии. набора чисел, с положительными весами, сумма которых равна единице, определяется как Если сумма весов не равна единице, то в приведенной формуле добавляется нормирующий множитель Обычно веса берутся обратно пропорциональными квадратам соответствующих средних квадратических отклонений. Для случая двух и трех измерений взвешенное среднее арифметическое определяется формулами набора положительных чисел, с положительными весами, определяется как набора чисел, с положительными весами, определяется формулой набора чисел, с положительными весами, рассчитывается по формуле . Минимизация критерия где некоторые весовые коэффициенты, приводит к взвешенной медианной оценке, совпадающей с одним из значений измерений. Как и ранее, весовые коэффициенты позволяют учитывать важность тех или иных измерений. Пусть по-прежнему, экспериментальные значения измерений, по которым необходимо построить оценку неизвестной скалярной величины . Будем полагать, что априорная информация отсутствует. Тогда, обозначая функцию оценивания через, можно записать При этом функция оценивания должна удовлетворять некоторым математическим ограничениям общего характера. Например, логично потребовать, чтобы оценка принадлежала тому же отрезку оси, что и значения измерений, 1 Отсюда, как следствие, получаем, что если все три значения измерений одинаковы, то оценка должна совпадать с ними при . Геометрически неравенство 1 можно проиллюстрировать с помощью рис. 4, на котором по оси абсцисс откладываются значения измерений, а по оси ординат оценка При построении графиков на этом и следующих рисунках предполагается, что измерения, помеченные на оси абсцисс вертикальными черточками, фиксированы, причем 0, а измерение пробегает все возможные значения из диапазона 0 . Штриховкой на рисунке выделена область, не удовлетворяющая неравенству 1. Границы ее определяются функциями представляющими два предельных случая оценок. Графики всех возможных функций оценивания должны лежать в незаштрихованной области. В качестве примера на рис. 4 показан график, отвечающий средней арифметической оценке Графики функций шести классических средних для трех значений измерений представлены на рис. 5. Аналогичные графики для случая двух измерений были показаны на рис. 2. Рассмотрим другой способ геометрического представления функции оценивания 2 Уравнение 2 описывает поверхность в четырехмерном пространстве, характер которой зависит от вида функции . Представление об этой поверхности можно получить, если фиксировать только один аргумент например, и рассматривать как функцию двух остальных аргументов. Геометрически этому будут соответст вовать поверхности в трехмерном пространстве с координатными осями, . Рассмотрим, например, поверхности для функций 3 построенные при условии 1. Совмещая их на одном графике, приходим к рис. 6, где буквой обозначена единственная общая точка обеих поверхностей. Она лежит на биссектрисе первого октанта и имеет координаты 1, 1, 1. В соответствии с условием 1 рис. 6 наглядно задает область, которой могут принадлежать функции оценивания. Поверхность, отвечающая любой такой функции, должна проходить через точку и лежать между поверхностями 3. Области ниже уровня и выше уровня являются запрещенными. На рис. 7 показана поверхность для выборочной медианы построенная для 1. Впервые условие 1 было введено французским математиком О. Л. Коши 2. Он дал следующее определение средней величины, известное также как определение. . Средней величиной действительных чисел, ..., является любая функция, ..., такая, что при всех возможных значениях аргументов значение этой функции не меньше, чем минимальное из чисел, ..., и не больше, чем максимальное из этих чисел Функция такого вида называется средней по Коши. Заметим, что среднее от одинаковых чисел равно их общему значению. Все рассмотренные выше виды средних величин являются средними по Коши. Гораздо более жесткие требования к функции, ..., предъявляются при определении средних, принадлежащем советскому математику академику А. Н. Колмогорову. . Непрерывная действительная функция, ..., от неотрицательных переменных называется средним, если для любых, ..., 0 выполняются условия 1 min, max, т. е. функция усредняет любой набор из неотрицательных чисел 2, т. е. большему набору аргументов соответствует большее значение функции 3 при любой перестановке чисел, значение функции не меняется 4, . В 1930 г. А. Н. Колмогоров доказал 3, что функция, ..., удовлетворяющая этим условиям, имеет вид 4 где непрерывная строго монотонная функция, а функция, обратная . Функция такого вида называется . Она непрерывна и монотонна по каждому аргументу . Укажем два свойства средних по Колмогорову как и ранее, среднее от одинаковых чисел равно их общему значению некоторую группу значений можно заменить их собственным средним, не меняя общего среднего. Отметим также несколько важных частных случаев функции . При получаем среднее арифметическое при ln среднее геометрическое при среднее гармоническое при среднее квадратическое при, 0 среднее степенное. Очевидно, что среднее по Колмогорову частный случай среднего по Коши, от которого требовалось обладать только свойством усреднения. В частности, любые взвешенные средние нельзя представить в виде средних по Колмогорову, поскольку они не обладают свойством симметричности. Отказавшись от требований симметричности и однородности, получаем следующее обобщение функции Колмогорова 4. 4. Квазисреднее неотрицательных чисел, есть величина вида где 0, 1, при условии, что функция непрерывна и монотонна на промежутке, содержащем . В частности, при получаем взвешенное среднее арифметическое, при ln взвешенное среднее геометрическое, при взвешенное среднее степенное. Очевидно, что квазисредние включают и обычные средние не взвешенные, если взять 1 для всех номеров и те же функции ln, . Эти частные случаи квазисредних удовлетворяют всем условиям определения средней величины. Обозначим через класс функций, удовлетворяющих определению Коши. Он чрезвычайно широк и включает в себя, как частные случаи, средние по Колмогорову и квазисредние. Соображения, приводящие к выбору той или иной функции, т. е. того или иного алгоритма оценивания, часто формулируются в виде некоторых эвристических принципов, таких как принцип голосования, принцип исключенного среднего, гипотеза компактности, принцип доверия большинству, принципы диагностики и коррекции, способ избыточных переменных и др. В зависимости от вида функций различают линейные, квазилинейные и нелинейные оценки. В книге 1 приводится несколько десятков функций и соответствующих им алгоритмов оценивания, часть из которых совпадает со средними оценками, рассмотренными ранее. Ряд алгоритмов оценивания можно получить, используя принципы и методы технической диагностики, в первую очередь идеи функционального диагностирования в системах с алгебраическими инвариантами и метод избыточных переменных МИП. Напомним, что согласно 5, системами с алгебраическими инвариантами называются системы, выходные сигналы, ..., которых удовлетворяют хотя бы одному алгебраическому соотношению вида причем при отсутствии ошибок это соотношение должно выполняться для любых входных сигналов и в любой момент времени. В рассматриваемом случае исследуемая система описывается уравнениями 5 где роль входного сигнала играет неизвестная измеряемая величина, а роль выходных сигналов значения измерений, . При отсутствии погрешностей промахов, ошибок, сбоев выходные сигналы этой системы удовлетворяют двум независимым линейным алгебраическим соотношениям алгебраическим инвариантам 6 Последние уравнения удобно записать в матричной форме 0, В реальных условиях погрешности ошибки 0, поэтому вектор рассогласований, где, будет также отличен от нуля. Для повышения точности и достоверности результата измерений естественно попытаться использовать информацию о неизвестных погрешностях, содержащуюся в векторе . В рамках МИП исследованы два подхода к использованию такой информации коррекция значений измерений, содержащих малые погрешности ошибки обнаружение, локализация и отбраковка исключение, отбрасывание недостоверных значений измерений, содержащих погрешности ошибки высокого уровня. Изложение соответствующих результатов для динамических систем с произвольными алгебраическими инвариантами имеется в работах 57. Ниже дается конкретизация их для системы, описываемой уравнениями 5 и 6. Предположим, что погрешности ошибки имеют малые значения лежат в допуске и вероятностью появления недостоверных измерений отказов датчиков можно пренебречь. Тогда для повышения точности оценивания можно использовать принцип коррекции ошибок, применяемый в МИП. В данном случае он сводится к следующему. Подставив в соотношение 6 реальные значения сигналов из 5, получаем . Таким образом, сигнал несет информацию о векторе погрешностей, содержащихся в значениях измерений. Идея коррекции состоит в том, чтобы вычесть из вектора значений измерений оценку корректирующую поправку. Простейшая оценка получается псевдообращением матрицы 7 Выполняя вычисления для находим псевдообратную матрицу Следовательно, скорректированный вектор значений измерений определяется выражением Подставляя сюда из 5 и из 6, получим Таким образом, перераспределение погрешностей в результате коррекции привело к тому, что значения стали одинаковыми. Поэтому любое из них может быть взято за искомую оценку, т. е. результирующий алгоритм оценивания можно записать в виде Оценка, получаемая по этому алгоритму, совпадает со средним арифметическим, в чем можно убедиться подстановкой в оценочную функцию двух последних уравнений. Это объясняется тем, что коррекция на основе псевдообращения эквивалентна применению метода наименьших квадратов, который, как известно, приводит к средней арифметической оценке. Если погрешности независимы и имеют одинаковые дисперсии, то такая коррекция является оптимальной, обеспечивая уменьшение дисперсии ошибок в 3 раза. Если измерения неравноточные и известна корреляционная матрица погрешностей, то минимальной дисперсией обладает оценка, получаемая в соответствии с алгоритмом где вектор определяется соотношением 6. Можно показать, что эта оценка совпадает с оценкой. Обратимся теперь к ситуации, когда наряду с малыми погрешностями возможны однократные ошибки высокого уровня, к которым могут приводить, например, отказы или сбои датчиков. С точки зрения технической диагностики, в такой ситуации целесообразно определить номер недостоверного значения измерения и отбросить его, сформировав оценку по двум оставшимся значениям. Такой подход позволяет построить целую группу оценок, отличающихся алгоритмом диагностики, используемым для определения индекса значения недостоверного измерения, а также способом формирования оценки по оставшимся значениям. Дадим описание некоторых оценок, разработанных в рамках метода избыточных переменных и систем с алгебраическими инвариантами. В теории систем с алгебраическими инвариантами доказано, что для диагностики однократных ошибок необходимо иметь два независимых алгебраических инварианта, которые в линейном случае можно записать в виде 0, где прямоугольная матрица, имеющая две строки. От исходных алгебраических инвариантов путем их линейного комбинирования перейдем к системе зависимых инвариантов 8 где квадратная матрица с нулевой диагональю. Для системы 5 и алгебраических инвариантов 6 уравнение 8 будет иметь вид 9 Подставляя получаем Если одна из погрешностей будет значительно больше других, это приведет к существенному отклонению всех компонент вектора рассогласований, кроме одной, в которую она входит с нулевым коэффициентом. Это обстоятельство позволяет определить индекс недостоверного значения измерений и отбраковать его. Таким образом, алгоритм диагностики состоит в том, что из трех значений измерений, отбрасывается только одно, индекс которого совпадает с индексом минимальной из величин, . Оценка формируется по двум оставшимся значениям измерений назовем их например путем вычисления их среднего арифметического, среднего геометрического и т. п. Описанный переход от значений измерений, к значениям можно формально представить в виде где оператор отбраковки по минимальному рассогласованию задается 2 3 матрицей, в каждой строке которой один элемент равен единице, а остальные нулю. Например, матрица отбраковки первого измерения имеет вид Используя классические средние двух оставшихся значений измерений, можно получить шесть различных оценок. Идея этого алгоритма состоит в получении оценки вектора погрешностей на основе анализа рассогласований алгебраических инвариантов и отбраковки значения измерений, обладающего максимальной оценкой погрешности. Оптимальная в смысле метода наименьших квадратов оценка вектора погрешностей дается формулой 7, откуда для матрицы получаем 10 Из трех значений измерений, будем отбрасывать то, индекс которого совпадает с индексом максимальной из величин Обозначая, как и прежде, оставшиеся значения измерений через можно записать где оператор отбраковки по максимальной оценке погрешности, подобный оператору . Так же, как и выше, в зависимости от способа осреднения оставшихся значений измерений можно получить различные оценки. Кроме обработки измерений с помощью операторов и, можно предложить много других способов отбраковки. Можно, например, считать недостоверным и отбрасывать значение измерений, наиболее удаленное от среднего арифметического трех значений, от их среднего геометрического или от любой другой оценки из числа приведенных ранее. После этого два оставшихся значения измерений осредняются одним из известных способов. Отдельный класс образуют алгоритмы оценивания, использующие отбрасывание исключение, отбраковку двух значений измерений из трех. Они позволяют парировать не только однократные, но и некоторые двукратные отказы. Согласно этим алгоритмам в качестве оценки берется одно из значений измерений, а два других в оценке в явном виде не присутствуют. Классическими примерами алгоритмов с отбраковкой двух значений измерений являются алгоритмы использующие в качестве оценки максимальное, минимальное или среднее выборочное измерение. Возможны и другие варианты, когда, например, за оценку берется значение измерений, ближайшее к среднему арифметическому, среднему геометрическому или к любой другой средней оценке. Опишем два алгоритма оценивания такого рода, опирающиеся на приведенные выше диагностические процедуры. Первый из них состоит в том, что вычисляется вектор рассогласований 9 и из трех значений измерений, отбрасываются два, индексы которых совпадают с индексами рассогласований, имеющих меньшую абсолютную величину. Тем самым в качестве оценки берется измерение, которому соответствует наибольшее из рассогласований, . Обозначая оператор отбраковки, определенный таким образом, через число штрихов указывает на число отбрасываемых измерений, можем записать Согласно второму алгоритму отбраковываются два значения измерений, для которых оценка погрешностей, полученных по формуле 10, имеет наибольшую абсолютную величину. Тем самым в качестве оценки берется измерение с минимальной оценкой погрешности. Обозначая соответствующий оператор также через можем записать Таким образом, в статье описаны классические средние и их обобщения сформулированы ограничения на функцию оценивания, приведены сведения о средних по Коши, Колмогорову и квазисредних дана геометрическая интерпретация функций оценивания и предложены новые алгоритмы оценивания на основе методов технической диагностики. Полученные результаты могут быть использованы при обработке малых выборок измерительных данных в метрологии, технике, экономике и других областях. 