АЛГОРИТМ  СЕГМЕНТАЦИИ  ОБЪЕКТОВ В  ПОСЛЕДОВАТЕЛЬНОСТИ  ВИДЕОКАДРОВ МЕТОДАМИ  НЕЧЕТКОЙ  ЛОГИКИ 

Рассмотрен алгоритм автоматической сегментации изображений многих объектов интереса на базе математического аппарата нечеткой логики. Предложено учитывать достоверность векторов движения. Рассмотрены признаки и функции принадлежности блоков кластерам на начальном этапе кластеризации при неизвестном числе кластеров. Дана методика определения характеристик объектов. Определены признаки и функции принадлежности блоков объектам в ходе сопровождения. Показано разрешение ситуаций окклюзии (перекрытия объектов) и отождествления объекта после срыва сопровождения. The paper concerns an algorithm of automatic segmentation for multiple objects of interest on the basis of fuzzy logic, taking into account the reliability of moving vectors. We study the attributes and membership functions for blocks and clusters at the initial segmentation stage in the case of the unknown number of clusters. Methods of finding the object characteristics, such as gravity centers, form parameters, movement models, are given. The attributes and membership functions for blocks and objects during tracking are determined. Resolution for situations of occlusion (overlapping objects) and object identification after tracking failure are shown.

В прикладных видеокомпьютерных системах актуальной является задача автоматической сегментации и сопровождения многих объектов интереса. Априорная информация об объектах минимальна количество объектов неизвестно, даны лишь пределы изменения их размеров и скоростей перемещения в пересчете к экранной плоскости видеокамеры. Это определяет целесообразность использования для сегментации объектов совокупности признаков и математического аппарата нечеткой логики 1. Наиболее информативными признаками являются детальность, движение и форма 2. При решении задач сегментации и сопровождения объектов ТВ-кадр разбивают на фрагменты блоки. Размеры блока выбирают с учетом площади изображения минимального сегментируемого объекта и интервала усреднения, необходимого для достижения нужной точности оценки вектора смещения движения блока за время ТВ-кадра рис. 1. Размер блока 8 8 элементов признан оптимальным при решении многих задач. Тогда, для телевизионного кадра с разрешением 576 768 элементов общее число блоков равно 6912. Определение векторов движения для всех блоков сопряжено со значительными вычислительными затратами и непродуктивно, так как объекты интереса обычно занимают малую часть площади кадра. Поэтому перед началом обработки целесообразно разбить универсальное множество блоков на нечеткие множества с использованием математического аппарата нечеткой логики и ряда признаков параметров. Под параметром детальность будем понимать уровень высокочастотной энергии в блоке изображения. Для оценки уровня детальности используют предварительную обработку изображения вейвлет-преобразование, морфологический анализ, пространственное дифференцирование, выделение контуров с последующим подсчетом интенсивности высокочастотной энергии для каждого блока рис. 2. Например, при использовании пространственного дифференцирования по направлению детальность блока размером где яркость пикселя в кадре, координаты левого верхнего угла блока приращение координаты Введем модифицированную оценку детальности, инвариантную по отношению к уровню шума и коэффициенту передачи измерителя где оценка минимального уровня детальности в блоках, обусловленная шумами здесь число блоков в изображении. Блок с высокой детальностью является нечетким понятием переменной. Определим на универсальном множестве всех блоков кадра нечеткое множество блоков с высокой детальностью как совокупность пар где функция принадлежности элемента блока, к множеству . Чем выше значение тем в большей мере элемент универсального множества соответствует свойствам нечеткого множества. Функцию принадлежности обычно задают на основании опыта, априорных данных и пр. Поскольку при сегментации и сопровождении объектов важную роль играют векторы движения, включим в число свойств нечеткого множества корректность их определения. На основании экспериментальных данных построен график зависимости вероятности, верных значений векторов движения от уровня детальности блоков рис. 3. Анализ графика позволяет предложить для описания математическую модель где 3 параметр модели, численное значение которого найдено методом нелинейного программирования. Блоки множества относят к объектам интереса и фону см. рис. 2. Нечеткое множество блоки с низкой детальностью характеризуют функцией принадлежности Признак движения оценивают на основе энергии движения или оптического потока 3. Определение векторов движения для всех блоков кадра или области поиска является избыточным если в блоке кадра нет значимых изменений относительно кадра 1, то с большой вероятностью вектор движения равен нулю. Очевидно, что определять векторы оптического потока целесообразно только в тех блоках, где произошли какиелибо изменения. Модифицированная оценка этих изменений может быть получена на основе модуля межкадровой разности энергии движения в блоке здесь где яркости пикселя в текущем и предыдущем 1 кадрах оценка межкадровой разности блока, обусловленная присутствием шумов Введенная модифицированная оценка позволяет определить на универсальном множестве нечеткое множество блоков с высокими значениями энергии движения. Функция принадлежности к этому нечеткому множеству где 3 параметр модели, численное значение которого найдено на основе экспериментальных данных. Функция принадлежности к нечеткому множеству блоков с низкой энергией движения Чем ближе к единице, тем более вероятна значимая величина вектора движения для блока, Блоки подмножества с определенной вероятностью принадлежат движущимся объектам рис. 4. Достоверность этих суждений определяется постоянством яркости движущихся объектов во времени и уровнем их детальности в пространстве. На практике эти условия достаточно часто нарушаются. Блики, тени, полупрозрачные и слабо текстурированные поверхности, изменения средней освещенности приводят к появлению энергии движения на участках кадра, где на самом деле движения нет. Если детальность этих участков низкая, результатом поиска могут явиться так называемые аномальные векторы движения, не отражающие реальное движение. Наличие аномальных векторов в оцениваемом оптическом потоке приводит к последствиям, тяжесть которых определяется назначением системы. При устранении временной избыточности в системах видеосжатия аномальные векторы уменьшают коэффициент сжатия. Для задачи сегментации последствия будут более существенными учет аномальных векторов может вызвать рассегментацию объекта и снижает точность определения параметров его движения. С целью преодоления этих недостатков предложено дополнить двумерные векторы движения третьим компонентом оценкой его достоверности, где, составляющие вектора движения, по направлениям и . Предварительная оценка степени достоверности векторов движения позволяет снизить влияние аномальных векторов и резко сократить вычислительную нагрузку векторы движения следует искать только в тех блоках, где уровень достоверности достаточно высок. Пересечение нечетких множеств определяет подмножество, в котором найденные векторы движения обладают уровнем достоверности в соответствии с одной из известных -норм. Наиболее часто используют -нормы вероятностное пересечение норма задана перемножением функций принадлежности, рис. 5 пересечение по Лукасевичу пересечение по Заде С целью снижения вычислительной нагрузки и повышения достоверности векторы движения следует искать для блоков, принадлежащих подмножеству . Сечение нечеткого множества по уровню применительно к сюжету корабль и катер см. рис. 2, включает в себя 74 блока, по уровню 16 блоков, что показывает возможности по снижению вычислительных затрат рис. 6. Результатом выполнения процедур поиска является множество блоков с присвоенными им трехкомпонентными векторами движения, где значения определены функцией принадлежности блоков множеству . Для блоков, принадлежащих сечению нечеткого множества по уровню достоверность векторов движения близка к единице. Блокам с высокой детальностью и низким уровнем энергии движения, принадлежащим пересечению без выполнения процедуры поиска присваивают нулевые векторы движения с достоверностями Блоки, принадлежащие сечению нечеткого множества блоков с низкой детальностью по уровню исключают из дальнейшей обработки. В рамках математического аппарата нечеткой логики задача сегментации может быть классифицирована как кластеризация блоков при априорно неизвестном числе кластеров 2. Число блоков, принадлежащих объектам интереса, сравнительно невелико. Кроме того, эти блоки могут быть размещены в произвольном порядке по площади кадра. Поэтому в дальнейшем будем использовать одномерную нумерацию блоков 1, . Исходной информацией для кластеризации является матрица наблюдений где -я строка содержит вектор параметров -го блока, . По матрице наблюдений формируют матрицу признаков где каждая строка содержит значения признаков по отношению к объекту одного из блоков, подлежащих кластеризации. Признаки приводят к стандартной форме это положительные безразмерные величины, изменяющиеся от нуля до бесконечности, причем, чем меньше их значения, тем лучше. Тогда совокупность признаков для -го блока строку матрицы можно представить в виде вектора, который имеет геометрический смысл. В ходе кластеризации блоки объединяют в кластеры объекты на основе схожести признаков для блоков одного объекта и отличий от других объектов. В соответствии с положениями нечеткой логики блок может принадлежать не обязательно одному объекту определяют лишь степень принадлежности блока к данному объекту. Начальные блоки кластеров затравки выбирают из множества это блоки с минимальными суммами расстояний до остальных блоков этого множества. Блоки множества, принадлежащие одному объекту, образуют связанную группу и имеют близкие векторы движения. Тогда первым признаком принадлежности блока к объекту является минимальное расстояние 1, 1, до одного из ранее включенных в кластер блоков на первом шаге к блоку затравки. Вторым признаком является взвешенная норма разностного вектора где наиболее вероятный вектор движения для данной области, а оценка достоверности вектора движения . Для -го блока формируют обобщенный признак, например в виде нормы вектора, составленного из взвешенных значений частных признаков где матрица переменных весовых коэффициентов учитывает динамику свойств объектов интереса и окружающей обстановки. Для евклидовой нормы матрица единичная если признаки взаимонезависимы диагональная в случае взаимной зависимости признаков заполненная и рассчитанная через матрицу ковариаций норма Махалонобиса. Целесообразно использовать экспоненциальную функцию принадлежности блоков к объекту на основании обобщенного признака где масштабный коэффициент. Чтобы получить степень принадлежности блока к объекту нужно подставить в выражение конкретное значение обобщенного признака . При варьировании признака от нуля до бесконечности функция принадлежности изменяется от нуля до единицы, причем, чем больше ее значение, тем выше степень принадлежности блока к данному объекту. После того как определены блоки со значениями функции принадлежности к данному кластеру, превышающими некоторый порог, переходят к формированию следующего кластера. Процесс заканчивают, когда осуществлен перебор всех оставшихся блоков рис. 7 и 8. Для всех сегментированных объектов определяют векторы параметров местоположения центров тяжести, параметры формы и моделей движения. При описании заранее неизвестной формы объектов используют наиболее общее представление на основе моментных инвариантов 4. Координаты центра эллипса рассеяния центра тяжести изображения объекта составляют вектор Угол поворота, длины большой и малой полуосей эллипса рассеивания находят на основании вторых моментов где 1, множество блоков, принадлежащих объекту вероятность принадлежности -го блока к объекту . Уравнение для эллипса рассеяния, описывающего объект где вектор координат элемента в плоскости изображения матрица ковариаций где матрица поворота на угол . Тогда форму объекта с номером можно компактно описать длинами полуосей эллипса углом поворота и коэффициентом элонгации Для жестких объектов движение учитывают векторами скорости и ускорения, отнесенными к центру тяжести Векторы параметров для всех объектов объединяют в матрицу наблюдений . В ходе сопровождения объектов в каждом последующем кадре определяют множество блоков, соответствующих -сечению нечеткого множества с присвоенными им трехкомпонентными векторами движения. Сопоставление параметров объектов, сегментированных в кадре 1 и вновь обнаруженных блоков позволяет определить признаки принадлежности для каждого блока к уже существующим объектам. Первым признаком принадлежности блока к объекту является расстояние до центра этого объекта. С учетом размеров эллипса рассеяния степень принадлежности блока к объекту по признаку формы где некоторая константа. Второй признак определен нормой разностного вектора, где и векторы скорости блока и объекта соответственно. Вероятность принадлежности блока к объекту по признаку движения где весовой коэффициент, определяемый оценкой достоверности вектора, скоростью движения объекта и расстоянием до соседних объектов вес тем больше, чем ниже скорость движения объекта и ближе соседние объекты интереса. Это позволяет уверенно сопровождать медленно движущиеся объекты и снизить вероятность потери объекта в случае некорректно найденного вектора движения. Результирующая функция принадлежности При сопровождении нескольких близко расположенных объектов используют функцию принадлежности вида где число нечетких множеств объектов. Функция принадлежности позволяет определить, в какой степени -й блок принадлежит объектам и 1, Чтобы не перегружать вычислитель, учитывают только близко расположенные объекты. Полученные значения функций принадлежности блоков к ранее сегментированным объектам используют для уточнения их местоположения, параметров моделей формы и движения рис. 9. Переход от нечетких множеств к их сечениям по уровню позволяет однозначно сегментировать объекты. Блоки, не отнесенные ни к одному из объектов, анализируют с целью сегментации вновь появившихся объектов. Для всех сопровождаемых объектов выполняют траекторный анализ на основе регрессии или фильтра Калмана. Это позволяет разрешать ситуации окклюзии перекрытия объектов. В случае длительного исчезновения объекта необходимо отождествить потерянный объект с одним из вновь захваченных объектов. Операцию отождествления выполняют по критерию минимума расстояния между векторами взвешенных параметров потерянного объекта и одного из вновь захваченных объектов где 1, 1, весовая матрица, в общем случае отличная от диагональной. Применение нескольких взаимодополняющих признаков с весами, адаптированными к их значениям и окружающей обстановке, а также использование теории нечетких множеств позволили обеспечить низкую вероятность потери объекта, а также его неполной сегментации, рассегментации или слияния с другим объектом разрешение ситуации окклюзии закрытия объекта другим объектом или фоном разрешение ситуации разделения объекта на несколько объектов интереса сопровождение объектов при условии динамики их свойств отождествление объектов при их повторном обнаружении. 