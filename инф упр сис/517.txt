ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ  И ОБРАЗОВАНИЕ МОДЕЛИРОВАНИЕ РАЗРЕЗА ПРИ СИМУЛЯЦИОННОМ  ОБУЧЕНИИ БАЗОВЫМ НАВЫКАМ ЛАПАРОТОМИИ 

Описывается тренажер открытой хирургии, входящий в аппаратно-программный комплекс «Виртуальный хирург». Тренажер разработан с использованием современных технологий трехмерного моделирования и компьютерной графики и предназначен для моделирования оперативного вмешательства при системном обучении врачей-хирургов методикам лапаротомии (разрезам брюшной стенки) с небольшим размером операционного поля на этапах додипломного и последипломного образования. Наибольшее внимание уделяется алгоритмам имитации разреза трехмерных объектов, представленных объемными примитивами.

Современное развитие информационных технологий и робототехники позволяет создать мощные средства дополненной виртуальной реальности, моделирующие реальные процессы и явления и позволяющие реализовать передовые методики обучения. Одним из актуальных направлений в этой области является разработка и внедрение в учебный процесс симуляционных технологий, например тренажеров, для подготовки врачей-хирургов с различной специализацией 1, 2. Это направление, известное как симуляционное обучение в медицине 3, вид учебной деятельности, направленный на освоение обучающимися всех категорий практических навыков, комплексных умений и отработку командных действий в процессе оказания медицинской помощи. В его основе лежит использование симуляционных моделей роботов-симуляторов пациента, виртуальных тренажеров, муляжей, фантомов и манекенов. В последнее время среди прочих моделей применяются тренажеры для обучения навыкам открытой хирургии 4, 5. Значимость таких тренажеров обусловлена тем, что открытые операции, во-первых, широко применяются на практике и, во-вторых, связаны с достаточно высоким уровнем травматичности и повреждения тканей и органов. От точных и выверенных действий хирурга во многом зависят последствия операции с возможными осложнениями и процесс послеоперационного восстановления. Существующие тренажеры воспроизводят условия операции с разной степенью реалистичности, однако комплексного решения, которое обеспечило бы высокую реалистичность обратной связи и трехмерного изображения, готового к внедрению в медицинских организациях, пока нет. При проведении открытых операций хирург получает визуальную информацию о состоянии внутренностей через открытый разрез, а тактильные ощущения посредством взаимодействия с хирургическими инструментами. Современные технологии трехмерного моделирования и мехатроники позволяют добиться высокой реалистичности как изображений, так и обратной связи, что определяет широкие перспективы использования таких тренажеров в учебном процессе. В данной статье описывается аппаратно-программное решение для симуляционного обучения базовым навыкам лапаротомии. Лапаротомия это маневр открытой хирургии, заключающийся в разрезе брюшной стенки для получения доступа к органам брюшной полости. Описываемое решение разработано с использованием манипуляторов, позволяющих симулировать движения инструментов с обратной связью. Данные манипуляторы универсальны и показали хорошие результаты в тренажере эндоскопии 6. Адаптация их для моделирования открытой операции потребовала разработки новых алгоритмов имитации разреза, анализу которых посвящена данная работа. Аппаратно-программный комплекс Виртуальный хирург был разработан для 3D-моделирования операционного процесса и системного обучения врача-хирурга методикам открытой хирургии с небольшим размером операционного поля, методикам эндоваскулярной хирургии и эндоскопической хирургии на этапах додипломного и последипломного образования. Если для тренажеров эндоваскулярной и лапароскопической хирургии существуют различные решения, то аналогичные тренажеры лапаротомии или открытой хирургии отсутствуют, что определяет новизну и высокую практическую значимость данной работы. Разработанный комплекс универсален, может применяться для отработки базовых навыков и освоения методик проведения операций, включая тактику при возможных осложнениях. Наличие общей программной составляющей, разнообразных манипуляторов и средств визуализации позволяет использовать комплекс для освоения различных методик открытой хирургии. Существующие алгоритмы оценки качества в составе учебно-методических модулей комплекса обеспечивают объективную оценку результатов тренировок. Внешний вид тренажера открытой хирургии в составе АПК Виртуальный хирург представлен на рис. 1. Программное обеспечение комплекса реализовано с использованием современных технологий для построения 3D-сред и физических свойств материалов USB HID, DirectInput, SDL, OpenGL, Direct3D, OpenCL, DirectCompute, CUDA, PhysX, Havok. В частности, разработан специализированный модуль, который обеспечивает имитационное моделирование физического взаимодействия в рамках операционного поля, включая обнаружение и обработку столкновений мягких тел, т. е. факта взаимодействия объектов операционного поля между собой, определение изменений в положении перемещения и в геометрии деформацию объектов операционного поля, определение изменений топологии объектов операционного поля нарушение целостности, обработку дискретных событий, изменяющих физическую модель операционного поля клипирование, отрезание, коагуляцию, смену инструмента и т. д., регистрацию событий взаимодействия инструментов с объектами операционного поля с требуемой детализацией и расчет положений и сил при взаимодействии инструментов с объектами операционного поля. Одной из основных задач обеспечения открытой хирургии является правильная алгоритмизация взаимодействия виртуальных инструментов и тканей на операционном поле. Рассмотрим задачу трехмерного моделирования взаимодействия инструментов и мягких тканей при симуляции верхнесрединной лапаротомии. При проведении этого вида вмешательства, т. е. при разрезе по средней линии выше пупка, рассекают кожу, подкожную клетчатку, апоневроз или белую линию живота, предбрюшинную клетчатку и брюшину. Этот разрез обеспечивает доступ к органам верхнего этажа брюшной полости. Объекты в сценах открытой хирургии описываются двумя видами примитивов треугольниками, принадлежащими поверхности, ограничивающей внутренний объем объекта поверхностная модель тетраэдрами, заполняющими внутренний объем объекта объемная модель. Таким образом, информация об объекте, представленном как поверхностной, так и объемной своей моделью, включает два массива массив координат вершин примитивов порядковый номер вершины и ее координаты в трехмерном пространстве массив примитивов, каждый элемент которого включает порядковый номер треугольника и три индекса, определяющих порядковые номера вершин, принадлежащих данному треугольнику, или четыре индекса, определяющих порядковые номера вершин, принадлежащих данному тетраэдру. При этом важнейшим аспектом является реалистичное моделирование разреза тканей инструментом. С технической точки зрения разрез сложен тем, что нарушает топологические свойства объекта, связан с перестроением данных, описывающих этот объект. Операция разреза обладает существенными особенностями, предъявляющими требования к реализации конкретных алгоритмов необходимость выполнения в реальном масштабе времени, так как неизвестно заранее, какой именно разрез его длина, глубина, направление и скорость будет произведен в таком случае стратегия предварительных расчетов и сохранение предварительно обработанных данных для их использования по запросу в требуемый момент оказывается неприменимой сохранение непротиворечивости и логической целостности структуры данных, описывающей трехмерный объект. Как уже отмечалось, объект при разрезе меняет свои топологические свойства, при этом для стабильной работы должны сохраняться требования используемых структур данных нарушение этого требования, т. е., например, появление лишних опорных точек поверхности, которые не принадлежат ни одному треугольнику поверхности, ведет к ошибкам при визуализации инвариантность алгоритма для объектов, описанных различными примитивами. Так как различные учебные задания могут включать объекты, составленные как поверхностными, так и объемными примитивами, то необходимо, чтобы алгоритм разреза в целом позволял работать и с первым, и со вторым видом объектов, возможно, с некоторыми деталями реализации. Задачи построения сечения решаются с помощью различных алгоритмов, которые зависят от конкретных условий применения, используемых примитивов и типов объектов, например, для поверхностных моделей объектов. Укрупненный и обобщенный алгоритм построения сечения включает следующие этапы определение области разреза т. е. той области объекта, которая непосредственно взаимодействует с инструментом, на следующем шаге она будет перестроена и разрез будет виден разделение примитивов, попавших в область разреза, так, чтобы края разреза были корректно описаны, а в результате был сформирован корректный набор данных, описывающих объект с разрезом включает перестроение данных объекта, удаление и добавление вершин и примитивов раздвижение разделенных примитивов в разные стороны. В ходе выполнения работы для решения поставленной задачи было предложено два универсальных алгоритма разреза трехмерных объектов операционного поля регулярной тесселяции и разделения по плоскости. Алгоритм регулярной тесселяции основан на разбиении треугольников, принадлежащих поверхностям операционного поля, путем заполнения двухмерного пространства в результате многократного повторения определенного геометрического примитива 7. Для упрощения описания рассмотрим принцип работы алгоритма для случая разреза поверхностной модели, включающей набор треугольников поверхности. Процесс тесселяции рис. 2 заключается в добавлении трех новых точек, каждая из которых находится в середине ребра треугольника, и соединении этих точек тремя дополнительными ребрами, т. е. из одного исходного треугольника 3 вершины, 3 ребра получаются четыре результирующих 6 вершин, 9 ребер. Данный процесс повторяется итеративно, причем на каждом следующем этапе тесселяции подвергаются только требуемые треугольники. В результате получается структура рекурсивного разделения поверхности объекта. Подобные же структуры, имеющие фрактальную природу, используются и для описания различных объемных объектов 8. Режущая часть используемого в тренажере хирургического инструмента практически всегда имеет плоскую или близкую к плоской форму, поэтому представляется треугольником или четырехугольником. На первом этапе производится анализ наличия пересечений всех примитивов объекта треугольников. Для этого находятся пересечения ребер треугольника секущего инструмента и плоскостей треугольников поверхности и наоборот такой двухпроходный анализ позволяет избежать ошибок в некоторых случаях особого взаимного расположения инструмента и поверхности. Те примитивы, которые обнаруживают взаимодействие с секущим треугольником, относятся к области разреза. На втором этапе все примитивы области разреза подвергаются тесселяции в зависимости от заранее установленного числа итераций. Теоретически при неограниченном числе итераций полученная линия разреза сойдется к секущей плоскости независимо, что справедливо для алгоритмов грубой силы brute force. На практике количество итераций выбирается из приемлемого соотношения вычислительных затрат и качества получаемого результата. Для используемых в тестовых сценах моделей принималось значение от четырех до восьми. После итеративной тесселяции анализируется положение каждого из примитивов относительно секущей плоскости. Для треугольников может использоваться достаточно простой критерий треугольник относится к одной из сторон разреза, если две вершины из трех относятся к этой стороне. Здесь также следует отметить, что при использовании объемных моделей алгоритм работает по такому же принципу в середине каждого из шести ребер тетраэдра появляется новая вершина, он разбивается на восемь новых тетраэдров. Но критерий отнесения новых тетраэдров к какойлибо стороне сечения усложняется, так как при наличии четырех вершин невозможно анализировать расположение простым большинством. А пространственная организация тесселированного тетраэдра не позволяет использовать четкий логически и физически обоснованный критерий, справедливый во всех возможных случаях, что ведет к использованию косвенных критериев. На третьем этапе происходит раздвижение тканей в разные стороны от секущей плоскости. Эффект раздвижения может достигаться двумя приемами использованием свойств физического натяжения ткани, эмулируемых физическим движком, или заданным перемещением по нормали от плоскости разреза. Достоинством такого алгоритма, безусловно, является его регулярность и достаточная алгоритмическая простота, т. е., по сути, на любом этапе и с любым примитивом производится только одна операция тесселяция. Несмотря на успешное тестирование, в процессе практического использования подобного алгоритма выявились его существенные недостатки зависимость качества получаемого результата от числа итераций высокая вычислительная нагрузка, которая ведет к тому, что в режиме реального времени может осуществляться сечение только с одной или двумя итерациями в зависимости от сложности каркаса, тогда как приемлемые по качеству результаты получаются после 48 итераций, также в зависимости от сложности каркаса условие отнесения нового примитива после тесселяции к одному или другому краю разреза приближенно и не всегда адекватно физическим параметрам например, расположению центра тяжести. Практически данный алгоритм может быть использован для обработки объектов, включающих небольшое число примитивов, а также в тех случаях, когда важно контролировать результат обработки данных об объекте ведь используется только одна операция регулярной тесселяции с известным заранее результатом или требуется значительно повысить детальность представления объекта в зоне разреза. Но поскольку важнейшим для практического использования тренажера является требование работы в реальном масштабе времени, то авторами разработан и внедрен алгоритм разреза с отсечением примитива по секущей плоскости, осуществляемый в одну итерацию. Основным отличием данного алгоритма от предыдущего, как следует из названия, является то, что разбиение примитивов происходит строго по секущей плоскости, а не по какому-то заранее заданному регулярному правилу. Таким образом, отпадает необходимость итеративно производить многократную тесселяцию для получения краев разреза, близких к линии сечения. На первом этапе, так же как и в алгоритме регулярной тесселяции, определяются пересечения ребер треугольника секущего инструмента и плоскостей треугольников поверхности и наоборот. За тем лишь исключением, что кроме отнесения примитивов к области разреза производится обнаружение непосредственно точек контакта рис. 3, после чего они соотносятся с ребрами примитива рис. 3, . На втором этапе все примитивы области разреза также подвергаются тесселяции, но уже не по регулярному закону, а в соответствии с правилом, что точка контакта делит примитив на новые примитивы, количество которых равно количеству ребер исходного. При этом последовательно обрабатываются все точки контакта рис. 3, . В результате получается набор точек, принадлежащих границе разреза рис. 3, . Данные точки, а также ребра, которые их включают, дублируются, так как край разреза должен быть целостным с обеих его сторон на рис. 3, эти стороны условно обозначены и в зависимости от знака уравнения секущей плоскости с данной стороны разреза. В результате разреза образуются новые поверхности рис. 3, . На третьем этапе происходит раздвижение тканей точно так же, как в алгоритме, рассмотренном выше. Для демонстрации результатов приведена одна из тестовых сцен верхнесрединной лапаротомии. На рис. 4 показано операционное поле перед началом операции. Результат разреза кожного покрова и мягких тканей с использованием второго алгоритма представлен на рис. 5. При этом эмулируется три слоя покрова кожа, подкожная и жировая прослойки. На рисунке показан момент разреза самого нижнего слоя с применением виртуального инструмента ножницы. В процессе выполнения тестового задания контролируется максимальный набор параметров, определяющих оценку правильности и эффективности его реализации, в частности, общее время проведения, правильность выбора инструментов, длина разрезов, касания тканей и органов, ориентация инструментов и др. Предложенные авторами алгоритмы позволили решить задачу имитации разреза объектов сцены виртуальными хирургическими инструментами при создании тренажера лапаротомии открытой хирургии в составе АПК Виртуальный хирург. Р абота выполнена при поддержке Министерства образования и науки РФ в рамках ФЦП Исследования и разработки по приоритетным направлениям развития научно-технологического комплекса России на 20072013 годы шифр 2011-2.7-527-062. 