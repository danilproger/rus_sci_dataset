АЛГОРИТМИЧЕСКОЕ  ОПИСАНИЕ И  СРАВНИТЕЛЬНЫЙ  АНАЛИЗ  СВОЙСТВ СИГМА-ДЕЛЬТА  АЦП (ЧАСТЬ 2) 

Предложено аналитическое описание алгоритма работы сигма-дельта АЦП в виде нелинейного отображения, на основании которого осуществлено исследование его характеристик и выполнен аналитическими методами и посредством имитационного моделирования сравнительный анализ особенностей его функционирования. We propose a non-linear mapping that describes the algorithm of work of the delta-sigma analogto-digital converter. This model is used to investigate the characteristics of the converter and give a comparative analysis of its features.

В первой части статьи был получен алгоритм, описывающий работу АЦП в виде 14 Напомним обозначения, приведенные в алгоритме входной сигнал диапазон преобразования 0 1 2 при 2 . Сравнение алгоритмов 6 и 14 показывает практически их аналитическую идентичность с точностью до слагаемого и размерностью множителя перед индикаторной функцией. Следовательно, динамические свойства данных алгоритмов в переходном режиме функционирования будут также идентичны, причем в установившийся режим работы уравновешивающая величина переходит в алгоритме 14 от нулевого начального значения точно так же, как и в следящем алгоритме. Это утверждение прослеживается на графиках рис. 7, полученных в результате имитационного моделирования алгоритма 14. При выбранном масштабе изображения графиков уравновешивающих величин для указанных значений входного сигнала невозможно визуально обнаружить аттрактор в установившемся режиме работы. Однако при графическом изображении установившегося режима функционирования алгоритма 14, т. е. после переходного процесса, уже в другом масштабе аттракторы визуально сразу же обнаруживаются. Действительно, на рис. 8 приведены в матричной форме графики, описывающие изменение фазовых портретов аттракторов для одного из фиксированных значений входного сигнала в установившемся режиме. Матричная реконструкция двумерных фазовых портретов построена для разности между входным сигналом и уравновешивающей величиной методом запаздывания при фиксированном значении входного сигнала с последовательным сдвигом на один такт относительно исходной разности с нулевым сдвигом до трех тактов включительно. По диагонали матрицы указаны гистограммы разностей, изменяющихся в пределах аттрактора. Геометрическая форма аттрактора меняется в зависимости от изменения входного сигнала, т. е. параметра отображения 14, и тем самым форма аттрактора, характеризующего динамику уравновешивающей величины АЦП в установившемся режиме работы, в отличие от просто следящего алгоритма, несет информацию о величине входного сигнала. Это четко устанавливается по диаграммам рассеяния рис. 9, которые представляют собой фактически фазовые портреты аттракторов, построенных так же, как и на рис. 8, в форме диаграмм Вороного при преобразовании различных значений входного сигнала. На диагонали матрицы указаны гистограммы значений уравновешивающей величины, изменяющейся в пределах аттрактора. Введенные обозначения соответствуют обозначениям рис. 8. В соответствии с методикой построения диаграмм Вороного фазовое пространство, вмещающее аттрактор, разделяется на области вокруг точек, определяющих значения уравновешивающей величины в области аттрактора в зависимости от изменения числа итераций. Для краткости назовем указанные точки точками уравновешивающей величины. Принцип формирования каждой области состоит в том, что эта область содержит все точки фазового пространства, максимально близкие к соответствующим точкам уравновешивающей величины. Достаточно беглого визуального анализа фазовых портретов рис. 8 и 9, чтобы убедиться в том, что, в отличие от следящего алгоритма, нет совпадающих фазовых портретов для разных значений входного сигнала. Привязка формы аттрактора к значению входного сигнала как раз и создает предпосылки для обработки значений знаковой функции отдельным цифровым фильтром, выведенным из основного замкнутого контура собственно АЦП, с целью получения результата преобразования с высокой точностью. Такая дополнительная к основному контуру обработка информации становится возможной благодаря тому, что в установившемся режиме математическое ожидание знаковой функции в усредненном алгоритме 14, как это будет показано ниже, соответствует неподвижной точке усредненного решения отображения в области аттрактора, следствием чего является равенство математического ожидания знаковой функции входному сигналу. Адекватная аналитическая запись алгоритма работы АЦП и сравнение его принципа функционирования с широко известными алгоритмами позволяют получить ответы на целый ряд вопросов, связанных с особенностями работы данного алгоритма. Такое сравнение с результатами дополнительного исследования следящего алгоритма, проведенного в первой части статьи, в свете последних достижений в области нелинейных динамических систем 1116 снимет некоторый ореол таинственности, сопутствующий принципу действия АЦП. Обратим внимание на то, что введение параметра в алгоритме 14 существенно изменяет фазовый портрет уравновешивающей величины по сравнению со следящим алгоритмом в установившемся режиме, т. е. в области аттрактора. Анализ гистограмм распределения вероятностей уравновешивающей величины в аттракторе, расположенных по диагонали матричной реконструкции фазовых портретов рис. 8 и 9, дает дополнительную очень интересную информацию о характере самого аттрактора. Все гистограммы близки по форме к равномерному распределению, что, казалось бы, говорит об эффекте перемешивания, поэтому эти аттракторы формально можно было бы отнести по принятой классификации 11 17 к так называемым стохастическим аттракторам. Однако по визуальному анализу траекторий, представленных на рис.10, аттракторы можно проклассифицировать скорее как квазистохастические, а не стохастические. На рис. 10 в установившемся режиме изображены фрагменты траектории уравновешивающей величины решения отображений в установившемся режиме, т. е. в аттракторе. В формировании этих фрагментов непосредственно участвует знаковая функция, так как эти фрагменты функционально связаны со значениями знаковой функции, которые приведены на рис.11. При этом интервал распределения аттрактора, как это следует из рис. 10, приблизительно равен удвоенному значению приведенного параметра или удвоенному значению шага итерации в алгоритме 14. Целью дальнейшего анализа является проведение необходимых доказательств следующих положений, соответствующих отображениям 7 и 14, и сопутствующих им исследований, а именно 1 существование аттрактора 2 существование неподвижной стационарной, особой точки для усредненного значения уравновешивающей величины в области аттрактора 3 установление закона распределения уравновешивающей величины в аттракторе 4 выявление условий построения градуировочной характеристики на основе достижения равенства усредненного значения знаковой функции входному сигналу в стационарной точке 5 исследование влияния аддитивной помехи на сходимость и существование стационарной точки в условиях воздействия помех. Сразу же отметим, что доказательство существования неподвижной точки усредненного значения уравновешивающей величины непосредственно связано с установлением закона распределения уравновешивающей величины в аттракторе. Для проведения необходимых доказательств и количественного анализа алгоритма 14 представим входной сигнал в виде следующей, знакомой по первой части статьи эквивалентной записи где погрешность усечения, изменяющаяся с равномерным законом распределения вероятностей в пределах 0 коэффициенты 1,2, в зависимости от принимают значения, равные либо единице, либо нулю. Тогда алгоритм 14 при отсутствии помех перепишем в виде или, поделив правую и левую части на величину, получим 15 где Нормированная погрешность усечения имеет равномерный закон распределения существенно меньше единицы. Для упрощения анализа приняты следующие значения основных параметров 2, начальное значение 0 0. При фиксированном входном сигнале, представленном в виде введем также обозначения для Приращение кода в отображении 15 на каждом такте итерации точно так же, как в следящем алгоритме, но уже на другую величину, равную 2 1, будет осуществляться до тех пор, пока для аргумента под знаковой функцией при приращение кода 1 и, следовательно, уравновешивающей величины не превысит значение входного сигнала . При этом возникает вопрос возможно ли достижение в пределах допустимой разрядности представления в двоичном коде в виде точного равенства Иначе говоря, можно ли получить для -разрядного двоичного кода, эквивалентного, равенство или 16 где число в двоичном эквиваленте соответствует равенству при установленных значениях 1 или 0 для 1, . Ответ на этот вопрос раскрывает причину возникновения аттрактора в отображении 14. Теория чисел 21 говорит о том, что равенство 16 можно получить, если справа будет стоять некоторое натуральное число, что в рассматриваемом случае достичь практически невозможно. Именно поэтому сходимость алгоритма будет обеспечиваться только в некоторую окрестность для установленного на входе значения сигнала, определяемую аттрактором алгоритма отображения см. рис. 8 и 9. В результате последующих тактов итерации для фиксированного входного сигнала получаем устойчивое движение траектории уравновешивающей величины, следовательно, и ее нормированного значения в малой окрестности области. Как показывает имитационное моделирование, окрестность не превышает 2, причем значение уравновешивающей величины в этой окрестности распределено по равномерному закону. Иначе говоря, отображение 15 при увеличении числа тактов итерации до бесконечности образует аттрактор, отличный от геометрической формы аттрактора, достигаемой в следящем алгоритме. Причем зависимость геометрии аттрактора от входного сигнала возникает изза добавления к симметричной относительно нуля знаковой функции постоянной величины, обуславливаемой значением входного сигнала, что и приводит к асимметричному изменению уравновешивающей величины в отображении 15 и, тем самым, к возникновению аттрактора. То есть наличие аттрактора говорит о локальной неустойчивости алгоритма 15. Для того чтобы сохранить глобальную устойчивость алгоритма или устойчивость алгоритма в среднем, необходимо, чтобы среднее значение уравновешивающей величины для фиксированного значения сигнала было бы равно постоянной величине. Доказательство выполнения этого требования для отображения 15 приведено в приложении. Именно за счет выполнения этого требования обеспечивается уже после выхода уравновешивающей величины в область аттрактора при дальнейшем увеличении числа итераций эффект достижения равенства усредненного значения знаковой функции, выраженного в двоичном эквиваленте, искомому значению входного сигнала. Такое дополнительное усреднение и осуществляется в АЦП в цифровой форме. Для того чтобы доказать данное утверждение аналитически, определим математическое ожидание справа и слева в алгоритме 15 по числу итераций фактически осуществим усреднение по времени. В результате получим Учитывая, что в области аттрактора для стационарной точки выполняется равенство см. приложение получаем для приведенного к диапазону преобразования входного сигнала равенство которое и определяет при надлежащем масштабировании, т. е. после умножения результата усреднения на величину кванта, градуировочную характеристику АЦП. Высокую точность за счет увеличения числа разрядов, но не превышающего некоторого заданного значения в равенстве теоретически можно получить в результате временного усреднения при, т. е. или 17 где оператор цифрового усреднения случайной последовательности, состоящей из положительных и отрицательных единиц, или эквивалентной ей последовательности, состоящей из нулей или единиц значение уравновешивающей величины, изменяющейся в пределах аттрактора при увеличении числа итераций после переходного процесса, равного . Выполним в 17 сначала усреднение справа Для того чтобы выполнить усреднение слева, заметим, что после переходного периода разность между входным сигналом и уравновешивающей величиной, являющейся аргументом знаковой функции, описывается некоторой линейной функцией, от входного сигнала и числа итераций. Следовательно, результат усреднения слева как раз и определяет двоичный эквивалент установленного на входе АЦП значения входного сигнала с высокой точностью, так как погрешность квантования определяется числом разрядов, полученных в двоичном эквиваленте после цифрового усреднения знаковой функции. С учетом вышеизложенного замечания предельное равенство 17 можно также представить в виде 18 где условная функция распределения вероятностей при фиксированном в области аттрактора некоторая линейная функция, которая выражает положительную разность между входным сигналом и уравновешивающей величиной в области аттрактора через параметры и . Дифференцируя справа и слева полученное равенство 18 по, убеждаемся, что производная функции распределения вероятностей равна постоянной величине Откуда следует, что искомая плотность распределения вероятностей разности между входным сигналом и уравновешивающей величиной соответствует равномерной плотности распределения вероятностей уравновешивающей величины в области аттрактора. При этом размер аттрактора зависит от параметра, т. е. от величины шага итерации и, следовательно, от диапазона преобразования. Теоретические выводы подтверждают результаты моделирования, представленные на рис. 711. Некоторый разброс гистограмм относительно равномерного распределения в рис. 79 связан с конечным значением объема выборки, т.е. с конечным числом итераций усреднения в области аттрактора. Если выразить знаковую функцию через индикаторную функцию, то алгоритм 14 трансформируется в алгоритм комбинированный с известным алгоритмом аналого-цифрового преобразования по методу считывания или просто с алгоритмом считывания, который задан в виде 19, 20 Исследование трансформированного алгоритма методически осуществляется аналогично исходному алгоритму. Таким образом, результаты аналитико-имитационного исследования алгоритма АЦП и анализа особенностей его функционирования показывают, что этот алгоритм относится к классу нелинейных отображений 914, которые в настоящее время интенсивно разрабатываются. Причем использование данного класса нелинейных отображений для решения такой чисто технической задачи как построение специализированных микросхем АЦП с характеристиками, существенно превосходящими соответствующие характеристики традиционных АЦП, подтверждает факт необычных возможностей нелинейных отображений. Это еще раз свидетельствует о причинах распространенности подобных отображений в живой природе 27. Исследование и анализ нелинейных отображений в большинстве случаев чрезвычайно сложны, тем не менее, достигнутые на современном этапе успехи стимулируют эти исследования для более сложных случаев технических приложений, в том числе при учете влияния различных дестабилизирующих факторов. Следует отметить также вопрос, связанный с так называемой децимацией отбрасыванием младших разрядов на выходе цифрового фильтра, который упоминается в источниках фирмы Analog Devices. Этот прием использовался автором статьи еще в конце 60-х годов в адаптивном АЦП Ф770, а теоретически эта процедура исследовалась в работе 28. Рассмотрим теперь вопрос влияния на свойства алгоритма АЦП аддитивной помехи. Механизмы возникновения и влияния аддитивной помехи в АЦП и в других типах АЦП, в том числе в следящем, на результаты преобразования заметно отличаются. Действительно, в АЦП входной сигнал проходит через большее число аналоговых элементов см. рис. 1 и в нем присутствует операция интегрирования. Поэтому адекватный алгоритм АЦП с учетом воздействия аддитивных помех выглядит следующим образом где аддитивная помеха с учетом усреднения ее на интеграторе и влияния помехи сравнивающего устройства аддитивная помеха, учитывающая непосредственное влияние внешних цепей на выходе аналогового сумматора. Для дальнейшего анализа с целью некоторого упрощения будем считать, что в обоих случаях воздействует одна и та же помеха . Тогда выражение 17 представляется в виде Если помеха имеет нулевое значение, то, как это следует из 18 и вывода в приложении, она не оказывает заметного влияния на исходную градуировочную характеристику и даже приводит, как показало моделирование, к уменьшению погрешности смещения. Однако сложение помехи с погрешностью усечения может привести к образованию несимметричной плотности распределения суммарной случайной величины в случае несовпадения математических ожиданий слагаемых, что вызывает некоторое увеличение систематической составляющей погрешности преобразования при усреднении знаковой функции. Количественную оценку динамики случайной составляющей погрешности преобразования с учетом воздействия помехи целесообразно осуществить посредством имитационного моделирования. Прежде всего, рассмотрим влияние аддитивной помехи на изменение геометрии аттрактора по диаграммам Вороного. На рис. 12 приведены гистограммы и фазовые портреты аттракторов, соответствующие погрешностям преобразования для различных входных сигналов без учета и при учете воздействия аддитивной помехи. Визуально заметно различие гистограмм и фазовых портретов аттракторов при отсутствии и воздействии помех. Количественные оценки погрешностей для уравновешивающей величины и результатов преобразования после цифрового усреднения в условиях отсутствия и воздействия помех выполняются для соответствующих гистограмм по первым двум моментам, полученным по результатам имитационного моделирования. На матрицах рис. 12 указаны гистограммы значений разности между входным сигналом и уравновешивающей величиной, изменяющейся в пределах аттрактора. На рис. 13 приведены совмещенные гистограммы с указанием оценок средних значений и СКО для уравновешивающей величины Var1 и результата цифрового усреднения Var2, выполненного по указанному на рис. 13 алгоритму экспоненциального сглаживания. Цифровое усреднение, как это и требуется в соответствии с алгоритмом АЦП, осуществлено дополнительно для знаковой функции в отсутствие помехи. Для того чтобы проследить количественно влияние воздействия аддитивной помехи, на рис. 14 приведены совмещенные гистограммы с указанием оценок средних значений и СКО для результата цифрового усреднения знаковой функции Var1, погрешности установления уравновешивающей величины Var2 и помехи Var3. Усреднение выполнено для знаковой функции при воздействии помехи. Сопоставление приведенных на рис. 14 графиков и значений соответствующих характеристик и параметров подтверждает сделанные аналитические выводы о свойствах алгоритма АЦП. Результаты моделирования подтвердили, что увеличение постоянной сглаживания для цифрового алгоритма экспоненциального сглаживания приводит к пропорциональному уменьшению погрешности преобразования при прочих фиксированных параметрах алгоритма. В заключение для сравнения с вышеприведенным анализом обратим внимание на известное классическое описание принципа действия АЦП первого порядка 28, 29, которое сводится, например, после некоторой обобщенной редакции по указанным источникам, не искажающей, а лишь улучшающей смысл основного содержания, к следующему. Входная аналоговая часть АЦП представляет собой сигма-дельта-модулятор, преобразующий входной сигнал в двоичную последовательность, образующую непрерывный поток нулей и единиц, следующих с частотой . Замкнутая цепь обратной связи состоит из вычитающего устройства, интегратора, компаратора 1-бит АЦП, 1-бит ЦАП. Двоичная последовательность поступает на вход ЦАП, а его выходной сигнал вычитается в темпе с поступлением из входного сигнала. Из теории обратной связи следует, что средняя величина напряжения на выходе ЦАП при достаточном петлевом усилении может достигать значения на входе модулятора. Интегратор в этом случае можно рассматривать как фильтр, амплитуда отклика которого пропорциональна 1 . Компаратор синхронизируется тактовыми импульсами, следующими с частотой, и, таким образом, он преобразует медленный входной сигнал в сигнал переменного тока высокой частоты, меняющейся в зависимости от среднего значения напряжения на входе. Далее АЦП можно также рассматривать как синхронный преобразователь напряжения в частоту со следующим за ним счетчиком. Число единиц, подсчитанное в заданном количестве отсчетов выходного потока данных, счетчик выдаст как цифровое значение входного воздействия. Однако прямой метод накопления подходит только для постоянных или медленно меняющихся входных сигналов из-за низкой скорости преобразования, так как только за 2 тактов цикла можно достичь эффективного разрешения, соответствующего -бит. Для повышения скорости преобразования применяют специальные способы распараллеливания процессов, а для уменьшения числа отсчетов на выходе АЦП применяется децимация. Данное описание дает только интуитивно-качественное представление о работе АЦП и никак не способствует сравнительному количественному анализу особенностей его работы в свете известных типов АЦП. Количественный анализ в известных публикациях фирмы-изготовителя сводится к следующему. Анализ количественный анализ сигма-дельта АЦП лучше всего производить в частотной области, используя линейную модель рис. 15. Отметим, что здесь интегратор представлен как аналоговый фильтр с заданной передаточной характеристикой, имеющей амплитудную зависимость, обратно пропорциональную частоте. Квантователь показан как каскад усиления, предшествующий сумматору шума квантования. Одним из преимуществ частотного подхода является то, что для описания поведения сигналов можно пользоваться простой алгеброй. Выходная величина может быть представлена как разность, умноженная на передаточную функцию аналогового фильтра и на коэффициент передачи усиливающего звена, а затем сложенная с шумом квантования . Если положить коэффициент передачи равным единице, а передаточную функцию представить как 1, то в результате получим 1 1. Отсюда следует, что на частоте 0 выполняется равенство . С увеличением частоты величина уменьшается, а значение шумовой компоненты возрастает. Так как аналоговый фильтр действует как ФНЧ на сигнал и как ФВЧ на шум квантования, такие модуляторы с фильтрами часто называют шумообразующими. Таким образом, известный анализ алгоритма работы АЦП, по мнению автора, конечно, дает в определенной степени качественное и даже количественное представление об особенностях его функционирования, однако далеко не раскрывает сущность и теорию его работы. Математическое ожидание алгоритма 14 без учета помехи при фиксированном входном сигнале находится путем усреднения правой и левой частей алгоритма по числу итераций, т. е. по времени. Если же вычесть правую и левую части алгоритма 14 из входного сигнала, то, выполняя аналогичное усреднение, приходим к нижеприведенным выражениям П1 где, 1 1 разность между входным сигналом и уравновешивающей величиной на -м и 1-м тактах итерации, причем 0 0. Так как знаковая функция до выхода решения в область аттрактора на -м такте итерации для всех равна единице, а в момент входа в аттрактор уравновешивающая величина const, то П2 Полученный результат вытекает из условия, что значение уравновешивающей величины в аттракторе распределено равномерно с плотностью 12, и доказывает, что в аттракторе математическое ожидание разности между входным сигналом и уравновешивающей величиной равно постоянной величине и не зависит от номера итераций. Следовательно, математическое ожидание уравновешивающей величины при постоянном входном сигнале в аттракторе определяет его особую или стационарную точку для усредненного в области аттрактора алгоритма АЦП. Отметим, что численный расчет и оценка этих параметров по результатам имитационного моделирования практически совпадают. 