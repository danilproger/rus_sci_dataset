ПОЛНЫЙ РАСЧЕТ СИСТЕМЫ ОБСЛУЖИВАНИЯ С РАСПРЕДЕЛЕНИЯМИ КОКСА 

Разработан алгоритм полного расчета стационарных характеристик системы обслуживания вида C /C /n: стационарного распределения числа заявок, их распределения перед прибытием очередной заявки, моментов распределения интервалов между обслуженными заявками. Обсуждаются частные случаи и обобщения. Рассмотрены особенности программной реализации алгоритма, приведены результаты тестирования. Алгоритм предлагается использовать при расчете сетей обслуживания методом потокоэквивалентной декомпозиции. An algorithm is proposed to compute the characteristics of the system C /C /n. This algorithm computes the stationary distribution of the number of demands, its distribution before arriving, and the moments of interdeparting intervals. Particular cases and generalizations, programming realization and testing results are discussed. The algorithm is planned to be used in the flow-equivalent network analysis.

Известно значительное влияние на результаты расчета сложных систем и сетей обслуживания не только средних интервалов между заявками и длительностей обслуживания, но и их распределений. Универсальным методом получения требуемых числовых характеристик является имитационное моделирование, существенными недостатками которого являются сложная логика программ, большой расход машинного времени и низкая точность определения малых вероятностей. Системы автоматизации имитационного моделирования типа GPSS включая новейшую модификацию последней GPSS World не снимают перечисленных проблем, а лишь упрощают программирование ценой замедления работы моделей как показали проведенные автором эксперименты в десятки раз. Таким образом, несмотря на увеличение быстродействия ЭВМ, численные методы расчета СМО сохраняют свою актуальность. Опубликовано множество методов расчета различных классов немарковских систем обслуживания, наиболее универсальные из которых опираются на подбираемые по методу моментов фазовые аппроксимации исходных распределений показательным, эрланговским, гиперэкспоненциальным, коксовым и общим распределением Ньютса. Для последнего, однако, отсутствуют алгоритмы расчета параметров аппроксимации. Эрланговские распределения из-за требования целочисленности фазового параметра не обеспечивают точного выравнивания даже двух моментов. Поэтому наибольшую практическую ценность представляют гиперэкспоненциальное и коксово распределения. Однако для первого из них распределения Эрланга являются особыми случаями система последовательных фаз не может быть сведена к тому же числу параллельных. Это гарантирует аварийное завершение программы подбора параметров аппроксимирующего распределения, вынуждает менять тип аппроксимации в зависимости от исходных данных и требует обширного набора программ, включающего все возможные комбинации. От данного недостатка свободно распределение Кокса, исследование свойств и систематическое использование которого в обеих позициях систем вида впервые описываются ниже. К фазовым распределениям относятся порождаемые системой подлежащих прохождению фаз обслуживания прибытия заявки с показательно распределенной длительностью пребывания в каждой из них. При фиксации номера фазы такие распределения приобретают марковское свойство, что и определяет целесообразность их использования. Для практических целей применение двухфазного распределения, обеспечивающего выравнивание трех начальных моментов, представляется вполне достаточным. Диаграмма этого распределения представлена на рис. 1. Параметры и задают интенсивности потоков перехода, вероятность потребности во второй фазе, вероятность отсутствия таковой. Получим алгоритм расчета параметров распределения по его моментам . Прежде всего заметим, что эти моменты с вероятностью являются моментами свертки показательно распределенных задержек в фазах, а с дополнительной к ней суть моменты задержки в первой фазе. Таким образом, для расчета параметров имеем систему уравнений Перейдем к обратным величинам и нормированным моментам Тогда исходная система может быть переписана как С учетом она преобразуется в систему 1 Из первого уравнения системы исключаем 2 и подставляем в два оставшихся. Первое из них дает Конечная форма задачи квадратное уравнение с решением 3 Решение для берется с плюсом, определяется из равенства 2. Заметим, что случай соответствует одной экспоненте и должен выявляться на первом этапе алгоритма. Здесь естественно принять 0 и 1, а значение можно выбрать произвольно например, равным . Подставим в эти формулы моменты гамма-распределения с параметрами и . Подкоренное выражение Таким образом, при 2 аппроксимация должна иметь комплексные параметры. Случай 2 является граничным он соответствует распределению Эрланга второго порядка с 1 и . В табл. 1 приведены параметры -аппроксимации гамма-распределения при единичном первом моменте. Таблица подтверждает сделанный прогноз и снимает опасения относительно возможной отрицательности . Отметим парадоксальный, но ожидаемый результат при 1 вероятность выхода процесса во вторую фазу отрицательна. Приведем результаты расчета распределения числа заявок в системе 1 табл. 2. Процедура MG1 использовала общеизвестные соотношения, реализующие метод вложенных цепей Маркова на базе рекуррентного расчета распределения числа заявок, прибывающих за случайное время обслуживания для вырожденного и гамма-распределений 1. Процедура MCN опиралась на -аппроксимацию и решала описанные ниже векторно-матричные уравнения баланса. Индекс указывает число заявок в системе. Параметр 1е9 фактически определяет вырожденное распределение, т. е. модель 1. Гамма-распределение было выбрано как удобный эталон по двум причинам 1 параметры его плотности легко выражаются через среднее и дисперсию согласно 2 вышеупомянутые для него вычисляются до удивления просто 1, с. 82 Хорошее согласие прямого расчета модели 1 и конечных результатов ее коксовой аппроксимации в широком диапазоне условий, в том числе для комплексных и отрицательных параметров, убедительно свидетельствует о приемлемости обсуждаемой аппроксимации. Достоинством -аппроксимации является естественное включение в нее как частных случаев и -моделей, а недостатками трудность обобщения на большее число составляющих и усложнение диаграмм переходов. Будем представлять состояние системы полным числом заявок в системе, фазой прибытия очередной заявки и расстановкой проходящих обслуживание заявок по его фазам ключами соответствующих микросостояний. Например, ключ 21 означает, что две заявки проходят первую фазу обслуживания с интенсивностями, а одна вторую с интенсивностью . Диаграмма состояний разделяется по фазам прибытия на две вертикальные ветви с интенсивностями и соответственно, а по числу заявок в системе на горизонтальные ярусы. Совокупности ключей в левой и правой ветвях диаграммы дублируются. На рис. 2 показаны переходы по завершению фазы обслуживания для половины диаграммы для другой половины они тождественны. Обозначим через множество всех возможных микросостояний системы, при которых на обслуживании находится ровно заявок, а через количество элементов . Нам потребуются следующие матрицы интенсивностей инфинитезимальных переходов в прибытие заявки, в конец промежуточной фазы обслуживания или прибытия заявки, в полное завершение обслуживания заявки, ухода из состояний яруса В квадратных скобках здесь и далее указывается размер матриц. Элемент, любой из этих матриц представляет интенсивность перехода из -го состояния -го яруса в -е состояние смежного по переходам рассматриваемого типа яруса. Заметим, что при все эти матрицы перестают зависеть от индекса. Ниже будут приведены примеры матриц для второго яруса. Переходы по завершению фазы обслуживания не меняют фазы прибытия, что позволяет ограничиться изображением для них половины диаграммы рис. 2. Здесь окончание первой фазы с интенсивностью переводит заявку во вторую фазу обслуживания, а с интенсивностью завершает обслуживание и поднимает изображающую точку на вышележащий ярус. Последнее при завершении второй фазы интенсивность происходит всегда. Интенсивности переходов проставлены с учетом числа заявок, находящихся в каждой фазе исходного микросостояния. Например, для полной диаграммы переходов по завершению обслуживания удвоенный рис. 2 имеем клеточно-диагональную матрицу интенсивностей переходов со второго на первый ярус Диаграмма переходов по фазам прибытия заявок в трехканальной системе оказывается весьма запутанной поэтому мы ограничимся описанием логики ее построения. Если интервалы между заявками подчинены -распределению с параметрами то все переходы из первой фазы с интенсивностями приводят в аналогичное микросостояние второй фазы прибытия того же яруса, а с интенсивностями в первую фазу нижележащего яруса. Переходы по завершению второй всегда последней фазы имеют интенсивность и также приводят в первую фазу нижележащего яруса. Соответственно интенсивности окончательных прибытий описывает матрица Переходы в пределах яруса могут быть связаны с выходом из первой во вторую фазу обслуживания в пределах каждой ветви либо с прибытием заявки переход из левой ветви в одноименное микросостояние правой Для диагональной матрицы суммарных интенсивностей ухода из микросостояний яруса мы приведем только ее диагональ Получим стационарные вероятности микросостояний, представленных на диаграммах предыдущего раздела. Введем векторы-строки нахождения системы в состоянии, 0, 1, . Теперь можно записать векторно-матричные уравнения баланса переходов между состояниями 4 Система 4, дополненная условием нормировки, даже для моделей с ограниченной очередью характеризуется чрезвычайно высокой размерностью, и стандартные методы решения систем линейных алгебраических уравнений применительно к ней оказываются малоэффективными. Для расчета разомкнутых систем обслуживания можно применить восходящий к Ивэнсу 5 метод матрично-геометрической прогрессии. Этот метод основан на представлении векторов вероятностей микросостояний для формулой 5 где некоторая матрица знаменатель прогрессии. Перепишем второе из уравнений 4 с учетом 5 для значения, при котором произошла вышеупомянутая стабилизация матриц, так что их индексы можно опустить 6 Теперь ясно, что удовлетворяет матричному квадратному уравнению 7 где . Применим к его решению метод итераций. Будем искать поправку к очередному приближению из уравнения 7, заменив в нем на . Пренебрегая членом, содержащим квадрат поправки, имеем или Последнее уравнение приводится к уравнению которое можно расписать как систему линейных алгебраических уравнений относительно компонент матричной поправки и решить любым стандартным методом. В качестве начального приближения можно принять где коэффициент загрузки системы и коэффициенты вариации распределений интервалов между смежными заявками и длительности обслуживания соответственно единичная матрица. Далее усеченная система 4 для в последнем из уравнений которой вектор заменен на, расписывается относительно компонент векторов, Затем одно из уравнений заменяется на условие баланса заявок где вектор-столбец из единиц и средние интервал между заявками и длительность обслуживания. Наконец, находится решение системы для компонент начальных векторов. Последующие векторы вероятностей микросостояний вычисляются согласно формуле 5. Для решения системы 4 можно также применить менее быстродействующий, но более универсальный итерационный метод, впервые предложенный Такахаси и Таками 7 и описанный в работах 1, 2 в более общей форме, с детальной проработкой расчетных зависимостей и с частными вариантами. В сетях обслуживания потоки на входе узлов формируются из выходящих потоков других узлов. В общем случае выходящий поток сохраняет среднюю интенсивность и средний интервал между заявками входящего, но меняет вид распределения интервалов между заявками. Последнее удобно характеризовать коэффициентами немарковости где моменты распределения интервалов между заявками выходящего потока, который предполагается рекуррентным. Для простейшего потока упомянутые коэффициенты согласно данному определению равны нулю. Ключом к проблеме преобразования потока в коксовом узле обслуживания является расчет марковской системы. В системе, загруженной полностью, частное преобразование ЛапласаСтилтьеса ПЛС интервала до очередного обслуживания при наличии в системе заявок При интенсивность обслуживания меняется с прибытием каждой очередной заявки. Будем интерпретировать как параметр простейшего потока катастроф. Тогда можно считать вероятностью отсутствия катастроф за интервал от ухода заявки, оставившей в системе ровно заявок, до следующего завершения обслуживания. Вероятности появления событий каждого из рассматриваемых простейших потоков катастроф, завершений обслуживания и прибытия новых заявок пропорциональны их интенсивностям, т. е., и соответственно. Теперь ясно, что Здесь первое слагаемое соответствует завершению обслуживания, а второе прибытию новой заявки отчего число заявок в системе увеличилось на единицу и отсутствию катастроф до следующего завершения обслуживания при новом начальном условии. Результирующее распределение интервалов между заявками выходящего потока задается ПЛС где финальные вероятности наличия в системе сразу после завершения обслуживания ровно заявок при подсчитываются согласно уравнению 8 Здесь стационарное распределение числа заявок в системе, а равно при и в противном случае. Знаменатель формулы 8 сводится к равенству Моменты искомого распределения можно получить многократным численным дифференцированием в нуле таблично заданной функции, 0, 2, с последующей сменой знаков у нечетных производных. Однако предпочтительнее вычислять их непосредственно. Обозначим набор моментов показательного распределения с параметром, имеющий компоненты Символом будем обозначать свертку распределений в моментах. Для наборов моментов распределений между выходящими заявками сохраним индексацию прежних обозначений, заменив лишь на . В модели при числе заявок в системе Перепишем формулу для при в виде Заменяя преобразование Лапласа показательных плотностей их моментами и произведение ПЛС сверткой, убеждаемся, что в частности Заметим, что свертка в моментах распределений и может быть выполнена на основе символического разложения 9 путем перевода показателей степени в индексы соответствующих моментов. Для выполнения сверток полезно составить автономную процедуру. Результаты практически совпали с моментами распределения интервалов между входящими заявками, а коэффициенты немарковости с точностью до пяти знаков оказались нулевыми выходящий поток простейший. Это согласуется с классическим результатом Берке, позволяет считать основную идею расчета правильной и распространить ее на более сложные немарковские системы, для которых теория расчета выходящего потока до сих пор отсутствовала в частности, на интересующую нас дважды коксову. . Введем обозначения для -го яруса суммарная интенсивность обслуживания в -м микросостоянии каждой ветви интенсивность переходов вверх по завершению обслуживания интенсивность переходов вправо по завершению фазы обслуживания сумма двух последних интенсивностей равна наборы моментов распределения времени до ближайшего обслуживания при соответствующем исходном состоянии верхние индексы указывают левую и правую ветвь диаграммы соответственно количество микросостояний в одной ветви диаграммы. В этих обозначениях для и правой ветви диаграммы имеем Для тех же значений и левой ветви диаграммы надо дополнительно учитывать возможные переходы в правую ветвь по завершению фазы прибытия заявки После выполнения сверток в моментах согласно формуле 9 замечаем, что для каждого искомые входят в обе части приведенных уравнений, причем с перекрестом. Поэтому для их определения приходится последовательно решать систем из шести линейных алгебраических уравнений по три момента в обеих ветвях на каждое микросостояние. Для ненасыщенных ярусов 1, 2, 1 в правой ветви диаграммы прибытие заявки приводит в одноименные состояния левой ветви нижележащего яруса. Соответственно имеем рекуррентные формулы Для левой ветви зоны ненасыщенных состояний завершение фазы прибытия заявки может привести как в правую ветвь диаграммы, так и в нижележащий ярус Здесь первое слагаемое соответствует непосредственному завершению обслуживания, а последующие переходам по завершению первой фазы обслуживания и фазы прибытия заявки окончательной или с переходом во вторую фазу ожидания прибытия с рекуррентным учетом моментов распределения времени до ближайшего обслуживания во вновь возникшем состоянии. Наконец, в случае полного освобождения системы до очередного завершения обслуживания сначала придется дождаться прибытия хотя бы одной заявки. Здесь В ненасыщенной зоне искомые наборы моментов определяются последовательно через ранее вычисленные для каждого сначала вычисляются правые, а затем левые моменты. Интересующее нас распределение можно задать его первым моментом и набором коэффициентов немарковости. Тогда высшие моменты можно вычислить по формуле 10 Известно, что условное распределение времени ожидания заявки в системе подчинено показательному закону. Это обстоятельство позволяет считать, что вид распределения времени ожидания не зависит от распределения интервалов между смежными заявками и числа каналов и определяется только распределением времени обслуживания. В работе 4 предложен конструктивный метод решения этой задачи, основанный на сохранении коэффициентов немарковости системы 1. Зависимость структуры матриц переходов от типа и порядка аппроксимирующих фазовых распределений ставит ценность программной реализации расчетной схемы в прямую зависимость от возможности автоматического построения матриц переходов. Эту проблему в общем случае можно решить следующим образом для каждого -го яруса системы, автоматически сгенерировать последовательность ключей микросостояний формировать матрицы переходов, сопоставляя ключи-источники -го яруса и совместимые с ними по выбранному типу переходов ключи-преемники для матрицы на 1-м ярусе, для на -м, для на 1-м. В обсуждаемом случае -аппроксимации структура матриц и правила их формирования относительно очевидны. Однако программная реализация метода оказалась значительно сложнее, чем это представляется при ознакомлении с его идеей. Дело в том, что метод предполагает работу с переменным числом матриц перехода изменяемой размерности, определяемой в процессе счета. Соответственно при программировании на Фортране пришлось упаковывать матрицы каждого вида и их половинки для треугольных матриц в линейные массивы, выделять под эти объекты динамическую allocatable память, фиксировать отдельно их размеры и координаты в линейных структурах, явно переадресовывать операнды матричных операций. На эти проблемы наложились порождаемые специфической структурой упомянутых матриц блочная с ненулевыми блоками в виде диагональных матриц, блочно-диагональная с одинаковыми блоками, верхняя треугольная, диагональная. Учет этих особенностей при программировании требуемых матричных операций оказался нетривиальным и весьма поучительным. Для проверки корректности метода и его программной реализации оценивалась средняя длина очереди показатель компактный, наглядный, чувствительный к входным данным и инвариантный к масштабу времени при коэффициенте загрузки системы 0,7 для различных видов исходных распределений и числа каналов. Для моделей в обозначениях Кендалла 1, 1, 1, Г 1, 1, 1, Г 1, 2, 2,2, 2 были получены соответственно значения 1,633, 1,089, 0,817, 1,361, 0,861, 0,599, 1,292, 1,345, 0,692, 0,911, 0,113. Эти результаты практически совпали с полученными ранее посредством других численных методов, в том числе не использующих фазовые аппроксимации например, метода Кроммелина для систем, Быкадорова для Такача для . Правильность расчета выходящего потока подтверждается равенством средних интервалов между заявками входящего и выходящего потоков получением практически нулевых коэффициентов немарковости выходящего потока для моделей вида, обработанных по общей схеме приближением этих коэффициентов к таковым для распределения времени обслуживания в случае одноканальных систем при устремлении коэффициента загрузки к единице совпадением результатов обсчета вышеперечисленных моделей с полученными посредством менее универсальной аппроксимации . Самостоятельную ценность имеет наиболее типичный частный случай рассмотренной модели с простейшим входящим потоком. В этом случае диаграмма переходов сводится к одной ветви и программная реализация сильно упрощается. Как обобщение алгоритма можно рассматривать его вариант для системы с ограниченной очередью. В этом случае в микросостояния нижнего яруса диаграммы нет переходов снизу. Соответственно для этого яруса корректируется матрица и отпадает надобность в расчете одного из вспомогательных векторов итерационного метода Для определения вероятности свободного состояния на заключительном этапе итерационного метода здесь условие баланса заявок заменяется условием нормировки вероятностей. Дальнейшим обобщением является расчет замкнутой системы с интенсивностью входящего простейшего потока, зависящей от числа заявок в системе в типичном случае линейно убывающей до нуля. Здесь дополнительно модифицируются числовые значения матриц. Конкретные результаты данной статьи сводятся к следующим. 1. Предложен алгоритм расчета параметров распределения Кокса, выравнивающий три заданных момента. 2. Проведено исследование алгоритма выявлена область входных данных, порождающая патологические вероятности переходов комплексные и отрицательные показано, что при обратном переходе от вероятностей микросостояний к укрупненным вероятностям патология исчезает и конечные результаты согласуются с полученными существенно иными методами. Указаны преимущества -аппроксимации в сравнении с другими фазовыми распределениями. 3. Впервые предложены диаграммы переходов для дважды коксовой системы, на основе которой получены матрицы интенсивностей переходов. 4. Разработан способ расчета распределения интервалов между заявками выходящего потока, в частности непосредственно моментов этого распределения. 5. Даны рекомендации по программной реализации основных этапов алгоритма. Эти результаты вместе с методами решения уравнений баланса и расчета временных характеристик позволяют, наконец, сравнительно просто и достаточно точно проводить полный расчет многоканальных систем с произвольными распределениями интервалов между заявками и времени обслуживания. В сравнении с имитационным моделированием метод существенно выигрывает по объему и точности вычислений. Он избавляет от изучения и использования других фазовых аппроксимаций и если не говорить о подготовке будущих теоретиков вообще всех прочих методов расчета немарковских систем обслуживания. Метод может использоваться как составная часть процедур расчета сетей обслуживания методом потокоэквивалентной декомпозиции 1. 