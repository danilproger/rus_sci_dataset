О  ТОЧНОСТИ  СПЕКТРАЛЬНЫХ  МЕТОДОВ РАСЧЕТА  ПОКАЗАТЕЛЕЙ  ВАРИАБЕЛЬНОСТИ СЕРДЕЧНОГО  РИТМА 

Представлены результаты экспериментального исследования ошибки определения оценок частотных показателей вариабельности сердечного ритма при использовании наиболее распространенных методов спектрального анализа: на основе быстрого преобразования Фурье и на основе модели авторегрессии. Показано, что как точность, так и статистическая устойчивость общепринятых спектральных показателей вариабельности, рассчитанных по отдельной реализации сигнала, относительно невелики, что необходимо учитывать при практическом использовании данной методики. The results of experimental estimation of the heart rate variability spectral parameters accuracy and validity are presented. Two groups of the spectral analysis methods were considered: FFT based and parametric (based on autoregressive model). It is shown that all the common methods provide comparatively high level of the spectral parameters estimation errors.

Методика анализа вариабельности сердечного ритма ВСР предполагает исследование статистических и частотных свойств сигнала, образуемого последовательностью интервалов времени между смежными сокращениями сердца, относящимися к фоновому ритму. Установлено 1, 2, что анализ ВСР позволяет получить количественные индикаторы активности различных отделов вегетативной нервной системы человека, что оказывается полезным для решения многих медицинских диагностических задач. Интервалы времени между последовательными сокращениями сердца RR-интервалы измеряются по ЭКГ обычно как расстояния между вершинами R-зубцов QRS-комплексов. Если за период регистрации ЭКГ в сигнале наблюдались нарушения сердечного ритма или помехи, вызвавшие ошибки в определении RR-интервалов, то участки сигнала, соответствующие этим событиям, должны исключаться из процедуры анализа. В связи с этим при анализе ВСР в качестве входных данных принято использовать не непосредственно последовательность RR-интервалов, а так называемую последовательность NNинтервалов т.е. интервалов между смежными QRS-комплексами фонового ритма или комплексами класса норма 1, 2. Так как анализируемая последовательность интервалов времени не является равномерно дискретизованным сигналом, традиционно используемым при частотном анализе, то к ней нельзя непосредственно применить общепринятые методы цифровой обработки. Поэтому на первом этапе анализа из последовательности NN-интервалов с использованием гладкой интерполяции получают равномерно дискретизованный сигнал частота дискретизации обычно составляет 4 Гц, который рассматривается как описание восстановленной функции управления сердечным ритмом 1, 2. Именно исследование этой функции, порождающей последовательность регистрируемых RR-интервалов, является предметом анализа ВСР. Международными стандартами по анализу ВСР 1 в качестве основных спектральных показателей рекомендованы три параметра, представляющих собой суммарные мощности в трех диапазонах частот VLF 0,0030,04 Гц, LF 0,040,15 Гц и HF 0,150,4 Гц, а также ряд показателей, производных от перечисленных параметров. Спектральные показатели ВСР рассчитываются с использованием как непараметрических классических методов, основанных на дискретном преобразовании Фурье или на алгоритме ускоренного вычисления этого преобразования быстром преобразовании Фурье БПФ, так и параметрических методов, в основе которых лежит модель авторегрессии скользящего среднего 1. Применение указанных методов связано с рядом ограничений и допущений, каждое из которых оказывает влияние на точность и статистическую устойчивость получаемых оценок 3. В частности, использование методов на основе БПФ подразумевает следующие условия. Входной сигнал рассматривается как бесконечный и периодический с периодом повторения, равным длительности анализируемого фрагмента. Это отражается в дискретности получаемого спектра и его ограниченном разрешении по частоте, которое тем хуже, чем короче взятый для анализа фрагмент. Взятие фрагмента сигнала конечной длительности в неявном виде предполагает использование прямоугольного окна, что ведет к появлению эффекта спектральной утечки, т. е. растекания энергии периодических компонент сигнала по частотному диапазону. Представление анализируемого сигнала в дискретной форме приводит к тому, что получаемый спектр является бесконечным и периодическим. Достоверная оценка какой-либо частотной составляющей может быть получена лишь при условии, что анализируемый фрагмент сигнала включает, по меньшей мере, 45 периодов колебаний с соответствующей частотой. Для параметрических методов, в свою очередь, характерны следующие особенности. Рассчитанный частотный спектр не является обратимым, т. е. по нему не может быть точно восстановлен исходный сигнал. Получаемая спектральная оценка существенно зависит от выбора порядка модели. Кроме того, необходимость подбора оптимального порядка исключает возможность полностью автоматического расчета спектральных оценок. Для моделирования низкочастотных компонент анализируемого сигнала требуется использовать достаточно большие значения порядка модели, что приводит к высокой вычислительной сложности процедур анализа. Помимо этого для обеих групп методов характерны следующие проблемы. Использование методов спектрального анализа предполагает выполнение условия стационарности исследуемого процесса, что для сигнала сердечного ритма может считаться справедливым лишь условно и на ограниченных отрезках времени. Получаемые спектральные оценки носят случайный характер, что связано со случайностью анализируемого процесса 3. Из перечисленных условий видно, что спектральные параметры, получаемые по фрагментам сигнала относительно небольшой длительности один из наиболее распространенных подходов при анализе ВСР, могут служить лишь приблизительными оценками истинных частотных свойств изучаемого сигнала. С другой стороны, метод получения показателей VLF, LF и HF как суммарных мощностей в определенных частотных диапазонах соответствует использованию усреднения по частоте, которое само по себе должно повышать статистическую устойчивость результатов 3. Целью данной работы являлось исследование наиболее часто используемых методик расчета спектральных показателей ВСР с точки зрения оценки точности и статистической устойчивости получаемых частотных параметров. Представленные в настоящей работе исследования проводились путем моделирования сигнала сердечного ритма и алгоритмов его анализа в программной среде MATLAB. В целях исследования точности вычисления спектральных оценок была создана модель сигнала, обладающего частотными свойствами, характерными для сигнала ВСР в норме концентрация мощности в диапазонах частот VLF, LF и HF 1, 4. Для этого в трех указанных диапазонах частот были сформированы три огибающие функции спектральной плотности мощности СПМ в форме гауссовых кривых, центр каждой из которых расположен в середине соответствующего диапазона частот, а значения на границах диапазона составляют приблизительно 1 от максимума для данной кривой. Масштаб каждой из трех кривых был выбран таким, чтобы величина площади под ней равнялась 500, что соответствует порядку наблюдаемых в норме значений показателей ВСР VLF, LF и HF, измеренных в миллисекундах в квадрате. Выражение для отсчетов полученной функции имеет вид 1 где выбранное число отсчетов по частоте в диапазоне частот от 0 до Гц шаг по частоте 1, 2, 3 номер диапазона частот соответственно для диапазонов VLF, LF и HF среднеквадратическое отклонение СКО для соответствующей гауссовой кривой здесь и границы -го диапазона. По отсчетам модельной СПМ были восстановлены значения модулей амплитудного спектра 2 Рассчитанные значения компонент амплитудного спектра были использованы для создания модельного сигнала функции управления сердечным ритмом где 102400 выбранное число отсчетов сигнала 10 мс интервал дискретизации соответствует частоте дискретизации 100 Гц 1000 мс произвольно выбранное среднее значение RR-интервала, а фазовый сдвиг для -й синусоиды, полученный как случайное число с равномерным распределением в диапазоне от 0 до 1 случайный фазовый сдвиг использован для предотвращения эффектов интерференции синусоид с частотами, кратными . В результате была получена реализация модельного сигнала, имеющая длительность 1024 с или 17мин и 4 с, с частотой дискретизации 100 Гц. Последовательность RR-интервалов, соответствующая рассчитанному по формуле 3 сигналу, была сгенерирована с использованием концепции модели порождения сигнала сердечного ритма, известной как IPFM Integral Pulse Frequency Modulation интегральная импульсно-частотная модуляция 5, в соответствии с описанным ниже алгоритмом. 1. начальное значение номера RR-интервала. 2. начальное значение номера отсчета сигнала. 3. начальное значение первого RR-интервала. 4. накопление значения очередного интервала. 5. Если, то переход к п. 8. 6. запись значения -го RR-интервала. 7. начальное значение следующего RR-интервала. 8. переход к очередному отсчету сигнала. 9. Если, то переход к п. 4, в противном случае завершение процедуры. Полученная последовательность RR-интервалов содержит 1024 значения. Далее с использованием интерполяции кубическими сплайнами была восстановлена исходная функция управления в виде равномерно дискретизованного сигнала с частотой 4 Гц частота, рекомендуемая международным стандартом по ВСР 1. Число отсчетов полученной реализации составило 4096 2, что позволяет непосредственно использовать алгоритм БПФ для расчета СПМ сигнала по всей реализации целиком. На рис. 1 показаны графики СПМ модельного сигнала и сигнала, восстановленного по последовательности RR-интервалов, а также приведены значения спектральных показателей ВСР, рассчитанные для обеих кривых СПМ. Как можно видеть, СПМ, рассчитанная по всей реализации модельного сигнала, почти совпадает с исходной СПМ модели, а значения параметров близки к заданным для модели. Некоторая потеря мощности для показателя HF около 6 объясняется сглаживающим эффектом интерполяции с использованием кубических сплайнов. На рис. 2, показан фрагмент сгенерированной последовательности RR-интервалов, а на рис. 2, график равномерно дискретизованной функции, восстановленной по данному фрагменту. Достаточно точное совпадение как СПМ, так и спектральных параметров с теоретически заданными значениями объясняется в данном случае тем, что при таком способе получения модельного сигнала все синусоиды, составляющие сигнал согласно формуле 3, целое число раз укладывались в генерируемый фрагмент, что исключает появление эффекта спектральной утечки. Таким образом, было показано, что модельный сигнал обладает заданными для модели частотными свойствами и может рассматриваться в качестве образца реализации сигнала сердечного ритма, стационарной на всем протяжении. При практическом использовании методик оценки частотных параметров ВСР принято выполнять анализ либо по коротким фрагментам сигнала обычно 5 мин, получаемым в ходе процедур функциональных исследований, либо по суточным записям, получаемым в ходе холтеровского мониторного наблюдения 1, 2. В данном исследовании рассматривался только первый подход. Исследовались методы, наиболее часто применяемые при спектральном анализе, рекомендованные международным и российским стандартами по анализу ВСР 13. 1. Непараметрические классические методы на основе дискретного преобразования Фурье периодограммный метод с использованием четырех типов окон прямоугольного, Бартлетта треугольного, фон Ханна и Тьюки 10 80 10 метод Уэлча с разбиением пятиминутного фрагмента на три перекрывающихся сегмента длительностью по 3 мин с использованием окна фон Ханна 2. 2. Параметрические методы на основе авторегрессионной модели со значениями порядка 20, 30 и 50 метод Берга ковариационный метод модифицированный ковариационный метод. Графики использованных оконных функций приведены на рис. 3. Выбор окон определялся следующими соображениями. Использование прямоугольного окна соответствует операции взятия конечного фрагмента без какого-либо сглаживания сигнала по краям, что ведет к существенной спектральной утечке, но обеспечивает наилучшее возможное разрешение по частоте. Окно Бартлетта треугольное является часто используемым простейшим сглаживающим окном. Окно фон Ханна обеспечивает высокую степень снижения спектральной утечки правда, за счет заметного ухудшения разрешения спектра 2. Окно Тьюки с 10-ми косинусными склонами представляет собой часто используемое эмпирическое окно, обеспечивающее достижение практичного компромисса между спектральной утечкой и потерей спектрального разрешения. Для получения оценок статистической устойчивости результатов из модельной последовательности RR-интервалов случайным образом выбирались 20 фрагментов продолжительностью по 5 мин каждый. Эти фрагменты были использованы для вычисления СПМ и спектральных параметров с помощью каждого из перечисленных методов. К каждому из анализируемых фрагментов применяли следующие процедуры предварительной обработки восстановление функции управления сердечным ритмом методом гладкой интерполяции с использованием кубических сплайнов получение равномерно дискретизованного сигнала 1200 отсчетов с частотой 4 Гц удаление линейного тренда с использованием метода наименьших квадратов. Дальнейшие процедуры для методов на основе БПФ включали следующие этапы с учетом различий между периодограммным методом и методом Уэлча умножение фрагмента на оконную функцию дополнение нулями до отсчетов расчет дискретного преобразования Фурье с помощью алгоритма БПФ расчет СПМ в диапазоне частот от 0 до 0,5 Гц где 4 Гц, 0, 1, 2, 2 и соответственно значения компонент разложения по Фурье и СПМ для частот домножение СПМ на корректирующий коэффициент, учитывающий потери мощности при использовании окна где размер окна в отсчетах отсчеты оконной функции домножение СПМ на корректирующий коэффициент, учитывающий потери мощности при дополнении нулями, где число отсчетов фрагмента сигнала до дополнения нулями. Для параметрических методов СПМ рассчитывалась непосредственно с помощью процедур MATLAB, реализующих соответствующие методы. Показатели VLF, LF и HF вычислялись интегрированием СПМ по соответствующим диапазонам частот с использованием формулы прямоугольников 3 На рис. 4 и 5 приведены примеры графиков оценок СПМ, полученных для одного и того же фрагмента модельного сигнала с использованием трех различных вариантов непараметрических и параметрических методов соответственно. На графиках также указаны рассчитанные по этим СПМ значения параметров VLF, LF и HF. Для контроля на всех графиках пунктирной линией показана истинная СПМ модельного сигнала. Кроме того, для периодограммного метода с использованием прямоугольного окна и для метода Берга с порядком модели, равным 50, были рассчитаны оценки СПМ, усредненные по 20 случайно выбранным фрагментам модельного сигнала см. рис. 4, 5, . Можно видеть, что оценки СПМ, полученные таким способом, оказываются существенно ближе к истинной СМП модели. Однако этот результат получен благодаря стационарности процесса на всем протяжении модельного сигнала, что в реальных условиях анализа ВСР практически недостижимо. Анализ приведенных на рис. 4 и 5 оценок СПМ, рассчитанных для отдельного фрагмента модельного сигнала, показывает, что как погрешность расчета параметров VLF, LF и HF, так и разброс получаемых значений достаточно велики. В целях получения статистических оценок этих погрешностей для параметров, полученных для 20 случайно выбранных фрагментов, рассчитывались следующие показатели среднее значение характеризует наличие смещения величин оценок максимальная относительная ошибка показывает наихудший случай СКО характеризует разброс значений. В табл. 1 и 2 сведены результаты полученных оценок точности и статистической устойчивости соответственно для непараметрических и параметрических методов. На основании имеющихся результатов могут быть сделаны следующие выводы. 1. Все исследованные методы дают достаточно большую ошибку, особенно для значения показателя VLF, соответствующего наиболее низкочастотным компонентам сигнала сердечного ритма. 