ПРИМЕНЕНИЕ МЕТОДОВ ОЦЕНИВАНИЯ  РАЗМЫТОСТИ ЦИФРОВЫХ ИЗОБРАЖЕНИЙ  В ЗАДАЧЕ АУДИОВИЗУАЛЬНОГО МОНИТОРИНГА 

исследование и разработка математических и программных средств оценивания размытости и других показателей качества цифровых изображений. Результаты: приведены классификация и анализ существующих методов количественной оценки размытости изображений, применяемых для обработки кадров в режиме реального времени. Для повышения скорости обработки и надежности определения качества интересующей области изображения при экспериментальной проверке реализованы несколько вариантов сегментации части кадра, а именно: анализировалось все изображение, обнаруженное лицо на изображении и область лица размером 200×200 пикселей. Предложенная процедура предварительного поиска области лица в кадре и оценки ее размытости на основе статистического анализа коэффициентов яркости пикселей позволила определить 94 % неискаженных кадров, полученных в ходе автоматической регистрации участников совещания в интеллектуальном зале. Практическая значимость: предложенные решения направлены на ускорение процессов автоматического распознавания образов на цифровых изображениях и могут быть успешно применены в широком спектре приложений компьютерного зрения.

В настоящее время системы автоматического мониторинга применяются в широком спектре областей и сфер деятельности человека. Постоянный рост объемов записываемых аудиовизуальных и других типов данных требует разработки технологий их автоматизированной обработки с минимальным участием человека 13. Существенная доля записываемых данных приходится на источники визуальной информации фотои видеосъемка изображения, полученные от электронных микроскопов, телескопов, и т. д. Задачей данного исследования является разработка методов, алгоритмов и программных средств аудиовизуального мониторинга, обеспечивающих сокращение времени и затрат на поддержку проведения мероприятий в зале совещаний за счет автоматизации процессов управления мультимедийным, аудиои видеозаписывающим оборудованием. Одной из целей аудиовизуального мониторинга является определение временных моментов событий изменения состояния положения в пространстве и поведения участников мероприятий, к которым относится появление нового участника в зале, выступления докладчиков и реплики сидящих в зале слушателей. Другой целью аудиовизуального мониторинга является автоматическая запись и анализ аудиовизуальных данных, отражающих происходящие в зале события, для определения текущей ситуации в интеллектуальном зале. Далее рассмотрим основные аспекты, касающиеся видеомониторинга участников в зале совещаний, и способы оценивания качества изображений, захватываемых видеокамерами в ходе мероприятий. Процесс автоматической обработки изображений обычно состоит, во-первых, из предварительной обработки кадра, включая удаление кадров неудовлетворительного качества, нормализацию по освещенности, очистку от цифровых шумов и др., и, во-вторых, из извлечения характеристик изображения, сегментации и распознавания образов, представляющих интерес в данной прикладной области. Часто возникает необходимость из некоторого множества изображений отобрать кадры, наиболее качественные и соответствующие требованиям конкретной технической задачи. Для эксперта-оператора подобная работа не составит труда, однако если объем данных велик, то, прежде всего, на стадии первичной обработки целесообразно автоматизировать процесс оценки качества изображений и фильтрации кадров, не имеющих достоверных данных. В работе 4 проанализированы методы повышения контрастности изображений, увеличивающие визуальную различимость фрагментов за счет преобразования шкалы яркости и адаптивных способов настройки параметров, и их применение в системах цифровой обработки видеоинформации. В серии работ 5, 6 предлагаются методы получения априорной оценки размытости изображения. В случае гауссова и равномерного размытия исходного монохроматического полутонового изображения описанный в работе метод позволяет дать оценку размера окна размытия. В работе 7 рассматриваются три вида представления изображений контурный, градиентный и фактурный, которые являются семантически значимыми для восприятия зрительной системой человека. Также обсуждаются типы дефектов изображений, например, размытие световых и цветовых границ наличие посторонних узоров в виде муарового рисунка, обусловленного шумом пространственной дискретизации наличие ложных контуров, обусловленных недостаточным количеством уровней квантования, и др. Описанный в работе метод реставрации изображений основан на увеличении резкости на границах и участках градиентного изменения интенсивности и фильтрации шумов на градиентных областях. Алгоритмы оценки качества изображений востребованы практически во всех областях применения технологий компьютерного зрения, например, таких систем, как фотои видеонаблюдения и регистрации, управления процессами промышленные роботы, автономные транспортные средства, моделирования объектов и окружающей среды, человеко-машинного взаимодействия, контроля качества и т. д. 4, 8, 9. Человек воспринимает любое изображение комплексно, однако судить о его качестве может, исходя из следующих основных параметров яркости, контрастности, преобладающего тона, резкости и зашумленности. В случае машинной обработки изображений эти параметры могут быть оценены как по отдельности, так и комплексно. В тех случаях, когда на вход поступает массив однотипных изображений, например при фоторегистрации, не все показатели качества могут варьироваться. При съемках фиксированной камерой неких подвижных объектов яркость, контрастность, зашумленность могут изменяться незначительно, в то время как на первый план выходит оценка резкости изображения. Изменение резкости может быть результатом погрешностей как аппаратных средств записи и трансляции, так и программного обеспечения цифровой обработки изображений. Резкость изображения может быть увеличена за счет фокусировки объектива камеры на объект и применения дополнительных методов цифровой обработки исходного изображения. Высококачественная видеоаппаратура должна без искажений передавать яркостный переход максимального контраста. Размытость на изображении получается в результате диффузного смешения двух контрастных цветов. Человек воспринимает и оценивает резкость по наличию контура контрастного яркостного или тонового перехода между смежными областями на изображении. Если во время съемки либо камера была неверно сфокусирована, либо снимаемый объект находился в движении, то полученное изображение будет частично или полностью размытым. В следующем разделе рассмотрим более подробно проблему размытости изображений и методы, позволяющие определить снижение качества, возникшее вследствие нечеткости изображений. Основными причинами искажений, приводящих к ухудшению резкости, являются ограниченная разрешающая способность формирующей системы, расфокусировка, наличие искажающей среды например, атмосферы, движение камеры по отношению к регистрируемому объекту и т. д. 2. Математическая модель формирования изображения имеет вид где, выход линейной системы формирования изображения, двумерный аддитивный шум. Изображение, полученное путем линейного искажения исходного изображения при отсутствии шума, определяется интегралом свертки где символ двумерной свертки, двумерная импульсная характеристика или функция рассеяния точки линейной искажающей системы. Таким образом, значение функции яркости, исходного изображения в точке с координатами, размазывается в соответствии с видом функции рассеяния точки, и искажается аддитивным шумом. Резкость изображения характеризуется воспроизведением мелких деталей и определяется разрешающей способностью формирующей системы. При расфокусировке точка воспроизводится в виде некоторого пятна кружка размытия, и две близко расположенные точки на исходном изображении сливаются в одну на наблюдаемом. Величина кружка размытия зависит от фокусного расстояния объектива, а также от расстояний от объектива до объекта и до плоскости формируемого изображения. Дискретное изображение будет четким сфокусированным, если диаметр кружка размытия не превышает шага дискретизации наблюдаемого изображения. В противном случае линейные искажения становятся заметными 2. Таким образом, о размытости изображения можно судить, оценивая его фокус. Кроме того, комплексная оценка качества также позволяет выявить размытые изображения. Для оценки размытости целесообразно конвертировать цветные изображения в ахроматические и исследовать прямоугольную матрицу значений яркости пикселей изображения. Размер такой матрицы может совпадать с размерами изображения в пикселях либо соответствовать размерам выделенной области изображения. Методы оценки фокуса изображения можно разделить на следующие категории 10. 1. На основе оценки градиента GRA, где градиент или первая производная изображения служит показателем более резких яркостных переходов на границах объектов, присутствующих на изображении. 2. На основе оценки лапласиана LAP, где лапласиан или вторая производная изображения могут служить для определения количества резких границ на изображении. 3. На базе вейвлет-преобразований WAV, где изменение коэффициентов дискретного вейвлет-преобразования используется для описания частотной и пространственной областей изображения. 4. Основанные на изучении статистических характеристик изображения STA, оценивающие размытость как отклонение от нормального распределения, которому, как правило, следуют неискаженные изображения. 5. На основе дискретных косинусных преобразований DCT, где, подобно вейвлет-преобразованиям, коэффициенты дискретного косинусного преобразования служат оценкой фокуса изображения в частотной области. 6. Комплексной оценки MIS. Перечисленные типы методов отличаются сложностью и временем обработки изображений, поэтому в зависимости от предметной области и выделенных вычислительных и временных ресурсов выбирается оптимальный метод обработки изображений. Рассмотрим четыре метода из некоторых перечисленных выше категорий, показавшие наилучшие экспериментальные результаты при оценке размытости изображений и обеспечивающие их обработку в режиме реального времени. Метод Tenengrad 11, 12 относится к категории GRA, в которой оценивается градиент изображения. Дадим ему обозначение GRA1. Данный метод основан на оценке среднего квадрата градиента яркости пикселей монохромного изображения, которая производится при помощи оператора Собеля, вычисляющего приближенный вектор градиента яркости в каждой точке 1. Приближенные значения производных в каждой точке вычисляются путем свертки двух масок вращения ортогональных матриц размерностью 3 3 с первоначальным изображением по горизонтали и по вертикали где, исходное изображение, маски на основе оператора Собеля двухмерная операция свертки. Приближенное значение средней величины квадрата градиента по обрабатываемому изображению вычисляется по формуле Увеличение среднего значения квадрата градиента означает наличие резких переходов яркости на изображении и, следовательно, более высокую четкость границ. Среди преимуществ данного метода следует отметить относительно небольшой объем вычислений и высокую скорость обработки. Лучше всего метод работает на небольшой области изображения, где есть контрастные переходы. Теперь рассмотрим метод оценки размытости изображения 13, основанный на измерении локального контраста яркости и относящийся к категории MIS, поэтому обозначим его MIS1. Данное измерение проводится путем вычисления отношения интенсивности каждого пикселя монохромного изображения и среднего уровня серого в окрестностях данного пикселя где, исследуемый пиксель среднее значение яркости в его окрестности. Размер окрестности, пикселей с центром в точке, определяется эвристическим путем. Коэффициент размытости равен сумме значений, по всему изображению либо по исследуемой области изображения. Далее рассмотрим другой метод из категории MIS метод измерения размытости по кривизне 13, 14, обозначим его MIS2. Матрица значений яркости пикселей монохромного изображения представляется как трехмерная поверхность второго порядка, координатами каждой точки которой являются две координаты каждого пикселя и значение его яркости. Кривизна данной поверхности соответствует переходам яркости между пикселями и аппроксимируется следующей функцией Чем выше значение кривизны трехмерной поверхности, тем более сфокусированным будет исследуемое изображение. Коэффициенты, приближенно вычисляются по методу наименьших квадратов путем свертки исходного изображения с матрицами, где транспонированные матрицы, исходное изображение. Оценкой размытости изображения при этом является сумма абсолютных величин значений коэффициентов Метод не подходит для однородных изображений с плавными переходами яркости таких, например, как безоблачное небо, поскольку в данном случае кривизна трехмерной поверхности изменяется незначительно и не может служить адекватным показателем размытости. Последним рассмотрим метод NIQE NoReference Image Quality Assessment 15, относящийся к категории STA, обозначим его STA1. Метод NIQE основывается на статистическом исследовании натуральных изображений. Под натуральными понимаются изображения, полученные при помощи фотосъемки, захвата кадра из видеоряда и т. д., т. е. изображения, не сгенерированные искусственно и не искаженные искусственными шумами. В натуральных монохромных изображениях матрица нормализованных коэффициентов яркости пикселей будет стремиться к нормальному распределению. Любое зашумление, в том числе размытость, приведет к отклонению от нормального распределения. Идея метода состоит в сравнении двух многомерных гауссовых моделей признаков вычисленной для исследуемого изображения и построенной на основе заранее подготовленного набора изображений. Для вычисления признаков, необходимых для построения модели, выполняется нормализация коэффициентов яркости пикселей изображения посредством вычитания локального среднего из исходной матрицы коэффициентов яркости монохромного изображения с последующим делением на среднеквадратическое отклонение где 1, 2, 1, 2, пространственные индексы, размеры изображения, математическое ожидание, дисперсия где, двумерная кругообразно-симметрическая весовая функция Гаусса. Такая нормализация позволяет существенно снизить зависимость между коэффициентами яркости соседних пикселей, приводя их к форме, удобной для построения многомерной гауссовой модели. Поскольку четкость всего изображения зачастую ограничивается глубиной резкости снимающей аппаратуры, целесообразно разбить исследуемое изображение на участки размером пикселей, затем, оценив локальную резкость каждого участка, выбрать для дальнейшего анализа наиболее резкие участки. Локальная резкость может быть вычислена посредством дисперсии, Порог резкости, относительно которого оценивается локальная резкость участка, определяется экспертным путем. Выбранные участки, прошедшие порог, описываются обобщенным нормальным распределением с нулевым средним где гамма-функция Параметры, могут быть оценены с применением метода моментов, описанного в работе 16. Отклонение модели изображения от обобщенного нормального распределения может быть выявлено посредством анализа произведений пар соседних коэффициентов нормализованной яркости пикселей I, I, 1, I, I 1, I, I 1, 1, I, I 1, 1, где 1, 2, 1, 2, по четырем направлениям горизонтали, вертикали, главной и побочной диагоналям. Эти параметры следуют асимметричному обобщенному нормальному распределению Параметр контролирует форму кривой распределения, параметры, контролирующие разброс слева и справа соответственно. Коэффициенты, могут быть эффективно оценены с использованием метода моментов. Среднее значение распределения также является одним из признаков, которые учитываются при построении модели В результате вышеизложенных вычислений имеем некий набор признаков, который сравнивается с многомерной гауссовой моделью, построенной на основе набора различных изображений известного качества где, набор вычисленных признаков и среднее и ковариация матрицы многомерной гауссовой модели, вычисленные методом наибольшего правдоподобия. Коэффициент качества изображения рассчитывается по следующей формуле где, векторы средних шаблонной многомерной гауссовой модели и модели, построенной для тестируемого изображения, соответственно, матрицы ковариации этих моделей. Коэффициент указывает на расхождения между моделями соответственно, чем меньше его значение, тем ближе распределение исследуемого изображения к нормальному, в противном случае на изображении присутствует зашумление, которое, в том числе, может являться размытием. Выбор области, по которой будет проводиться оценка размытости изображения, зависит от конкретной практической задачи, в рамках которой проводится исследование. Такой областью может служить как все изображение, так и очертания объекта на нем либо области, в которой данный объект расположен. Например, при исследовании фотографий, на которых присутствуют несколько человек, целесообразно выбрать для анализа только те области, где вероятнее всего находятся их фигуры. На портретных фотографиях областью оценки качества будет являться лицо человека либо ли-ца, если их несколько. При фоторегистрации транспортных средств во время дорожного движения основной интерес представляет регистрационный номер. Выделение конкретной области оценки качества позволяет увеличить робастность методов оценки качества так как анализу не подвергаются области, вносящие искажения, но не влияющие на область интереса, а также существенно повысить скорость обработки изображения за счет уменьшения обрабатываемого объема данных. В нашем случае при решении задачи автоматической регистрации участников совещания в интеллектуальном зале наиболее важными на изображении областями являются те, которые содержат лицо человека 17. Примеры сегментации интересующих областей на изображении представлены в табл. 1. Выбранные три типа областей на изображении использовались для сравнения производительности четырех описанных выше методов, для этого применялась процедура предварительной сегментации заданной части кадра, на которой уже производился расчет размытости пикселей. В проведенных экспериментах анализировалась база данных фотографий участников мероприятий, проходивших в интеллектуальном зале СПИИРАН. Изображения были записаны с использованием программно-аппаратного комплекса аудиовизуального мониторинга и дополнительно не обрабатывались 18. Применение математического и программного обеспечения обработки аудиовизуальных данных в ходе мониторинга мероприятий в зале позволяет определить текущие положения участников, время их выступлений, этапы мероприятий и автоматизировать персонифицированную запись протоколирование мультимедийных данных. При видеомониторинге участников в зале совещаний использовались камеры трех различных моделей AXIS 212, 215, 207, параметры которых приведены в табл. 2. В качестве областей интереса рассматривались все изображение, обнаруженное лицо на изображении, область лица размером 200 200 пикселей. Аннотированная база данных, использованная для экспериментов, состояла из 50 резких и 50 размытых фотографий. Деление фотографий было произведено экспертным путем. Размытые фотографии использовались для расчета порогового значения оценки размытости по каждому методу. Затем при тестировании на вход каждому методу подавался набор резких фотографий и определялся процент фотографий, оценка размытости которых превышала установленный порог. Результаты эксперимента представлены в табл. 3. Наилучшие результаты большинство методов показывает на небольшом сегменте, выделенном на найденной области лица. Естественно, что скорость обработки повышается с уменьшением области анализа. Кроме того, точность метода, как правило, также возрастает при уменьшении анализируемой области. Так, например, метод оценки по локальному контрасту не работает на больших областях, однако показывает приемлемый результат на области 200 200 пикселей. Наиболее точным из вышеописанных является метод STA1, однако он же является и самым длительным по времени обработки. Оценка размытости изображений является необходимым этапом обработки в системах, работающих с большими входными массивами визуальной информации. Предварительная оценка позволяет исключить из области дальнейшего анализа изображения низкого качества, не несущие полезную информацию, экономя тем самым загруженность автоматических систем компьютерного зрения. Возникающая из-за плохих условий съемки размытость происходит вследствие неверной фокусировки снимающего оборудования либо непредвиденного движения объекта съемки. Она может быть оценена различными методами, среди которых можно выделить исследование градиента яркости пикселей изображения, отношение значений яркости пикселей на некоторой области, статистический анализ коэффициентов яркости пикселей. Рассмотренные в статье методы позволяют оценить количественно величину размытости, являющуюся одним из критериев качества изображений, они удобны в моделировании и применении в различных алгоритмах обработки визуальной информации. Предварительное выделение области лица на изображении и оценка ее размытости были успешно применены для отбора искаженных кадров в задаче автоматической регистрации участников совещания в интеллектуальном зале. Работа выполнена при частичной финансовой поддержке РФФИ проект 13-08-0741-а. 