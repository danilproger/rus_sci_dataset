АДАПТИВНЫЙ АЛГОРИТМ ВЫДЕЛЕНИЯ   И ОБНАРУЖЕНИЯ ВОЗДУШНЫХ ОБЪЕКТОВ   НА ИЗОБРАЖЕНИЯХ 

Описан алгоритм выделения и обнаружения воздушных объектов, построенный на оценивании параметров авторегрессионной модели фона с помощью процедуры адаптивной пространственной фильтрации. На основе данного подхода разрабатывается модифицированный вариант алгоритма. Приводятся результаты сравнительных экспериментальных исследований.

В последние десятилетия комплексы обработки изображений реального времени активно применяются в составе систем автоматического сопровождения воздушных объектов, наблюдаемых на фоне ясного или облачного неба, в целях решения задач их обнаружения и оценки параметров. В качестве объектов интереса могут выступать самолеты, вертолеты, беспилотные летательные аппараты, ракеты. Необходимо отметить, что ранее для этих целей использовались преимущественно радиолокационные станции РЛС. Однако РЛС свойственны существенные недостатки, что требует поиска и внедрения новых подходов. Преодолеть многие проблемы можно путем использования современных телевизионных и тепловизионных датчиков для получения изображения объекта с последующей компьютерной обработкой и анализом видеоинформации. Примеры формируемых изображений, содержащих воздушные объекты, приведены на рис. 1. В ряде работ 1, 2 рассматриваются алгоритмы, позволяющие обнаруживать точечные и малоразмерные воздушные объекты, однако они ориентированы преимущественно на обработку изображений, получаемых с тепловизионных датчиков, и часто не способны эффективно обнаруживать протяженные объекты. Разработанные алгоритмы обнаружения 3 ориентируются либо на случай неподвижного фона при перемещающемся объекте, либо на использование предварительной процедуры компенсации геометрических искажений изображений, вызванных смещением поля зрения видеодатчика. Однако при наблюдении объектов на относительно однородном фоне возникает проблема оценивания параметров геометрических преобразований с требуемой точностью, что в итоге приводит к ухудшению качества решения рассматриваемой задачи. Таким образом, разработка эффективных алгоритмов выделения, обнаружения и оценки параметров воздушных объектов до настоящего времени остается актуальной задачей. В качестве модели формирования изображения, получаемого с помощью видеодатчика, можно использовать пространственно-временную модель заслона 3, 4. Будем рассматривать только пространственную информацию, тогда, опуская номер кадра, данную модель можно записать в следующем виде где, высота и ширина кадра, наблюдаемое изображение, и, неизвестные функции, значения которых являются яркостями точек фона и объекта соответственно шум видеодатчика. Функция, которая определяет расположение объекта на изображении, задается правилом Задача объектов заключается в нахождении оценки по наблюдаемому изображению, . Таким образом, выделение объектов состоит в классификации точек исходного изображения на точки, принадлежащие объекту, и точки, принадлежащие фону. Этап выделения объектов, как правило, предшествует этапу объектов, который заключается в принятии решения о присутствии или отсутствии объекта на изображении, 3. Можно отметить, что многие существующие подходы к решению задачи обнаружения объектов основываются на предварительном получении оценки фактически являющейся бинарным изображением. Располагая информацией о для каждого объекта можно вычислить такие параметры, как левая, правая, верхняя и нижняя границы. Перечисленные параметры определяют минимального размера прямоугольник, ограничивающий объект. Координатами объекта будем считать координаты центра такого прямоугольника, а размерами объекта высоту и ширину ограничивающего прямоугольника. При наблюдении воздушных объектов в качестве фоновой составляющей может рассматриваться облачное небо с плавными переходами яркости. Для описания подобного фона предлагается использовать авторегрессионную модель АРмодель следующего вида 1 где, коэффициенты авторегрессии, ненаблюдаемый белый формирующий шум с нулевым математическим ожиданием величина определяет порядок модели. Фактически модель 1 задает марковское поле на прямоугольной решетке Для принятия решения о наличии объектов в кадре необходимо компенсировать фон, описываемый марковским полем, что в свою очередь предполагает нахождение оценок параметров этого поля. С данной целью широко используются подходы, основанные на решении уравнений ЮлаУолкера 5. Отмеченный метод обладает тем недостатком, что для его реализации необходимо находить оценку корреляционной матрицы фона, что составляет определенные трудности. Во многих случаях для нахождения используются алгоритмы линейного предсказания 6. Классический алгоритм требует решения переопределенной системы линейных уравнений на основе метода наименьших квадратов. Однако в общем случае параметры модели могут зависеть от, что существенно усложняет задачу. В ситуациях, характеризующихся априорной неопределенностью и пространственной изменчивостью наблюдаемых изображений, целесообразно использовать адаптивные методы обработки информации, в которых осуществляется автоматическая оптимизация параметров и структуры алгоритма относительно текущих характеристик фона. Применительно к рассматриваемой ситуации общую структуру адаптивной системы обработки изображений, решающую задачи выделения и обнаружения воздушных объектов, можно представить в следующем виде рис. 2. На вход системы поступают яркостные изображения от видеодатчика, а выходом является список параметров обнаруженных объектов. Для оценки фона предлагается использовать процедуру линейного предсказания, построенную на основе адаптивной пространственной фильтрации. Компенсировав фоновую составляющую, можно отделить объект от остаточного шума. В литературе 7, 8 описана возможность применения адаптивного метода наименьших средних квадратов для оценки параметров АР-модели фона. Данный подход послужил основой для предлагаемого в данной работе алгоритма рис. 3, позволяющего повысить качество решения поставленных задач. В соответствии с алгоритмом значение каждого пикселя отфильтрованного изображения, вычисляется по выражению 2 где оценки АР-коэффициентов, вычисленные на -м шаге. Фактически формула 2 задает некоторый двумерный линейный нестационарный фильтр. Будем считать, что изображение формируется построчно, тогда номер шага будет определяться как Введем в рассмотрение ошибку фильтрации, представляющую собой скалярную величину, с помощью выражения, . Результатом работы алгоритма будет являться некоторое бинарное изображение, для нахождения которого осуществляется пороговая обработка, по правилу где пороговое значение, вычисленное на шаге 1. На основе, на каждом шаге сформируем значение ошибки адаптации, . За ошибку адаптации, принимается значение, при т. е. в случае отнесения элемента, к фону. Величина фиксируется при переходе от к значению Следует ожидать, что среднее значение ошибки при использовании процедуры адаптации фильтра будет близко к нулю. Тогда порог можно выбрать в соответствии с выражением где среднеквадратическое отклонение ошибки адаптации на шаге некоторый пороговый коэффициент. В блоке адаптации на основе, рекуррентно уточняется весовая функция, 0, 0 двумерного фильтра в соответствии с выражением 3 где коэффициент сходимости. Показано 5, что 3 представляет собой численное решение уравнения ЮлаУолкера по методу градиентного спуска. Алгоритм обеспечивает сходимость процесса адаптации при любых начальных значениях коэффициентов и наложении определенных условий на выбор величины 7. Для простоты реализации в качестве начального приближения предлагается использовать двумерную усредняющую маску. Вместо последовательного построчного обхода изображения маской фильтра на практике целесообразным является выбор направления обхода змейкой рис. 4, где маска коэффициентов фильтра представлена матрицей 3 3 элемента, а текущий элемент, затемнен. Если имеется априорная информация о том, что в первых нескольких строках объект не содержится, то для улучшения сходимости процедуры адаптации в течение первых шагов целесообразно принять Во многих случаях получаемые бинарные изображения содержат элементы, ложно отнесенные к объектам. Поэтому для улучшения качества обнаружения следует осуществить дополнительную обработку получаемого бинарного изображения. Суть обработки заключается в последовательном применении процедур морфологического закрытия и открытия с квадратным структурирующим элементом заданного размера. Разметка и параметризация связных элементов итоговой бинарной маски осуществляется с помощью известного алгоритма 3. В процессе параметризации сегментов вычисляются координаты их центров, габаритные размеры, площадь и другие параметры. Исходя из параметров сегментов и имеющейся априорной информации принимают решение об обнаружении объектов в кадре. Пример исходного и инвертированного бинарного изображений показан на рис. 5. Необходимо отметить, что в общем случае наблюдаемый фон может описываться более сложной авторегрессионной моделью скользящего среднего АРСС, которую можно представить в виде где, некоторый белый шум с нулевым средним и дисперсией параметры скользящего среднего. В отличие от имеющегося большого разнообразия алгоритмов вычисления АР-коэффициентов разработано всего лишь несколько подходов, предназначенных для нахождения АРССпараметров, что объясняется главным образом нелинейным характером получаемых уравнений. Для решения подобных уравнений часто применяются итеративные методы оптимизации, основанные на использовании оценок максимального правдоподобия, и близкие к ним методы 9. Однако данные подходы требуют больших вычислительных затрат, к тому же они не гарантируют сходимости или даже могут сходиться к неверным решениям, поэтому их нецелесообразно применять для обработки изображений в реальном времени. В целях существенного снижения вычислительных затрат для получения оценок АРССпараметров чаще всего применяются субоптимальные процедуры, в большинстве из которых оценки АР- и СС-параметров получаются раздельно. Сначала, как правило, вычисляются АРпараметры, а затем эти оценки используются для построения некоторого фильтра, который будет применен к исходным данным. Двумерная последовательность остаточных ошибок на выходе этого фильтра характеризует процесс СС, к которому затем может быть применена процедура оценивания СС-параметров. СС-параметры можно определить, исходя из некоторой эквивалентной АР-модели бесконечного порядка с параметрами . На практике порядок модели часто ограничивают таким, что . В соответствии с подходом раздельного оценивания коэффициентов структура алгоритма выделения объектов может иметь вид, представленный на рис. 6. Поскольку базовый алгоритм является составной частью модифицированного варианта, то экспериментальной проверке подвергался только последний подход. Исследования производились с использованием четырех естественных видеопоследовательностей продолжительностью от 600 до 800 кадров, отснятых в ТВ- и ИК-диапазонах. Характерные кадры из тестовых видеосюжетов представлены на рис. 7. Фон на выбранных сюжетах был как однородным сюжет 3, так и содержал кучевые облака сюжет 2, поверхность земли, дома и траву сюжет 1. Размеры объектов колебались от 2 2 до 20 15 пикселей. Отношение сигналшум тестовых видеосюжетов лежало в диапазоне примерно от 1,5 сюжет 4 до 35 сюжет 1. Основные исследования были посвящены анализу эффективности процедуры адаптивной фильтрации. Для изучения влияния описанной выше процедуры адаптивной фильтрации на характеристики разрабатываемого алгоритма оценивалось качество получаемых бинарных изображений. Исходя из анализа рассматриваемого алгоритма можно сделать вывод, что основные преимущества от применения описанной выше обработки следует ожидать на видеопоследовательностях, содержащих сильно коррелированный облачный фон. При проведении сравнительных исследований использовался алгоритм выделения и обнаружения воздушных объектов, основанный на применении полосового пространственного фильтра с конечной памятью 10. Суть данного подхода состоит в применении параллельной двумерной фильтрации наблюдаемого изображения двумя фильтрами с масками разного вида и размерности, подстройки размерности маски фильтра для лучшего обнаружения интересующего объекта и сравнения обработанного изображения с глобальным порогом. Выбор порядка модели осуществлялся эмпирическим путем. В теории для этой цели может быть использован информационный критерий Акаике. Минимум данного критерия по всем возможным размерностям модели характеризует те его значения, которые целесообразно использовать 5. Значение выбиралось равным 913, а 27. В процессе исследования эффективности алгоритма использовалось несколько методик визуальная оценка качества, вычисление рабочих характеристик выделения, нахождение частоты правильного обнаружения малоразмерного объекта. Остановимся на каждой методике подробнее. В целях оценки точности выделения объектов для сюжетов 1 и 2 в работе использовались кривые зависимости частоты правильного выделения точек изображения от частоты ложного выделения точек изображения . Под частотой правильного выделения понималось отношение числа точек, правильно отнесенных к объекту, к общему количеству точек объекта. Частота ложных тревог вычислялась как отношение количества точек, неверно отнесенных к объекту, к общему количеству точек изображения, не принадлежащих объекту. Кривую зависимости, получаемую при варьировании порогового коэффициента, назовем рабочей характеристикой выделения. Рабочие характеристики выделения для сюжета 1 при 13 представлены на рис. 8, . Для сравнения рядом приведены результаты для разработанного алгоритма и алгоритма, предложенного в работе 10. Для каждого сюжета параметры используемого для сравнения алгоритма выбирались наилучшими с точки зрения получаемых характеристик. Из анализа приведенных графиков видно, что рост при фиксированном значении составил до 9 по сравнению с разработанным ранее алгоритмом. От значения коэффициента сходимости во многом зависит вид получаемых кривых. Так, при больших значениях фильтр будет очень чувствителен к шуму и ошибке адаптации, при этом сама процедура вычисления весов фильтра будет расходиться. При малых значениях фильтр будет неспособен адаптироваться к изменяющемуся фону. При анализе полученных результатов можно сделать вывод, что оптимальное значение в большой степени зависит от степени неоднородности фона и размерности маски фильтра . Исходя из этого необходимо отслеживать рост значений весов фильтра, чтобы исключить возможность расхождения итеративного процесса, своевременно скорректировав значение . Оптимальные значения и выбирались экспериментальным путем и для всех сюжетов лежали в диапазонах 10 10, 10 10 . Рабочие характеристики выделения для сюжета 2 представлены на рис. 8, . Так, значение при 0,005 для предлагаемого алгоритма составляет 0,93 против 0,87 у сравниваемого подхода. Построение характеристик выделения для сюжетов 3 и 4 некорректно, так как отношение сигналшум изменяется от кадра к кадру, а площадь выделяемых объектов незначительна. При этом важно обнаруживать объект в каждом кадре видеопоследовательности. Поэтому был использован другой подход к количественной оценке характеристик разработанного алгоритма. В соответствии с данным подходом оценивалась точек объекта и рассчитывался бинарный параметр правильного обнаружения на м кадре по следующему правилу где эталонные значения координат центров объектов на м кадре, в качестве которых использовались данные, полученные человеком-экспертом измеренные значения координат центров объектов число кадров в видеосюжете. Зная на каждом кадре, можно вычислить частоту правильного обнаружения Построенные зависимости для видеосюжетов 3 и 4 получены при 9 рис. 9. Из графиков видно, что результаты применения адаптивного подхода несколько лучше. Низкие показатели работоспособности, полученные для сюжета 4, обусловлены большой степенью зашумленности обрабатываемого видеосюжета и малым контрастом объекта. По результатам анализа экспериментальных данных можно сделать вывод, что адаптивный алгоритм выделения и обнаружения объектов работоспособен при отношениях сигналшум, больших 2,5. В данной статье предложен алгоритм выделения и обнаружения воздушных объектов, основанный на оценивании параметров АРСС-модели фона с помощью процедуры адаптивной пространственной фильтрации. Анализ полученных результатов моделирования и сравнительных исследований позволяет сделать вывод об эффективности использования рассмотренного алгоритма при работе с реальными видеопоследовательностями, содержащими облачный фон. Исследования выполнены при поддержке гранта для ведущих научных школ НШ-1.2010.10. 