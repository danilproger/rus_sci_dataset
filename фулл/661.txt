МЕТОД ПОЛУЧЕНИЯ 3D-ИЗОБРАЖЕНИЙ,   ОСНОВАННЫЙ НА ДИФФУЗНОМ ОТРАЖЕНИИ СВЕТА  СКАНИРУЕМЫМИ ОБЪЕКТАМИ 

Описан метод получения 3D-изображений объектов, основанный на том, что сила света, диффузно отражаемого сканируемыми объектами, зависит только от угла падения исходного луча на рассеивающую поверхность  и от коэффициента ее отражения. Приводятся результаты экспериментальных исследований, подтверждающие  эффективность рассмотренного метода. Ключевые слова  — 3D-изображения, 3D-сканирование, диффузное отражение. 

На пути создания реалистичных трехмерных изображений сцен среди прочих можно выделить проблему трехмерного сканирования. В настоящее время наиболее популярными технологиями бесконтактного трехмерного сканирования являются 1 технология, основанная на использовании стереоизображений 2 технология, использующая структурированный свет 3 лазерная технология. Первая технология заключается в фотографировании объекта сканирования с различных точек и воссоздании на основе полученных изображений его трехмерной модели 1. Основной недостаток этой технологии состоит в том, что, используя ее, трудно обеспечить точное соответствие для пикселей на изображениях, полученных с двух камер, в бесструктурных областях объекта, вследствие чего точность получаемых 3D-изобра жений недостаточна. При второй технологии на сканируемый объект проецируется решетка из линий реже из точек, образующих на нем узор, состоящий из отдельных полос 2, 3. Объект, на который спроецирована решетка, фотографируется камерами, расположенными таким образом, что их оптические оси образуют с оптической осью проектора значительные углы. Полученные фотографии вводятся в компьютер. Поскольку различные части отражающей поверхности сканируемого объекта, на который проецируется решетка, расположены на различном удалении от проектора, на фотографиях объекта спроецированные на него линии решетки будут расположены на различных расстояниях друг от друга. Эти расстояния измеряются, и по ним определяются недостающие третьи координаты оболочки сканируемого объекта. Текстура объекта получается путем его фотографирования без решетки. Несмотря на кажущуюся простоту описанной технологии и рекламируемую изготовителями сканеров автоматичность режима, процесс получения 3D-изображений оказывается весьма труD-изображений оказывается весьма тру-изображений оказывается весьма трудоемким и требует больших затрат ручного труда. В настоящее время полностью автоматических систем общего назначения не существует. При получении 3D-изображения объекта по неD-изображения объекта по не-изображения объекта по нескольким проекциям необходимо производить сшивание этих изображений, а для этого нужно предварительно произвести калибровку камер, т. е. определить их взаимное расположение. Кроме того, при работе с объектами, различные части которых имеют сильно различающуюся детализацию, необходимо вручную добавлять точки в создаваемую модель, в областях высокой детальности 14. При лазерной технологии применяют как лазерные датчики, так и цифровую фототехнику. Использование лазеров позволяет непосредственно получать третью координату путем измерения времени задержки светового сигнала, отраженного от поверхности сканируемого объекта, в то время как направление лазерного луча дает две другие координаты. Применение же цифровой фототехники позволяет создавать 3D-модели объектов с текстурами. Достоинством лазерных сканеров является возможность сканировать крупные объекты. Однако результаты сканирования, как и в предыдущем случае, требуют трудоемкого последующего редактирования, на которое затрачивается много времени. Рассмотрим метод трехмерного сканирования, в значительной степени свободный от указанных недостатков. Как известно, информацию о глубине наблюдаемой сцены зрительная система получает целым рядом путей. К ним относятся не только стереоскопический, но и другие эффекты, в частности, наличие перспективных искажений в проекции этой сцены на сетчатке глаз, а главным образом распределение светотеней на изображениях объектов. Эта особенность проекций объектов изображений была давно замечена и широко используется в живописи. Так, наличие на изображении объекта светотеней, обусловленных тем, что количество света, попадающего в глаза зрителя, наблюдающего объект, зависит от интенсивности света, падающего на диффузно отражающую поверхность объекта, угла между нормалью к отражающей поверхности и направлением на источник света, а также от коэффициента отражения этой поверхности, позволяет судить о рельефности объекта. Благодаря этому на двумерной фотографии мы легко отличаем цилиндрическую колонну от колонны, имеющей квадратное сечение. Рассмотрим более подробно процесс образования светотеней на изображении объекта и метод использования информации, содержащейся в этом распределении, для получения 3D-изображений. При этом будем считать, что объект диффузно отражает падающий на него свет. Поскольку сила света, отражаемая различными частями объекта, зависит от углового положения отражающих поверхностей по отношению к направлению, из которого падает свет, то, измеряя силу света, исходящего от каждой точки поверхности объекта, можно определить угловое положение поверхности в этих точках. Зная угловое положение различных точек поверхности объекта, нетрудно определить третью координату удаленность от наблюдателя этих точек, расположенных на видимой части поверхности. Рассмотрение проведем в несколько приемов. Вначале рассмотрим простой случай, когда диффузно отражающая свет поверхность, представляющая оболочку объекта, параллельна оси рис. 1. Поместим источник, создающий пучок параллельных лучей света, на координатной оси, а камеру, посредством которой получается изображение этой поверхности, на координатной оси, на достаточно большом расстоянии от фотографируемой поверхности, так, чтобы можно было пренебречь перспективными искажениями изображения. Поскольку, по принятому условию, поверхность объекта диффузно отражает падающий на нее свет, то, согласно закону Ламберта, сила света, отраженная этой поверхностью, будет одинакова во всех направлениях. Сила света, диффузно отраженная поверхностью, как известно, определяется не только силой падающего света и коэффициентом отражения поверхности 0 1, но и косинусом угла между нормалью к диффузно отражающей поверхности и направлением на источник света 1 Если известны сила падающего света и коэффициент отражения, то по формуле 1 можно определить угол между нормалью к отражающей поверхности, которая нормаль будет лежать в плоскости, параллельной координатной плоскости, и направлением на источник света. Определив углы для каждой точки отражающей поверхности, можно построить саму поверхность, т. е. трехмерное изображение освещенной части оболочки объекта, обращенной в сторону камеры. При этом расстояние от построенной таким образом поверхности до начала системы координат остается неопределенным, но это и неважно, поскольку, в конечном итоге, интерес представляет не расположение сканируемого объекта в пространстве, а его форма оболочка. Усложним задачу. Будем теперь считать, что коэффициент отражения оболочки объекта неизвестен и может изменяться от точки к точке. В данном случае формулы 1 будет уже недостаточно для определения угла, поскольку неизвестных величин две угол и коэффициент отражения, а уравнение одно. Однако эта трудность легко обходится. Для этого достаточно воспользоваться вторым источником света, идентичным первому, но помещенным, например, на оси, и измерить силу света, отраженного этой же точкой поверхности от второго источника света где угол между нормалью к диффузно отражающей поверхности и направлением на второй источник света. В этом случае, как нетрудно видеть, углы и будут находиться в соотношении 2 . Взяв отношение и выражая через, запишем что после очевидных преобразований дает 2 Далее, используя формулы 1 и 2, можно определить коэффициент отражения поверхности объекта для каждой ее точки. Перейдем теперь к рассмотрению еще более сложного случая, когда рассеивающая поверхность произвольно ориентирована в пространстве рис. 2. Как и ранее, поместим источник параллельных лучей света на оси координат . Введем обозначения. Угол, заключенный между нормалью к отражающей поверхности и координатной плоскостью угол места, обозначим через, а угол, заключенный межу осью координат и проекцией нормали к отражающей поверхности на координатную плоскость азимут, обозначим через . При этом косинус угла между нормалью к отражающей поверхности и направлением на источник равен -os -os -os, и, следовательно 3 Целью дальнейшего анализа является определение углов и, а также коэффициента отражения поверхности, т. е. трех неизвестных, для чего необходимо иметь три уравнения значение можно задать при выполнении эксперимента. Недостающие два уравнения получим следующим образом. Вначале поместим источник света так, чтобы он оказался на оси, и проведем измерения, а затем поместим его на оси и тоже проведем измерения. В результате этих измерений будут получены два недостающих уравнения где и интенсивности отраженных лучей второго и третьего источников света. Значения котангенсов углов и при этом определятся следующим образом 4 5 Таким образом, для каждой точки поверхности сканируемого объекта, видимой для камеры, определяется поле направлений нормали к этой поверхности, т. е. углы и, что дает возможность построить видимую часть этой поверхности. Процедура построения поверхности видимой части объекта заключается в следующем. Вначале для произвольной точки его поверхности с координатами и задается произвольное значение координаты, которое удобно принять равным нулю. После этого, перемещаясь по произвольному пути из точки с координатами и в точку, для которой определяется координата глубины, координаты которой и, производится наращивание координаты на каждом шаге. При этом результирующее значение координаты глубины определится по формуле 6 При работе с дискретными изображениями, что и имеет место на практике, интегралы в формуле 6 заменяются суммами, а координаты и заменяются номерами столбцов и строк, в которых расположены пиксели исходных двумерных изображений 7 В этой формуле введены следующие обозначения и соответственно текущие номера строки и столбца изображения, полученного посредством камеры и номера строки и столбца произвольной точки поверхности, для которой координата глубины принята равной нулю, а и номера строки и столбца пикселя, для которого измеряется третья дискретная координата, шаг дискретизации которой равен шагу дискретизации исходных двумерных изображений. Далее, зная котангенсы углов и, найдем их косинусы -os и -os, а затем из уравнения 3 вычислим значение коэффициента отражения по формуле Таким образом, измеряя в каждой точке двумерных изображений трехмерного объекта силу диффузно отраженного света при трех различных положениях его источников, для каждой точки изображения определяем величину наклона отражающей поверхности по отношению к выбранным координатным осям, а также коэффициент отражения поверхности. Обратим внимание на то, что для определения величин наклона отражающей поверхности при различных ее ориентациях необходимо каждый раз источники света располагать таким образом, чтобы точка поверхности, для которой производится измерение, была доступна для освещения каждому из трех используемых источников света, т. е. не затенялась бы другими частями оболочки объекта. Обратим также внимание и на то, что в рассмотренном случае в результате сканирования получается трехмерное изображение только той части объекта, которая обращена к камере, а следовательно, имеется на используемых при измерениях двумерных изображениях. Для получения трехмерного изображения всего объекта необходимо произвести его съемку со всех сторон и сшивку всех полученных при этом трехмерных изображений. В отличие от рассмотренных ранее методов сканирования, сшивка в данном случае намного проще, что является серьезным достоинством этого метода. Это обусловлено тем, что третья координата сканируемого объекта глубина здесь определяется для каждого пикселя исходных двумерных изображений, благодаря чему при сшивке отдельные фрагменты трехмерного объекта легко совмещаются. Недостатком рассмотренного метода, как, впрочем, и других известных методов 3D-сканирования, использующих свет, является то, что он ориентирован на работу с объектами, диффузно отражающими свет. Для сканирования объектов, имеющих блестящие поверхности, таких как, например, окрашенный кузов автомобиля, их необходимо предварительно покрывать антибликовым составом распыляя из баллончика, создающим белую матовую поверхность, так, как это принято делать при известных методах, использующих структурированный свет. Для экспериментальной проверки описанного метода 3D-сканирования был выбран сравниD-сканирования был выбран сравни-сканирования был выбран сравнительно простой объект, а именно пирамида, поверхность которой диффузно отражала свет. Пирамида была расположена таким образом, чтобы ее вертикальная ось совпадала с координатной осью, а боковые ребра были бы равноудалены от координатной плоскости . При таком расположении пирамиды яркость пикселей вдоль контуров ее изображения была постоянна. В эксперименте использовались фронтальное и боковые освещения рис. 3. Благодаря выбранному расположению пирамиды оказалось возможным при определении третьей координаты трехмерного изображения для очередного пикселя каждый раз перемещаться только в одном направлении, вдоль очередной строки, принимая значение третьей координаты для границы объекта ребра пирамиды равным нулю. С учетом сказанного, поскольку второе слагаемое формулы 7 всегда равно нулю, координата глубины может быть найдена следующим образом 8 При выполнении эксперимента вначале были получены двумерные цифровые изображения пирамиды при трех различных положениях источников света спереди, слева и справа см. рис. 3. Изображения различались между собой только направлением освещения, поскольку съемка делалась при неизменном положении камеры и объекта. На изображениях рис. 3, фон, на котором представлена пирамида, оставался не освещенным, поскольку пирамида освещалась сбоку. На рис. 3, фон, на котором видна пирамида, светлый вследствие фронтального освещения. Далее, для каждой пары пикселей, представляющих одну и ту же часть объекта, показанного на рис. 3, и, измерялись интенсивности, величины которых прямо пропорциональны силам диффузно отраженного света. Аналогичные измерения производились с использованием изображений, показанных на рис. 3, и . После этого по формуле 4 определялся котангенс угла . Далее находилось значение координаты суммированием приращений координаты глубины, возникающих при движении вдоль каждой строки изображения. Результаты измерений третьей координаты объекта в виде линий постоянной высоты представляют собой, как и следовало ожидать, ломаные прямые рис. 4, . Аксонометрическое изображение пирамиды, построенное посредством функции mesh системы MATLAB, показано на рис. 4, . Таким образом, рассмотренный метод 3D-сканирования кратко можно сформулировать следующим образом. Вначале сканируемый объект фотографируется цифровой камерой таким образом, чтобы каждая его точка в общем случае была три раза снята при трех различных положениях источника света. Затем, используя описанную выше методику и полученные изображения объекта, определяют третью координату для каждого пикселя изображения, снятого при фронтальном освещении. Результаты сканирования легко могут быть представлены в одном из 3D-форматов, а также выведены на экран посредством соответствующих функций MATLAB. 