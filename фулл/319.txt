КОМБИНИРОВАННЫЙ МЕТОД  АВТОМАТИЧЕСКОГО ОПРЕДЕЛЕНИЯ ТОНАЛЬНОСТИ ТЕКСТА 

Статья посвящена проблеме автоматического анализа тональности текста. Анализ тональности используется для решения многих важных прикладных задач, таких как исследование для коммерческой организации отношения потребителей к ее продукции или разработка рекомендательной системы для покупателей определенных групп товаров и услуг.  Предлагается новый метод определения тональности, комбинирующий результаты работы метода опорных векторов (SVM) и метода ключевых слов. SVM является широко известным методом классификации, показывающим хорошие результаты при обработке текстовой информации. Метод ключевых слов основан на подсчете весов входящих в текст признаков. В качестве признаков используются слова и словосочетания, важность которых оценивается на основе релевантной частоты (Relevance Frequency, RF).  Комбинированный метод включает две фазы – обучение и распознавание. На первой фазе на основе размеченной коллекции текстов происходит обучение SVM классификатора и классификатора на базе ключевых слов. На второй фазе результаты распознавания нового текста обоими классификаторами комбинируются и формируется итоговое решение; при этом учитываются степени уверенности классификаторов в своих результатах.  Каждый метод классификации, используемый в работе (метод опорных векторов, метод ключевых слов, комбинированный метод), имеет свой набор параметров. Подбор оптимальных значений параметров классификаторов осуществляется при помощи скользящего контроля.  Эффективность комбинированного метода подтверждается экспериментами на текстовой коллекции отзывов о фильмах семинара РОМИП-2011. Для оценки используются метрики точности (precision), полноты (recall), правильности (accuracy) и F1 меры (F1 measure). Значение F1 меры для предлагаемого метода составляет 79 %, что на два процента превосходит лучший результат, полученный в рамках упомянутого семинара. 

 Тональность текста это выраженное в тексте эмоциональное мнение относительно некоторого объекта . Тональность можно измерять при помощи шкалы в диапазоне от положительного отношения до отрицательного. Шкала обычно является дискретной и в зависимости от задачи включает определенное количество значений . В настоящее время Интернет открыл доступ к огромному количеству текстов, которые аккумулируются, например, на специализированных сайтах отзывов, в социальных сетях и блогах, в разделах комментариев новостных изданий. Автоматическое определение тональности текстов может использоваться для решения многих важных прикладных задач исследования для коммерческой организации отношения потребителей к ее продукции разработки рекомендательной системы для покупателей определенных групп товаров или услуг введения в человеко-машинный интерфейс компьютерной системы функции, отвечающей за адаптацию поведения системы к текущему эмоциональному состоянию человека, и т.д. Проблема автоматического анализа текста для определения выраженных в нем эмоциональных отношений оказалась в числе активных научных исследований в начале 21 века 1, 2. Подробный обзор этого направления исследований дается в 3. В России публикаций по данной тематике пока крайне мало правда, в конце 2011 года в рамках семинара по оценке методов информационного поиска РОМИП 4 состоялось тестирование систем по анализу мнений, результаты которого обсуждались на конференции по компьютерной лингвистике Диалог-2012 5. В данной работе предлагается комбинированный метод автоматического определения тональности текста, основанный на методе опорных векторов и методе ключевых слов. Общая схема метода. Комбинированный метод автоматического определения тональности текста объединяет результаты работы классификатора на основе опорных векторов 6 и классификатора на базе ключевых слов 7. До начала его применения необходимо задать дискретную шкалу измерения тональности, содержащую M классов. Метод включает две основные фазы обучение и распознавание . Фаза обучения подразумевает наличие обучающей текстовой коллекции, каждый текст которой помечен определенным значением из диапазона используемой шкалы, то есть задана принадлежность текста к одному из классов. Фаза обучения. Схема фазы обучения показана на рисунке 2 и включает типичные этапы процесса текстовой классификации 8 предобработку, формирование словарей признаков, взвешивание признаков, формирование векторной модели, обучение SVM-классификатора, настройку параметров. 1. На этапе предобработки все тексты подвергаются одинаковым преобразованиям выделяются отдельные слова, исключаются однобуквенные слова. Для оставшихся слов определяется словарная форма . В итоге после предобработки каждый текст представляется в виде набора слов в словарной форме. 2. На следующем этапе выделяются множества признаков для задачи определения тональности и на их основе формируется словарь признаков. В качестве признаков в предлагаемом методе используются отдельные слова и словосочетания. В словарь входят все слова и словосочетания, которые встречаются не менее чем в трех текстах после предобработки длина словосочетаний составляет от двух до пяти слов. . На этапе взвешивания для каждого признака из словаря вычисляется и сохраняется глобальный вес, определяющий значимость признака для решения задачи анализа тональности. Обозначим a количество текстов, содержащих j-й признак и относящихся к классу С b количество текстов, содержащих j-й признак и не относящихся к классу С. Отметим, что для каждого признака в словарь заносятся веса по каждому классу отдельно. В 7 указывается, что, несмотря на высокую эффективность, применение способа RF для взвешивания признаков, формирования векторной модели текстов и дальнейшего обучения SVMклассификатора нецелесообразно вследствие того, что он вычислительно сложный, а более простые способы дают близкие по точности результаты. Однако в предлагаемом в настоящей работе комбинированном методе применение взвешивания RF оправдано, поскольку результативно используется в методе ключевых слов, а не только при обучении SVMклассификатора. При этом более простые подходы к взвешиванию не позволяют получить хорошие результаты для метода ключевых слов. 4. На следующем этапе формируется векторная модель текстов 11 для дальнейшего обучения SVM-классификатора. В векторной модели текст представляется в виде вектора, количество компонентов N которого совпадает с количеством признаков в словаре. Каждый компонент является весом соответствующего признака в данном тексте. Для вычисления локального веса в соответствии с результатами 7 применяется бинарный способ Глобальный вес не вычисляется, а извлекается из словаря для j-го признака. 5. Этап обучения SVM-классификатора стандартная процедура построения в N-мерном пространстве признаков гиперплоскости, разделяющей векторы двух классов 6. При этом выделяются так называемые опорные векторы, находящиеся ближе всего к разделяющей гиперплоскости. Существует множество программных библиотек, реализующих обучение SVM-классификаторов в данной работе используется библиотека LIBSVM 12. 6. Заключительный этап фазы обучения подбор параметров комбинированного метода определения тональности текста. При этом осуществляется поиск оптимальных параметров для метода ключевых слов и для алгоритма комбинирования результатов классификации. Для подбора используется известный подход скользящего контроля по Q блокам на основе обучающей коллекции 13. При этом обучающая коллекция случайным образом разделяется на Q частей и проводится Q циклов обучения и тестирования, причем в каждом цикле одна из частей выступает в роли тестовой, а остальные части являются обучающими. После этого Q полученных тестовых результатов усредняются. Таким образом, в результате выполнения фазы обучения формируются, во-первых, словарь признаков, включающий слова и словосочетания с глобальными весами для каждого класса отдельно, во-вторых, SVMклассификатор, состоящий из M гиперплоскостей в N-мерном пространстве, в-третьих, набор оптимальных параметров комбинированного метода определения тональности текста. Фаза распознавания. Схема фазы распознавания включает пять этапов, два из которых совпадают с уже рассмотренными в фазе обучения . Этап классификации на основе SVM заключается в применении обученного SVM-классификатора для распознавания векторов, сформированных по тестовой коллекции. При этом для каждого тестового вектора SVM-классификатор возвращает один из M классов, к которому отнесен данный вектор, вместе с расстоянием до соответствующей гиперплоскости чем больше это расстояние, тем выше степень уверенности в результате распознавания. На этапе классификации на основе метода ключевых слов для каждого текста из тестовой коллекции возвращается и один из M классов. На завершающем этапе объединяются результаты классификации SVM-классификатором и методом ключевых слов при помощи алгоритма комбинирования результатов. Таким образом, после выполнения фазы распознавания каждому тексту из тестовой коллекции присваивается класс значение на шкале измерения тональности. Множество таких значений для всех текстов тестовой коллекции составляет итоговый результат работы комбинированного метода автоматического определения тональности. Метод ключевых слов. На основе данного метода возможно независимое определение тональности текста, но его применение совместно с SVM позволяет получать более высокие результаты. Метод ключевых слов предложен в 7 и основан на подходе, примененном, например, в 1. Идея метода ключевых слов заключается в том, что тональность текста определяется на основе подсчета весов входящих в него признаков слов и словосочетаний. Веса могут задаваться по-разному, например, устанавливаться экспертом вручную или вычисляться автоматически с использованием статистических или каких-либо других методов. Предлагаемый метод ключевых слов отличается от существующих, во-первых, использованием в качестве веса релевантной частоты RF 10, хорошо зарекомендовавшей себя в текстовой классификации, во-вторых, введением ряда настраиваемых параметров и процедуры их нахождения. Для каждого класса C вес j-го признака вычисляется независимо по формуле . Признаки с весами для всех классов сохраняются в словаре признаков. Параметры метода ключевых слов объединяются в две группы. В процессе его разработки исследовалось влияние количества признаков на качество распознавания. Оказалось, что наилучшее качество достигается при удалении из словаря всех признаков с весами, ниже определенного оптимального порога, причем такой порог для каждого из M классов свой. Таким образом, первая группа параметров метода ключевых слов представляет собой M пороговых значений весов признаков. При решении задачи определения тональности текста нужно учитывать, что в человеческом общении преобладает позитивная лексика 14, вследствие чего решения автоматических классификаторов оказываются ошибочно смещенными в сторону положительной тональности. Существующие системы пытаются учитывать это обстоятельство за счет введения фиксированных повышающих коэффициентов для классов, расположенных ближе к отрицательной границе шкалы тональности 15. Помимо двух групп параметров, в предлагаемом методе ключевых слов применяется процедура настройки этих параметров, представляющая собой реализацию метода скользящего контроля по Q блокам на основе обучающей коллекции. Решение об отнесении текста T к одному из классов в методе ключевых слов принимается следующим образом. Для каждого класса C вычисляется вес текста W путем простого суммирования весов входящих в текст признаков с учетом коэффициентов k где вес j-го признака в тексте T по отношению к классу C. Затем среди полученных весов определяется максимальный Текст T относится к тому классу, для которого получен максимальный вес W. Алгоритм комбинирования результатов классификации. В предлагаемом комбинированном методе определения тональности для объединения результатов классификации, полученных методом опорных векторов и методом ключевых слов, используется специальный алгоритм. Вместе с обоими классами должны поступать степени уверенности классификаторов Conf и Conf. Степень уверенности SVM-классификатора Conf представляет собой расстояние от вектора, обозначающего заданный текст, до соответствующей гиперплоскости. В алгоритме используются три группы параметров, вычисляемых во время фазы обучения на этапе настройки параметров. Превышение степени уверенности Conf порогового значения указывает на сильную уверенность SVMклассификатора в выданном решении и наоборот, если Conf меньше порога, уверенность в решении слабая. Сильная и слабая уверенности этого классификатора определяются по аналогии с SVM. В третью группу входит единственный параметр, обозначающий приоритетный, SVM-классификатор, или классификатор на основе ключевых слов. Класс, выданный приоритетным классификатором, присваивается тексту в том случае, если не удается принять решение на основе оценки степеней уверенности классификаторов. Алгоритм комбинирования результатов классификации для текста T включает следующие шаги. 1. 2. Если один из классификаторов сильно уверен в своем решении, а другой слабо, то текст T относится к классу, который выдал классификатор с сильной уверенностью. 3. Если оба классификатора сильно уверены в своих решениях или оба слабо уверены, а решения не совпадают, выбирается решение приоритетного классификатора. Таким образом, алгоритм комбинирования результатов классификации позволяет эффективно разрешать конфликты двух классификаторов за счет найденных на этапе обучения оптимальных параметров. Проведенные эксперименты Коллекция. В ходе экспериментов с предлагаемым комбинированным методом в качестве обучающей коллекции использовалась одна из коллекций семинара РОМИП набор отзывов пользователей рекомендательного портала Imhonet.ru на различные фильмы 4, 5. Каждый отзыв оценивался по шкале тональности от 1 до 10. В данном исследовании авторы проводили эксперименты в рамках задачи классификации с двумя классами, поэтому десятибалльная шкала отображалась в двухбалльную отзывы с оценками от 6 до 10 обозначались как положительные, с оценками от 1 до 5 как отрицательные. Общее количество отзывов 14 813, из них положительных 11 680, отрицательных 3 133. Тестовая коллекция в задаче анализа мнений на семинаре РОМИП-2011 представляет собой набор из 329 отзывов на фильмы, оцененных независимо двумя экспертами. Каждый эксперт оценивал отзыв как положительный или отрицательный. Для 312 отзывов оценки совпали, и именно эти отзывы использовались в данной тестовой коллекции . Метрики оценки. Для усреднения результатов по классам применялся подход макроусреднения 5, 8. В качестве основной метрики, используемой, в частности, для выбора оптимальных параметров в процедуре скользящего контроля, применялась F1-мера. Для дальнейшего сравнения с авторскими результатами в таблице 1 приводятся значения указанных метрик для тестовой коллекции отзывов на фильмы, полученные на семинаре РОМИП-2011 5. Оценка метода. На коллекции отзывов по фильмам проводились тестирование и оценка SVM-классификатора, классификатора на основе ключевых слов и предлагаемого метода, комбинирующего результаты этих классификаторов. Перед тестированием во время фазы обучения были подобраны оптимальные параметры на основе обучающей коллекции и скользящего контроля по Q блокам. Например, в качестве приоритетного метода выбран метод ключевых слов как показывающий несколько лучшие результаты для данной обучающей коллекции, чем SVM-классификатор. Значение повышающего коэффициента для отрицательных весов в методе на основе ключевых слов по результатам подбора оказалось равным 3,1. Значения метрик, выявленные в ходе экспериментов, приведены в таблице 2. Из таблицы 2 видно, что результаты, полученные на тестовой коллекции с использованием комбинированного метода, существенно превосходят результаты SVM-классификатора, классификатора на основе ключевых слов и в некоторой степени результаты лучшего участника РОМИП2011, что подтверждает применимость разработанного метода для определения тональности текстов. Возникновение такого эффекта обеспечивается за счет учета степеней уверенности классификаторов в своих решениях и подбора оптимальных параметров на основе скользящего контроля. В дальнейшем предполагается провести экспериментальное исследование предложенного метода на других коллекциях русскои англоязычных, в том числе с использованием большего количества классов, а также разработать обобщенный метод, позволяющий комбинировать K различных классификаторов. 