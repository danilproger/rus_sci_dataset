КОДИРОВАНИЕ И ПЕРЕДАЧА ИНФОРМАЦИИ ПРИМИТИВЫ КРИПТОСИСТЕМ С ОТКРЫТЫМ КЛЮЧОМ:  КОНЕЧНЫЕ НЕКОММУТАТИВНЫЕ ГРУППЫ  ЧЕТЫРЕХМЕРНЫХ ВЕКТОРОВ 

1 Для синтеза производительных алгоритмов распределения открытых ключей и открытого шифрования вводится новая вычислительно трудная задача над конечными некоммутативными группами. Предложен подход  к построению некоммутативных групп четырехмерных векторов над простым полем и выводится формула для  порядка этих групп. Описана схема согласования общего секретного ключа двух удаленных абонентов и алгоритм открытого шифрования на основе новой трудной задачи.  Ключевые слова  — криптография, криптосистемы с открытым ключом, протокол открытого согласования  ключа, открытое шифрование, конечные группы, некоммутативные группы, группы векторов, трудная задача. 

В последние годы возрос интерес к использованию некоммутативных групп в качестве примитивов криптосистем с открытым ключом 1, связанный с ожиданием разработки действующего квантового компьютера, с применением которого задачи факторизации и дискретного логарифмирования в циклической группе будут решаться за полиномиальное время 2. Последнее означает, что все наиболее широко применяемые алгоритмы открытого распределения ключей, открытого шифрования и электронной цифровой подписи ЭЦП станут небезопасными, поскольку их стойкость основана на сверхполиномиальной сложности указанных двух задач при их решении на имеющихся в настоящее время компьютерах. Постквантовая криптография связана с использованием новых трудных задач, сложность которых была бы сверхполиномиальна и в случае применения квантового вычислителя. В работах 3, 4 такие задачи сформулированы над бесконечными некоммутативными группами переплетения, а затем применены для построения алгоритмов открытого шифрования 4 и ЭЦП 5. В данной статье формулируется новая вычислительно трудная задача над конечными некоммутативными группами, рассматривается построение на ее основе алгоритмов открытого согласования общего секретного ключа двух удаленных абонентов и открытого шифрования, описывается подход к заданию конечных некоммутативных групп четырехмерных векторов и выводится формула для вычисления порядка таких групп. Одним из способов синтеза криптосистем с открытым ключом на основе некоммутативных конечных групп является использование их подгрупп, обладающих достаточно большим простым порядком. Такие подгруппы являются циклическими, а групповая операция в них коммутативна. В этом случае синтез криптосхем, основанных на сложности задачи дискретного логарифмирования, аналогичен синтезу в случае коммутативных групп. Обоснованием данного подхода является ожидание, что сведение задачи дискретного логарифмирования в циклической подгруппе некоммутативной группы к задаче дискретного логарифмирования в конечном поле или конечном кольце многочленов будет невозможно. В частных случаях такое сведение возможно, поэтому требуется выполнить выбор подгрупп, обладающих соответствующим значением простого порядка 6. Более интересным является подход, использующий задачу вычисления элемента некоммутативной группы и числа пара этих элементов служит секретным ключом в уравнении, где элемент группы, используемый в качестве открытого ключа элемент достаточно большого простого порядка элементы и считаются известными элемент, для которого выполняются неравенства и при заданном числе значение элемента определяет значение . Операции умножения на взаимно обратные элементы и реализуют операцию автоморфизма 7. Решение указанного выше уравнения представляет собой самостоятельную трудную вычислительную задачу, отличную от задачи дискретного логарифмирования. При известном можно вычислить или, после чего число можно найти из уравнения или соответственно, т. е. решая задачу дискретного логарифмирования. Однако значение является неизвестным, поэтому задача дискретного логарифмирования в циклической подгруппе не стоит. Можно ожидать, что в конечной некоммутативной группе при известном сравнительно легко вычислить неизвестный элемент, однако одновременное нахождение и является сложной задачей, несмотря на то, что существует очень большое число различных решений если и некоторое решение, то для произвольного элемента группы, коммутирующего со всеми другими элементами, пара, также является решением . Схема открытого согласования ключа на основе предлагаемой задачи описывается следующим образом. Пусть два удаленных абонента имеют открытые ключи и, где, и, личные секретные ключи первого и второго абонентов такие, что . После открытого обмена открытыми ключами первый абонент вычисляет общий секретный ключ по формуле а второй по формуле Комбинируя аналогичным образом операцию автоморфизма и операцию возведения в большую дискретную степень, можно построить алгоритмы коммутативного и открытого шифрования. Техническим вопросом является согласование выбора секретных значений и из одной и той же коммутативной подгруппы, который решается заданием дополнительного известного элемента такого, что, также обладающего большим простым порядком. В этом случае открытые ключи вычисляются по формулам и где пары, и, являются личным секретным ключом первого и второго абонентов соответственно. В случае, когда порядки элементов и равны большому простому числу, имеющему размер бит, вычисление пары неизвестных, может быть выполнено методом, аналогичным методу больших и малых шагов 8, с трудоемкостью 2 операций возведения в степень. Из этой оценки следует, что рассмотренная схема открытого согласования ключа имеет приемлемую для практического применения криптостойкость при 2 . Алгоритм открытого шифрования можно построить по следующей схеме. Пусть некоторый пользователь желает послать секретное сообщение владельцу открытого ключа, где, личный секретный ключ получателя сообщения. Отправитель сообщения формирует разовый личный секретный ключ в виде пары чисел, вычисляет разовый открытый ключ, вычисляет разовый общий секретный ключ, по ключу зашифровывает сообщение и отправляет разовый открытый ключ и зашифрованное сообщение получателю. Получатель по разовому открытому ключу вычисляет разовый общий секретный ключ, затем по ключу расшифровывает сообщение . Пусть в данной схеме используется алгоритм шифрования, представленный функцией шифрования, управляемой секретным ключом в виде элемента некоммутативной группы . Тогда описанная выше схема реализуется следующим алгоритмом. 1. Отправитель генерирует пару случайных чисел, вычисляет элементы и некоммутативной группы, где открытый ключ получателя. 2. Используя значение в качестве ключа шифрования, отправитель зашифровывает сообщение . 3. Отправитель направляет получателю криптограмму и значение . 4. Получатель вычисляет значение, где, личный секретный ключ получателя, и расшифровывает криптограмму, где функция расшифрования, обратная . В описанных выше криптосхемах используется отображение циклической подгруппы, порождаемой элементом в некоторую другую скрытую циклическую подгруппу того же простого порядка, задаваемого отображением, где 1, 2, которое является автоморфизмом рассматриваемой конечной некоммутативной группы. При этом элемент задается в виде . Возникает вопрос о различии циклических подгрупп, в которые отображается подгруппа при различных значениях 1, где порядок элемента . Ответ на этот вопрос дает следующая теорема. . Пусть и элементы некоммутативной группы, имеющие простые порядки и соответственно, такие, что и, где . Тогда все элементы, где 1, 2, 1 и 1, 2, попарно различны. Очевидно, что при фиксированном элементы, где 1, 2, образуют циклическую подгруппу порядка . Условие означает, что элемент не принадлежит подгруппе, порождаемой степенями элемента при предположении противного легко устанавливается противоречие. Пусть при некоторых, и для определенности положим элементы и равны, т. е. . Умножая обе части последнего выражения справа на и слева на, получаем . Так как есть подгруппа простого порядка, то любой неединичный элемент подгруппы является порождающим, т. е. при 1 1 элемент является порождающим, а значит степени 1, 2, пробегают все элементы подгруппы . При этом для всех имеет место соотношение, т. е. отображение переводит любой элемент подгруппы в некоторый элемент этой же подгруппы. Это означает, что отображение отображает подгруппу в себя. Рассмотрим отображение . Поскольку порядок элемента есть простое число, то для существует некоторое число mod, для которого имеют место соотношения и где в правой части последнего выражения выполняется последовательных отображений . Так как это отображение подгруппы в себя, то таких отображений также переводит подгруппу в себя, т. е. . Из сделанного предположения вытекает, что элемент принадлежит циклической подгруппе, порождаемой элементом, следовательно, для элементов и должно выполняться свойство коммутативности, т. е., однако это противоречит условию теоремы. Полученное противоречие доказывает теорему. В соответствии с теоремой 1 число различных неединичных элементов составляет 1, и они образуют вместе с единичным элементом подгрупп простого порядка, где, причем каждый неединичный элемент принадлежит только одной из этих подгрупп. Рассмотрим множество векторов вида, где, и формальные базисные векторы, и целые числа, называемые координатами и принадлежащие конечному простому полю, где простое число. Выражения, и обозначают векторы, 0, 0, 0, 0, 0, 0, 0, 0, 0 и 0, 0, 0, соответственно и называются компонентами вектора, . Определим операцию сложения векторов как сложение одноименных координат, где знак применен для обозначения двух разных операций сложения элементов поля и сложения векторов, что не вносит неопределенности ввиду очевидности интерпретации знака в каждом случае его применения. Операцию умножения векторов и определим по правилу умножения многочленов, где координаты вектора умножаются как элементы поля, а операция имеет более высокий приоритет по сравнению со сложением, а произведения всевозможных пар базисных векторов заменяются базисным вектором или однокомпонентным вектором в соответствии с правилом умножения, задаваемым табл. 1, в которой параметр называется структурным коэффициентом. Различным значениям соответствуют формально различные операции умножения векторов. Определенная таким способом операция умножение векторов, и, выполняется по правилу, . Легко проверить, что определенная операция умножения обладает свойством ассоциативности и в общем случае является некоммутативной. Нейтральным элементом по умножению является вектор 1, 0, 0, 0. Множество всех векторов такое, что каждому вектору может быть сопоставлен обратный вектор, для которого выполняется соотношение, образует конечную группу. Для вычисления порядка построенной некоммутативной группы рассмотрим решение уравнения вида, которое можно представить следующим образом 1 0 0 0 . Из последней записи вытекает, что для определения обратных значений следует решать следующую систему из четырех линейных сравнений с четырьмя неизвестными 1 Если главный определитель системы 1 не равен нулю, то существует решение, которое дает значение координат вектора, являющегося обратным к вектору, . Если 0, то вектор необратим. Значение определим как число всех четырехмерных векторов, равное, за вычетом числа необратимых векторов. Запишем значение определителя Четыре слагаемых в правой части последнего выражения содержат одинаковый множитель Складывая правые части последних четырех выражений, получаем откуда следует, что число необратимых векторов равно числу решений сравнения 2 относительно неизвестных, . Рассмотрим следующее утверждение. . Пусть простое число представляется в виде 4 1 при некотором нату 1 при некотором нату1 при некотором натуральном 1. Тогда число решений сравнения 2 равно при произвольных значениях 1 1. Для рассматриваемых значений простого числа число 1 является квадратичным вычетом. Действительно, в соответствии с критерием Эйлера имеем 1 1 1 mod . Следовательно, существует квадратный корень из 1, т. е. для некоторого целого числа 1 имеем 1 mod . Перепишем сравнение 2 в тождественном виде 3 где mod mod 0 1 и 0 1. Легко видеть, что между множеЛегко видеть, что между множеством пар, и множеством пар, существует взаимно однозначное соответствие, следовательно, число решений сравнения 3 относительно неизвестных, равно числу решений сравнения 2 относительно неизвестных, . Подсчитаем число решений сравнения 3. Если 0 mod, то 0 и 0. Сравне0. Сравнение 0 mod имеет 2 1 решений относи1 решений относительно неизвестных и одно решение имеет вид, 0, 0 и 2 1 решений имеют вид, где 1 1. Для каждого значения 0 это имеет место для 2 1 различных пар значений и и каждого значения 0 число различных значений равно 1 су1 существует единственное, удовлетворяющее сравнению 3, т. е. случаю 0 соответствуют 1 различных решений сравнения 3. Каждому из 2 1 вариантов пар значений и, при которых имеет место случай 0, соот 0, соот 0, соот0, соответствуют 1 различных решений, образуемых парами значений 0 и 0 плюс 1 различ1 различных решений, образуемых парами значений 0 и 0 плюс решение, 0, 0, т. е. значению 0 соответствуют 2 1 различных решений сравнения 3. Таким образом, число различных решений сравнения 3, а значит и сравнения 2, равно 1 2 1, что и требовалось доказать. . Пусть простое число представляется в виде 4 1 при некотором нату 1 при некотором нату1 при некотором натуральном 1. Тогда порядок некоммутативной группы четырехмерных векторов, групповая операция которой задана по табл. 1, равен 1 1. Число всех различных четырехмерных векторов над простым полем характеристики равно . В соответствии с утверждением 1 число необратимых векторов равно . Порядок группы равен числу обратимых векторов 1 1 1 1, что тре1, что требовалось доказать. . При 0 порядок некоммутативной группы четырехмерных векторов равен 1, если простое число представляется в виде 4 3, или 1, если простое число представляется в виде 4 1. При 0 определитель системы сравнений 1, из которой вычисляются координаты обратного вектора, равен mod . Для значений простого числа, представимых в виде 4 3, число 1 является квадратичным невычетом. Действительно, в соответствии с критерием Эйлера имеем 1 1 1 mod . Следовательно, не существует квадратный корень из 1, поэтому сравнение 0 mod имеет решение только при, 0, 0, т. е. все векторы вида 0, 0 являются необратимыми. Число таких векторов равно . В рассмотренном случае порядок группы векторов равен 1. Для значе1. Для значений простого числа, представимых в виде 4 1, число 1 является квадратичным вычетом, поэтому сравнение 0 mod имеет 2 1 различных решений см. доказательство утверждения 1, которым соответствуют необратимые векторы вида, где и произвольные значения. Число необратимых векторов равно 2 1. В этом случае порядок группы векторов равен 2 1 1 . Утверждение 3 доказано. . Пусть простое число представляется в виде 4 3 при некотором нату 3 при некотором нату3 при некотором натуральном 1. Тогда если структурный коэффи1. Тогда если структурный коэффициент является квадратичным невычетом, то порядок некоммутативной группы четырехмерных векторов, групповая операция которой задана по табл. 1, равен 1 1. Для рассматриваемых значений простого числа число 1 является квадратичным невычетом. Действительно, в соответствии с критерием Эйлера имеем 1 1 1 mod . Поскольку квадратичный невычет, то 1 mod и 1 mod . Следовательно, число является квадратичным вычетом и существует квадратный корень из, т. е. для некоторого целого числа 1 имеем mod . Перепишем сравнение 2 в тождественном виде 4 где mod mod 0 1 и 0 1. Подсчитаем число решений сравнеПодсчитаем число решений сравнения 4 относительно неизвестных, аналогично тому, как это сделано в доказательстве утверждения 1. Если 0 mod, то 0 и 0. Сравнение 0 mod имеет 2 1 решений относительно неизвестных и одно решение имеет вид, 0, 0 и 2 1 ре1 решений имеют вид, где 1 1. Для каждого значения 0 это имеет место для 2 1 различных пар значений и и 0 1 различных значений существует единственное, удовлетворяющее сравнению 4, т. е. случаю 0 соответствуют 1 различных решений сравнения 4. Каждому из 2 1 вариантов пар значений и, при которых имеет место случай 0, соот 0, соот 0, соот0, соответствуют 1 различных решений, образуемых парой значений 0 и 0 плюс 1 различных решений, образуемых парой значений 0 и 0 плюс решение, 0, 0, т. е. случаю 0 со 0 со 0 со0 соответствуют 2 1 различных решений сравнения 4. Таким образом, число различных решений сравнения 4, а значит и сравнения 2, равно 1 2 1 . Число всех различных четырехмерных векторов равно . Порядок группы равен числу обратимых векторов, следовательно 1 1, что и требовалось доказать. Доказанные выше утверждения о порядке конечной некоммутативной группы четырехмерных векторов для различных значений и были проверены экспериментально с помощью компьютерной программы, реализующей алгоритм вычисления строения группы под строением группы понимается таблица, показывающая число векторов для каждого возможного значения их порядка. Типичные результаты, полученные в ходе вычислительного эксперимента, который подтвердил доказанные в предыдущем разделе утверждения, показывает табл. 2. Эксперимент также показал, что в утверждении 4 требование того, что структурный коэффициент является квадратичным невычетом, может быть удалено, т. е. во всех экспериментах порядок конечной некоммутативной группы четырехмерных векторов оказался равным 1 1 независи1 независимо от структуры простого числа и значения коэффициента 0. Рассмотрим пример выбора простых чисел, и векторов и, удовлетворяющих условиям и, где, и, где длина двоичной записи числа 751788397 12 375894199 1 493205368, 605223810, 704049712, 215749841 204543067, 267966222, 209297175, 161608828 204543067, 483822175, 542491222, 590179569 493205368, 638573510, 56561748, 103277561 478445912, 349091248, 194139031, 297937680 478445912, 529600113, 62144304, 36127512 325816345 478721415 216264816 409136505 325816345 196930991 521380191 144664353. В схемах открытого согласования ключа и открытого шифрования, описанных в первом разделе, используется открытый ключ, который вычисляется по личному секретному ключу, по формуле, где и известные элементы некоммутативной группы достаточно большого простого порядка и соответственно. Сложность вычисления секретного ключа по открытому задает верхнюю границу стойкости предложенных криптосхем. Для вычисления секретного ключа по открытому может быть использован алгоритм, аналогичный алгоритму больших и малых шагов, применяемому для решения задачи дискретного логарифмирования 8. Рассмотрим вычисление секретного ключа в случае алгоритм может быть легко адаптирован для . 1. Для всех значений 1, 2, вычислить таблицу значений . Трудоемкость этого шага составляет 2 операций умножения элементов группы. 2. Упорядочить таблицу, вычисленную на шаге 1. Трудоемкость этого шага составляет log операций сравнения элементов группы. 3. Установить счетчик 1 и значение вектора 1, 0, 0. 4. Вычислить вектор . 5. По отсортированной таблице проверить, имеется ли в ней значение . Если в таблице имеется значение, то вывести значение секретного ключа, и СТОП, в противном случае перейти к шагу 6. 6. Если, то прирастить значение счетчика 1 и перейти к шагу 4, в противном случае СТОП и вывести сообщение условия некорректны. Трудоемкость шагов 5 и 6 составляет не более операций умножения и log операций сравнения. Если условия корректны, т. е. решение задачи имеется, то приведенный алгоритм при некотором значении счетчика найдет значение вектора в таблице, т. е. в этот момент будет выполняться соотношение . Поскольку, то, т. е. при корректно заданных условиях алгоритм действительно найдет решение. Трудоемкость алгоритма составляет 3 операций умножения плюс 2 log операций сравнения, т. е., где обозначение порядка. Если принять достаточной верхнюю границу стойкости, равную 2 операций как в случае 1024-битовой криптосистемы RSA, то в предложенных в первом разделе криптосхемах следует выбрать некоммутативную группу, для которой значение порядка элементов и равно 2 . В качестве примитива протоколов открытого согласования секретного ключа и открытого шифрования предложена новая вычислительно трудная задача над конечными некоммутативными группами, которую можно назвать задачей дискретного логарифмирования в скрытой циклической подгруппе. На основе данной задачи построена схема согласования по открытому каналу общего секретного ключа двух удаленных абонентов и алгоритм открытого шифрования. В основе этих построений лежит процедура, комбинирующая функцию, задающую автоморфизм конечной некоммутативной группы, и операцию возведения элемента достаточно большого простого порядка в большую целочисленную степень. Разработан алгоритм решения рассматриваемой задачи, из которого дана оценка стойкости предложенных криптосхем. Однако данная задача является новой, поэтому требуются другие независимые исследования для более полной оценки безопасности этих криптосхем. Доказанная теорема 1 имеет общее значение для конечных некоммутативных групп различных типов. Эта теорема отражает локальное строение некоммутативной группы, а именно строение в той ее части, которая используется в построении криптосхем на основе новой задачи. Предложенные криптосхемы могут быть реализованы над построенными конечными некоммутативными группами четырехмерных векторов, над конечными некоммутативными группами векторов других размерностей 9 или над конечными группами невырожденных матриц 10. Выбор конкретного варианта некоммутативной группы для построения криптографических алгоритмов и протоколов будет определяться вычислительной эффективностью алгоритмов и протоколов при заданном уровне стойкости. Сравнительный анализ быстродействия криптосхем на основе конечных некоммутативных групп различного типа представляет самостоятельный интерес. Предложенная вычислительно трудная задача может быть применена и для построения криптосхем других типов, например для разработки быстродействующих алгоритмов коммутативного шифрования и протоколов аутентификации с нулевым разглашением. Эти вопросы также представляют интерес как тема отдельного исследования. Работа поддержана грантом РФФИ 08-0700096-а. 