ПРОБЛЕМА ОБНАРУЖЕНИЯ АНОМАЛИЙ В НАБОРАХ ВРЕМЕННЫХ РЯДОВ 

Рассматривается проблема обнаружения аномалий в наборах временных рядов. Исследуется случай, когда обучающее множество содержит наборы временных рядов единственного класса – положительные примеры. Предлагается новый алгоритм, позволяющий эффективно строить критерии для распознавания аномалии во временных рядах. Приводятся результаты программного моделирования.

 В последнее время большое внимание уделяется анализу временных рядов, которые используются в различных областях и описывают длительные процессы, протекающие во времени. Значениями ts могут быть показания датчиков, цены на какой-либо продукт, курс валюты и т.п. На рисунке 1 приведен пример временного ряда, где i-я точка на графике соответствует значению ts, полученному в момент времени i . В данной работе решается задача определения аномалий в наборах временных рядов. Проблема определения, или обнаружения, аномалий 1 была поставлена как задача поиска в наборах данных образцов, не удовлетворяющих предполагаемому типовому поведению. Аномалия, или выброс, определяется как элемент, явно выделяющийся из набора данных, к которому он принадлежит, и существенно отличающийся от других элементов выборки. Неформально задача определения аномалий в наборах временных рядов ставится следующим образом. Существует коллекция временных рядов, описывающих некоторые процессы, используемая для описания нормального протекания процессов. Требуется на основании имеющихся данных построить модель, которая является обобщенным описанием нормальных процессов и позволяет различать нормальные и аномальные процессы. Каждый из временных рядов в обучающей выборке является примером нормального протекания некоторого процесса. Рассмотрим данную задачу на простом примере. Пусть обучающая выборка TSGOOD и экзаменационная выборка TSTEST состоят из трех временных рядов. Из приведенной выше постановки задачи видно, что временные ряды 1 и 3 из экзаменационного множества значительно отличаются от временных рядов из обучающего множества и, следовательно, будут являться аномалиями для данного обучающего множества. При этом можно предположить, что механизм, или закон, по которому были получены временные ряды 1 и 3 экзаменационной выборки, отличается от механизма, с помощью которого были получены временные ряды из обучающего множества. Напротив, временной ряд 2 из экзаменационного множества не будет являться аномалией, так как по форме очень похож на временные ряды из обучающего множества. В работе рассматривается задача поиска аномалий для случая, когда обучающее множество состоит из примеров единственного класса положительных. Задача усложняется тем, что набор исходных данных ограничен и не содержит примеров аномальных процессов также не задан критерий, по которому можно было бы различать нормальные и аномальные временные ряды. В связи с этим трудно точно оценить качество работы алгоритма . Более того, многие алгоритмы, хорошо показавшие себя на одних наборах данных, совершенно не подходят для других предметных областей. Также может отличаться и критерий, на основании которого определяется нормальность рядов, в приведенном примере таким критерием была форма ряда . О способах представления временных рядов Для создания алгоритмов обобщения информации, представленной временными рядами, требуется, безусловно, разработка методов предварительного преобразования самих рядов. Временные ряды, представляющие данные из разных областей в различных единицах измерения, следует привести к некоторым типовым, удобным для дальнейшего анализа формам. Для работы с временными рядами предлагается использовать два способа их представления нормализованное и символьное. Нормализацией назовем приведение временного ряда к такому виду, при котором среднее для него отклонение было бы равно нулю, а среднеквадратичное единице. Настоящее преобразование является необходимым процессом при предварительной обработке данных 2. Пример нормализованного ряда приведен в таблице 1. Символьное представление для временного ряда может быть получено из нормализованного с помощью алгоритма Symbolic Aggregate approXimation 2. При создании данного алгоритма сделано допущение о том, что желательно иметь равные вероятности появления символов алфавита A 2. Символьное представление для временного ряда TS получается далее по следующему правилу если очередной элемент ts меньше, то он отображается в первый символ алфавита A, если элемент ts больше, то он отображается в последний символ алфавита A. Алгоритм обнаружения аномалий в наборах временных рядов Как было отмечено выше, критерий, позволяющий выявлять аномалии среди нормальных рядов, от задачи к задаче может меняться. Одним из наиболее универсальных способов обнаружения аномалий при наличии в обучающем множестве примеров единственного класса является использование нейронной сети 1. Однако сам по себе процесс построения и обучения нейронной сети весьма трудоемок, особенно в условиях ограниченности имеющихся для анализа данных. Поэтому была поставлена задача создать такой алгоритм, который можно было бы использовать для поиска аномалий в наборах временных рядов даже при минимальном наборе данных для обучения. Алгоритм при этом должен быть достаточно простым в применении, но способным эффективно определять аномалии в предъявленных временных рядах. В данной работе предлагается алгоритм TSADEEP, который является модификацией алгоритма, основанного на точном описании исключения 3 для определения аномалий в наборах временных рядов. Исходная постановка задачи 3 следующая для заданного множества объектов I необходимо получить множество-исключение I. Тогда I I является множеством-исключением для I относительно D и C, если его фактор сглаживания SF максимален 3. Данный метод, на основе которого разработан алгоритм TS-ADEEP, был адаптирован для задачи поиска аномалий в наборах временных рядов. Сначала вычисляется I среднее для векторов из I. Функция неподобия вычисляется как сумма квадратов расстояний между средним и векторами из I. Функция мощности задается формулой. Приведем псевдокод алгоритма. Помимо этого, предлагается следующая модификация для алгоритма поиска исключений найдя множество-исключение I, можно продолжить поиск множества-исключения I уже в нем. Таким образом, этот поиск может производиться до тех пор, пока в исходном множестве три или более элементов. Данная модификация позволяет исключить большое число ложных срабатываний алгоритма определения аномалий, поскольку накладывает более строгое условие на отнесение временного ряда к аномальным. О временных рядах, используемых для моделирования процесса обнаружения аномалий Моделирование процесса обнаружения аномалий было проведено как на искусственных, так и на реальных данных. В качестве искусственных данных взяты классические описания временных рядов, используемые в научной литературе cylinder-bell-funnel и control chart. В качестве реальных трафик . Дадим их краткое описание. Сylinder-bell-funnel 4 содержит три различных класса цилиндр, колокол, воронка. Сontrol chart 5 включает шесть различных классов, описывающих тренды, которые могут присутствовать в процессах цикличность, уменьшение значения, резкое падение, увеличение значения, постоянная величина, резкое возрастание. Трафик данные, полученные на основе анализа трафика при передаче файлов по протоколу ftp в различных условиях в том числе при одновременной передаче нескольких файлов по нескольким протоколам. В качестве тестовых данных, помимо прочих, использовались специальным образом сгенерированные временные ряды, имитирующие передачу данных. Результаты моделирования процесса обнаружения аномалий во временных рядах Чтобы определить, насколько хорошо предложенный алгоритм справляется с обнаружением аномалий в наборах временных рядов, было проведено его программное моделирование. Рассмотрим процесс моделирования на примере набора данных cylinder-bell-funnel. Сначала в качестве обучающего множества TSGOOD генерируется набор временных рядов, принадлежащих первому из классов, цилиндр. В качестве экзаменационного множества TSTEST генерируются временные ряды, принадлежащие всем трем классам, цилиндр, колокол, воронка. Временной ряд TStest является нормальным, если он принадлежит классу цилиндр, и аномалией, если принадлежит классу колокол или воронка. Соответственно, алгоритм корректно находит аномалии, если он относит временные ряды класса колокол и воронка из TSTEST к аномалиям, а временные ряды класса цилиндр аномалиями не считает. При этом были рассмотрены как численное представление временных рядов, так и символьное с разным размером алфавита. Аналогично проводилось моделирование для классов колокол и воронка. Данные, приведенные в таблице 2, дают возможность оценить результаты распознавания аномалий. Полученные в эксперименте данные позволяют сделать вывод, что предложенный алгоритм успешно решает такую сложную задачу, как поиск аномалий в наборах временных рядов. В заключение необходимо отметить, что в работе рассмотрена задача поиска аномалий среди наборов временных рядов. Предложен непараметрический алгоритм TS-ADEEP для определения аномалий в наборах временных рядов для случая, когда обучающее множество содержит примеры одного класса. Проведено программное моделирование предложенного алгоритма. Результаты показали, что он успешно справляется с задачей поиска аномалий в наборах временных рядов. В дальнейшем предполагается модифицировать предложенный алгоритм для определения аномалий в наборах временных рядов для случая, когда обучающее множество содержит примеры нескольких классов. 