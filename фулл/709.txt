ФИЛЬТРАЦИЯ  ИЗОБРАЖЕНИЯ ПРИ  НАЛИЧИИ  ФОТОННЫХ  ШУМОВ 

Рассматривается работа ТВ-систем на пороге их чувствительности, связанная с наблюдением слабых сигналов в фотонных шумах. При этом как сигнал, так и мешающий фон являются источниками мультипликативных фотонных шумов, которые возрастают с увеличением уровней как самого сигнала, так и фона. Синтезируются фильтры, позволяющие выделить сигнал изображения из фотонных шумов уже на уровне десятков фотоэлектронов на пиксель изображения. Для решения задачи используется теория нелинейной фильтрации и статистических оценок. We examine the sensitivity-threshold operation of TV-systems, related to the observation of weak signals in the presence of photon noise. Both the signal and the hum are assumed to generate multiplicate photon noise which increases as soon as either the signal or the hum is increased. We synthesize the filters enabling to extract the picture signal from photon noise already on the level of tens photoelectrons per pixel of the image. For the solution of this problem the theory of nonlinear filtration and statistical estimations is used. 

Проблема работы ТВ-датчика в условиях слабой освещенности связана с тем, что модель изображения с аддитивным шумом становится неприемлемой, так как основное влияние оказывают фотонные шумы. Величина заряда, накопленного ячейкой ТВ-датчика, зависит от площади светочувствительного элемента и его квантовой эффективности. Для датчика на ПЗС типовое значение площади элемента составляет 8,5 8,5 мкм. Квантовая эффективность вероятность преобразования фотон-электрон у современных матриц равна 0,40,6. Качество переноса зарядов определяется шумом считывания, который для современных матриц составляет величину менее 1030 электронов. Таким образом, чувствительность ПЗС-камер вплотную подошла к физическому пределу, и задача обработки изображения на уровне фотонных шумов имеет практический интерес для многих приложений. Вместе с тем до сих пор используется и такой фотоэлектронный датчик, как диссектор, ввиду его высокой радиационной стойкости. При синтезе алгоритмов обнаружения и оценке параметров изображений в ТВ-системах в качестве исходных данных принимается случайное поле в плоскости изображения. В результате его детектирования получаем поле фотоотсчетов. Согласно литературе 14, статистические модели таких изображений в силу случайного характера интенсивности принимаются в виде условнопуассоновских полей или пуассоновских полей с двойной стохастичностью. Двойная стохастичность обусловлена тем, что пространственно-временная интенсивность поля, так же, как и входные данные, является случайным полем. Оценка интенсивности фотоотсчетов, регистрируемых апертурой датчика, входит в алгоритмы измерения параметров условно-пуассоновского поля. То же самое имеет место при обнаружении в задачах проверки гипотез необходимо находить оценки интенсивности фона для каждого элемента датчика. Современные ТВ-датчики имеют матричную структуру, что обуславливает пространственную дискретизацию изображения, в результате которой наблюдаемая совокупность фотоотсчетов привязана к элементам матрицы решетке, т. е. условно-пуассоновское поле задано на решетке. Изображение задается в виде векторного условно-пуассоновского процесса 5 где вектор фотоотсчетов, полученных за время в результате построчного считывания зарядов с элементов матрицы двумерный индекс, соответствующий номеру элемента матрицы дельта-функция, описывающая регистрацию фотоотсчета в случайный момент времени нулевой вектор. Размерность вектора равна числу элементов решетки. Параметром условно-пуассоновского поля является пространственно-временная интенсивность ПВИ среднее число фотоотсчетов в единицу времени на единицу площади ТВ-датчика. Обозначим ее как где принадлежит плоскости изображения ТВ-датчика, а вектор информационных параметров изображения, подлежащий измерению и закодированный в ПВИ. Интенсивность пуассоновского процесса число фотоотсчетов в единицу времени для одного элемента решетки, занимающего область, рассматривается ниже как изображение. Обозначим ее как Изображение считывается с ТВ-датчика на ПЗС или датчика на диссекторе одноэлементной апертурой с построчным сканированием. При этом наблюдается условно-пуассоновский процесс, интенсивность сигнал изображения которого есть случайный процесс 1 где среднее значение и информационная составляющая изображения. Оценке подлежит векторный параметр вектор состояния 2 управляемый стохастическим дифференциальным уравнением 3 в котором и матрицы, составленные из постоянных коэффициентов белый шум со спектральной плотностью Процессу соответствует матрица диффузии Поскольку интенсивность фотоотсчетов неотрицательна, а уравнению 3 соответствует случайный гауссовский процесс, то среднее значение интенсивности и среднеквадратическое значение ее флюктуаций должны быть связаны условием достаточно потребовать, чтобы Используя работу 5, дифференциальные уравнения относительно оценки и ковариационной матрицы ошибок представим в виде 4 5 где входные данные в виде -образного случайного импульсного потока, 0, 1, 2 матрица вторых производных. Введем обозначения для апостериорной ковариационной матрицы ошибок измерения параметров компонентов вектора состояния, определяемого соотношением 2 6 где 0, 1, 2 апостериорные дисперсии ошибок измерения соответственно среднего значения, флюктуаций относительно среднего и их производной . Используя численные методы, заменим дифференциальные уравнения 4 и 5 уравнениями в разностной форме. Для этого введем шаг временной дискретизации, удовлетворяющий условию малости по сравнению с временем корреляции наиболее быстрого компонента процесса . Обозначив получим 7 8 где единичная матрица есть приращение процесса за время . Конкретизируем параметры уравнения 3 9 Вектор-градиент в уравнении 4, согласно соотношениям 1 и 2, равен и уравнение 4 относительно оценки с учетом обозначений 9 принимает вид 4 10 Вычисление матриц вторых производных в уравнении 5 с использованием соотношений 1 и 2 приводит к следующим результатам согласно которым матрица Подставляя обозначение 6 в уравнение 5, получаем уравнение относительно ковариационной матрицы ошибок 11 Оставшиеся элементы определяются из условия симметрии ковариационной матрицы Введем обозначения 12 где апостериорная ковариация ошибки измерения интенсивности или ее апостериорная дисперсия Используя соотношения 12, уравнения относительно оценки 10 и элементов апостериорной ковариационной матрицы ошибок 11 можно привести к упрощенному виду 13 14 где и определяются соотношениями 12. Затем от уравнений 13 и 14 перейдем к разностным уравнениям вида 7 и 8. Предварительно введем безразмерные переменные 15 и обозначим 16 Используя 15 и 16, уравнения 13 и 14 запишем в разностной форме 17 18 с начальными условиями Аппроксимируем спектральную плотность изображения спектром Баттерворта 6 19 что вполне допустимо в силу непрерывности изображения и ограниченности его спектра. Кроме того, для справедливости аппроксимации 19 в уравнении для вектора состояния необходимо принять коэффициент При этом нетрудно показать, что интервалы корреляции процессов и соответственно равны 20 Из выражения 20 находим, что где величина более высокого порядка малости, чем и 21 Шаг временной дискретизации должен удовлетворять условию малости в котором время корреляции наиболее быстрого компонента вектора состояния, поэтому входящий в уравнения 17, 18 коэффициент . При этом реализация фильтра значительно упрощается, так как отпадает необходимость в оценке переменной составляющей интенсивности и вычислении связанных с ней взаимных ковариаций ошибок. При разностные уравнения 17 и 18 преобразуются к виду 22 23 Ниже представлены результаты моделирования фильтра, осуществляющего оценку интенсивности условно-пуассоновского процесса в соответствии с алгоритмами 22, 23. Входными данными являются приращения условно-пуассоновского процесса, интенсивность которого есть гауссовский случайный процесс с параметрами Параметры фильтра, соответствующие энергетическому спектру 19, принимают следующий вид где шаг дискретизации время корреляции компонента вектора состояния 2 спектральная плотность белого шума дисперсия белого шума в уравнении состояния 3 дисперсия случайной составляющей интенсивности гауссовского процесса дисперсия фотоотсчетов случайной составляющей сигнала изображения на элемент решетки. Зададим исходные данные для моделирования среднее значение фотоотсчетов на интервале среднеквадратичное значение фотоотсчетов, соответствующих случайной составляющей интенсивности-сигнала изображения на интервале относительный шаг дискретизации параметр 1 0,14. Начальные условия Результаты моделирования для скалярного наблюдения представлены на рис. 19. На рис. 1 показаны фотоотсчеты входных данных и результат фильтрации интенсивности обозначенный на рис. 1 как для 5 фотоотсчетам на элемент решетки номер шага дискретизации от элемента к элементу решетки. Гауссовская интенсивность-сигнал изображения рис. 2 выражена в среднем числе фотоотсчетов на элемент решетки. Результат ее фильтрации обозначен как при этом 5. Результаты рекуррентного вычисления коэффициентов передачи фильтра представлены на рис. 3. Отметим, что из уравнений 17 и 18 следует, что стационарного режима фильтрации с установившимися коэффициентами передачи не существует, так как последние зависят от входных данных. Интересно получить средние значения коэффициентов фильтра. С помощью моделирования рис. 4, 5 получены усредненные во времени по характеристики фильтра средние коэффициенты передачи, нормированные к средней измеряемой интенсивности, и средние ошибки измерения как функции от среднего уровня измеряемой интенсивности . Число отсчетов усреднения выбрано равным 600, при этом исключался начальный участок время переходного процесса. Масштабы коэффициентов 24 увеличены в 10 раз см. рис. 4. Поскольку время корреляции интенсивности условно-пуассоновского процесса обычно неизвестно, то представляет интерес исключить эту информацию из алгоритма оценки, приняв в 17 и 18 параметр 1 0, что существенно не ухудшит точности измерения, если время корреляции будет оставаться значительно больше шага дискретизации . При этом формулы 22, 23 принимают более простой вид 7 25 26 Результаты моделирования фильтра в соответствии с алгоритмами 25, 26 представлены на рис. 59. На рис. 5 показаны зависимости среднеквадратичной ошибки измерения 27 от средней интенсивности для двух вариантов реализации фильтра априорные данные относительно параметра имеются 1 0,14 и априорные данные относительно отсутствуют 1 0. Влияние параметра 1 на оценку интенсивности условно-пуассоновского процесса показано на рис. 6. На рис. 79 представлены зависимости от средней интенсивности усредненных во времени в соответствии с 24 и нормированных к коэффициентов фильтра в установившемся режиме для случаев 1 0,14 и 1 0. В одномерном скалярном случае измерения интенсивности фотоотсчетов условно-пуассоновского поля используется информация о корреляции интенсивности в одном направлении вдоль траектории считывания. Если имеется возможность запоминания изображения, то необходимо учитывать более полную информацию, рассматривая интенсивность как двумерное случайное поле, имеющее корреляцию в двух ортогональных направлениях 5. Поэтому при регистрации поля фотоотсчетов ТВ-датчиком матричного типа, например датчиком на ПЗС или диссекторным датчиком, для измерения интенсивности используем корреляцию интенсивности в связанной области. Для измерения интенсивности оценки изображения используется скользящее окно в виде подрешетки из элементов. Измеритель осуществляет фильтрацию интенсивности центрального элемента подрешетки, анализируя входные данные с элементов датчика. Через каждый такт измерения происходит сдвиг подрешетки на один элемент вдоль строки. Таким образом, пространственные характеристики изменения интенсивности определяются сечением поля интенсивности в направлении строки. От входных данных перейдем к усредненным на подрешетке где целочисленное множество индексов . Предполагается нечетное число элементов по строке и столбцу подрешетки. Результат усреднения используем для фильтрации. Можно показать, что при высокой взаимной корреляции компонентов переменной составляющей интенсивности в пределах подрешетки можно воспользоваться полученными ранее алгоритмами для случая скалярного наблюдения. Уравнения относительно оценки интенсивности центрального элемента подрешетки и ковариаций ошибок принимают вид Отличие заключается лишь в весовом коэффициенте Для определения коэффициентов передачи фильтра и необходимо выполнить рекуррентные вычисления в соответствии с полученными уравнениями. Для оценки качественных показателей измерителя интенсивности условно-пуассоновского поля на решетке проведено его моделирование при 0. Входными данными являются приращения условно-пуассоновского процесса для подрешетки из 3 3 элементов. Матрица 3 3 составлена из одноименных элементов верхней, нижней и центральной строк. Сканирование матрицы вдоль строки на один элемент за шаг временной дискретизации задает новое положение подрешетки. Таким образом формируется скользящее окно. Временное поведение интенсивности центральной строки задается гауссовским случайным процессом с параметрами, Исходные данные моделирования случайной составляющей интенсивности центрального элемента приняты такими же, как и в случае скалярного наблюдения. Межстрочная взаимная корреляция элементов верхней и нижней строк относительно одноименных элементов центральной строки устанавливается за счет добавления белого шума и к интенсивностям элементов центральной строки. Несложно определить уровень белого шума для обеспечения заданного коэффициента взаимной корреляции . Дисперсия добавленного белого шума Для того чтобы выровнять дисперсии верхней и нижней строк относительно центральной, дисперсия которой равна, интенсивности верхней и нижней строк и нормированы Результаты моделирования представлены на рис. 1012. На рис. 10 показаны зависимости средних ошибок измерения интенсивности от коэффициента взаимной корреляции одноименных элементов верхней и нижней строк относительно центральной для средних интенсивностей 5 и 10, где, а усреднение ошибок проведено по 600 оценкам интенсивности в соответствии с формулой 27 вдоль строки. На рис. 11 показаны зависимости средних ошибок измерения интенсивности в диапазоне изменения средних интенсивностей 5100 для подрешетки, состоящей из 3 3 элементов и одного элемента скалярный случай. На рис. 12 показано установление и результат последовательных вычислений коэффициентов фильтра, для подрешетки 3 3. Коэффициент взаимной корреляции между интенсивностями одноименных элементов строк 0,9, а величина средней интенсивности 5. Учитывая, что коэффициент есть апостериорная дисперсия ошибки измерения, т. е. сравним результаты моделирования на рис. 11 и 12, конкретизировав численные результаты. При 5 средняя ошибка 0,36096 или дисперсия 0,1303. Усреднив результаты моделирования см. рис. 12, получим 0,12218, что подтверждает достоверность результатов фильтрации, полученных в работе. В заключении проведем сравнение эффективности различных алгоритмов фильтрации, введя нормированную ошибку как отношение выборочного среднеквадратичного значения флюктуаций ошибки 27 к среднему значению измеряемой интенсивности Первый алгоритм оценка в точке. Измерение сводится к суммированию фотоотсчетов для одного элемента изображения за фиксированное время наблюдения и является оценкой максимального правдоподобия. Назовем этот алгоритм простейшим. Второй алгоритм оценка в точке и фильтрация вдоль строки случай скалярного наблюдения. Третий алгоритм суммирование фотоотсчетов на подрешетке и последующая фильтрация интенсивности вдоль строки. Сравнение будем проводить по возрастанию степени сложности алгоритмов, переходя от простейшего алгоритма одноэлементного измерения к скалярному случаю измерения и затем к случаю подрешетки. Для поля фотоотсчетов со средней интенсивностью 5 и 6 нормированная ошибка в простейшем случае одноэлементного накопления равна 48 и уменьшается до 12,7 в 3,8 раза в случае скалярного измерения и до 7,2 в 6,7 раза для случая подрешетки 3 3. То же сравнение для средней интенсивности 100 дает следующие результаты нормированная ошибка для одноэлементного накопления равна 18,9 и уменьшается по сравнению с предыдущим случаем 5 за счет увеличения объема выборки. Для скалярного наблюдения нормированная ошибка уменьшается до 6,1 в 3,1 раза, а для случая подрешетки 3 3 до 3,6 в 5,2 раз по сравнению со случаем одноэлементного накопления. На рис. 13, слева, представлено изображение пуассоновского поля с интенсивностью 5 и импульсным перепадом интенсивности по строке и кадру, а изображение справа результат его фильтрации вдоль строки случай скалярного наблюдения. Перепад интенсивности равен 10 единицам. Коэффициент усиления сигнала изображения для наблюдателя равен 10. Весь динамический диапазон сигнала изображения 0255. Внизу на графике представлена строка левого изображения оценка в точке, результат его фильтрации вдоль строки и модулирующая интенсивность, которая и подлежит оценке. Как видно из графиков, левое изображение имеет более высокую четкость, но значительную ошибку измерения интенсивности 8. Для изображения справа ошибка измерения интенсивности значительно меньше 2, но изображение имеет более низкую четкость вдоль строки. Переходный процесс установления и спада профильтрованного изображения вдоль строки равен 10 пикселям. Таким образом, повышение точности измерения интенсивности фильтрации вдоль строки происходит за счет потери четкости изображения. 