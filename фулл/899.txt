ИССЛЕДОВАНИЕ ПОГРЕШНОСТЕЙ   ОПРЕДЕЛЕНИЯ КООРДИНАТЫ ГЛУБИНЫ   ПРИ 3D-СКАНИРОВАНИИ МЕТОДОМ,   ОСНОВАННОМ НА ДИФФУЗНОМ ОТРАЖЕНИИ СВЕТА  

Приведены результаты теоретических и экспериментальных исследований погрешностей, возникающих при  измерении координаты глубины в процессе 3D-сканирования методом, основанном на диффузном рассеянии  света. Эти погрешности обусловлены наличием шума квантования исходных изображений, а также флуктуационного шума. Показано, что рассматриваемые погрешности максимальны в областях оболочки, на которые  свет падает под небольшими углами. Приведены рекомендации, следуя которым эти погрешности можно свести  к малым величинам.  Ключевые слова  — 3D-изображение, 3D-сканирование, диффузное отражение. 

В настоящее время значительно возрос интерес к проблемам 3D-сканирования изображений, что проявляется, в частности, при проектировании систем трехмерного видео и виртуальной реальности. Одной из таких проблем является разработка методов 3D-сканирования, основанных на физических принципах, не использованных в существующих трехмерных сканерах, выпускаемых промышленностью, например, на принципе диффузного отражения света поверхностью сканируемого объекта и на некоторых других, в целях создания метода, оптимального для применения в этих областях информационных технологий. При этом необходимо оценить наиболее важные характеристики вновь разрабатываемых методов, такие как сложность их реализации погрешности измерения, которые в этом случае имеют место ожидаемая стоимость используемой аппаратуры и т. д. Целью описываемых исследований является оценка погрешностей определения координаты глубины, обусловленных наличием флуктуационного шума и шума квантования, при 3D-сканировании объектов методом, основанным на измерении интенсивности света, диффузно отраженного поверхностью сканируемого объекта. Что касается погрешностей, возникающих при определении двух других координат по этим же причинам, то здесь не возникает каких-либо принципиально новых проблем по сравнению со случаем обычного 2D-сканирования. В работах 1, 2 описан метод получения 3D-изображения объекта, основанный на измерении интенсивности света, диффузно отраженного его поверхностью 1 где интенсивность падающего на поверхность объекта света от источника коэффициент отражения поверхности угол между нормалью к отражающей поверхности и вектором, направленным на источник света. В данной статье оценивается погрешность измерения координаты глубины, измеренной этим методом. Переходя к рассмотрению проблемы, выберем правую систему координат и определим направление единичного вектора нормали к отражающей поверхности посредством направляющих косинусов cos, cos, cos рис. 1 Поскольку направление вектора в трехмерном пространстве полностью определяется двумя углами, то такое представление является избыточным, так как значения этих углов удовлетворяют равенству Подобным образом посредством направляющих косинусов может быть представлено направление единичного вектора указывающего на источник света cos, cos, cos . При этом имеем аналогично Чтобы не усложнять рис. 1, единичный вектор на рисунке не показан. Косинус угла между двумя единичными векторами, в рассматриваемом случае векторами и, равен Делая подстановку данного выражения для cos в формулу 1, имеем 2 Поместим камеру, измеряющую интенсивность диффузно отраженного света, на ось и направим ее в начало координат. В дальнейших расчетах направление единичного вектора удобнее выражать через азимут, представляющий собой угол между вектором и плоскостью, и угол места, представляющий собой угол между вектором и плоскостью . Установим связь между углами, и углами, . Длина проекции единичного вектора на ось равна cos . Если вектор спроецировать на плоскость, получим отрезок длиной cos, если затем результат спроецировать на ось, получим вектор длиной cos sin . Из этого следует, что Значение cos находим аналогичным путем. Длина проекции единичного вектора на ось равна cos . Если вектор спроецировать последовательно сначала на плоскость, получим отрезок длиной sin, если затем результат спроецировать на ось получим отрезок длиной sin cos . Откуда следует, что Значение cos находим подобным же путем. Отрезок, представляющий собой проекцию вектора на ось длина которого равна cos, можно получить двумя путями. Либо непосредственно проецируя вектор на ось, либо последовательно, проецируя его сначала на плоскость, получая отрезок длиной cos, а затем проецируя отрезок на ось в результате чего получаем отрезок длиной cos cos Откуда следует, что Аналогично будем иметь для единичного вектора, направленного на источник освещения Делая подстановки cos, cos, cos, cos, cos, cos в формулу 2, запишем Полученное уравнение включает в себя параметры оболочки, и, которые являются неизвестными и которые нам необходимо найти, в то время как остальные величины, входящие в это уравнение, либо назначаются нами, как, например, либо могут быть измерены, как, например, . Для того чтобы найти все три параметра оболочки, нам необходимо располагать тремя уравнениями. Недостающие уравнения можно получить, если измерить интенсивности света, рассеянного диффузно отражающей оболочкой объекта, при трех различных угловых положениях источника света, Совместное решение трех написанных трансцендентных уравнений позволяет получить значения, и . Проиллюстрируем сказанное конкретным примером, когда исходный для формирования 3D-изображения материал получен при трех различных положениях источника света 0, 0 источник света расположен на координатной оси 0, 0 источник света расположен в координатной плоскости 0, 0 источник света расположен в координатной плоскости . В этом случае будем иметь 3 4 5 Решая совместно уравнения 3 и 4, а также уравнения 3 и 5, получим выражения для тангенсов углов, определяющих положение нормали к диффузно отражающей поверхности относительно выбранной координатной системы 6 7 После того как найдены значения тангенсов, а следовательно, и сами углы и значения, определяется коэффициент отражения оболочки объекта путем решения уравнения 3 относительно 8 Располагая полученными формулами, можно перейти к определению координаты глубины. В целях большей наглядности рассмотрим определение координаты глубины на примере сканирования сферы, расположенной в начале координат. Выбор сферы обусловлен тем, что в ней представлены области поверхности оболочки, ориентированные в пространстве под всеми возможными углами. Как и ранее, поместим камеру на координатной оси и направим ее в начало координат. В результате получим три изображения, соответствующих рассмотренным выше положениям источников освещения объекта рис. 2, . Распределения яркости в этих изображениях представлены величинами, и, по которым находятся значения tg и tg, определяющие угловые положения нормалей к поверхности сканируемого объекта в точках, для которых могут быть последовательно измерены, и, а следовательно, и угловое положение касательной плоскости. Обратимся к точкам на этих изображениях. При смещении из точки в произвольном направлении на бесконечно малую величину координата глубины получает приращение, равное, где, функция, представляющая собой тангенс угла между координатной плоскостью и прямой, определяющей направление смещения. Если направление, в котором происходит смещение, совпадает с координатной осью то, tg, если направление смещения совпадает с координатной осью то, tg . В общем случае значение функции, равняется сумме проекций tg и tg на направление смещения. При смещении из точки с координатами, в точку с координатами, приращение координаты составит Правая часть формулы представляет собой криволинейный интеграл первого типа. Замечательной особенностью криволинейного интеграла является то, что путь, по которому выполняется интегрирование, т. е. путь из точки с координатами, в точку с координатами, не влияет на конечный результат . В частности 9 В рассматриваемом случае вначале вычисляется приращение координаты глубины за счет перемещения в направлении координатной оси, а затем к нему добавляется приращение координаты глубины за счет перемещения в направлении координаты . Иногда при вычислениях оказывается удобным выбирать путь интегрирования так, чтобы он совпадал, например, с линией градиента яркости на изображении, показанном на рис. 2, . При построении поверхности видимой камерой части объекта вначале нужно назначить плоскость, параллельную координатной плоскости, относительно которой будет отсчитываться координата глубины. С этой целью можно выбрать любую произвольную точку на изображении 2, и координату глубины этой точки принять равной нулю. Так как конечной целью является определение оболочки сканируемого объекта, а не его расположение в пространстве, то произвольность этого выбора не повлияет на конечный результат. Поскольку в дальнейшем речь идет о дискретных изображениях, интегралы необходимо заменить суммами, а координаты и номерами столбцов и строк, в которых расположены пиксели исходных двумерных изображений 10 Здесь и текущие номера строк и столбцов изображения, полученного посредством камеры и номера строк и столбцов точки оболочки, для которой координата глубины принята равной нулю и номера строки и столбца пикселя, для которого определяется дискретная координата глубины . Шаг дискретизации третьей координаты выбирается равным шагу дискретизации исходных двумерных изображений. Описанным способом находятся координаты глубины для каждого пикселя той части изображения см. рис. 2, которая доступна освещению тремя источниками света в рассматриваемом примере свет спереди, слева и сверху. Затем положение источников света изменяют, например, освещение объекта слева заменяют на его освещение справа, и снова проводят измерения. Так повторяют до тех пор, пока не будут получены координаты глубины для всех пикселей изображения видимой части объекта, с использованием которых строится так называемое -изображение карта глубины рис. 2, . Яркость пикселей -изображения представляет собой значение координаты глубины. Чем меньше значение этой яркости, тем более удален от зрителя данный элемент объекта. Поочередное получение фрагментов в рассматриваемом примере четвертушек -изображения не создает проблем при последующем сшивании оболочки, поскольку работа происходит с изображениями, полученными одной камерой, положение которой неизменно. Переходя к определению погрешностей измерения координат глубины, будем считать, что они обусловлены шумом квантования интенсивностей диффузно отраженного света, и, на основании которых рассчитываются нормали к отражающей поверхности, а также наличием флуктуационного шума. В конечном итоге это приводит к геометрическим искажениям полученной в результате сканирования оболочки объекта. Шум пространственной дискретизации при этом играет меньшую роль. Погрешности, обусловленные шумом квантования интенсивностей диффузно рассеянного света, проиллюстрируем на примере, когда 0, 0. Рассмотрение начнем с определения погрешности, обусловленной шумом квантования Как известно, погрешность функции, обусловленная погрешностью аргумента, может быть оценена с помощью дифференциала этой функции. В данном случае смещение вдоль строки на один пиксель вызывает приращение координаты глубины, согласно формуле 10 равное tg . Поэтому погрешность, допущенная при измерении, приводит к погрешности, с которой вычисляется tg, и, как следствие, к погрешности вычисления координаты глубины. Вначале примем, что изображения, показанные на рис. 2, дискретны в пространстве, но не квантованы по яркости, и напишем выражение для дифференциала d Поскольку погрешность d невелика, то от дифференциалов можно перейти к приращениям и записать 11 Делая подстановку выражения для из формулы 3 в формулу 6 и вычисляя производную, запишем что после подстановки в формулу 11 дает 12 Реальные изображения являются цифровыми, поэтому значения интенсивностей света и в формуле 12 выражаются количеством квантовых уровней, а значение после вычисления следует округлять до целого. На рис. 3 кривой показана зависимость погрешности измерения координаты глубины в пикселях от угла, выраженного в градусах, для частного случая, когда 1. Формула, по которой рассчитывается погрешность определения координаты глубины, обусловленная шумом квантования, выводится аналогично формуле 12 с тем отличием, что при выводе формулы вместо интенсивности используется . Рассмотрим теперь погрешность, обусловленную шумом квантования . Как и ранее, напишем выражение для дифференциала d и поскольку погрешность d невелика, то от дифференциалов перейдем к приращениям 13 Сделаем подстановку выражения из формулы 4 в формулу 6, вычислим производную, после чего подставим в получившееся выражение значение из формулы 3 и запишем Делая подстановку найденного значения производной в формулу 13 и отбрасывая знак минус, получим выражение для абсолютного значения погрешности координаты глубины 14 Здесь, как и ранее, значения интенсивностей света и в формуле 14 выражаются количеством квантовых уровней, а значение после вычисления следует округлять до целого. На рис. 3 кривой показана зависимость погрешности измерения координаты глубины в пикселях от угла, выраженного в градусах, для частного случая, когда 1. Сравнивая зависимости и, видим, что погрешность измерения интенсивности рассеянного света, обусловленная процессом квантования, приводит к существенно меньшей погрешности определения координаты глубины, чем погрешность, вызванная квантованием интенсивности рассеянного света . Другими словами, первой составляющей погрешности вполне можно пренебречь. Расчеты показывают, что если назначить максимальное допустимое значение погрешности 0,5 пикселя, то область сканирования, в которой это условие выполняется для, составит от 85 до 85 . Объясняется это тем, что в областях сканирования объекта, где плоскость, касательная к оболочке объекта, ориентирована так, что свет от источника освещения падает на нее под углом, близким к нулю, диффузно отраженный ею свет также мал. При этом даже малая абсолютная погрешность при измерении его интенсивности приводит к большой погрешности в определении тангенса угла наклона нормали, что следует из формул 6 и 7, а следовательно, и в определении тангенса угла наклона касательной плоскости. В результате резко возрастает погрешность определения координаты глубины. В рассматриваемом примере это имеет место в области периметра большого круга сферы см. рис. 2, . В результате проведенного эксперимента получено каркасное сетчатое изображение сферы рис. 4. Эксперимент заключался в том, что вначале специальной программой были сгенерированы пять изображений сферы, подобные показанным на рис. 2. Эти изображения различались между собой расположением источников освещения слева, справа, сверху, снизу и спереди. Радиус сферы составлял 105 пикселей, 1, 250. Далее, используя эти изображения в качестве исходных данных, в соответствии с описанным выше методом находилось -изображение, на основе которого строилось каркасное изображение сферы. При выполнении эксперимента в целях наиболее наглядной демонстрации рассматриваемого вида искажений исходные изображения были проквантованы по яркости на малое количество уровней, а именно на 8. Возникающие при этом искажения, как это видно из рисунка, проявляются в виде характерной бахромы по периметру большого круга сферы. В случае, когда погрешности измерения координаты глубины обусловлены воздействием флуктуационного шума, расчетные формулы имеют аналогичный вид, с той разницей, что вместо и в них подставляются среднеквадратичные значения флуктуационного шума в единицах квантовых уровней. При этом результатом расчета будет среднеквадратичное значение погрешности измерения координаты глубины. Погрешности измерения координаты глубины, обусловленные квантованием сигналов, представляющих интенсивности диффузно отраженного света по существу, квантованием яркости наблюдаемых изображений при различных положениях источников света, могут быть уменьшены путем увеличения количества уровней квантования. Однако это не решает проблемы. Вопервых, при этом всегда остается, хотя и относительно узкая, область, где погрешности недопустимо велики. Во-вторых, этот прием не позволяет снизить погрешности, обусловленные флуктуационным шумом, уменьшения которых можно достигнуть путем применения камер, обеспечивающих достаточно высокое отношение сигналшум. Для того чтобы обеспечить малые погрешности измерения координаты глубины при сканировании объектов со сложной формой оболочки, рекомендуется сканирование выполнять в несколько этапов. На первом этапе следует выполнить сканирование, расположив источники света так, как это описано в разделе Вычисление координаты глубины оболочки 3D-объекта, и получить карту глубины. После этого необходимо на карте глубины выделить области с недопустимо большими погрешностями, что несложно. Эти области соответствуют тем областям исходных изображений, использованных в расчетах, которые оказались затененными для одного или двух источников света, или для которых интенсивность отраженного света мала. Для этих областей измерения следует повторить, подобрав для каждой из них другое положение источников света, а затем на карте глубины сделать соответствующие замены. Каких-либо проблем, связанных со сшиванием изображений, при этом не возникает, поскольку исходные изображения, используемые в расчетах, получаются посредством одной камеры, расположенной в одном и том же месте. В качестве примера рис. 5 приведены экспериментально полученное -изображение головы человека и построенное на его основе каркасное изображение оболочки, которые были получены в процессе 3D-сканирования описанным методом. При выполнении эксперимента исходные изображения были изготовлены с помощью графического редактора 3ds max. На рисунке намеренно сохранены области, в которых искажения, обусловленные погрешностями измеренной координаты глубины, хорошо заметны и для которых измерения должны быть повторены при других положениях источников света. Технология 3D-сканирования, основанная на диффузном отражении света поверхностью сканируемого объекта, наряду с рядом других технологий, описанных в отечественной и иностранной литературе 16, позволяет при выполнении несложных дополнительных условий преобразовывать двумерные изображения в трехмерные. Принимая во внимание низкую стоимость используемой при этом аппаратуры цифровых фотокамер, вэб-камер по сравнению со стоимостью аппаратуры для традиционных методов сканирования, данный метод представляется весьма перспективным уже только по экономическим соображениям. В настоящее время Интернет буквально переполнен всевозможными двумерными изображениями и видео, в том числе изображениями улиц, транспортных перекрестков, дорожных магистралей, получаемых посредством вэб-камер, количество которых лавинообразно возрастает. Учитывая сказанное, нетрудно видеть, что с небольшими дополнениями применение рассмотренных технологий преобразования 2D-изображения в 3D-изображение открывает возможность создания 3D-модели среды нашего обитания в самом широком смысле слова. И наконец, применение рассматриваемой технологии позволит, по мнению авторов, сравнительно простым способом увеличить эффективность автоматического распознавания лиц методом сравнения 3D-изображений, получаемых посредством расположенных в общественных местах камер видеонаблюдения, с 3D-шаблоном лица, которое следует опознать. Трехмерное изображение дает возможность выполнять сравнение с шаблоном, основываясь на форме оболочки объекта, а не на яркости отдельных его пикселей, что делает неэффективным применение грима для целей маскировки. 