НЕКОТОРЫЕ ВОПРОСЫ КОЛИЧЕСТВЕННОЙ ОЦЕНКИ ПРОИЗВОДИТЕЛЬНОСТИ ДЕТЕКТОРОВ ГРАНИЦ 

В статье рассматриваются основные подходы к сравнительной оценке производительности детекторов границ. При этом особое внимание уделено методам количественной оценки, использующим ground truth изображения и меры различий. Анализируются достоинства и недостатки наиболее употребительных мер различий, особенности их совместного применения. Рассматриваются нечеткие методы оценки.

 Выделение границ один из основных шагов задач обработки изображений, распознавания и анализа образов, компьютерного зрения. Под детекторами границ понимаются различные алгоритмы, выделяющие точки цифрового изображения, в которых резко изменяется яркость или есть другие виды неоднородностей. При этом способ определения граничной точки двухмерного изображения носит нечеткий характер, поскольку на практике редко жестко фиксируется порог, при котором яркость между двумя соседними пикселями изменяется настолько, что можно утверждать о нахождении там границы. Это одна из причин считать выделение границ нетривиальной задачей. Как правило, желаемым результатом выделения границ является набор связных кривых, обозначающих границы объектов. Но, к сожалению, не всегда можно выделить границы в картинах реального мира. Появившиеся первыми методы выделения границ можно разделить на две основные категории основанные на поиске максимумов и основанные на поиске нулей . Методы, основанные на поиске максимумов, восходящие к работам Sobel, Prewitt и Roberts, выделяют границы с помощью силы края, такого как величина градиента. Затем происходит поиск локальных максимумов силы края с использованием предполагаемого направления границы . Методы второго порядка, восходящие к работам Marr и Hildreth, ищут пересечения оси абсцисс выражения второй производной . Принято считать, что основные требования к детектору границ впервые были сформулированы J. Canny в 1986 году. Автору удалось сначала сформулировать содержательные требования к детектору, выразить их в виде некоторой оптимизационной задачи, а затем решить эту задачу. Детектор границ должен удовлетворять следующим трем критериям эффективности. 1. Хорошее отношение сигнала к шуму, то есть детектор должен выделять все истинные границы и при этом не выделять ложные. 2. Хорошая локализация. Точки, отмеченные как границы, должны располагаться как можно ближе к истинному положению границ. 3. Единственность отклика на границу . Хотя детектор границ Canny был разработан на заре компьютерного зрения, он до сих пор является одним из наиболее часто используемых. Кроме частных случаев, трудно найти детектор, который работал бы существенно лучше Canny, и практически все работы по сравнительному исследованию детекторов границ содержат его в качестве своего рода эталона. Цель настоящей работы дать объективное представление о некоторых методах в том числе применяемых авторами сравнительного исследования производительности детекторов границ и об используемых при этом количественных критериях оценки качества рассматриваемых алгоритмов. Предполагается, что это поможет практическим пользователям сделать выбор того или иного детектора границ для решения своих задач более осмысленным и стимулировать дальнейший интерес к задаче количественной оценки производительности детекторов границ. Методы оценки детекторов границ Как и в случае с другими классами алгоритмов обработки изображений, методы оценки производительности детекторов границ можно разделить на теоретические и эмпирические. Это зависит от того, используют они теоретический анализ или рассматривают экспериментальные результаты работы того или иного алгоритма. Что касается теоретических методов оценки производительности детекторов границ, в известных работах входные данные рассматриваемого алгоритма описываются математически, а его производительность определяется аналитически или путем симуляции. Для оценки были разработаны соответствующие меры. Недостатками этих работ являлись упрощенные математические модели, характеризующие входные сигнал и шум, а также сложность применения предложенных методов к современным детекторам границ из-за сложности алгоритмов последних. Методы эмпирической оценки доброкачественности, как правило, оценивают либо форму выделяемых границ, либо вероятность правильного определения граничного пикселя на основе изучения яркости пикселей в его окрестности. Существенным недостатком данных методов в их практическом применении является то, что они не могут измерить смещение выделенных граничных пикселей относительно их истинного положения. В частности, эти методы могут давать неадекватные результаты на детекторах, использующих размытие изображения на этапе предобработки. К данной группе методов можно отнести и такие, в которых качество работы различных алгоритмов оценивают люди, выразившие желание участвовать в эксперименте. Эти исследования подтвердили некоторые сложившиеся представления об известных детекторах границ . Однако они не решают проблему выбора оптимального детектора границ для той или иной конкретной задачи обработки изображений. Наиболее обширное семейство методов оценки детекторов границ использует сравнение результатов работы исследуемых алгоритмов на тестовых изображениях с GT-образами. Для количественной оценки результатов основную роль здесь играют меры различий . Используются и производные от этих метрик методы оценок, например, анализ ROC-кривых 1. К недостаткам ранних работ по данной тематике можно отнести то, что используемые в них GT-образы создавались искусственно или брались несложные реальные изображения с легко идентифицируемыми границами. На практике нередко встречаются достаточно трудные для распознавания ситуации, и это сужает область применения указанных методов. Некоторые авторы отмечали, что небольшие изменения в используемых искусственных тестовых изображениях приводили к различным оценкам тестируемых детекторов границ . Так возник вопрос о полноте набора тестовых изображений, используемых в методологии с использованием GT-образов. Указанные недостатки были изучены и частично преодолены в последующих работах по данной тематике . Стали чаще использоваться изображения, моделирующие сложные для выделения границ ситуации например, на рис.представлено несколько изображений из базы тестовых образов системы PICASSO 2. На рисунке 1 каждому изображению соответствует определенная сложная ситуация, связанная с наличием границы изменяющегося контраста. В работе 2 тестировались шесть известных алгоритмов выделения границ Canny, Rothwell, Heitger, Black, Smith and Iverson. В частности, было установлено нестабильное поведение всех алгоритмов на изображениях, содержащих подобные границы, при малых поворотах, сдвигах и растяжениях этих изображений. Использовались и упрощенные версии изображений, содержащие только границы постоянного контраста, при этом поведение алгоритмов на них было относительно стабильным. Тем самым сочетание простых и усложненных изображений сделало тестирование более результативным. Используемые меры различий Как уже отмечалось, основными характеристиками хорошего детектора границ являются высокий процент правильно выделенных граничных пикселей и высокая степень локализации . К настоящему времени не удалось создать меру, одинаково эффективно оценивающую эти две характеристики. Отчасти это связано с тем, что, как было отмечено J. Canny, имеет место своего рода принцип неопределенности между высоким уровнем детектирования и высокой степенью локализации. Соответственно, для оценки данных характеристик детекторов границ используются разные меры различий. В частности, в работе 3, посвященной исследованию мер различий для детекторов границ, они подразделялись на меры оценки качества детектирования и меры оценки локализации. Приведем пример нескольких часто встречающихся мер оценки качества детектирования. Ошибка второго рода определяется как то есть как отношение невыделенных граничных пикселей к общему числу граничных пикселей. Общая ошибка классификации определяется как где симметрическая разность множеств. Чувствительность, специфичность, ошибки первого и второго рода являются исходными величинами при построении ROC-кривых, анализ которых нашел применение и в задаче оценки детекторов границ 1. Указанные меры оценки качества детектирования неслучайно называются статистическими. Изначально они использовались в медицинской статистике при анализе диагностики различных заболеваний. Кроме того, указанные меры являются частным случаем мер оценки качества классификации, широко используемых в обработке данных дистанционного зондирования. В случае детекторов границ f и g могут принимать значения 0 или 1 в зависимости от того, является ли точка соответствующего изображения граничной или нет. Сюда же относятся эквивалентные отношения сигнала к шуму, пиковое и среднеквадратическое. Эти отношения используются и на этапе предобработки изображений для оценки соответствующих фильтров. Указанные меры оценки качества детектирования имеют большое практическое применение, при этом неоднократно отмечались их недостатки 3. Наиболее слабым местом является то, что различия между изображениями A и B определяются по общему числу расхождений между ними безотносительно к образу, который эти изображения представляет. При практическом оценивании детекторов границ с помощью этих мер следует принимать во внимание указанные недостатки. В частности, это относится к выделению границ, использующих размытие зашумленных изображений на этапе предобработки. К данному разряду мер оценки локализации можно отнести и метрику Хаусдорфа Хотя классическая версия данной метрики обладает желательными для использования в оценке цифровых изображений топологическими свойствами, на практике она используется редко в силу своей высокой чувствительности к шуму и даже к изменениям в один пиксель на оцениваемом изображении. В свою очередь, метрика Пратта наиболее часто используемая. Недостатком перечисленных мер оценки локализации является то, что они зачастую нечувствительны к ошибкам второго рода. В отличие от метрики Пратта меры e и e сильно чувствительны к фоновому шуму. К примеру, если образ B содержит даже один пиксель x, находящийся на большом расстоянии от A, значение этого расстояния даст большой вклад в значение средних ошибок расстояния. Это согласуется с известным фактом из статистики о неустойчивости среднего арифметического. Ряд недостатков метрики Пратта был перечислен в работе 3. В частности, при оценке данной метрикой результатов выделения границ лапласианом часто возникали ситуации высоких значений FOM на изображениях, содержащих участки разрывов границ и участки, где получившийся граничный контур осциллирует вокруг своего истинного положения . Значения вышеприведенных мер оценки качества детектирования будут также одинаковыми. Применительно к метрике Пратта подобные примеры означают, что она позволяет соответствовать нескольким выделенным граничным пикселям одному и тому же пикселю на GTизображении . В работе 3 предложена мера оценки локализации, представляющая собой Lc0. Данная метрика, как и метрика Хаусдорфа, обладает желаемыми топологическими свойствами. При этом, в отличие от последней, она более устойчива к возмущениям в один или несколько пикселей . Ряд экспериментов показал ее более адекватное поведение в сравнении с метрикой Пратта. В то же время метрика Пратта продемонстрировала более устойчивое поведение к малым возмущениям границы. В дальнейшем были предложены обобщения метрики, позволяющие использовать ее для сравнения полутоновых изображений. Для оценки детекторов границ данная метрика используется сравнительно редко. В силу того, что отсутствие взаимно однозначного соответствия между пикселями оцениваемой карты границ и соответствующим GT-изображением в перечисленных мерах может привести к их нереалистичным оценкам, представляется целесообразным использовать меры, где подразумевается такое соответствие. В частности, в работе 1 предложено проводить вычисление мер чувствительности и ошибки первого рода с использованием взаимно однозначного соответствия. А именно, берется дистанционный порог T . Если в окрестности T пиксель оцениваемой граничной карты оказывался без соответствующих GT-пикселей, значение ошибки первого рода увеличивалось на единицу. Если соответствующий GT-пиксель находился, значение чувствительности увеличивалось на единицу, и этот пиксель помечался как использованный, так что его нельзя было использовать в дальнейшем. Если в окрестности T оказывалось несколько GTпикселей, в качестве соответствующего брался тот, который находился на кратчайшем расстоянии от пикселя оцениваемого изображения. В работе отмечалось, что предложенный метод слегка меняет значения ошибки первого рода и чувствительности по сравнению с их вычислением обычным способом. Однако он не влияет на общие результаты оценки производительности детекторов границ. В 4 данная методика модернизирована для работы с картами границ, содержащими информацию о силе края. Именно, если граничный пиксель имеет два соответствующих ему пикселя, находящихся на одинаковом расстоянии, из них выбирается наиболее сходный по силе края. Метрика, сравнивающая два изображения и построенная на данном соответствии, была названа в 4 метрикой кратчайшего пути . В свою очередь, в работе 4 была предложена альтернативная метрика, основанная на поиске соответствующих пикселей на сравниваемых изображениях, так называемая метрика соответствия пикселей . Для каждой пары соответствующих пикселей строится функция затрат, вычисляемая с учетом расстояния между ними и силы края. Выбирается пара соответствующих пикселей с учетом наименьшего значения функции затрат. Индекс Т означает окрестность, в которой ищутся соответствующие пиксели. Поиск пар пикселей по минимальному значению функции затрат представляет собой трудоемкий вычислительный процесс. Для этого поиска используется алгоритм из теории двудольных графов, разработанный для решения сходной задачи. Данная метрика наряду с FOM и CDM использовалась для оценки нескольких зашумленных классических изображений, обработанных детектором Canny, и данных изображений без добавления шума, обработанных несколькими версиями этого детектора. Основной задачей было исследование поведения указанных мер оценки локализации при небольших сдвигах полученных границ относительно GT-образов. Эксперименты показали в целом более аккуратное поведение метрики PCM по сравнению с CDM и FOM. В частности, при увеличении окрестности T увеличивается значение PCM, что согласуется со здравым смыслом . Однако явные преимущества метрики PCM над CDM выявлены не были, хотя программная реализация последней значительно проще. Следует отметить, что совместное применение нескольких мер различий из двух рассмотренных классов к оценке детекторов границ может поставить вопрос о согласованности их результатов и предпочтениях в их интерпретации. Результаты измерений показали существенно худшее поведение двух из рассматриваемых детекторов и невозможность выявить лидера из оставшихся четырех детекторов, опираясь исключительно на значения данных мер различий. Также было замечено, что в некоторых случаях выбор между результатами работы двух детекторов на одном тестовом образе осуществлялся на основании значений метрики Хаусдорфа, в то время как значения других метрик практически совпадали. Тем самым использование метрики Хаусдорфа в сочетании с другими метриками оказывалось полезным. В некоторых работах применяется комбинация одной из мер различий с метрикой, не использующей GT-образы. Можно сделать вывод, что на практике задача сочетания различных метрик не менее актуальна, чем задача совершенствования существующих различий. Нечеткие методы оценки В настоящее время разработано большое число алгоритмов обработки изображений, в той или иной степени использующих элементы теории нечетких множеств . Во многих ситуациях выбор таких алгоритмов вполне оправдан. Как отмечалось выше, полутоновые изображения являются нечеткими по своей природе из-за неопределенности, существующей в локализации положения границы, отделяющей объект от фона. Особенно это характерно для размытых изображений. Следовательно, современные методы сравнительного исследования должны уметь работать с подобными алгоритмами, а также включать в себя элементы нечеткой логики. Начиная с ранних работ, посвященных использованию нечеткой логики в задачах выделения границ, делались попытки оценить качество работы предлагаемых алгоритмов путем введения различного рода мер, характеризующих существование, локализацию, связность выделенных граничных пикселей. Следует, однако, признать, что методика сравнительного исследования четких и нечетких детекторов границ не получила достаточного развития. В ряде работ, посвященных анализу и классификации аэрокосмических снимков, было проведено обобщение нескольких известных статистических мер оценки качества на случай нечетких множеств, позволяющее в том числе сравнивать между собой четкие и нечеткие множества. Соответствующие меры были названы нечеткими мерами сходства. Там же рассматривалась и концепция нечеткого GT-образа. Это наблюдение нашло свое отражение в работе 5, где несколько известных детекторов границ было протестировано с использованием нечетких мер сходства и нечетких GT-образов. Рассмотрим подробнее эти концепции. Приведем несколько основных понятий из теории нечетких множеств. Пусть X непустое множество . Значение f в точке x X называется степенью принадлежности x множеству C, а функция f функцией принадлежности нечеткого множества. Обозначим множество всех нечетких множеств на X за 0, 1. Для A и B из 0, 1 нечеткое отношение включения A B означает, что f f для всех x X. Важными примерами данных мер являются следующие. Заметим, что обычные подмножества M из X включаются в данный подход, если рассматривать их как стандартные характеристические функции 1 X 0, 1. Тем самым меры s и s можно применять, когда A или B или оба они являются четкими множествами. В частности, для четких A или B, отождествленных со своими характеристическими функциями, s и s совпадают с мерами оценки качества классификации Шорта и Хеллдена соответственно 5. Изначально эти меры определялись только для четких множеств, так что меры s и s можно рассматривать как их обобщение. Для нечетких GT-образов не существует общих правил построения. В работе 5 было сделано предположение, что их включение в системы сравнительного тестирования детекторов границ позволит не только тестировать нечеткие детекторы, но и сделать процедуру тестирования всех детекторов более содержательной. Там же предлагались различные нечеткие GT-образы, соответствующие одному и тому же тестовому изображению. Предполагалось, что они позволят лучше протестировать те или иные свойства исследуемого детектора границ. В качестве примера в 5 рассматривалось изображение исчезающий уступ . На рисунке 3b изображен соответствующий GT-образ, построенный стандартным образом . На рисунке 3с, d изображены два нечетких GT-образа G и G, соответствующих рисунку 3a. Их отличают различные функции и принадлежности пикселей множеству границ. Функция принадлежности является прямоугольной, фактически образ G эквивалентен стандартному образу . Тестирование двух детекторов с использованием данных изображений показало, что, поскольку функция присваивает одинаковые значения сильным и слабым пикселям, ее уместно использовать для проверки способности детектора выделять слабые края. Соответственно, образ G предпочтительнее использовать для проверки свойства выделять непрерывные границы. Другим потенциально важным приложением нечетких GT-образов из 5 является возможность их использования в проверке свойства детектора границ выделять граничные точки, существенные для характеризации ограничиваемого объекта. Например, для прямоугольника таковыми являются угловые точки. Задавая для них более высокие значения функции принадлежности множеству границ в сравнении с остальными граничными точками GT-образа, можно добиться высокой чувствительности нечетких мер сходства к выделению этих существенных точек. Однако в работе 5 нет методики построения таких образов и использования различных нечетких мер сходства для практического тестирования детекторов границ. Так что, вопрос о создании методологии тестирования данных алгоритмов с использованием нечетких элементов остается открытым. В заключение необходимо отметить, что в последние двадцать лет существенно вырос интерес к сравнительному исследованию алгоритмов обработки изображений, хотя достижения в этой области пока отстают от сегодняшних потребностей. Каждый из рассмотренных подходов имеет свои достоинства и недостатки и, как следствие, ограничения в применении. Тем не менее, накопленные результаты позволяют дать подробную характеристику известным детекторам границ. Эта информация оказывается полезной практическим пользователям при выборе того или иного детектора границ для решения своих задач. Кроме того, можно сделать вывод, что для пользователя, решающего проблему выбора одного из нескольких имеющихся детекторов границ, в числе наиболее перспективных представляется путь их сравнительного тестирования с использованием GT-оценок. Следует заметить, что более современные версии мер различий имеют сомнительные преимущества над более ранними, к тому же численная реализация новых версий зачастую достаточно сложна. По мнению авторов, выработка методологии совместного использования известных мер для сравнительного тестирования детекторов границ является перспективной задачей. Например, пользуясь результатами 2, можно рассмотреть задачу определения ситуаций, в которых использование метрики Хаусдорфа совместно с метриками Пратта и среднеквадратичной делает тестирование более качественным. Кроме того, полезно сочетание мер различных классов, оценивающих качество детектирования и локализации. Рассмотренный нечеткий подход к оценке детекторов границ позволяет проводить углубленное тестирование детекторов границ, как использующих элементы теории нечетких множеств, так и не использующих данную теорию. 