КОДИРОВАНИЕ И ПЕРЕДАЧА ИНФОРМАЦИИ АЛГОРИТМ ДЕКОДИРОВАНИЯ КОДОВ  С МАЛОЙ ПЛОТНОСТЬЮ ПРОВЕРОК НА ЧЕТНОСТЬ  С БОЛЬШИМ РАСПАРАЛЛЕЛИВАНИЕМ 

Предложена модификация алгоритма декодирования belief propagation для кодов с малой плотностью проверок на четность, основанных на матрицах перестановок. Представленный в работе алгоритм имеет векторную реализацию. Приведены результаты моделирования данного алгоритма при передаче кодового слова с помощью двоичной фазовой модуляции по каналу с аддитивным белым гауссовым шумом.  Ключевые слова  — МПП-код, векторный декодер, матрица перестановок. 

Двоичные коды с малой плотностью проверок на четность МПП-коды были предложены Галлагером 1. Данные л инейные блочные коды задаются с помощью проверочной матрицы, характеризуемой относительно малым числом единиц в строках и столбцах. Часто проверочную матрицу МПП-кода удобно представлять в виде графа Таннера 2. Также в работе 1 был предложен итеративный алгоритм декодирования распространения доверия belief propagation. Данный алгоритм основан на декодировании по апостериорным вероятностям на выходе канала и требует порядка log операций, где длина кода. Помимо случайных МПП-кодов нередко используют алгебраические МПП-коды, основанные на матрицах перестановок специального вида 3 7. В данной работе рассмотрена модификация алгоритма декодирования распространения доверия для случая, когда проверочная матрица кода с малой плотностью проверок на четность состоит из произвольных матриц перестановок. Основное преимущество данного алгоритма заключается в том, что он имеет параллельную реализацию, работая не с отдельными символами, а с векторами. Для лучшего понимания изложенного в статье материала мы приведем алгоритм построения проверочной матрицы случайного МПП-кода. В 1960 г. Р. Галлагер предложил алгоритм генерации проверочной матрицы случайного кода с малой плотностью проверок на четность 1. Ниже приведен алгоритм построения этой матрицы. Пусть проверочная матрица кода проверки на четность длины Запишем блочно-диагональную матрицу с проверочными матрицами на главной диагонали где достаточно велико. Так как размер матрицы равен 1, то размер матрицы . Пусть случайная перестановка столбцов матрицы . Тогда матрица, составленная из 2 таких перестановок в качестве слоев является разреженной проверочной матрицей размера, которая определяет ансамбль МПП-кодов Галлагера длины . Обозначим этот ансамбль, . Элементы ансамбля, получаются путем независимого выбора без возвращений перестановок, 1 Все перестановки выбираются равновероятно, таким образом, на ансамбле, задано равномерное распределение вероятностей. Проверочная матрица МПП-кода Галлагера, построенная указанным выше способом, содержит единиц в каждом столбце и единиц в каждой строке. Такие кодовые конструкции назовем регулярными, кодами. Нижняя оценка на скорость кода из, определяется формулой 1 1, где 1 скорость кода проверки на четность. Таким образом, получим оценку на скорость МПП-кода Галлагера 1 Для большего понимания алгоритма декодирования МПП-кодов, основанных на матрицах перестановок, который будет рассмотрен ниже, в данном разделе мы напомним классический алгоритм декодирования, предложенный Галлагером 1. Описанный здесь декодер относится к классу так называемых вероятностных алгоритмов декодирования. На вход алгоритму передается оценка вероятностного распределения символов, полученная из канала, и далее декодер работает с численными значениями вероятностей. Рассматриваемый декодер МПП-кодов работает с представлением кода в виде фактор-графа, также известного как граф Таннера. Граф Таннера это двудольный граф, состоящий из двух подмножеств вершин вершин-символов вершин-переменных и вершин-проверок рис. 1. Ребро соединяет вершину-переменную и вершину-проверку в том случае, если соответствующая переменная символ входит в проверку. Рассматриваемый алгоритм является итеративным. Каждая итерация состоит из последовательной обработки сначала данных вершин-проверок, а затем вершин-переменных. Пусть 1, 1, где длина кода, количество проверок на четность. Введем некоторые обозначения LLR логарифм отношения правдоподобия log likelihood ratio знак LLR -й переменной из канала модуль LLR -й переменной из канала вычисленный знак LLR -й переменной вычисленный модуль LLR -й переменной сообщение от -й проверки к -й переменной знак сообщения от -й переменной к -й проверке принимает значения 1 или 1 модуль сообщения от -й переменной к -й проверке набор переменных, которые участвуют в проверке набор, кроме бита набор проверок, в которых участвует -я переменная набор, кроме бита . Декодер включает в себя следующие шаги. 1. присвоим 1 2. вычисление сообщений от вершин-проверок к вершинам-переменным при использовании LLR оно будет выглядеть следующим образом где функция 3. вычисление сообщений от вершин-переменных к вершинам-проверкам Далее по вычисленным 1 строится вектор который является жестким решением, и проверяется равенство нулю синдрома . Горизонтальный и вертикальный шаги выполняются ограниченное число раз. В случае если все проверки оказались выполнены синдром равен нулевому вектору, алгоритм может быть остановлен досрочно. Если достигнуто максимальное число итераций, то исполнение алгоритма прерывается и блок считается принятым с ошибкой. Возможны и другие критерии остановки. Отметим также, что если составить матрицу 1 -я переменная входит в -ю проверку, 0 иначе, то будет являться проверочной матрицей МППкода. Таким образом, существует взаимно-однозначное отображение между фактор-графом и проверочной матрицей МПП-кода. Данный факт позволяет дать процессу декодирования матричное описание. Пусть, причем, . Рассмотрим группу матриц перестановок размерности, . Выберем случайных матриц, 1, 1 . Потребуем также, что если, то, Ясно, что такие условия выбора матриц перестановок соответствуют урновой модели без возвращений. Построим проверочную матрицу следующего вида 2 Указанный выше способ построения матрицы гарантирует, что все матрицы в каждой строке и каждом столбце будут различны. Так как квадратная матрица, то размерность определяет ансамбль регулярных, -кодов с малой плотностью проверок на четность длины, который мы обозначим, Элементы ансамбля, получаются путем выбора без возвращений матриц перестановок, 1, 1 . Произвольный код, назовем . Как и для произвольного кода из ансамбля, для кода из, также справедлива оценка на скорость 1. Одним из наиболее распространенных на практике и простых по структуре кодов из ансамбля, является квазициклический МПП-код. Дадим определение ансамбля таких кодов. Пусть, матрица -кратного циклического сдвига столбцов единичной матрицы, 1, 1, 1 Построим матрицу следующего вида Поскольку размерность, то размерность определяет ансамбль регулярных, МПП-кодов длины Обозначим этот ансамбль, Элементы ансамбля, получаются путем равновероятного выбора возможно, с возвращениями матриц -кратных циклических сдвигов. Произвольный код, назовем квазициклическим МПП-кодом. Очевидно, что ансамбль, является подансамблем ансамбля, . В то же время, поскольку проверочная матрица квазициклического МПП-кода полностью определяется набором из чисел, 0 1, 1, 1, то для хранения нам достаточно хранить матрицу Хранение данной матрицы вместо позволяет существенно оптимизировать процедуру хранения. Поскольку для представления проверочной матрицы в форме 2 нам потребовалось бы чисел, то достигается кратная экономия памяти. Матрицы перестановок, использованные в 2, для квазициклического МППкода являются матрицами кратного циклического сдвига. Отметим, что из работ 8, 9 следует, что коды из ансамблей, и, при одинаковых параметрах обладают практически одинаковыми корректирующими свойствами. Пусть проверочная матрица регулярного, -кода с малой плотностью проверок на четность, причем размер, 1, 1, равен, тогда матрицу можно представить в следующем виде 3 где перестановка, соответствующая матрице Поскольку длина МПП-кода с проверочной матрицей равна, то кодовое слово, 2, можно представить в следующем виде 4 где двоичный вектор длины Напомним, что синдром для принятого слова вычисляется по формуле, причем 0 тогда и только тогда, когда является кодовым словом. Пусть проверочная матрица задана соотношением 3, а принятое слово соотношением 4, тогда является кодовым тогда и только тогда, когда Последнее соотношение эквивалентно следующей системе из уравнений Таким образом, доказано следующее . Вектор где двоичный вектор длины, является кодовым словом кода с малой плотностью проверок на четность длины, задаваемого проверочной матрицей 3, тогда и только тогда, когда выполняется соотношений Как следует из утверждения, для МПП-кода, основанного на матрицах перестановок, вычисление синдрома ошибки имеет векторный характер в вычислениях используются не отдельные символы принятого слова, а блоки длины Предлагаем модификацию алгоритма belief propagation для кодов с малой плотностью проверок на четность, основанных на матрицах перестановок. Основная идея предложенной модификации заключается в одновременной обработке символов принятого слова т. е. алгоритм работает с векторами длины, в то время как классический алгоритм belief propagation не предусматривает такую возможность. Векторный характер декодирования принятого слова, как будет показано, позволяет распараллелить алгоритм декодирования в раз, что существенно отразится на скорости обработки данных. Как и при декодировании случайного МПП-кода Галлагера, на вход алгоритму передается оценка вероятностного распределения символов, полученная из канала. Данная оценка представляет из себя вектор длины, т. е. Так как, то для справедливо представление 4 причем 1 Выше было введено множество набор переменных участвующих в -й проверке, и множество набор проверок в которые входит -я переменная. Рассмотрим произвольный вектор Так как размерность равна, а матрицы, матрицы перестановок т. е. содержат ровно 1 единицу в каждой строке и каждом столбце, то участвует в различных проверках. Таким образом, Полученное равенство позволяет нам сделать вывод о том, что элементы участвуют во всех проверках. Таким образом, при декодировании нам не требуется искать для каждого вектора Проводя аналогичные рассуждения, можно показать, что в проверках участвуют переменных, поэтому вычисление для каждой -й проверки также не требуется. Введем необходимые обозначения принятый из канала вектор логарифмов отношения правдоподобия, причем 1 вектор знаков 1 или 1 вектора полученного из канала, т. е. где 1 вектор модулей вектора полученного из канала, т. е. где 1 вычисленный вектор знаков для вектора вычисленный вектор модулей для вектора вектор сообщений от -й группы из проверок к вектор знаков покомпонентный сообщений от переменных к -й группе из проверок вектор модулей покомпонентный сообщений от переменных к -й группе из проверок. Изложенный ниже алгоритм декодирования применим только для МПП-кодов, основанных на матрицах перестановок, и работает с проверочной матрицей, представленной в форме 3 Декодирование включает в себя следующие шаги. 1. по принятому из канала вектору строится жесткое решение, вычисляется синдром согласно алгоритму, описанному в предыдущем разделе. Если синдром равен нулевому вектору, то декодирование прекращается и является результатом выполнения алгоритма, иначе переходим к шагу 2. 2. строим матрицы и по правилу 3. строим матрицу сообщений от й группы проверок к му вектору переменных где причем отображение имеет следующий вид 4. вычисление сообщений от го вектора переменных к й группе проверок 5. по вычисленным 1, cтроится жесткое решение и вычисляется синдром если 0, то декодирование прекращается и считается результатом работы декодера. Если синдром не нулевой, то возвращаемся на шаг 3. Вертикальный и горизонтальный шаги выполняются ограниченное число раз. Если достигнуто максимальное число итераций, то алгоритм прерывается и блок считается принятым с ошибкой. Описанный выше алгоритм оперирует только с векторами длины, не обращаясь явно к отдельным символам. Таким образом, процесс декодирования можно осуществлять параллельно для символов. Для практической реализации описанного в статье алгоритма декодирования МПП-кодов, основанных на матрицах перестановок, была написана функция для MatLab Для рассмотренного в работе декодера производилось имитационное моделирование с использованием среды MatLab Передача данных осуществлялась по каналу с аддитивным белым гауссовым шумом и двоичной фазовой модуляцией. Максимальное число итераций ограничивалось 50. В качестве МПП-кодов, основанных на матрицах перестановок, были выбраны квазициклические коды QC-LDPC. Результаты моделирования 4 кодов различных длин из ансамбля, при фиксированном числе слоев и столбцов и скорости представлены на рис. 2 Из рисунка следует, что энергетический выигрыш при использовании кода длины 2000 по сравнению с кодом длины 1000 составляет около 0,35 дБ по уровню вероятности ошибки на блок 10 в то же время при переходе от длины 2000 к 4000 выигрыш составляет уже порядка 0,3 дБ при аналогичном уровне вероятности ошибки увеличение длины кода от 4000 к 8000 уже практически не улучшает корректирующих свойств выигрыш менее 0,1 дБ. Результаты моделирования 8 квазициклических кодов длин 1000 при фиксированной скорости и различном числе слоев представлены на рис. 3 Как следует из рисунка, наилучшими корректирующими свойствами обладает код с наименьшим числом слоев 3. Переход от 3 к 4 приводит к энергетическому проигрышу порядка 0,3 дБ по уровню вероятности ошибки на блок 10 Дальнейшее увеличение также приводит к ухудшению корректирующих свойств кода, хотя при 6 ухудшение становится незначительным. В то же время из работ 1, 9, 10 следует, что увеличение при фиксированной длине кода и его скорости приводит к увеличению минимального кодового расстояния . Следовательно, чем больше число слоев, тем меньшую часть доли исправляемых ошибок реализует алгоритм belief propagation. Таким образом, belief propagation хорошо работает только с кодами с наихудшими потенциальными корректирующими свойствами. Вывод о том, что предложенный в статье алгоритм декодирования уже при сравнительно небольших дает выигрыш по времени декодирования минимум в 5 раз по сравнению с декодером, предложенным в работе 1, позволяет сделать рис. 4. Отметим, что моделирование обоих алгоритмов проводилось в среде MatLab. При 600 векторный алгоритм декодирования работает примерно в 20 раз быстрее классического belief propagation Причем следует отметить практически линейную зависимость отношения от Предложен векторный алгоритм декодирования МПП-кодов, основанных на матрицах перестановок. Для декодера осуществляется распараллеливание в раз, где достаточно велико. Данный подход позволяет существенно увеличить скорость декодирования. Поскольку к современным сигнально-кодовым конструкциям предъявляются достаточно жесткие требования по скорости обработки и передачи данных, то построенный декодер может иметь практическую ценность. 