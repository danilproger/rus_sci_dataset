ЗАЩИТА ИНФОРМАЦИИ ПРИМЕНЕНИЕ ВЕЙВЛЕТ-ПРЕОБРАЗОВАНИЯ   ДЛЯ ВНЕДРЕНИЯ ЦВЗ В ВИДЕОПОТОК   В РЕЖИМЕ РЕАЛЬНОГО ВРЕМЕНИ  

Приводится описание метода защиты видеопотока в режиме реального времени. Детально описаны алгоритмы внедрения цифрового водяного знака в последовательность кадров и алгоритм его извлечения из принятого  потока. Содержатся результаты контроля качества внедрения знака.  Ключевые слова  — цифровой водяной знак, робастность, пиковое соотношение сигнал/шум, вейвлетпреобразование, базис Хаара, режим реального времени. 

Существуют различные способы защиты видеопотока от возможного преднамеренного искажения при передаче его по сетям общего пользования. Однако авторы статьи столкнулись с необходимостью разработать собственный метод, обеспечивающий требуемый уровень защиты кадров при реализации их преобразования в реальном масштабе времени. Стоящая задача актуальна для передачи видеопотоков в распределенных информационно-управляющих IP-системах с виIP-системах с ви-системах с видеоканалом в обратной связи, в которых IPвидеосервер реализуется на базе сигнального процессора, основной вычислительный ресурс и память которого заняты выполнением операций по захвату, оцифровке, формированию пакетов и их передаче по сети. В данной работе в качестве инструмента защиты используется цифровой водяной знак ЦВЗ. Внедряемый ЦВЗ представляет собой растровое цветное графическое изображение малого по отношению к кадру-контейнеру размера, внедряемое в защищаемый кадр и полностью его покрывающее. В качестве ЦВЗ может использоваться не только растровое изображение, но и любая последовательность байт требуемого объема, поскольку все операции осуществляются на битовом уровне. Существует ограничение максимального размера ЦВЗ, поскольку он рассчитывается исходя из уровня защиты и размера целевого кадра. Минимального ограничения нет, но для полной защиты кадров необходимо иметь ЦВЗ максимального или близкого к максимальному объема. Робастность внедряемого ЦВЗ можно повысить, увеличив плотность защиты, однако при неизменном размере контейнера это уменьшит максимальный размер самого ЦВЗ. Соответственно, уменьшение плотности защиты позволит внедрять ЦВЗ большего размера. Однако в любом случае защищенный кадр должен не выделяться из ряда обычных кадров ни визуально, ни при оценке с помощью известных критериев оценки качества, таких как метрики PSNR, Delta и др. 1. Приведем кратко действия по выполнению обработки видеопоследовательности. 1 подбор целевого кадра по его номеру из последовательности формируемых кадров согласно установленной методике в режиме реального времени 2 получение низкочастотных коэффициентов -го уровня и всех высокочастотных коэффициентов с использованием вейвлет-преобразования 3 внедрение в низкочастотные коэффициенты -го уровня содержания цифрового водяного знака по оригинальному алгоритму 4 синтез изображения и нормализация полученных значений пикселей 5 установка замена синтезированного кадра в последовательность передаваемых кадров на соответствующее ему место. 1 подбор целевого кадра по его номеру из последовательности уже сформированных кадров согласно установленной методике 2 вейвлет-преобразование целевого кадра получение низкочастотных коэффициентов -го уровня и всех высокочастотных коэффициентов 3 извлечение из низкочастотных коэффициентов -го уровня по оригинальному алгоритму информации, возможно, являющейся ЦВЗ, и форматирование ее в растровое изображение 4 оценка достоверности принятого сегмента видеопотока учитывая возможные ошибки передачи по определенной методике. Рассмотрим описанный выше процесс защиты видеопотока. С помощью внедрения ЦВЗ необходимо защитить видеопоток, формируемый со скоростью 25 кадровс. Предполагаемая атака на целевую видеопоследовательность, направленная на искажение смысла передаваемой информации, допускает подмену значительного числа кадров в их последовательности. Исходя из этого можно предположить, что не имеет большого смысла внедрять ЦВЗ последовательно в каждый кадр, а для эффективной защиты достаточно выбирать целевые кадры с определенным интервалом или номером. При анализе уже полученной информации факт отсутствия или значительного искажения ЦВЗ обозначает значительные изменения в кадрах, что в свою очередь свидетельствует об их искажении или подмене. Естественно, что при передаче информации по каналам связи могут также возникнуть и случайные изменения потока, под воздействием которых ЦВЗ может быть частично разрушен в некоторых кадрах. Однако, если удельное количество таких кадров на определенном временном отрезке не превышает критического порога, полученный видеопоток считается оригинальным. . В статье 2 были проанализированы различные известные методики и алгоритмы внедрения ЦВЗ в отдельные изображения. Анализ показал, что для поставленной задачи наилучшим образом подходит вейвлетпреобразование Хаара исходного изображения, поскольку оно выполняется в 6 раз быстрее, чем дискретное косинусное преобразование. К тому же при его выполнении используются самые быстрые команды процессора битовый сдвиг и сложение, что также важно при использовании сигнального процессора, имеющего малый свободный вычислительный ресурс. Для уменьшения времени выполнения всех операций преобразования и внедрения будем использовать целочисленную арифметику. Это позволит экономно использовать память и получить экономию во времени преобразования. Хотя сами компоненты пикселей представлены только целыми числами, рациональными могут оказаться коэффициенты вейвлет-преобразования уже на первом и последующих уровнях. Поэтому в алгоритмах внедрения и извлечения ЦВЗ в процессе выполнения операций используется переход к целочисленным вычислениям с возможностью распараллеливания вычислений. Итак, для внедрения ЦВЗ в кадр его необходимо разложить по базису Хаара, простейшему базису вейвлетов, путем вычисления вейвлетпреобразования. Вычисление проводится попарным усреднением пикселей, которое дает в результате новое изображение с более низким разрешением. Поскольку усреднение и децимация повлекли потерю некоторой информации, для восстановления величины исходных пикселей из имеющихся усредненных пикселей необходимо наличие нескольких уточняющих коэффициентов, хранящих потерянную информацию 3. В итоге можно определить вейвлет-преобразование исходного изображения, также называемое вейвлет-разложением, как набор коэффициентов, представляющих собой общее среднее значение исходного изображения, дополненный уточняющими коэффициентами, располагающимися в порядке, соответствующем увеличению разрешения 3. Метод, по которому происходит вычисление вейвлет-преобразования с использованием рекурсивного усреднения коэффициентов и нахождением разностей, называется методом блока фильтров. При его использовании не происходит ни потери, ни прибавления никакой информации исходное изображение имеет столько же коэффициентов, сколько и у выполненного преобразования. Еще одним плюсом вейвлет-преобразования является то, что его выполнение возможно распараллелить в структуре IP-видеосервера. Дальнейшие действия связаны с необходимостью определить уровень декомпозиции изображения. Поскольку этот параметр напрямую влияет на скорость выполнения данного алгоритма, его необходимо рассчитывать, исходя из характеристик конкретной аппаратной платформы IP-видеосервера. Выполнив декомпозицию исходного изображения до заданного уровня, получаем набор низкочастотных коэффициентов. Конечный уровень декомпозиции выбирается исходя из размеров встраиваемого ЦВЗ. Затем в каждый из полученных коэффициентов необходимо внедрить биты пикселей ЦВЗ. Сам цифровой знак представлен цветным растровым изображением 24 бита на пиксель, соответственно, каждый пиксель определяется значениями трех цветовых каналов. Именно эти значения последовательно побитно внедряются в кадр. Два младших бита каждого из низкочастотных коэффициентов модифицируются одним значением бита ЦВЗ, затем в следующий коэффициент внедряется следующий бит компоненты цифрового знака. Обработка последующих частей кадра производится аналогично. Таким образом, биты первых пикселей будут встроены в начало кадра, биты середины знака разместятся в середине обрабатываемого кадра и т. д. Для увеличения устойчивости ЦВЗ можно применить метод коррекции ошибок. В результате выполнения описанных выше действий для всех пикселей ЦВЗ получаем незначительно модифицированную последовательность низкочастотных коэффициентов вейвлетпреобразования. Внедрение завершено. После завершения процесса внедрения ЦВЗ необходимо синтезировать из модифицированной последовательности низкочастотных коэффициентов и всех высокочастотных коэффициентов исходное изображение для установки его в последовательность кадров. Операция синтеза является обратной операции декомпозиции. Поскольку коэффициенты были незначительно изменены, то и значения компонент полученного в итоге изображения будут также модифицированными, а соответственно, некоторые значения могут выйти за допустимые пределы. Поэтому после полного синтеза необходимо выполнить операцию нормализации запредельных значений и только после этого вставить полученный кадр на место в последовательности кадров. Рассмотрим процесс проверки последовательности кадров на наличие ЦВЗ. Методика поиска кадра с ЦВЗ на этапе защиты предполагает слепое извлечение на этапе анализа. Поскольку ЦВЗ был внедрен в последовательность с известной частотой, то на начальном этапе необходимо определить кадр, в котором содержится ЦВЗ, путем последовательного перебора и анализа всех кадров. После выявления любого искомого защищенного кадра все следующие выбираются согласно методике внедрения. Таким образом формируется отдельная последовательность кадров, содержащих ЦВЗ. В результате вейвлет-преобразования кадра получим низкочастотные коэффициенты -го уровня, в которых, предположительно, побитно внедрен ЦВЗ. Сама методика декомпозиции с использованием вейвлет-преобразования идентична той, которая была использована на этапе кодирования. . Из полученных коэффициентов побитно извлекаются значения каждой из компонент каждого пикселя ЦВЗ. Пиксели знака расположены построчно. Полученный набор форматируется в изображение с заданным размером и глубиной цвета. Эти параметры заранее определены еще на этапе кодирования. Затем полученный образец сохраняется. На этом извлечение цифрового водяного знака из текущего кадра завершено. . Для подтверждения достоверности принятой последовательности кадров необходимо сравнить извлеченный водяной знак с эталоном. Значительные искажения или невозможность распознать в образце водяной знак являются основанием считать последовательность принятых кадров измененной или подмененной. Водяной знак располагается на кадре-контейнере равномерно и покрывает его полностью, поэтому по местам искажений на образце при частичном изменении деталей защищаемого кадра можно судить о масштабах и местах искажения и на исходном кадре-контейнере. Поскольку все образцы ЦВЗ, извлеченные из принятой последовательности, будут сохранены на диске в виде растровых изображений, то имеется возможность их последующей автоматизированной обработки. Для контроля качества защищенного изображения была создана тестовая видеопоследовательность из 220 разных кадров 4 с характеристиками 1900 1200 24 бит. Для защиты видеопоследовательности использованы последовательно четыре разных по форме и цветам ЦВЗ одинаковый ЦВЗ внедрялся подряд в 55 кадров. С помощью программы Elecard Video Quality Estimator из пакета Elecard StreamEye Tools 2.9.1 5 было проведено исследование качества внедрения ЦВЗ с применением метрик OPSNR 6, APSNR, NQI, VQM, SSIM, Delta, MSE, MSAD 7. Данные, полученные при анализе указанной видеопоследовательности, были систематизированы, посчитана разница значений метрик для каждого исходного и защищенного кадров по каждой из восьми метрик. Значения дисперсий по каждой из метрик 1,151576 1,155470 0,003878 0,000396 0,00001 0,000635 0,001483 0,001483. Результаты исследований показали, что внедрение ЦВЗ в отдельные кадры почти не нарушает их статистических характеристик. Максимальные изменения по метрике APSNR зарегиAPSNR зареги зарегистрированы в кадре IMG1 8 рис. 1, с использованием цифрового водяного знака DWM1 8 рис. 2 значение 4,8998. Расхождений почти не выявлено в кадре IMG2 рис. 3 c внедренным цифровым водяным знаком DWM2 рис. 4 значение 0,0036 APSNR рис. 14 см. с. 3 обложки. Результаты приведены в таблице и представлены графически на рис. 5 см. с. 3 обложки. Сравнительные измерения временных затрат на внедрение ЦВЗ в изображения, имеющие разные размеры, были проведены на ПК с процессором Pentium IV 1800 МГц. При проведении этих исследований использовались три разных 24-битных ЦВЗ разного размера 64 64, 80 80, 90 120 пикcелей и три больших 24-битных изобраcелей и три больших 24-битных изобраелей и три больших 24-битных изображения размерами 640 480, 1024 768 и 1920 1200 пикcелей. Результаты приведены в таблиcелей. Результаты приведены в таблиелей. Результаты приведены в таблице и представлены графически на рис. 5. В работе предложен метод внедрения ЦВЗ в потоковое видео, основанный на быстром вейвлет-преобразовании Хаара 8. ЦВЗ, представляющий собой заранее подобранное цветное изображение, программно внедряется в кадр передаваемого видеопотока на стадии защиты и выделяется из него при приеме. Реализация метода обеспечивается преобразованиями, выполняемыми над целыми числами, и использованием простейших операций, что, очевидно, снижает его вычислительную сложность. Так, в сравнении с популярным методом A17 2, использующим дискретно-косинусное преобразование изображения, предлагаемый в работе метод выполняет преобразование видеокадра в среднем в 56 раз быстрее, а в сравнении с методом А21 2, использующим биортогональные вейвлет-фильтры, в 23 раза. Предложенные в работе процедуры внедрения и извлечения ЦВЗ имеют потенциал для оптимизации. Поскольку процесс анализа принятого видеокадра производится на компьютере, то он может быть запущен в любой момент времени и применен к любому отсчету последовательности кадров. При этом для быстрого получения результатов анализа может быть использовано распараллеливание подпроцесса выделения ЦВЗ и подпроцесса сравнения с эталоном. Подпроцесс выделения знака также может быть распараллелен, исходя из природы вейвлетпреобра зования. 