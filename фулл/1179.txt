ВОЗМОЖНОСТИ ИСПОЛЬЗОВАНИЯ ИМПУЛЬСНЫХ  РЕКУРРЕНТНЫХ НЕЙРОННЫХ СЕТЕЙ  ДЛЯ АНАЛИЗА ЭЛЕКТРОКАРДИОГРАММ  

Цель:  разработка системы распознавания динамических образов с использованием нового подхода на основе резервуарных вычислений.  Результаты:  распознавание динамических образов определяется как выявление патологических состояний сердца пациента — аритмий по изменяющемуся сигналу его электрокардиограммы. В качестве примера рассматриваются два типа аритмий — суправентрикулярная и вентрикулярная. Предложен новый эффективный  метод решения поставленной задачи на основе модели машины неустойчивых состояний, состоящей из импульсной  рекуррентной нейронной сети и считывателей. Представлен процесс решения задачи распознавания электрокардиограмм. Демонстрируется на понятном примере специфика используемого подхода: представление данных в импульсной форме, работа импульсной нейронной сети, считывание данных и принятие решения — классификация. В качестве  исходных данных используется база данных SVDB по аритмиям из свободного ресурса Physionet. Рассчитываются показатели качества распознавания и сравниваются с показателями, полученными при использовании наиболее известных  альтернативных методов.  Практическая значимость:  предложенный метод на основе машины неустойчивых состояний  позволяет повысить качество решения задач распознавания динамических образов разнообразной природы по сравнению с классическими методами.  Ключевые слова  — импульсные нейроны, рекуррентные нейронные сети, распознавание динамических образов,  электрокардиограмма.  

Несмотря на то что теория распознавания образов развивается с 70-х годов прошлого века, все еще существует много нерешенных задач, относящихся к этому направлению. Особенно это касается случая динамических образов, которые в отличие от статических образов зависят от времени и, таким образом, имеют одно дополнительное измерение. Для устранения возникающей сложности в большинстве подходов предлагается перейти от динамического образа к статическому путем формирования некоторого набора признаков. Новым статистическим подходом к извлечению признаков динамического сигнала является использование рекуррентных нейронных сетей РНС в составе системы, реализующей парадигму резервуарных вычислений 1, 2. Использование данного подхода, как будет показано дальше, позволяет повысить качество распознавания по сравнению с классическими решениями. Одним из приложений теории распознавания динамических образов являются задачи диагностики динамических систем. Их состояние представляет собой набор изменяющихся во времени непрерывных сигналов или последовательностей. Примером такой задачи выступает медицинская диагностика заболеваний и патологий сердечно-сосудистой системы человека по записям его электрокардиограммы ЭКГ. В настоящее время распознавание ЭКГ с помощью компьютерных алгоритмов используется только для первичной диагностики пациента, а окончательная расшифровка ЭКГ выполняется врачом. Одной из главных причин этого является как раз недостаточное качество распознавания. Поэтому усовершенствование системы распознавания динамических образов на примере ЭКГ позволит автоматизировать и тем самым ускорить процесс медицинской диагностики. Рассмотрим особенности, связанные с задачей распознавания ЭКГ графического представления разности потенциалов, формирующейся в результате работы сердца. В ходе анализа ЭКГ выявляются различные нарушения ритма, определяется их тип и предполагаются различные причины, с которыми эти нарушения могут быть связаны. Наиболее распространенным нарушением ритма является аритмия. При аритмии происходит нарушение частоты, ритмичности и последовательности возбуждения и сокращения сердца. В зависимости от нарушенной функции сердца выделяют три группы аритмий, в каждой из которых выделяют несколько типов и подтипов. Каждый тип аритмии характеризуется своим уникальным внутренним рисунком. Однако несмотря на это, ряд обстоятельств затрудняет постановку точного диагноза у каждого человека рисунок аритмии может немного отличаться различные патологии могут накладываться друг на друга и изменять общий рисунок при суточном мониторинге сигнал ЭКГ может быть сильно зашумлен очевидные патологии могут быть видны сразу, однако предпатологические состояния могут оставаться незаметными. Для настройки, обучения и оценки качества разрабатываемых систем автоматического распознавания ЭКГ используются специальные медицинские базы данных ЭКГ 3. Процесс подготовки такой базы включает в себя запись сигнала ЭКГ с некоторой частотой дискретизации, разбиение всей ЭКГ на секции. Каждая секция характеризует одно биение сердца и анализируется врачом-специалистом для маркировки своим классом здоров, аритмия типа 1, аритмия типа 2 и т. д.. На рис. 1 показан пример фрагмента ЭКГ, снятой с двухканального регистрирующего прибора с частотой дискретизации 128 Гц и разбитой на секции, каждая новая секция на графиках отмечена ромбом. Между графиками отображается тип биения для каждой секции. В примере показаны три типа биения нормальное N, суправентрикулярное преждевременное S и вентрикулярное преждевременное V. Задачей распознающей системы является определение типа биения по двухканальному сигналу ЭКГ. Несмотря на кажущуюся различимость указанных типов биений, на всем множестве имеющихся экспериментальных данных сигналы ЭКГ, соответствующие биениям, имеют множество вариаций по форме, и отличить их друг от друга довольно сложно. При формировании обучающей и тестовой выборок вначале составляются пары вход-желаемый выход вида П, где значения сигнала ЭКГ с -й секции тип или класс биения для -й секции. Поскольку секция представлена множеством значений сигналов ЭКГ во времени, то является также набором векторов значений сигналов ЭКГ в различные моменты времени, 2, где период квантования, а число значений моментов времени для -й секции. может варьироваться в зависимости от частоты пульса пациента, а также от других факторов, например от пропуска биения. Класс биения -й секции принимает дискретные значения от 1 до, где число классов. Все пары объединяются в общее множество П П, П, П . Затем это множество П может быть разбито различными способами на два непересекающихся подмножества обучающее П и тестовое П . Задача распознавания формально может быть определена следующим образом. По обучающему множеству П необходимо синтезировать такую систему распознавания, которая на тестовом множестве П обеспечит минимальную ошибку классификации. Процедура синтеза распознающей системы сводится к поиску наилучшей конфигурации алгоритмов выделения признаков, классификаторов-аппроксиматоров, а также их параметров в смысле обеспечения минимального значения ошибки на сформированных тестовых выборках. Для выделения динамических признаков из изменяющегося сигнала ЭКГ предлагается использовать подход на основе резервуарных вычислений РВ 1. Резервуар представляет собой динамическую систему, интегрирующую в своем состоянии предысторию информацию о предыдущих входных сигналах 4. Поэтому из текущего состояния резервуара можно извлечь полезную информацию о динамическом образе ЭКГ и решить задачу распознавания диагностики аритмии. По сравнению с другими известными решениями задачи на базе нейросетевых подходов 5, 6 при использовании РВ в одной системе решаются сразу две задачи выделение информационных признаков в том числе и за счет внутренней реконструкции ЭКГ внутри резервуара и последующая их обработка с формированием решения за счет работы считывателей, в качестве которых могут быть использованы известные классификаторы. Упрощение системы РВ до считывателей приводит к системам классических вычислений. Одной из моделей РВ является модель МНС, предложенная Маассом 4, название которой дословно переводится как машина неустойчивых состояний Liquid State Machine LSM. В ней резервуар представлен импульсной 7 РНС. Динамика импульсной РНС в ответ на входной сигнал похожа на динамику воды в стакане после некоторого возмущения затухающие распространяющиеся волны. Автором модели математически строго доказано, что модель МНС при идеализированных условиях обладает универсальными вычислительными возможностями. МНС структурно представляет собой резервуар в форме импульсной РНС, последовательно соединенный со специальными устройствами считывателями рис. 2. Входные сигналы на входе резервуара представлены векторной непрерывной функцией . В ответ на эти сигналы резервуар с некоторой задержкой по времени переходит в новое состояние . Затем это состояние подается на вход считывателей, выходы которых являются выходами всей системы и представлены векторной непрерывной функцией . Так как считывающее отображение не имеет памяти, вся информация о входах, должна содержаться во внутреннем состоянии . Подробное описание и анализ всех составляющих МНС приведен в работе 8, поэтому коснемся лишь некоторых основных моментов. Преобразование из в, осуществляемое в резервуаре, можно определить через некоторый оператор фильтр или систему нелинейных нестационарных дифференциальных уравнений d d, МНС состоит из считывателей и PHC, которая структурно организована в форме трехмерной решетки из импульсных нейронов со случайными связями. В качестве импульсных моделей используются модели типа интегрирование и возбуждение и нейрон Ижикевича 9. Связи представлены электрическими и химическими синапсами. Определенное число нейронов, составляющее от их общего числа, произвольно назначаются подавляющими, остальные нейроны выбираются возбуждающими. Связи между нейронами формируются на основе их взаимного расположения на решетке. Вероятность связей между двумя нейронами определяется по формуле, min1, exp, где буквами и обозначаются два нейрона, постоянная, зависящая от типов взаимодействующих нейронов возбуждающий или подавляющий, 1, евклидово расстояние между нейронами. Параметр управляет числом связей и средней длиной связи между нейронами. Каждый из входов РНС случайно соединен с определенным числом ее нейронов . Основная специфика МНС заключается в том, что внутри нее в РНС информация передается и обрабатывается в импульсной форме. В связи с этим необходимо выполнять прямое и обратное преобразование между импульсной и аналоговой формой. Считыватели устройства, предназначенные для анализа динамики резервуара РНС и решения конкретных прикладных задач классификации, аппроксимации и др. Считыватели могут реализовывать предобработку выходного сигнала РНС преобразование информации из импульсной формы в аналоговую сокращение размерности выходного сигнала анализ выходного сигнала РНС определение типа динамики, вычисление различных показателей статистических, информационных, динамических, частотных решение конечной задачи классификации, аппроксимации и др. При решении конечной задачи для контроля используется набор показателей качества вероятности правильнойнеправильной классификации, ошибки аппроксимации, различные индексы кластеризации. Можно выделить следующие основные особенности, связанные с использованием считывателей сигнал с выхода импульсной РНС является многомерным и импульсным, поэтому вначале осуществляются преобразования этого сигнала в аналоговую форму анализаторы динамики сигнала могут быть использованы при выборе надлежащего алгоритма преобразования импульсного сигнала. Они позволяют определить временной масштаб, скорость изменения сигнала и потом с наименьшими потерями перейти от импульсного сигнала к аналоговому к набору признаков может быть применена процедура сокращения размерности, что позволяет исключить из рассмотрения слабо влияющие признаки и избежать проблемы проклятия размерности выбор наилучшей комбинации считывателей осуществляется на основании анализа показателей качества решения конечной задачи. Остановимся подробней на одной из подзадач считывателей, упомянутой выше и связанной с нормализацией входных образов во временном диапазоне. Это важно из-за специфики обрабатываемых образов ЭКГ. Длительность секций может различаться в зависимости от частоты сердцебиения. Ввиду затухающей памяти, которой обладает импульсная РНС, нет смысла подавать на ее вход образы, которые длятся дольше, чем глубина ее памяти, поскольку к моменту считывания она забудет начальную часть образа. Для реализации процедуры нормализации определяется средняя глубина памяти РНС и задается время образа . Если время представления входного образа больше меньше этих значений, следует сжать растянуть входной образ во времени до . С математической точки зрения процедура сжатия растяжения во времени является очевидной при интервальной форме задания все границы всех временных интервалов следует умножить на константу, определяющую коэффициент сжатия растяжения. Для успешного решения задачи распознавания динамических образов с помощью МНС использовалась методика синтеза импульсных РНС в составе МНС 10. Она предусматривала выполнение ряда шагов. 1. Анализ задачи входных данных. На данном шаге в зависимости от типа, размерности, сложности входных данных определяется форма их подачи на вход РНС импульсная или непрерывная, а при необходимости алгоритм преобразования данных в импульсную форму, выполняется нормализация данных во временном диапазоне и формируется набор обучающих и тестовых примеров. 2. Синтез резервуара. На данном этапе приводятся рекомендации по выбору типа и задания значений всех параметров импульсной РНС. Эти рекомендации составлены на основе экспериментального исследования. Среди основных определяемых параметров число входов РНС, число нейронов резервуара, вероятность связи между входами и нейронами резервуара, процент подавляющих нейронов, средняя длина связей, плотность связей матрица . По этим параметрам случайным образом генерируется структура РНС. Затем в соответствии с рекомендациями задается тип нейронов, синапсов, сила связей между входами матрица, а также сила связей между нейронами матрица, задержки и параметры нейронов и синапсов. В конечном итоге в соответствии с рекомендуемыми значениями параметров формируется резервуар импульсная РНС, на вход которого будут подаваться входные сигналы. 3. Выбор считывающих модулей. Последовательность выбора считывателей можно представить следующим образом. Вначале определяется время считывания и выбирается алгоритм преобразования из импульсной формы в непрерывную. Затем выбирается алгоритм сокращения размерности числа признаков и алгоритм решения конечной задачи классификации, аппроксимации и др.. 4. Оценка качества распознавания. После решения задачи распознавания качество оценивается с помощью процедуры кросс-валидации. В случае, если полученное качество распознавания не устраивает, можно вернуться на один из предыдущих этапов и выполнить одно из следующих действий увеличить число обучающих примеров, повысить их репрезентативность изменить способ подачи, представления, предобработки входных данных сгенерировать новый резервуар с теми же параметрами или немного изменить параметры резервуара изменить параметры считывателей. С применением этой методики осуществлялось решение задачи распознавания ЭКГ. В качестве исходных данных использовался набор баз данных аритмий MIT-BIH 11, свободно распространяемый в рамках проекта PhysioNet 3. Одна из задач, представленная в базе данных SVDB Supraventricular Arrhythmia Database, выявление суправентрикулярной и вентрикулярной аритмий. Эта база данных содержит 94 30-минутных записей ЭКГ с двух датчиков с аннотациями биений и их свойств норма, аритмия. Пример фрагмента таких записей показан на рис. 1. Для решения тестовой задачи в рамках предлагаемой методики выбирался способ подачи данных на вход резервуара, синтезировался резервуар, определялись параметры считывателей. Поскольку данные ЭКГ снимаются с двух каналов, то исходная размерность входного сигнала равна двум 2. Для подготовки набора обучающих и тестовых примеров из разных ЭКГ были взяты секции с биениями, соответствующими разным классам нормальным биениям и биениям с аритмией по 100 примеров каждого типа всего 200 примеров. Средняя длительность одного биения 1 с. Глубина памяти импульсной РНС меньше, поэтому производилась нормализация входного сигнала во временном диапазоне. В результате все примеры были приведены к такой форме, что каждый из них длился 0,3 с. Один из вариантов такой нормализации показан на рис. 3. Для подачи примеров на вход импульсной РНС они были преобразованы из непрерывной формы в импульсную. В качестве алгоритма преобразования использовался пространственно-временной алгоритм на основе рецептивных полей каждый аналоговый сигнал преобразуется в множество импульсных сигналов в примере 8. В результате 2-мерный непрерывный сигнал был преобразован в 16-мерный импульсный сигнал рис. 4. Минимальный период импульсов 0,1 с. Поскольку выявление аритмии является сложной задачей, то в соответствии с методикой было предложено использовать резервуар из нейронов Ижикевича. В целях сравнения качества распознавания были также проделаны эксперименты с резервуаром из нейронов IaF 7, 9. Параметры резервуара из нейронов Ижикевича включали возбуждающие нейроны типа RS подавляющие нейроны типа FS число нейронов 125 решетка 5 5 5 2 20 нейронов подавляющие каждый из 16 входов случайно связан с 10 нейронов силы химических синапсов от входов к подавляющим и возбуждающим нейронам 0,01 постоянная времени 3 мс для всех химических синапсов, кроме синапсов от подавляющих нейронов для них 6 мс задержка во всех химических синапсах одинакова 1 мс. Параметры резервуара из нейронов IaF отличаются матрицами В результате анализа реакции РНС были определены следующие параметры считывателей. Время считывания равно моменту времени, соответствующему окончанию подачи двух третей образа, т. е. 100 мс. Алгоритм преобразования из импульсной формы в непрерывную выбран на основе преобразования каждого импульса в затухающую экспоненту с постоянной времени 10 мс. Были рассмотрены два варианта сочетания алгоритма сокращения размерности и классификатора алгоритм PCA, 23 компоненты и байесовский классификатор классификатор k-NN без сокращения размерности. В ходе проверки работы МНС образы подавались по очереди нормальный и с аритмией в два цикла. Вначале решалась простая задача с 12 вариантами ЭКГ. k-NN-классификатор, используя в качестве обучающих первые два образа, успешно распознал все следующие 10 образов. Также без ошибок справился с задачей и обычный байесовский линейный классификатор при использовании двух главных компонент 125 сигналов с нейронов использовать нельзя в силу невозможности получить удовлетворительную ковариационную матрицу. После этого решалась задача со всеми 200 образами 70 образов были случайно выбраны обучающими, а остальные 30 тестовыми. Качество распознавания оценивалось с помощью вероятностей правильного распознавания для случая нормального биения и аритмии В таблице приведены результаты качества распознавания исследуемой системы c помощью МНС и применением классических подходов при одних и тех же условиях и входных данных 12. Вероятности правильного распознавания приведены в форме математическое ожидание среднеквадратичное отклонение. Из таблицы следует, что лучше всего с поставленной задачей справилась система распознавания на основе МНС с резервуаром в форме импульсной РНС из нейронов Ижикевича. Качество распознавания нормальных биений выше наилучшего наихудшего из классических методов на 1 10, а биений с аритмией на 5 9 . Как следует из приведенных результатов, теоретически обоснованные возможности РНС в рамках парадигмы РВ достаточно хорошо согласуются с результатами их применения при решении реальных практических задач распознавания аритмий по ЭКГ. Использование нового подхода позволяет повысить качество распознавания даже по сравнению с проблемно-ориентированными методами. Действительно, качество распознавания системы распознавания на основе МНС выше наилучших вариантов использования классических структурных и статистических подходов на 5 . Отсюда явно вытекает перспективность использования предлагаемого подхода при решении новых задач распознавания динамических образов, для которых сама природа и свойства образов являются мало или совсем не изученными. Несмотря на полученные положительные результаты, еще есть много задач, требующих решения выбор оптимального алгоритма кодирования входных и декодирования выходных импульсных образов аппаратная реализация модели, позволяющая значительно повысить быстродействие системы распознавания усовершенствование внутренней структуры резервуара в зависимости от входных образов построение самоорганизующихся резервуаров и др. Вполне вероятно, что решение этих задач будет способствовать повсеместному использованию различных моделей РВ в новых перспективных информационных и управляющих системах. 