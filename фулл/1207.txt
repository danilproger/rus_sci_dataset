МЕТОДИКА ВЫБОРА КОНТРМЕР В СИСТЕМАХ УПРАВЛЕНИЯ  ИНФОРМАЦИЕЙ И СОБЫТИЯМИ БЕЗОПАСНОСТИ 

Цель:  ручная обработка информации, связанной с безопасностью, может привести к упущению важных факторов  и, в конечном итоге, к выбору неэффективных защитных мер. Целью исследования является автоматизация процесса  выбора защитных мер путем обработки данных по безопасности.  Результаты:  разработана методика выбора контрмер  в процессе управления информацией и событиями безопасности, основанная на предложенной авторами комплексной  системе показателей защищенности, отражающих ситуацию по безопасности в сети. Для выбора контрмер в систему  показателей вводится дополнительный уровень поддержки принятия решений, базирующийся на показателях оценки  эффективности применения контрмер. Основными особенностями предлагаемого подхода являются использование  графов атак и зависимостей сервисов, применение предлагаемых модели контрмер и показателей защищенности,  а также возможность предоставления решения по выбору контрмер в любой момент времени в соответствии с текущей  информацией о состоянии защищенности и событиях безопасности.  Практическая значимость:  разработанная методика позволит повысить эффективность процесса принятия решений по выбору защитных мер в системах управления  информацией и событиями безопасности. Ключевые слова  — инциденты безопасности, мониторинг,  реагирование, показатели защищенности, выработка  контрмер, графы атак, графы зависимостей сервисов.  

Современные информационные системы, как правило, содержат большое количество связанных между собой устройств и средств управления безопасностью, формирующих огромное количество информации и событий безопасности. Эту информацию необходимо обрабатывать в целях выявления возможных уязвимостей в защите, идентификации компьютерных атак и принятия контрмер. Ручная обработка данной информации неэффективна по ряду причин ограниченное время обработки, в результате чего время на противодействие компьютерной атаке может быть упущено зависимость от уровня знаний эксперта, который может упустить важное сообщение или не связать между собой события, указывающие на атаку возможность нанести системе еще больший ущерб в результате применения неэффективных контрмер или неправильной оценки уровня разрушительности атаки и несвоевременного реагирования на нее из-за сложных взаимосвязей между устройствами и сервисами системы. Системы управления информацией и событиями безопасности SIEM создаются с целью решить эти проблемы и автоматизировать процесс обработки информации и событий безопасности 1, 2. Функции SIEM-систем включают сбор записей о событиях из различных источников, их нормализацию, корреляцию, агрегацию, аналитическую обработку и составление отчетов. Для повышения эффективности реагирования на компьютерные атаки в рамках исследований авторами в архитектуру SIEM-системы был добавлен компонент анализа защищенности на основе графов атак и зависимостей сервисов 1, 2. Данный компонент дает возможность в результате анализа информации и событий безопасности сформировать ряд показателей защищенности, позволяющих сделать выводы об уровне защищенности системы и выбрать набор наиболее эффективных контрмер как для повышения общего уровня защищенности системы, так и для реагирования на отдельные атаки, выполняемые в реальном времени 3. При разработке подхода, лежащего в основе работы компонента, учитывались особенности архитектуры SIEM-систем и особенности моделирования атак на компьютерные сети в виде графов атак 3. Основными особенностями предлагаемого в статье подхода являются использование графов атак и зависимостей сервисов применение введенной модели контрмер, базирующейся на стандартах Общее перечисление защитных мер CRE 4 и Расширенная информация по защитным мерам ERI 5 использование предложенных показателей эффективности, стоимости и побочного ущерба контрмеры, а также возможность предоставления решения по выбору контрмер в любой момент времени в зависимости от текущей информации о состоянии защищенности и событиях безопасности в статическом и динамическом режимах функционирования. Предлагаемый в работе подход позволит повысить защищенность информационных систем за счет автоматизации выбора обоснованных защитных мер. Ранее авторы рассматривали вопросы вычисления различных показателей защищенности на основе графов атак и графов зависимостей сервисов 3. В данной работе рассматриваются вопросы применения предложенных показателей, а также новых показателей уровня поддержки принятия решений для выбора контрмер. Подход учитывает и развивает модели и методы для расчета показателей, рассмотренные в работе 6. При разработке подхода к выбору контрмер учитывались последние исследования в данной области 7, 8. Вопросы автоматического выбора защитных мер представлены во многих работах, например в 9. В ряде работ рассматривается аспект оценивания уровня риска на основе графов атак и графов зависимостей сервисов 68. Некоторые авторы используют экономические индексы для оценивания возможных потерь и эффективности контрмер 10, 11. Так, в работе 11 контрмеры оцениваются по трем параметрам, на основе которых определяется общий выигрыш от реализации -й контрмеры где количество контрмер выигрыш от реализации -й контрмеры затраты на -ю контрмеру дополнительная польза от реализации -й контрмеры. В работе 7 предлагается показатель выбора контрмер для реагирования на атаки на основе графов зависимостей сервисов RORI где эффективность реагирования побочные потери при реагировании затраты на контрмеры. Для реализации выбирается контрмера с наибольшим значением показателя RORI. В статье 12 представлен модифицированный показатель RORI, учитывающий вариант отсутствия контрмер, а также размер инфраструктуры системы где ожидаемые годовые потери соответствуют последствиям негативного события в случае отсутствия контрмер, которые зависят от критичности и вероятности реализации атаки уровень снижения риска в случае реализации контрмеры ожидаемые годовые затраты на реализацию контрмеры годовые затраты на инфраструктуру оборудование, поддержку в случае реализации защитной меры. Кроме того, следует учитывать существующие стандарты в области выбора контрмер. Вопросы выбора контрмер рассмотрены, например, в ГОСТ Р ИСОМЭК ТО 13335-4-2007 Информационная технология. Методы и средства обеспечения безопасности. Часть 4. Выбор защитных мер. В этом стандарте риск используется для определения того, требуются ли защитные меры. В стандарте отмечено, что при выборе защитных мер важно сравнивать расходы по реализации защиты со стоимостью активов и оценивать возврат вложений с точки зрения снижения рисков. Кроме того, защитные меры не должны снижать функциональные возможности системы. Настоящие исследования ориентированы на системы управления информацией и событиями безопасности. В этой области наиболее продвинутыми работами являются, например, 7, 12. В статье предлагается развитие существующих подходов с использованием расширенного набора показателей и многоуровневого подхода, использующего, в том числе, семейство стандартов, применяемых в протоколе SCAP 13. Авторами разработана методика выбора защитных мер, которая учитывает их влияние на угрозы, уязвимости и воздействия, а также общий уровень риска с учетом подхода к оценке защищенности системы на основе графов атак 3. Для учета контрмеры в общем подходе к поддержке принятия решений по реагированию на атаки необходимо сформировать модель контрмер. Поскольку в данном исследовании используются стандарты протокола SCAP 13 для автоматизации оценки защищенности, рассмотрим соответствующие стандарты описания контрмер стандарты CRE 4 и ERI 5. Хотя стандарты еще находятся в процессе разработки и не сформирована полная база данных, использующая указанные стандарты, они подходят для создания модели контрмер. Стандарт CRE является схемой определения и описания контрмер в формате XML 4. Стандарт ERI содержит дополнительную информацию к CRE 5. В настоящей статье в модель контрмеры рис. 1 предполагается включить 1 поля стандарта CRE текстовое описание элемента метод и действие контрмеры платформу с использованием языка CPE Applicability Language 2.3, для которой применима данная контрмера 2 поля стандарта ERI индикаторы ссылки на CCE 14 или CVE 15 влияние на работу отрицательное влияние на свойства безопасности активов, выражается показателем CD в виде трехмерного вектора, где, соответственно ущерб для свойств конфиденциальностицелостностидоступности в результате реализации контрмеры эти параметры принимают значения от 0 до 1 3 дополнительные поля название контрмеры тип влияния на граф атак удаление, добавление или изменение связи в графе поле принимает значения REMOVECVE1-CVE2, ADDCVE1CVE2, MODIFYCVE1-CVE2 4 показатели CE степень исправления свойства безопасности в виде трехмерного вектора, где, соответственно значения эффективности исправления свойств конфиденциальностицелостностидоступности в результате реализации контрмеры эти параметры принимают значения от 0 до 1 CC стоимость реализации контрмеры, измеряется в денежных единицах. В качестве демонстративного примера рассмотрим следующие варианты контрмер патч для уязвимости информацию можно взять, например, из базы xForce 16, 17, которая содержит временные оценки CVSS, в том числе, который определяет наличие патча для уязвимости удаление уязвимого программного обеспечения закрытие порта добавление дополнительных защитных средств например, фаервола или антивируса. В основе методики принятия решений лежит граф атак. Граф атак представляет собой граф переходов состояний, в котором каждый узел соответствует успешнойнеуспешной эксплуатации уязвимости, а дуга возможности перехода от одного атакующего действия к другому 19. Реализация контрмеры влияет на переходы состояний и, соответственно, изменяет граф атак удаляядобавляя узлы и вероятности атак. Очевидно, что контрмера может повлиять на каждый из этих элементов тремя способами удалением, добавлением, изменением например, вероятности атак рис. 2. Пунктирными и сплошными стрелками выделены пути, соответствующие определенным контрмерам, например, открытие порта обусловливает добавление дуги, но не узла. В соответствии с работами 3, 19 для построения таксономии показателей используется комплексная иерархическая система показателей, позволяющих на разных уровнях топологическом, графа атак, атакующего, событий и системы и с учетом различных аспектов основных показателей, показателей нулевого дня и стоимостных показателей отразить текущий уровень защищенности. Показатели топологического уровня определяются администратором на основе топологии системы сети 3. На уровне графа атак для вычисления показателей защищенности используется информация, получаемая на основе графа атак. Данный уровень позволяет определить вероятность атаки и возможный ущерб с учетом всех путей атаки 3. На уровне атакующего вводится зависимость от профиля атакующего т. е. его положения в сети и навыков. Это позволяет сформировать так называемый профильный граф атак, который включает атаки, которые может реализовать именно данный атакующий 3. Уровень событий соответствует динамическому режиму работы системы оценивания защищенности 3. Он позволяет отслеживать развитие атаки и профиль атакующего по событиям безопасности. На основе поступающих событий корректируется позиция атакующего на графе атак и возможные пути продолжения атаки. На уровне системы определяются общий уровень защищенности системы и поверхность атаки системы. Основные показатели каждого уровня представлены на рис. 3, где пунктирными стрелками обозначены необязательные связи. В соответствии с определенной моделью контрмер необходимо расширить таксономию показателей защищенности за счет введения дополнительных показателей в модель контрмер стоимости контрмеры, эффективности контрмеры и уровня побочного ущерба. Рассмотрим ниже связь уровня принятия решений с четырьмя другими уровнями топологическим, графа атак, атакующего и событий. На данном уровне не рассматриваются многошаговые атаки, использующие множество уязвимостей. Как следствие, не учитывается влияние контрмер на граф атак. Поэтому принятие решений основано на использовании уровня риска для отдельных активов, который определяется при помощи контекстной оценки CVSS от 0 до 10 18 где, в котором заменен на где, влияние на конфиденциальность, целостность и доступность, требования безопасности, которые в данном контексте рассматриваются как критичность актива, поэтому где, и критичность конфиденциальности, целостности и доступности актива соответственно. Значения определяются экспертами в зависимости от возможных потерь организации. Возможные значения показателей критичности 0 1,51 20, где вектор доступа сложность доступа аутентификация Методика выбора контрмер на данном уровне реализуется в несколько этапов. 1. Выявление активов с неприемлемым уровнем риска, т. е. высокой контекстной environmental CVSS-оценкой согласно системе CVSS от 7,0 до 10,0. 2. Определение временной temporal CVSSоценки на предмет того, не уменьшится ли значение риска с реализацией патча. Оценка определяется на основе временного уравнения CVSS, использующего только один дополнительный показатель у, который определяет наличие патча для уязвимости 18 1, где функция 1 выполняет округление аргумента до одного знака после запятой. Временная CVSS-оценка имеет значение от 0 до 10. Если уровень риска для актива становится ниже 7,0, то система рекомендует применить патчи для соответствующих уязвимостей. 3. Для активов с высокой оценкой уровня риска определяются четыре аспекта риск нарушения конфиденциальностицелостностидоступности и получения привилегий нелегитимным пользователем в соответствии с CVSS-данными по уязвимости, определившей оценку риска. Для этого используются показатели, и, следующим образом реализация контрмер необходима для обеспечения соответствующего свойства безопасности, если, или 0,275 т. е. ущерб есть, и если требования, для этого свойства 1,0 т. е. критичность высокая. Необходимо перебрать все уязвимости с высокой оценкой риска, относящиеся к данному активу. В случае если уязвимость дает возможность получения привилегий, необходимо применять контрмеры. 4. В зависимости от того, какие аспекты безопасности могут быть нарушены, выбираются контрмеры для обеспечения соответствующих свойств безопасности например, дополнительная аутентификация в случае риска нарушения конфиденциальности. В модели контрмер это заложено в оценках показателей эффективности если 0, то соответствующую контрмеру можно использовать против нарушения конфиденциальности если 0 против нарушения целостности если 0 против нарушения доступности. 5. Для выбора контрмер используется следующий подход. Интуитивно понятно, что необходимо увеличить выигрыш от реализации защитных мер при снижении затрат. Выигрыш определяется отношением риска до реализации защитных мер к риску после реализации защитных мер. Чем меньше будет риск после реализации защитных мер, тем больше будет данная величина. Затраты, нормализованные согласно шкале критичности, помещаются в знаменатель. Таким образом, с увеличением затрат данный показатель уменьшится, и наоборот. Показатель CI, используемый для выбора защитных мер, определим следующим образом где риск в случае, если защитные меры не реализованы риск в случае, если защитные меры реализованы. На уровне рассматриваются узлы графа атак с уровнем риска, превышающим приемлемый. Для таких узлов рассматривается возможность реализации защитных мер в соответствии с классификацией на рис. 2. На данном уровне применяются методы вычисления уровня риска, определенные для графа атак 3, 19, 20. На дополнительно учитываются возможности нарушителя. На контрмеры реализуются в зависимости от текущих и будущих спрогнозированных шагов нарушителя. При этом учитывается глубина графа до критичного ресурса, которая определяется как количество узлов графа до актива с высоким уровнем критичности. Если данная глубина превышает определенное значение, то система ждет нового события для уточнения своих оценок если глубина меньше определенного значения, система предлагает контрмеру на основе имеющихся данных со степенью точности, соответствующей количеству уже выявленных релевантных событий. Для демонстрации выбран фрагмент сети из сценария ATOS для проекта MASSIF 1. Фрагмент тестовой сети представлен на рис. 4 1. В таблице 1 описано программное обеспечение тестовой сети. Структуру сервисов тестовой сети определим следующим образом для аутентификации используется NetIQ eDirect, доступ к данным eDirect осуществляется по протоколу LDAP, инкапсулированному в SSL порт 636 веб-приложения Accreditation и Sport Entries задействуют ApacheStruts2 framework использует порт 8080 для доступа к веб-страницам, поддерживаемый JBoss AS использует порт 443. Граф зависимостей сервисов рис. 5 построен в соответствии с методикой, предложенной в работе 7 зависимость определяется необходимостью доступности, целостности и конфиденциальности сервиса для обеспечения доступности, целостности и конфиденциальности другого сервиса. Сервисы предоставляются различными приложениями хостов системы или сетевыми устройствами. Для вычисления показателей необходимо задать весовые матрицы зависимостей задаются экспертами. Для описанного фрагмента сети и атаки на вебсервер Massif-2 определим . Для этого необходимо найти уровень риска до и после внедрения контрмер. Для упрощения вычислений выберем топологический уровень. На топологическом уровне риск атаки на веб-сервер Massif-2 до внедрения контрмер определим следующим образом. Вначале вычислим критичность активов в данном случае, это информация на веб-серверах 0,8, 0,8 и 0,8. Далее необходимо оценить риск до внедрения контрмер в соответствии с формулой для топологического уровня, определенной выше. Например, для узла Massif-2 он будет определен в соответствии с максимальной CVSS-оценкой уязвимостей хоста уязвимостью ApacheStruts2 Framework CVE-2013-4316 10,0 H AVLACL AuNCCICAC. Отметим, что хотя сам сервис ApacheStruts2 Framework не отмечен как критичный для системы, тем не менее сохранение его свойств безопасности необходимо для сохранения свойств безопасности веб-приложения в соответствии с весовой матрицей Критичность ApacheStruts2 Framework будет определяться как 0,56, 0,8 и 0,8. Уязвимость представлена с помощью идентификаторов CVE 15, базовой оценки CVSS по шкале от 1 до 10 и соответствующего качественного значения H высокая, M средняя, L низкая оценка критичности уязвимости и базовых векторов CVSS AVL,A,NACH,M,L AuM,S,NCN,P,CIN,P,C AN,P,C, где AV вектор доступа к уязвимости L локальный, A смежная сеть, N удаленный AC сложность доступа к уязвимости H высокая, M средняя, L низкая Au показатель того, требуется ли дополнительная аутентификация M требуется пройти несколько процедур аутентификации, S требуется пройти одну процедуру аутентификации, N не требуется C, I и A ущерб, наносимый конфиденциальности, целостности и доступности в результате успешной эксплуатации уязвимости соответственно N нет, P частичный, C полный 19. Поскольку ущерб является полным, то согласно системе оценивания CVSS C, I и A имеют значения 0,660. Тогда Вектор доступа определяется как локальный, что согласно системе оценивания CVSS соответствует значению 1,0 сложность доступа определяется как низкая, что соответствует значению 0,71 аутентификация не требуется, что соответствует значению 0,704. Таким образом Определим риск после внедрения контрмер. Для примера возьмем контрмеру 1 блокировка подозрительных учетных записей в случае которой эффективность 0,75 и стоимость 0,0001 и контрмеру 2 активация многофакторной аутентификации 0,85 и 0,0001 Соответственно, коэффициенты выбора контрмер Максимальный коэффициент используется для выбора защитных мер. Таким образом, будет выбрана контрмера блокировка подозрительных учетных записей. Были проведены эксперименты для различных сетевых топологий и различных наборов входных данных. Эксперименты подтвердили, что благодаря дополнительной информации на каждом новом уровне можно выбрать более эффективные защитные меры с меньшей стоимостью и позволяющие минимизировать ущерб. Тем не менее индекс принятия решений имеет ряд ограничений. Так, например, он не применим в случае нулевой стоимости защитных мер и в случае нулевого риска после внедрения защитных мер. В дальнейшем планируется модифицировать индекс для устранения этого недостатка. Предложен подход к выбору контрмер в системах управления информацией и событиями безопасности, основанный на многоуровневой системе показателей защищенности. Для выбора контрмер применяются показатели оценки эффективности и целесообразности применения контрмер. Особенностью предложенного подхода является возможность предоставления решения по выбору контрмер в любой момент времени в зависимости от имеющихся в наличии входных данных о текущей ситуации по уровню защищенности как в статическом, так и в динамическом режимах функционирования системы. Приведен пример применения подхода для простого сценария атаки на фрагменте тестовой сети. В дальнейшем планируется продолжить серию экспериментов по определению эффективности предложенного подхода на различных компьютерных сетях при реализации различных атак. Работа выполнена при финансовой поддержке РФФИ 13-01-00843, 14-07-00697, 14-07-00417, 15-07-07451 и программы фундаментальных исследований ОНИТ РАН контракт 1.5. 