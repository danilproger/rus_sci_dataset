МОДИФИЦИРОВАННЫЙ АЛГОРИТМ ОБНАРУЖЕНИЯ  РАЗЛАДКИ СЛУЧАЙНОГО ПРОЦЕССА И ЕГО ПРИМЕНЕНИЕ  ПРИ ОБРАБОТКЕ МНОГОСПЕКТРАЛЬНЫХ ДАННЫХ 

Рассмотрено использование алгоритмов обнаружения разладки случайного процесса при обработке данных, полученных системами сбора информации. Исходные данные представляют собой функцию изменения по  некоторой координате анализируемого параметра, по которой определяются координаты его существенного  (скачкообразного) изменения. Представлено решение задачи обнаружения последовательности скачков анализируемой функции в виде решающей статистики для оценки максимального правдоподобия координат скачков  с использованием модифицированного алгоритма кумулятивных сумм с настраиваемым скользящим окном.  Приводится пример применения предложенного модифицированного алгоритма обнаружения разладки при обработке данных многоспектрального дистанционного зондирования и определении наиболее информативных  спектральных каналов. Ключевые слова  — обработка данных, разладка случайного процесса, максимум правдоподобия, алгоритм  кумулятивных сумм, многоспектральное дистанционное зондирование. 

Задача обнаружения разладки изменения свойств стохастических сигналов и динамики систем является одной из широко распространенных задач анализа и обработки информации 1 4. К ней сводятся многие прикладные задачи обработки данных, полученных системами сбора информации, такими как системы дистанционного зондирования, телеметрии, контроля технологических процессов и др. Обнаружение изменения свойств является составной частью анализа сигналов и динамических систем, оно представляет основу алгоритмов распознавания образов, контроля и технической диагностики информационно-управляющих систем, а также дополняет адаптивные процедуры идентификации состояния систем со сложной динамикой. При формальной постановке задачи обнаружения существенных изменений свойств случайных процессов под разладкой понимают скачкообразное изменение описывающих этот процесс параметров, происходящее в неизвестный момент изменения процесса по той или иной координате, в большинстве случаев во времени 1 4. Задачей обнаружения разладки является установление факта разладки, и если считается, что разладка произошла, оценивание момента разладки. Исходными для решения задачи обнаружения разладки являются данные о распределениях значений анализируемого процесса до и после возможной разладки, реализация случайного процесса, а в некоторых случаях также априорные распределения на множестве неизвестных параметров, одним из которых может быть координата момента разладки. В то же время классический математический аппарат обнаружения разладки, основанный на алгоритме вычисления кумулятивных сумм 1, 2, позволяет обнаруживать однократную разладку случайного процесса и получать оценку максимального правдоподобия координат скачка. Кроме того, в большинстве прикладных задач обработки данных необходимо обнаружение последовательности скачков анализируемой функции. Для решения таких задач в настоящей работе предложен модифицированный алгоритм обнаружения последовательности скачков анализируемой функции на основе вычисления кумулятивных сумм с настраиваемым скользящим окном и показано его применение при анализе данных многоспектрального дистанционного зондирования. Пусть в качестве анализируемой выступает функция координаты, заданная в виде совокупности дискретных составляющих, каждая из которых соответствует координате, 1, . Необходимо определить моменты разладки, в качестве которых выбираются значения координат, соответствующие областям, в которых функция претерпевает явно выраженные изменения резкое увеличение или уменьшение, локальные максимальные и минимальные значения. Эти области могут быть найдены методами поиска скачков в анализируемой функции, удовлетворяющих некоторому критерию. В качестве такого критерия при известных допущениях о функции потерь будем использовать критерий максимального правдоподобия, позволяющий получить оценки максимального правдоподобия моментов координат изменения свойств анализируемых процессов 1, 2. Для того чтобы определить на некотором интервале изменения координаты скачок функции, представленной составляющими, необходимо в каждой координате, 1, последовательно проверить выполнение двух гипотез и . Гипотеза состоит в том, что вся совокупность составляющих, соответствует одной и той же модели . Гипотеза состоит в том, что совокупность составляющих, соответствует одной модели, а совокупность составляющих, соответствует другой модели . Модели и в общем случае параметризированы некоторым вектором. Если гипотеза истина, то координата принимается за момент скачка существенного изменения функции . При равномерной дискретизации это эквивалентно определению номера координаты, в которой обнаружен скачок, 1, . Cовокупность составляющих дискретной функции в области анализа, может быть представлена как последовательность независимых случайных гауссовых величин с параметрами дисперсией и кусочно-постоянным средним, которое скачкообразно изменяется при переходе от одной дискретной координаты к другой 3. Обнаружение скачка в точке с координатой эквивалентно принятию для анализируемой функции в этой точке гипотезы, когда она проверяется против гипотезы . Поиск просмотр начинается в точке с координатой и осуществляется в направлении увеличения номера . Тем самым решается задача обнаружения однократной разладки. После обнаружения первого скачка в точке с координатой процедура поиска скачка повторяется и продолжает осуществляться в направлении увеличения номера, начинаясь в точке с координатой . В результате решается задача обнаружения многократной разладки последовательно обнаруживаются все скачки значимые изменения дискретной функции . В рамках допущения о гауссовой статистике составляющих, анализируемой функции с помощью последовательных алгоритмов обнаружения разладки могут быть получены оценки моментов разладки, удовлетворяющие критерию максимального правдоподобия. Логарифм отношения правдоподобия различения гипотез и при гауссовом распределении дискретных составляющих функции для координаты скачка, задаваемой ее номером, при выполнении условия независимости составляющих принимает вид 1 где с учетом знака есть величина скачка функции, представленной составляющими, в анализируемой точке, среднее до скачка, среднее после скачка дисперсия значений, анализируемого ряда. Полагается, что изменение свойств связано с изменением кусочно-постоянного среднего, которое изменяет свое значение с на, а дисперсия при переходе через точку скачка не изменяется. Критерием качества проверки гипотез и является стандартный для задач различения сигналов 1, 5 критерий идеального наблюдателя, которому соответствуют и минимум суммы вероятностей ошибок первого и второго рода соответственно и . Соответствующий алгоритм реализуется при сравнении логарифма отношения правдоподобия с порогом, выбираемым исходя из условия минимума суммы вероятностей и или их заданных значений. Критерием качества оценки координаты скачка является максимум логарифма отношения правдоподобия . За неизвестную координату скачка принимается координата задаваемая оценкой максимального правдоподобия номера точки в которой выполняется гипотеза . С учетом выражения 1 оценка максимального правдоподобия может быть записана в виде 2 а правило принятия решения о наличии скачка в точке решающая статистика определяется следующим образом 3 где порог, выбираемый исходя из выбранного критерия 1, . В выражениях 2 и 3 проверка условия максимизации функции правдоподобия и ее сравнение с порогом осуществляются с учетом значений дискретной функции для всех координат, 1, . Условие определяет величину обнаруживаемого скачка анализируемой функции, по сути дела пороговую чувствительность детектора скачков устройства или программно-аппаратных средств, анализирующих функцию по ее дискретным отсчетам, . На выбор величины порога оказывают влияние, с одной стороны, допустимый уровень ложных тревог значимости решений при обнаружении скачков, с другой стороны, требуемое или ожидаемое количество скачков существенных изменений функции на интервале анализа. Пример, демонстрирующий принцип обнаружения ярко выраженного скачка анализируемой случайной функции, приведен на рис. 1. При отсутствии увеличения среднего значения функции до скачка логарифм отношения правдоподобия имеет тенденцию убывания его среднее значение убывает по прямой с тангенсом угла наклона рис. 1, . После скачка среднего значения функции логарифм отношения правдоподобия имеет тенденцию возрастания его среднее значение возрастает по прямой с тангенсом угла наклона рис. 1, . Таким же образом в среднем возрастает и решающая статистика, которая до момента скачка была близка к нулю рис. 1, . В условиях априорной неопределенности, когда величина обнаруживаемого скачка неизвестна, она является неизвестным параметром функции правдоподобия, и также подлежит оцениванию по критерию максимального правдоподобия. При известной координате точки скачка фиксированном оценка максимального правдоподобия величины скачка имеет вид 4 При оценивании среднего используется модель анализируемого процесса, а наличие явного решения для вида 4 может быть присуще любой линейной модели анализируемого процесса . Однако если координата точки скачка неизвестна, то оценивание координаты скачка и его величины в каждой возможной координате составляет задачу двухпараметрической максимизации отношения правдоподобия 2. С учетом выражения 4 оценка максимального правдоподобия номера координаты, в которой выполняется гипотеза, определяется выражением 5 Соответствующее правило принятия оптимального решения при оценке координаты скачка имеет вид 6 Выражения 5 и 6 определяют процедуру оптимального обнаружения момента и величины разладки анализируемой функции, задаваемой составляющими, 1, . Реализуемый при этом алгоритм вычислений называется алгоритмом кумулятивных сумм. В работах 1, 2 показано, что данный алгоритм является оптимальным последовательным алгоритмом, который при фиксированной вероятности ошибки первого рода минимизирует среднее число измерений, производимых от начала разладки до ее обнаружения. Получаемая при этом оценка совпадает с моментом последнего отрыва от нуля статистики, алгоритм кумулятивных сумм 6 также называют алгоритмом кумулятивных сумм с отражающим от нуля экраном 3. На практике при решении прикладных задач обнаружения разладки необходимо обнаруживать не единственный скачок функции, а несколько скачков. Для поиска нескольких скачков необходимо выполнить процедуру поиска первого скачка функции, описываемую выражениями 5 и 6, для каждого значения, 1, . При принятии решения о наличии скачка функции в момент это значение фиксируется. Далее процедура оценки координаты скачка повторяется для значений, 1, до обнаружения следующего скачка и так далее до тех пор, пока не будут оценены все значений функции . Количество обнаруживаемых скачков ограничивается величиной порога . Как показала практика использования алгоритма кумулятивных сумм 6 при последовательном поиске нескольких скачков, анализ функции по всей выборке 1, не всегда позволяет обнаружить необходимые скачки. Это является следствием распространения алгоритма обнаружения одиночной разладки на задачу обнаружения многократной разладки и связано с тем, что решение о наличии разладки скачка анализируемой функции принимается в результате сравнения разницы ее среднего значения на интервале 1, и среднего значения на интервале 1, . При этом на первом интервале 1, до момента обнаружения разладки в силу выполнения гипотезы других разладок нет, а на втором интервале 1, после момента обнаружения разладки, соответствующей выполнению гипотезы, могут иметь место и другие разладки. Если в моменты этих разладок на втором интервале имеют место скачкообразные изменения функции и в положительную, и отрицательную сторону, то эти изменения дают противоположный по знаку вклад в величину решающей статистики, что затрудняет их обнаружение. Для устранения этого эффекта предлагается использовать подход к обнаружению последовательности скачков анализируемой функции, основанный на ограничении интервала анализа дискретных отсчетов, . Многократная проверка с использованием критерия максимума логарифма отношения правдоподобия гипотезы при альтернативе осуществляется по ограниченной вспомогательной выборке, выделенной с помощью скользящего окна, из исходной совокупности составляющих, 1, . Число элементов во вспомогательной выборке, определяемое размером окна, выбирается таким образом, чтобы кумулятивная сумма формировалась из составляющих анализируемой функции, не содержащих противоположных скачков. Для выборки, вычисляется решающая статистика и сравнивается с порогом . При выдается сигнал о наличии скачка, а при рассматривается следующее значение и обрабатывается следующая вспомогательная выборка, . В результате имеем следующее правило принятия оптимального решения при оценке координаты скачка 7 Алгоритм, определяемый выражением 7, представляет собой модифицированный алгоритм вычисления кумулятивных сумм со скользящим окном. При его использовании необходимо выбрать размер вспомогательной выборки окна, соответствующий интервалу корреляции анализируемой функции . Этот интервал корреляции характеризует поле рассеяния пар значений функции, где интервал между отсчетами, выраженный в числе точек, и оценивается по выборочной автоковариационной функции анализируемой функции . Важным свойством автоковариационной функции является способность находить по ним характерные и повторяющиеся участки анализируемого процесса сигнала 6. В рассматриваемом случае анализ автоковариационной функции позволяет обнаруживать масштаб изменений анализируемой функции, соответствующий участкам изменения, которые дают противоположный по знаку вклад в величину решающей статистики и могут быть не обнаружены. Объем вспомогательной выборки можно определить по интервалу корреляции анализируемой функции, соответствующему ширине центрального пика выборочного коэффициента автоковариации от максимума до первого пересечения с линией, взятой на некотором уровне, например на уровне 0,5. В последующем полагается, что, где интервал корреляции спектрального образа, определяемый по уровню 0,5 расстояние между отсчетами, функции . Выборочный коэффициент автоковариации определяется выражением 8 где 1, 2, 3, 0 автоковариация при 0 дисперсия выборки. Отметим принципиальное значение использования именно автоковариационной, а не автокорреляционной функции при определении интервала корреляции анализируемой функции, которая в общем случае имеет ненулевое среднее значение постоянную составляющую. Наличие этой постоянной составляющей приводит к тому, что для стационарного ряда значений анализируемой функции автокорреляционная функция с увеличением принимает положительные значения и демонстрирует свойство монотонного убывания по абсолютной величине. В результате масштаб автокорреляционной функции выбирается в соответствии с интервалом определения анализируемой функции, а влияние на автокорреляционную функцию изменений анализируемой функции в пределах этого интервала оказывается незначительным. В то же время масштаб автоковариационной функции, которая вычисляется без учета постоянной составляющей анализируемой функции, определяется, прежде всего, масштабом ее изменений на интервале анализа, что позволяет выделить интервал корреляционной связи между отсчетами. При вычислении значений в соответствии с выражением 8 вычитание постоянной составляющей осуществляется для каждого из слагаемых внешней суммы по . Поэтому выборочный коэффициент автоковариации обладает отмеченными свойствами и может быть использован для определения настройки размера окна при реализации модифицированного алгоритма кумулятивных сумм с настраиваемым скользящим окном. Одной из областей применения предложенного алгоритма обнаружения последовательности скачков анализируемой функции является анализ данных многоспектрального дистанционного зондирования Земли ДЗЗ. В современных системах ДЗЗ широко используются многоспектральные и гиперспектральные датчики с числом спектральных каналов до нескольких тысяч, а корреляционное распознавание наблюдаемых объектов осуществляется по зарегистрированным спектральным образам 7, 8. В этих условиях для оперативной обработки и передачи данных ДЗЗ необходимо выбирать так называемые наиболее информативные спектральные каналы, соответствующие областям существенных изменений спектральных образов 7. Рассмотрим пример работы модифицированного алгоритма вычисления кумулятивных сумм с настраиваемым скользящим окном при обнаружении наиболее информативных спектральных каналов многоспектральной системы ДЗЗ. В данном случае в качестве анализируемой функции выступает спектральный образ наблюдаемого объекта или подстилающей поверхности, где длина волны излучения, в виде дискретных составляющих, значений коэффициента спектральной яркости, регистрируемой в спектральных каналах, каждый со средней длиной волны и спектральным разрешением, 1, . С точки зрения корреляционного распознавания, выбор наиболее информативных спектральных каналов состоит в определении спектральных составляющих, которые при распознавании дают наибольшую корреляцию зарегистрированного спектрального образа с эталонным. Очевидно, что при корреляционном распознавании по спектральным образам максимальный вклад в величину коэффициента корреляции вносят спектральные составляющие, соответствующие участкам наиболее быстрого изменения анализируемого спектрального образа, на которых функция, описывающая спектральный образ, имеет некоторые локальные особенности и существенные изменения в характере поведения. В рассматриваемом случае анализируемым процессом является спектральный образ, и задача обнаружения изменения свойств анализируемого процесса переносится в частотную область координатой изменения процесса является длина волны . При этом постановка задачи определения участков существенных изменений анализируемых спектральных образов полностью соответствует рассмотренной задаче обнаружения разладки анализируемого процесса, и для нее при принятых допущениях может быть получено строгое решение по критерию максимального правдоподобия. В общем случае задача обнаружения изменения свойств разладки анализируемого процесса включает две последовательно решаемые задачи установления факта изменения свойств и определения момента координаты изменения свойств, если считается по результатам решения первой задачи, что оно произошло. В случае анализа спектральных образов при многоспектральном ДЗЗ решение двух указанных задач позволяет получить оценки координат или номеров наиболее информативных спектральных каналов для распознавания по ограниченному объему многоспектральных данных. При этом следует отметить, что выбор для распознавания наиболее информативных спектральных каналов соответствует гипотезе существования существенной размерности спектральных признаков при распознавании объектов в системах ДЗЗ, что следует из физической природы оптического излучения 9. В частности, установлено, что существенная размерность многоспектральных данных в диапазоне 0,4 15,0 мкм, определяемая для явлений отражения и излучения энергии от поверхности Земли, составляет около шести. Близкую оценку спектральной размерности данных наблюдений дают и исследования вероятности распознавания по спектральным признакам техногенных объектов на фоне природной подстилающей поверхности 9. При определении областей изменения зарегистрированного спектрального образа его составляющие в области анализа, рассматриваются как последовательность независимых случайных гауссовых величин с параметрами дисперсией и кусочно-постоянным средним, которое скачкообразно изменяется при переходе от одной дискретной координаты к другой. Оценки максимального правдоподобия координат наиболее значимых изменений анализируемого спектрального образа и правила принятия решения решающая статистика с использованием алгоритма вычисления кумулятивных сумм спектральных составляющих со скользящим окном определяются выражениями 5 и 7 соответственно с заменой составляющих, на составляющие дискретного спектрального образа в области анализа, дисперсии на, среднего значения на и величины скачка на . Последовательное применение данного алгоритма к выборке значений спектральных составляющих позволяет определить номера наиболее информативных спектральных каналов. На рис. 2 представлены результаты применения рассмотренного модифицированного алгоритма обнаружения разладки к типовому спектральному образу наблюдаемого объекта, полученному в 200 спектральных каналах в диапазоне длин 0,35 2,5 мкм. Для этого спектрального образа в соответствии с алгоритмом, определяемым выражениями 5 и 7 и запрограммированным в среде программирования MathLab, был осуществлен выбор наиболее информативных спектральных каналов при различных значениях параметров и . На графиках приведен анализируемый спектральный образ, совмещенный с диаграммами, показывающими выбор областей существенного изменения спектрального образа в группах по 10 каналов, соответствующих номерам каналов, приведенным в таблицах под диаграммами для различных значений размера вспомогательной выборки порога . Анализ диаграмм и табличных данных позволяет сравнить результаты выбора наиболее информативных спектральных каналов при различных значениях и и выявить ряд тенденций. При использовании вспомогательной выборки с изменяющимися объемом и значениями порога 1, 0,01 рис. 2, хорошо обнаруживаются только наиболее крупные скачки функции спектрального образа спектральные каналы 7882, 137139, 169170. При пороге 0,01 дополнительно обнаруживаются менее крупные скачки функции спектрального образа спектральные каналы 146, 168169, 182 189. Таким образом, алгоритм с таким объемом вспомогательной выборки способен обнаруживать малые скачки функции спектрального образа только для больших номеров спектральных каналов, ближайших к Это обусловлено тем, что поиск скачков функции спектрального образа в канале с номером ведется по результату сравнения среднего значения спектральных составляющих на интервале от предыдущего обнаруженного скачка до канала с номером и среднего на интервале от до В таком случае при малом значении некоторые скачки функции спектрального образа не вносят существенного изменения в среднее значение спектральных составляющих интервала от до . При приближении значения к интервал вычисления среднего уменьшается, и малые скачки становятся более заметными для алгоритма. При использовании вспомогательной выборки малого объема, например 3, и при малых значениях порога 0,01 рис. 2, проявляется тенденция к обнаружению большого числа малых скачков. Таким образом, алгоритм становится более чувствительным к многочисленным шумовым составляющим функции спектрального образа, обнаруживая помимо значительных скачков функции спектрального образа все прочие менее значимые скачки. В двух рассмотренных случаях выбор объема вспомогательной выборки размера окна осуществлялся без учета величины интервала автокорреляции автоковариационной функции анализируемого спектрального образа. Как показали исследования функций спектральных образов различных наземных объектов и подстилающей поверхности, для рационального выбора значения может быть рекомендовано его определение по величине интервала корреляции, соответствующего ширине центрального пика автоковариационной функции анализируемой функции . Выборочный коэффициент автоковариации дискретной функции спектрального образа определяется выражением вида 8 с заменой составляющих, на составляющие, . Для рассматриваемого в качестве примера спектрального образа определяемая таким путем величина вспомогательной выборки составляет 20. Таким образом, в общем случае размер вспомогательной выборки при настройке алгоритма анализа спектрального образа сверху ограничивается условием и выбирается исходя из условия При выборе параметра результаты работы алгоритма становятся зависимыми только от выбора порога Увеличение порога приводит к уменьшению количества выбираемых наиболее информативных спектральных каналов, а уменьшение соответственно к увеличению их количества. Подбирая значения порога, можно осуществлять управление алгоритмом обработки спектрального образа по параметру числу выбираемых наиболее информативных спектральных каналов. При использовании вспомогательной выборки объемом 20 и значениях порога 1, 0,1 рис. 2, алгоритм позволяет обнаруживать только наиболее крупные скачки функции спектрального образа спектральные каналы на интервалах 38, 8183, 138139, 170174. При значении порога 0,1 помимо крупных скачков обнаруживаются менее значительные, а крупные скачки представляются обнаружением нескольких скачков в близко расположенных спектральных каналах. Например, при значении порога 0,1 в анализируемой функции спектрального образа обнаруживается пять скачков с соответствующими номерами спектральных каналов 38, 81, 96, 138, 170. При снижении порога до 0,005 скачок функции спектрального образа, обнаруживаемый ранее в спектральном канале 38, также обнаруживается, но представлен уже тремя каналами с номерами 21, 33 и 51. Аналогично скачок в спектральном канале 81, обнаруживаемый при 0,1, при 0,005 представлен четырьмя каналами с номерами 79, 84, 90 и 105. Аналогичная тенденция наблюдается и в других случаях. Результаты проведенных исследований, в частности диаграммы, приведенные на рис. 2, свидетельствуют, что с изменением порога происходит изменение чувствительности алгоритма с хорошей повторяемостью выбора наиболее информативных спектральных каналов в областях наиболее существенных изменений анализируемых спектральных образов. На практике при реализации алгоритма выбора наиболее информативных спектральных каналов необходимым условием является выбор для любой функции спектрального образа одного и того же количества спектральных каналов. При таком условии для каждой реализации функции необходим подбор порогового значения, обеспечивающего выбор заданного количества областей существенного изменения. Однако вычисление пороговых значений, обеспечивающих выбор заданного количества наиболее информативных спектральных каналов, для всего многообразия реализаций функций и условий многоспектральной съемки является задачей, не имеющей общего решения. Она должна решаться итерационно для заданных и . В работе рассмотрено решение задачи обнаружения координат изменения свойств разладки случайного процесса в виде правила принятия решения и оценки максимального правдоподобия координаты скачка анализируемой функции, определяемой с использованием алгоритма вычисления кумулятивных сумм. Для представляющего наибольший практический интерес случая определения последовательности скачков предложен модифицированный алгоритм вычисления кумулятивных сумм со скользящим окном, ограничивающим объем выборки, используемой при расчетах спектральных составляющих. Использование скользящего окна позволяет исключить пропуски скачков, дающих противоположный по знаку вклад в величину решающей статистики. Основными настраиваемыми параметрами алгоритма являются величина порога и объем вспомогательной выборки, определяющий размер скользящего окна. Разработанный алгоритм вычисления кумулятивных сумм со скользящим окном программно реализован в виде пакета прикладных программ в среде программирования MathLab и применен для анализа функций спектральных образов наземных объектов и подстилающей поверхности в целях выбора наиболее информативных спектральных каналов многоспектральных систем ДЗЗ. Анализ полученных результатов демонстрирует работоспособность алгоритма и возможности его настройки с хорошей повторяемостью выбора наиболее информативных спектральных каналов в областях наиболее существенных изменений анализируемых типовых спектральных образов. 