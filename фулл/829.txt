ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ   И ОБРАЗОВАНИЕ НАУЧНО-МЕТОДИЧЕСКИЕ АСПЕКТЫ   ПРЕПОДАВАНИЯ ДИСЦИПЛИН ЦИКЛА   «ВСТРАИВАЕМЫЕ МИКРОКОНТРОЛЛЕРЫ» 

Рассматриваются проблемы подготовки специалистов в области разработки встраиваемых систем, подходы  к повышению уровня профессиональных навыков разработчиков с учетом современных тенденций развития  данной отрасли. Ключевые слова  — встраиваемая система, микроконтроллер, алгоритмическая оптимизация. 

К преимуществам систем управления на осно ве программируемых микроконтроллеров МК, выгодно отличающих их от непрограммируемых схемотехнических решений, относятся, в частно сти, более широкие средства изменения функци ональных возможностей алгоритма управления за счет модификации программной составляю щей 1. Системообразующими признаками встраивае мых систем являются пригодность к конструк тивной, системотехнической и алгоритмической интеграции с объектом управления, к массовому тиражированию, к автономности функциониро вания и связанные с этим требования высокой надежности, низкой стоимости и энергоэконо мичности встраиваемой системы. Прямым след ствием необходимости удовлетворения указан ных требований является относительно меньшая вычислительная мощность и ограничения по ре сурсам памяти в сравнении с вычислительными системами общего назначения постоянное совер шенствование обеих ветвей вычислительной тех ники из поколения в поколение продолжает под тверждать эти соотношения. Таким образом, естественным и объективным критерием оптимальности реализации встраива емой системы является степень удовлетворения указанных системообразующих ограничений, в частности минимизации необходимой вычис лительной производительности и требуемых объ емов памяти. Широкое применение МК в промышленности, средствах связи, медицинской аппаратуре, быто вой технике, изделиях специального назначения обусловливает существенное разнообразие этой ветви изделий полупроводниковой техники. Для систематизации МК применяют различные клас сификационные признаки. Так, ряд аналитиче ских агентств 2 используют в своих оценках в качестве первого классификационного призна ка разрядность процессорного ядра. К другим признакам относятся принадлежность к опреде ленной архитектурной линии MCS51, ARM и др., область использования специализированные МК, например, для применения в приборах учета электроэнергии, или МК общего назначения для решения относительно широкого круга задач автоматизации и т. п. Технологические достижения, обеспечиваю щие рост тактовой частоты МК, увеличение объе мов памяти, снижение стоимости, расширение функциональных возможностей инструменталь ных сред оказывают двоякое влияние на идеоло гию разработки встраиваемых систем на основе МК традиционный подход к проектированию МКсистем рис. 13 претерпевает ряд изменений. Обзорно перечислим некоторые примечатель ные тенденции в эволюции возможностей совре менных сред разработки развитие средств автоматизированного опре деления оптимальной архитектуры МК в каче стве примера можно привести среду DAVE ком пании Infineon 3, на основе применения муль типликативного оценочного функционала вы числяющую потенциальную эффективность реа лизации МКсистемы рис. 4 развитие средств автоматического анализа количественных показателей разрабатываемой системы, например среды Fastview и UDE фир мы PLS 5 рис. 6. Функциональные возможности такого рода позволяют существенно сократить сроки разра переход к использованию графических средств ввода программы, обеспечивающих авто матизированную генерацию исполняемого кода, как, например, в средах Realizer фирмы Actum и Algorithm Builder 4 для МК AVR фирмы Atmel рис. 5 ботки МКсистем и снизить требования к квали фикационному уровню разработчика встраивае мых систем. Весьма непростым при этом остается ритори ческий, на первый взгляд, вопрос о соотношении польза вред подобных тенденций. Оборотной стороной использования указан ных технологий является рост накладных расхо дов в МКсистеме. В частности, универсальность графического ввода программы, призванная обе спечить автоматическую генерацию эквивалент ного машинного кода для любых синтаксически корректных исходных конструкций графа про граммы, неизбежно приводит к неоптимально сти результирующей программы в смысле требу емого объема памяти и или времени ее выполне ния. Рост таких накладных расходов частично компенсируется ростом технических возможно стей контроллеров новых поколений в частно сти, увеличением объемов встроенной памяти и значений тактовой частоты, что приводит к возникновению своеобразного замкнутого кру га потенциально более широкие возможности МК например, возможность обеспечить лучшие частотные характеристики системы измерений оказываются принесенными в жертву комфорту разработчика, а на удовлетворение запросов по требителя отводится лишь малая оставшая ся часть ресурсов. Следует отметить, что ряд производителей МК прямо способствуют этому, не допуская разработ чика МКсистемы к непосредственному програм мному управлению аппаратными ресурсами МК. Программное обеспечение этого уровня распола гается в фирменных объектных модулях, взаи модействие с которыми возможно только посред ством вызовов скрытых там процедур в качестве примера можно указать инструментальные сред ства от zensys.com, предназначенные для разра ботки беспроводных Zwaveсетей на основе спе циализированных МКсистем. Неоспоримая польза такой идеологии ощуща ется только при рассмотрении ситуации с пози ций производителя МК разработчики, избало ванные комфортностью инструментальных сред, не желают отказываться от удобства процесса разработки и не хотят а отчасти уже и не могут заботиться об оптимальности результата. В итоге потребители целевых МКустройств вынуждены оплачивать перерасход ресурса, допущенный раз работчиком. Одной из многочисленных иллюстраций ска занного служит пример, приведенный на рис. 7. Здесь показаны две реализации алгоритма сум мирования элементов массива с применением языка Си инструментальная среда Keil и языка ассемблера. Как видно, вариант реализации, при котором разработчик был изначально ориентиро ван на отчетливое понимание возможностей ап паратной платформы, обеспечил полуторную эко номию памяти и при больших объемах масси ва практически 1,75крат ный выигрыш по ско рости. Таким образом, изготовитель кристалла зача стую снимает с себя обязанность удовлетворять спрос и дает себе право и возможность этот спрос формировать в собственных интересах ситуа ция, давно известная во многих других отраслях экономики. На рынке встраиваемых систем, где долгожительство платформ и технологий являет ся залогом длительности жизненного цикла про дукции, концепция технологической гонки в ко рыстных интересах изготовителя стала синони мом слова катастрофа 6. Очевидно, что эффективность, получаемая при таком подходе к разработке, имеет мало об щего с приведенными выше естественными кри териями оценки эффективности разработки. Понимание сложившегося противоречия су ществует, в том числе, и у ряда производителей микроконтроллеров и микропроцессоров. Так, в публикациях фирмы Tensilica 7 высказыва ются следующие положения переход на платформы с повышенной такто вой частотой проистекающий из потребности компенсировать описанные выше накладные рас ходы сопровождается увеличением энергопотреб ления зависимость роста энергопотребления МК от его тактовой частоты описывается показатель ной функцией, что, в частности, резко снижает срок продолжительности автономной работы це левого устройства рост сложности аппаратного обеспечения МК проистекающий из потребности снабдить разработчика аппаратно реализованными ко мандами, поддерживающими идеологию про граммирования систем общего назначения, на пример, командами обработки многоразрядных данных с плавающей запятой сопровождается увеличением площади кристалла что ухудшает массогабаритные показатели устройства либо необходимостью ужесточить проектную норму изготовления кристалла что увеличивает его стоимость. Выход, предлагаемый аналитиками Tensilica, заключается в создании так называемых appli cationoriented процессоров отметим, что давно используется и отечественный эквивалент тер мина функционально ориентированный про цессор 8, оптимизированных под определен ный класс решаемых задач. В более широком смысле этот подход следует трактовать как необходимость существенного увеличения внимания к этапу системного анали за задачи, позволяющего выполнять алгоритми ческую оптимизацию с учетом возможностей и особенностей вычислительной платформы. Одной из показательных тенденций развития аппаратуры платформ МК стал переход к много уровневым адаптивным системам управления иначе встраиваемым интеллектуальным си стемам управления ВИСУ рис. 8 . Одним из базовых подходов к реализации ин теллектуальных систем является подход, осно ванный на нечетких преобразованиях информа ции. В этом случае подсистема принятия реше ний нечеткий контроллер НК описывается совокупностью логиколингвистических правил Если условие, то действие, где условие описывает принадлежность входов контроллера некоторому набору диапазону входных значе ний, а действие задает значения выходов кон троллера при этом каждое из условий характе ризуется некоторой мерой достоверности в дан ный момент времени. Результирующее решение для данного момента времени вырабатывается на основе суперпозиции действий с учетом меры достоверности правил, их предлагающих. К до стоинствам нечетких систем принятия решений относятся эффективность эвристического синте за в смысле минимизации трудозатрат, предска зуемость и объяснимость поведения системы. Процесс разработки и функционирования НК, с некоторыми упрощениями представленный на рис. 9, включает десять основных этапов 1 сбор данных об объекте в режиме управле ния оператором позволяет сформировать первич ную базу данных стимул реакция, описыва ющую поведение реального объекта с учетом осо бенностей внешней среды 2 формирование по первичной базе стимул реакция моделей объекта и внешней среды, по зволяющих ставить принципиально не ограни ченные по разнообразию и кратности повторений эксперименты по формированию полной базы данных стимул реакция 3 накопление полной базы стимул реак ция. Отметим, что при наличии достоверного математического описания объекта и внешней среды этап 1 может быть опущен при невозмож ности провести качественное моделирование база данных собирается на этапе 1 4 формирование базы метаданных иначе базы нечетких знаний, описывающей систем ные зависимости входвыход в эксперименталь ных данных, позволяющих описать связи вход выход в терминах если то. Диапазоны зна чений входов и выходов т. е. лингвистических переменных делятся на участки термы, между ними выявляется и описывается взаимосвязь 5 ручная коррекция базы нечетких знаний функций принадлежности и правил с учетом неформальных знаний эксперта. В случае отсут ствия средств автоматической генерации баз нечет ких знаний задачи этапа 4 переходят на этап 5 эксперт должен самостоятельно обнаружить и опи сать на уровне правил системные зависимости между входными и выходными переменными 6 отладка базы нечетких знаний на моделях позволяет удостовериться в корректности сбора исходных данных и проведенных преобразований 7 генерация описания НК, пригодного для ре ализации во встраиваемой системе программы, эквивалентной с точки зрения результатов преоб разования так называемый программный эмулятор нечеткого вычислителя, или прошив ки для аппаратного вычислителя 8 разработка МКсистемы с нечетким вычис лителем, выполняемая по стандартной схеме про ектирования встраиваемых приложений 910 загрузка программ и отладка встраивае мой нечеткой системы на реальном объекте, так же соответствующая традиционной последова тельности действий разработчика. Характерной тенденцией развития ВИСУ яв ляется появление на рынке нового класса МК, со держащих особое периферийное устройство, свя занное с арифметикологическим устройством, блок нечеткой обработки, и представляющих со бой законченную аппаратную платформу для си стемы управления для их обозначения приме няется термин ICU Intelligent Controller Unit интеллектуальный контроллер. К таким fuzzy контроллерам относятся ST5 STMicroelectron ics, 68HCS12 Motorola и др. На рынке представлено достаточно большое количество инструментальных средств поддерж ки разработки нечетких систем. Кратко класси фицировать их можно в соответствии с основны ми областями применения. Рассмотрим особен ности классов инструментальных средств. например, FuzzyToolBox для MatLab предназна чены для выполнения анализа систем обработки данных в том числе с применением нечетких под систем и позволяют создавать математически аб страктные нечеткие модели произвольной слож ности, не ориентированные специально на кон кретную область применения. Моделирование происходит на достаточно мощных кроссовых вычислительных системах, при этом сложность реализации модели и конкретные пути ее переноса на целевую систему не принимаются во внимание. Такая нечеткая модель может быть легко встрое на в более сложную модель, описанную в том же пакете. Однако ее использование в целевой систе ме, как правило, затруднительно или требует не оправданно больших накладных расходов, свя занных с поддержкой функционирования проме жуточного уровня интерпретатора модели. например, FuzzyTech предназначены для построения целевого нечеткого вычислителя, учитывают требования реализуемости и позво ляют разрабатывать нечеткие системы для широ кого круга задач. Но, как правило, они либо опе рируют нестандартными способами описания мо делей например, посредством специализирован ных языков, либо активно используют особенно сти архитектуры целевой платформы для дости жения наивысшей производительности, либо ге нерируют высокоуровневое описание модели для достижения наибольшей универсальности. В свя зи с этими различными по природе причинами перенос разработок на другие целевые платфор мы представляет определенные трудности. Отме тим, что трансляция нечеткого описания в про грамму на некотором языке во многих случаях является необратимой операцией т. е. восстанов ление исходной нечеткой модели по ее описанию невозможно или существенно затруднено. на пример, Diagnos.ru используются для проекти рования средств нечеткого принятия решений на уровне специальных моделей для конкретной предметной области медицины, экономики и пр.. Они, как правило, не предназначены для исполь зования во встраиваемых системах и являются закрытыми от модификации или расширения но менклатуры функциональных возможностей си лами целевого пользователя. имеют смешан ные черты инструментальных средств перечис ленных выше классов. Необходимо отметить, что для сложных си стем, помимо методов эвристического формиро вания нечеткого контроллера, существенное зна чение приобретают методы и средства автомати зированной генерации баз знаний, в частности, основанные на комбинации методов генетическо го синтеза и кластеризации. Следует особо оговориться, что авторы настоя щей статьи не являются сторонниками отказа от современных достижений в области инструмен тальных средств для МК. Тем не менее, речь должна идти о том, что разработчик, имеющий глубокое системное понимание этапов процесса проектирования и навыки осмысленного управ ления им, обладает существенными профессио нальными преимуществами и обеспечивает боль ший экономический эффект своей деятельности по сравнению с разработчиками, таких знаний и навыков не имеющими. Пример оптимизации алгоритма в рамках единой инструментальной технологии приведен на рис. 10. По условию задачи программисту тре буется вычислить модуль произведения двух зна копеременных чисел, представленных в 8разряд ном дополнительном коде диапазон значений от минус 128 до плюс 127, при этом знак произведе ния необходимо вычислить отдельно. Показаны два варианта схема программы ее реализа ция. Из рисунка видно, что грамотно выполнен ный системный анализ может обеспечить эконо мию обоих критически важных ресурсов МК здесь сэкономлено 18 памяти и от 10 до 25 времени. Таким образом, совместное действие двух тен денций расширяющихся потенциальных воз можностей встраиваемых систем при одновре менном рациональном подходе к использованию их ресурсов позволит, с одной стороны, расши рить класс задач, эффективно реализуемых на встраиваемых системах, с другой стороны ре шать более сложные задачи на конкретной разно видности МК. Сказанное выше переводит проблему в мето дическую плоскость. В этом аспекте первостепен ную важность приобретает проблема создания ме тодики преподавания дисциплин цикла Встраи ваемые системы, обеспечивающей долгожи тельство подготовленного специалиста, его воз можность адаптироваться к изменениям в сфере встраиваемых устройств. Одним из ключевых подходов является необ ходимость обеспечить фундаментальность обра зования в этой сфере, несмотря на кажущуюся, на первый взгляд, невозможность этого в такой столь быстро обновляющейся предметной обла сти, как платформы встраиваемых средств вы числительной техники. Речь идет о необходимо сти выделить онтологический сущностный слой базовых знаний, устойчивый к изменениям конкретных реализаций МК. Такими базовыми знаниями являются прин ципы архитектурной реализации МК общие структурнофункциональные схемы, принципы обмена данными по внутренним магистралям, принципы функционирования процессорного ядра, построения памяти программ и памяти данных, знания основных классов периферий ных устройств портов, таймеров, ЦАП, АЦП, средств обмена данными в распределенных систе мах, подсистем обслуживания запросов прерыва ний, средств повышения надежности функцио нирования и др., наиболее целесообразных под ходов к их реализации и обосновывающих их фак торов, фундаментальных методов работы с ними. Эти знания должны сообщаться студентам на первом этапе изучения дисциплины. На втором этапе изучается конкретный пред ставитель МК на основе предшествующих зна ний об общих особенностях МКархитектур. Важ ной методической задачей является выбор такой конкретной архитектуры. Если речь идет о под готовке специалистов по заказу некоторого пред приятия, выбор очевиден если готовится специ алист достаточно широкого профиля, необхо димо более тщательно подойти к решению этого вопроса. Анализ рынка МК показывает, что наиболь шую долю как в денежном эквиваленте, так и в валовом количестве занимают 8битные ар хитектуры. Область их применения локаль ные системы управления промышленного и бы тового назначения, сверхнизкопотребляющие си стемы, системы для беспроводной связи. С точки зрения выбора конкретной архитектуры 8раз рядных МК для задач обучения необходимо ори ентироваться на МК, ставшие стандартом. Сегодня в мире производится несколько де сятков тысяч типов различных микроконтролле ров. Среди них особое место занимают так назы ваемые x51совместимые контроллеры, т. е. мик роконтроллеры, совместимые с одним из первых типов микроконтроллеров i8051 Эти микро контроллеры и сегодня занимают лидирующее место и являются de facto всемирным промыш ленным стандартом. Х51совместимые МК выпу скаются практически всеми известными миро выми производителями 9. Отметим также, что известными лидерами микроконтроллерной отрасли осваиваются но вые подсемейства x51совместимых МК все по следние годы. На момент написания статьи в апреле 2011 г. фирмой SiLabs анонсированы се мейства C8051F38x и C8051T62x32x. AnalogDe vices развивает направление так называемых AnalogMicroconrollers микроконтроллеров, встроенных в аналогоцифровые преобразовате ли высокого разрешения и решающих в том чис ле задачи цифровой фильтрации. Сопоставление этих и многих других фактов позволяет говорить о существовании тенденции перспективность се мейства х51 аналитики оценивают в полторадва десятилетия. Таким образом, МК семейства х51 являются своего рода живой классикой, достаточно инте ресными, в том числе с академической точки зре ния, и при этом простыми для изучения. Выбор конкретного варианта МК, изучаемого во второй части курса, связан с лабораторным практикумом безусловно необходимым для за крепления полученных знаний и развития прак тических навыков разработки МКсистем и наи более сильно обусловливается технической сто роной удобством изготовления, эксплуатации и обслуживания экспериментальной базы не сколько подробнее о ней будет сказано ниже, здесь отметим, что в авторском варианте лабо раторного практикума применяется МК Infi neon 515. На третьем этапе рассматриваются методы и средства проектирования, отладки и диагно стирования МКсистем особенное внимание уде ляется вопросам единства разработки аппаратно го и программного обеспечения МК. На заключительном, четвертом этапе теоре тической подготовки учащиеся знакомятся с при мерами применения МК. Часто встречающийся в практике преподавания подход, связанный с рассмотрением достаточно сложной задачи из практической деятельности преподавателя, по видимому, неприемлем как правило, он слиш ком сложен для аудитории и, кроме того, изоби лует массой конкретных нюансов, которые слу шателям трудно разъяснить. Авторы статьи предлагают учащимся примеры решения типовых задач построения МКсистем рассматриваются ввод информации в МКсистему т. е. измерение значения некоторого параметра физи ческого сигналаносителя обработка сигна лов с дискретным, аналоговым, времяимпульс ным кодированием информации вычислитель ные преобразования вывод информации из МК сис темы т. е. кодирование информации некото рым параметром физического сигнала рассматри ваются дискретное, ШИМ и ФИМкоди рование. Для поддержки лабораторного практикума авторами предлагается исследовательский ком плекс СТК1 рис. 1113, позволяющий выпол нять полный цикл разработки встраиваемых МК систем управления, осуществлять подготовку ба калавров и магистров по дисциплинам Микро контроллеры, Вычислительные машины и си стемы, Встраиваемые интеллектуальные си стемы управления, исследовать уровень аппа ратной поддержки вычислений во встраиваемых системах управления. К отличительным чертам комплекса относят ся интеграция объекта, средств и технологии проектирования, что обеспечивает существенное повышение эффективности проектирования встра иваемых систем и качества обучения наличие коммутационного поля позволяющего задавать структуру аппаратного взаимодействия элемен тов стенда между собой и портами вводавывода МК для разработки аппаратных соединений на личие встроенных в стенд объектов управления и датчиков клавиатура и ЖКИ для изучения дискретного вводавывода, потенциометр, инте грирующее RCзвено, микрофон и динамик для изучения аналогового вводавывода, а также ге нераторов тестовых воздействий источник гар монического сигнала с регулируемыми пользова телем частотой и амплитудой, источник импульс ных сигналов с регулируемыми пользователем частотой и скважностью. Для поддержки про цесса проектирования применяется авторское инструментальное программное обеспечение. Как видно из рисунков, при разработке МК системы студенты проектируют и натурно реали зуют аппаратные соединения МК с объектами си стемы, разрабатывают и отлаживают соответ ствующее программное обеспечение. Отметим, что в качестве методического обе спечения экспериментальные комплексы на осно ве микроконтроллеров х51 выпускают такие при знанные лидеры рынка мирового учебного и ла бораторного оборудования, как KH Manufactur ing Тайвань, Edibon Испания и др. Учебное оборудование подобного рода производится во многих странах, в том числе в СНГ и России. Важ ной отличительной чертой СТК1 является то, что в нем отсутствуют предопределенные соединения объектов и линий вводавывода МК, благодаря чему обучающиеся должны следовать описанному ранее технологическому маршруту проектирова ния естественно, в упрощенном для целей обуче ния виде сначала разработать структуру систе мы и связи МК с прочими ее элементами и лишь затем осуществлять программирование МК. Авторский курс Микроконтроллеры. Разра ботка встраиваемых приложений изложен в од ноименной книге 10. Авторы полагают, что следует преодолевать стереотипные представления о разработке си стем такого рода как о процессе прикладного программирования, а также повышать внимание к методическим вопросам подготовки специали стов в области встраиваемых средств. Такой под ход, усиленный возможностями современных ин струментальных комплексов, обеспечит повыше ние качества разработки в такой массовой и все охватывающей области применения средств вы числительной техники, как встраиваемые си стемы. 