ПРОТОТИП ДИАГНОСТИЧЕСКОЙ СИСТЕМЫ ПОДДЕРЖКИ ПРИНЯТИЯ РЕШЕНИЙ НА ОСНОВЕ ИНТЕГРАЦИИ БАЙЕСОВСКИХ СЕТЕЙ ДОВЕРИЯ И МЕТОДА ДЕМПСТЕРА–ШЕФЕРА 

Рассматриваются применение и программная реализация формального аппарата, интегрирующего возможности расширенных байесовских сетей доверия (Bayesian belief networks) и метода Демпстера–Шефера (Dempster–Shafer). Данный аппарат ориентирован на использование в интеллектуальных системах поддержки принятия решений для помощи специалистам при диагностике сложных проблемных ситуаций. В отличие от традиционных байесовских сетей доверия предлагается применение перспективных многоуровневых (сложно-структурированных) сетей, более удобных для комплексного исследования проблемы и представления экспертных данных. Интеграция позволяет использовать при диагностике как экспертные данные, так и числовые (вероятности) данные, полученные в результате измерений. Совместное использование байесовских сетей доверия и метода Демпстера–Шефера позволяет оценить соотношения между возможными исходами (ситуациями) и уточнить их вероятности. Предложенный подход реализован в прототипе интеллектуальной диагностической системы поддержки принятия решений для диагностики сложных заболеваний зрения.

 В статье рассматривается совместное использование байесовских сетей доверия БСД 1 и метода Демпстера-Шефера МДШ 2, предназначенное для помощи ЛПР при диагностике сложных проблемных ситуаций. В отличие от классической БСД в системе используется многоуровневая архитектура, объединяющая несколько методов и позволяющая исследовать проблему в целом. Разбиение на уровни позволяет также сократить область перебора различных ситуаций для поиска наиболее вероятного результата. В системе используются не только рассуждения экспертов, но и анализ числовых данных, полученных при проведении различных диагностик с применением вероятностных методов. Установлено 3, что при применении аппарата БСД в интеллектуальных системах поддержки принятия решений ИСППР, особенно в ИСППР реального времени РВ, недостаточно определить основные составляющие события в сети и их связи. Нужно также учитывать все возможные ситуации, которые может предвидеть эксперт. Для этого предлагается использовать сложноструктурированную БСД. Такой тип БСД был адаптирован и применен в прототипе ИСППР для диагностирования сложных глазных заболеваний на примере патологий сетчатки, когда невозможно с абсолютной уверенностью сказать, какая именно болезнь у пациента и на какой стадии. Даже после выявления симптомов с помощью специальных компьютерных средств диагностики и заключений опытных специалистов пациентам приходилось повторно проходить обследование из-за неточности и недостаточности имеющейся информации. При построении модели и опытной апробации было выявлено, что использование БСД позволяет анализировать только один из возможных исходов наличие одного из заболеваний, игнорируя другие варианты. Совместное использование БСД и МДШ позволит оценить соотношения между возможными исходами ситуациями и уточнить их вероятности. В качестве объекта исследований была выбрана глаукома. Основными признаками данного заболевания являются повышение внутриглазного давления и снижение зрения. В основе заболевания лежит нарушение циркуляции внутриглазной жидкости чаще всего затруднение ее оттока 4. Статистические данные и данные по пациентам были получены в Московском НИИ глазных болезней им. Гельмгольца. Создаваемый прототип ИСППР должен помочь ЛПР врачу-офтальмологу в выявлении на начальной стадии признаков глаукомы и в уточнении типа заболевания с целью как можно более раннего назначения соответствующего лечения. Рассмотрим основные этапы исследований при диагностике глаукомы. Прежде всего пациент должен пройти комплекс клинических обследований у врача-офтальмолога. На этом этапе применяется определенный набор психофизических тестов для выявления патологий. Если имеются основательные достоверные данные в пользу определенного заболевания пациента, то дальнейшие исследования нецелесообразны в противном случае обследование может продолжиться. Дообследование часто необходимо на ранних стадиях заболевания или в сложнодифференцируемых случаях, например при глаукоме низкого давления, когда данные клинического обследования пациента могут почти не отличаться от нормы. Далее выполняется комплекс аппаратных исследований, при которых анализируются ответы сетчатки на различные световые раздражители. Для этого используются разные виды электроретинограмм ЭРГ в виде компьютерных графиков, отражающих изменения биопотенциалов сетчатки, возникающие в ответ на вспышки света, оцениваются амплитуда и время кульминации волн. На основе характера изменений ЭРГ выявляется имеющаяся патология. На заключительной стадии специалист-физиолог или группа специалистов на основе полученных в результате обследований пациента данных должен подтвердить или опровергнуть предвари-тельный диагноз офтальмолога в последнем случае надо уточнить диагноз и рекомендовать соответствующее лечение. На рисунке 1 представлена БСД, характеризующая процесс диагностирования глаукомы в виде множества определяемых событий T результаты клинических исследований у офтальмолога подозрение на наличие у пациента заболевания Z заключение физиолога о наличии болезни в ходе проведения исследований ЭРГ и данных офтальмолога I результат исследования ЭРГ D результирующее событие, характеризующее решение поставленной задачи уточненный диагноз, текущая стадия, рекомендации по лечению или дальнейшему обследованию и т.д.. Цифрами обозначаются события, относящиеся к этапам исследования пациента. Рассмотрим событие, определяющее результат исследования ЭРГ, на примере первичной открытоугольной глаукомы ПОУГ. Для диагностирования данного заболевания состояния и его стадии необходимо проанализировать ряд ЭРГ, сделать по ним заключение о выявленных признаках симптоматике заболевания и определить степень вероятность уверенности в диагнозе. На рисунке 2 представлена модель второго уровня для определения значения события Результат исследования ЭРГ, где I целевое собы-тие диагноз IК, IРТ результаты проведенных исследований IK результат, полученный при ис-следовании колбочковой ЭРГ, IM максимальной ЭРГ, IP палочковой ЭРГ, IOP осцилляторных потенциалов ОП, IF диаграммы фотопического негативного ответа ФНО, IPT паттернЭРГ ПЭРГ. В модели второго уровня представляются результаты основных видов ЭРГ, каждая из которых имеет свой собственный вид и изменяется в зависимости от заболевания, то есть определяются ключевые значения, характеризующие ту или иную болезнь. Палочковая, колбочковая и максимальная ЭРГ используются для проверки способ-ности глаза к темновой и световой адаптации. Каждый из компонентов ЭРГ генерируется различными структурами сетчатки. На рисунке 3 представлен пример ЭРГ и ее компонентов 5. Каждый из компонентов ЭРГ генерируется различными структурами сетчатки. Основными результирующими показателями являются aи b-волны 5. В ходе диагностики анализируются значения амплитуды и времени кульминации волн различных видов ЭРГ. В таблице 1 представлены полученные статистические данные амплитуд колебаний по обследуемым пациентам с ПОУГ 1-й и 2-й стадий.По данным амплитуд можно проанализировать изменение значения проходящего через сетчатку сигнала. При наличии заболевания происходит угнетение aи b-волн. Кроме того, может изменяться и время их кульминации в худшем случае время увеличивается, а при начальной стадии заболевания время не изменяется относительно нормы. Прогрессирование болезни способствует значительному снижению амплитуды и увеличению времени кульминации волн ЭРГ, снижению зрительных функций. Рассмотрим модель БСД для диагностики ПОУГ на основе проведенного анализа максимальной ЭРГ рис. 4, где Aa, Ab значения максимальной амплитуды Ta, Tb значения времени кульминации соответствующих волн Va, Vb заключения на основе введенных данных, определяющие заболевание IM целевое событие, соответствующее общему результату анализа ЭРГ диагнозу. Предложенная модель учитывает все ключевые значения стандартных видов ЭРГ для ПОУГ. На данном этапе диагностики ПОУГ возможны толь-ко 1-я и 2-я стадии, поэтому можно отметить ряд особенностей Aa и Ab могут принимать различные значения в зависимости от типа и стадии заболевания в некотором диапазоне относительно средних значений амплитуд, указанных в таблице 1 например, для заболевания ПОУГ 1-й стадии каждое событие имеет три состояния более типично для заболевания ПОУГ 1-й стадии, типично для заболевания ПОУГ 1-й стадии, менее типично для заболевания ПОУГ 1-й стадии зоны состояний могут пересекаться, то есть нужно проанализировать все состояния, если значения максимальных амплитуд aи b-волн находятся в зоне пересече-ний Ta и Tb изменяются только при ПОУГ 2-й стадии, следовательно, можно выделить два состояния больше нормы для здорового человека, норма для здорового человека Va и Vb в зависимости от ключевых значе-ний позволяют констатировать наиболее соответствующее состояние диагноз ПОУГ 1-й ста-дии, ПОУГ 2-й стадии или здоров IM обозначает событие, результат которого при анализе всех заключений по данным макси-мальной ЭРГ имеет состояния, аналогичные Va и Vb. Рассмотрим пациента с подозрением на ПОУГ 1-й стадии. В таблицах 2 и 3 заданы ключевые значения амплитуд и времени кульминации aи b-волн, соответствующие состояния событий и коэффициенты уверенности при анализе максимальной ЭРГ глаза. Значение амплитуды a-волны соответствует двум состояниям событий типично для заболевания ПОУГ 1-й стадии и менее типично для заболевания ПОУГ 1-й стадии. Нужно рассчитать вероятность выполнения обоих событий. Конечным событием для анализа данных мак-симальной ЭРГ является событие IM следствие наиболее вероятного заболевания пациента или опровержение подозрения при клиническом исследовании. В данном случае необходимо подтвердить или опровергнуть, что у пациента ПОУГ 1-й стадии. Чтобы полностью удостовериться, что резуль-татом анализа максимальной ЭРГ является наличие заболевания, нужно определить наибольшее значение совместной вероятности событий. Рассчитав совместную вероятность событий при условии, что Aa менее типично для заболевания ПОУГ 1-й стадии, получим PAa, Ta, Ab, Tb, Va, Vb, IM0,125. Таким образом, результат диагноз Aa ме-нее типично для заболевания ПОУГ 1-й стадии имеет наибольшее значение совместной вероятности событий. Чтобы удостовериться, что результатом анализа максимальной ЭРГ является наличие у пациента ПОУГ 1-й стадии, нужно рассчитать соответствующую условную вероятность при заданных событиях, определяющих значения ключевых точек на ЭРГ. После соответствующих вычислений получим результат 0,67 67, означающий, что при анализе максимальной ЭРГ пациента наиболее вероятным диагнозом является наличие ПОУГ 1-й стадии, но данной информации недостаточно, чтобы подтвердить или опровергнуть соответствие данного диагноза действительности, поскольку, как уже отмечалось, использование БСД позволяет анализировать лишь один из возможных диагнозов, в частности наличие или отсутствие ПОУГ 1-й стадии. Для устранения этого недостатка для проведения комплексного анализа с возможностью учета и других возможных диагнозов предлагается, помимо БСД, использовать также МДП, который позволяет сопоставить все имеющиеся значения как множества признаков, характеризующих заболевания. Например, значение Va может иметь три возможных значения состояния. В зависимости от введенных значений амплитуды и времени кульминации волн можно задать вероятность принадлежности для всех возможных состояний события Va. Каждое из состояний Va будем рассматривать как заключение одного из экспертов, который утверждает, что при введенных данных его заболевание является наиболее вероятным. Исходя из этого можно определить интервалы доверия и правдоподобия для каждого из заболеваний. В таблице 4 приведены соответствующие значения масс, коэффициентов доверия и правдоподобия, используемые для расчетов. Выделенные значения в таблице можно интерпретировать как нижние и верхние пределы интервалов, на которых находятся значения соответствующих вероятностей. Согласно полученным данным можно затем корректировать значения вероятностей для БСД. Совместное использование аппарата БСД и МДШ позволит повысить качество диагностики при наращивании БД по заболеваниям и методам их анализа. Для реализации прототипа диагностирующей ИСППР был выбран перспективный язык искусственного интеллекта Clips 6. В качестве входных данных используются информация о клинических исследованиях пациента, данные различных видов ЭРГ и заключения врачей. Выходной информацией являются диагноз с соответствующей вероятностью уверенностью и предлагаемые методы лечения или рекомендуемые действия для уточнения информации о пациенте. По данным, полученным при анализе различных видов ЭРГ, строится БД база фактов, хранящая словесное исход-ное описание задачи сведения о пациенте. Для построения БСД и оперирования данными из базы фактов используется база знаний правил, включающая методы получения результата. Представим фрагмент программы на языке Clips с примером правила добавления нового элемента значения максимальной амплитуды a-волны при попадании в интервал для ПОУГ 1-й стадии После задания в системе множества фактов для описания событий Aa, Ab, Ta, Tb на основании коэффициентов уверенности выполняется поиск правил для определения состояний событий Va и Vb. В процессе поиска может возникнуть ситуа-ция, когда выполняются несколько правил, формирующих некоторое множество фактов при одних и тех же условиях. Это объясняется тем, что экстремумы aи b-волн могут соответствовать нескольким состояниям. В этом случае используется наибольшее значение условной вероятности события Im. 