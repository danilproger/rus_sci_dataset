ОБНАРУЖЕНИЕ  ТРАНСПОРТНЫХ  СРЕДСТВ И  ОЦЕНКА  ПАРАМЕТРОВ  ТРАНСПОРТНЫХ  ПОТОКОВ ПО  ВИДЕОПОСЛЕДОВАТЕЛЬНОСТИ 

В автоматизированных видеосистемах контроля дорожного движения предлагается использовать вейвлет-преобразование с целью выделения и сегментации движущихся объектов. Для измерения параметров транспортных потоков применяется метод контрольных сечений с двойной пороговой оценкой присутствия транспортных средств в контрольной зоне. Приводятся результаты обработки реальных видеопоследовательностей. We propose the use of wavelet transformations for the extraction and segmentation of moving objects in automated video monitoring systems of traffic control. The method of control sections with double threshold estimation of vehicle presence inside of the control zone is applied for measurement of traffic flow parameters. Results of real-life video sequences processing are presented. 

Российский парк автомобилей каждый год растет на 10 в отдельных городах ежегодный рост может превышать 30, также необходимо учитывать наличие в крупных городах транзитных транспортных средств ТС, а протяженность транспортных магистралей за этот же отрезок времени увеличивается лишь на 1,5. Эта диспропорция приводит к увеличению плотности движения и росту негативного влияния выбросов на окружающую среду. Одной из мер борьбы с этими явлениями, необходимой в современных мегаполисах, является автоматическое регулирование транспортных потоков ТП. Сбор информации о параметрах движения ТП скорость, интенсивность, наличие заторов и др. позволяет своевременно принимать конструктивные решения. На сегодняшний день подобные системы регулирования дорожной обстановки внедрены во многих крупных городах например, в Москве уже несколько лет действует система Старт. За прошедшие годы стали очевидны недостатки индуктивных, емкостных, пьезоэлектрических и других детекторов транспорта, размещаемых в дорожном покрытии 1 сложность и, следовательно, дороговизна установки и обслуживания короткий срок службы сильная зависимость надежности от внешних воздействий механических и климатических . Видеодетекторы транспорта, напротив, не имеют недостатков, присущих вышеназванным датчикам, потому что они установлены над магистралями. Кроме этого, они имеют много преимуществ, таких как выделение ТС одним датчиком по нескольким полосам, сбор большого числа разнообразных данных о дорожном движении и способность визуального наблюдения ТП. Эти преимущества признали, например, департаменты транспорта США и стали широко применять видеодетекторы транспорта 2. В настоящее время наметились следующие основные подходы к задаче выделения движущихся объектов 1 выделение особых точек изображения перепадов яркости 2 выделение областей интереса по текстуре 3 выделение области интереса по шаблонам 4 использование разности соседних кадров энергии движения 5 анализ смещения пикселей за время кадра оптического потока 6 расчет и устранение фоновой составляющей. Используются и комбинации методов для улучшения выделения объекта. Например, объединяется информация о перепадах яркости и энергии движения 3. В таблице приводятся некоторые параметры традиционных подходов. Знаки и означают, соответственно, наличие и отсутствие возможности знак наличие ограничений или возникающие сложности. Исследования методов выделения ТС показали особую важность этапа выделения объектов на фоне меняющейся освещенности 1, 48. Этот этап является ключевым во всех алгоритмах анализа видеопоследовательностей. В частности, было обращено внимание на наличие проблем в методах устранения фона влияние фона на изображение кадр фон может приводить к наличию объектов-призраков, которые на самом деле являются не объектами, а частями фона неправильная оценка фона при резком изменении освещенности или дрожании камеры влияние теней автомобилей проявляется сильнее, чем в алгорит мах энергии движения и энергии движения раздробленность объектов и исчезновение частей объектов из-за межкадровой разности зависимость результата от освещенности сцены, отношения сигналшум и изменчивости фона. В подходах, основанных на оптическом потоке, даже в случае использования полного перебора, до трети от общего количества векторов имеют ложное значение. Комбинации методов имеют свойство проявлять недостатки, как минимум, одного из методов, используемых при их построении. Результаты применения некоторых современных алгоритмов показаны на рис. 1, исследование алгоритмов описано в работе 8. Приведенные кадры демонстрируют недостатки применяемых ранее методов ошибки компенсации фона рис. 1, влияние фона на разность кадр фон отпечаток бордюра на микроавтобусе рис. 1, наличие объектов-призраков рис. 1, раздробленность объектов при применении энергии движения рис. 1, . Как правило, алгоритмы анализа видеопоследовательностей в видеодетекторах транспорта состоят из следующих этапов определение пикселей, потенциально принадлежащих объектам обработка пикселей, потенциально принадлежащих объектам сегментация идентификация классификация ТС определение параметров ТП. Основным инструментом выделения объектов в видеопоследовательности является вейвлет D4, который обладает хорошей локализацией энергии из-за сравнительно небольшой величины коэффициентов используемых фильтров 6. Преимуществом этого подхода является возможность выделять как движущиеся, так и неподвижные ТС, что дает возможность в реальном времени прогнозировать и выявлять заторы на городских магистралях. Алгоритм может быть применен как для исходных, так и для разностных изображений в последнем случае получается комбинация методов использование энергии движения и выделение перепадов яркости. Общая схема алгоритма анализа коэффициентов вейвлет-преобразования показана на рис. 2. Изменения яркости на разных участках изображения соответствуют высокочастотным ВЧ возмущениям, которые можно находить с помощью анализа трансформант вейвлет-преобразования. При применении вейвлет-преобразования к сигналам изображений ВЧ-фильтры выделяют контуры объектов, а низкочастотные НЧ сглаженную версию исходного изображения. Разложение сигнала на НЧ-составляющие, и ВЧ-составляющие, осуществляется путем умножения отсчетов сигнала, на коэффициенты фильтров низких, и высоких, частот Вейвлет Добеши относится к классу квадратурных зеркальных фильтров. Особенностью этого класса фильтров является то, что фильтр ВЧ получается из соответствующего фильтра НЧ простой перестановкой его коэффициентов в обратном порядке и изменением знака половины из них только четных или только нечетных на противоположный. При этом вейвлет выделяет локальные особенности сигнала в каждой точке и является, таким образом, фильтром ВЧ, а соответствующий фильтр НЧ описывается так называемой масштабирующей функцией 9. Коэффициенты НЧ-фильтра Коэффициенты ВЧ-фильтра . Соответственно, имеем НЧ-трансформанты вейвлет-преобразования и ВЧ-трансформанты вейвлет-преобразования Разложение изображения с помощью вейвлетпреобразования начинается с того, что по строкам производится умножение отсчетов сигнала на коэффициенты фильтров. Соответственно, для каждой последовательности из четырех отсчетов получится по восемь значений, т. е. происходит увеличение размера матрицы, описывающей сигнал изображения. Такое представление является избыточным, и производится децимация оставляются только четные члены. Вообще, нет необходимости делать лишние вычисления, поэтому можно рассчитать только значения, . Полученные значения помещают в разные половины матрицы изображения, 1, 1, где половина ширины изображения. В левой половине изображения оказывается НЧ-составляющая, а в правой ВЧ-составляющая сигнала. Далее производится процесс свертки элементов массива с коэффициентами фильтров, но на этот раз процесс уже идет по столбцам, затем децимация и сортировка значений НЧ в верхнюю часть, ВЧ в нижнюю часть рис. 3, . Следует отметить, что поскольку сумма коэффициентов НЧ-фильтра больше 1, необходимо производить нормировку значений трансформант вейвлет-преобразования делением на после каждой итерации для сохранения исходной яркости. При выполнении вейвлет-преобразования значения трансформант брались по модулю. Результирующий массив состоит из четырех частей в левой верхней части сглаженная и уменьшенная в два раза копия исходного изображения, в правой верхней части массив трансформант по вертикали, в левой нижней массив трансформант по горизонтали, в правой нижней массив трансформант по диагонали Высокочастотные массивы трансформант содержат информацию о перепадах яркости в изображении. Для обнаружения движения объектов предлагается объединять информацию трех ВЧ-диапазонов . Движение объекта в видеопоследовательности это процесс коррелированного переноса перепадов яркости от частей объекта из кадра в кадр. Объединение информации о перепадах яркости позволит увеличить точность обнаружения объекта за счет лучшего его описания суммой трансформант, которые на объединенном изображении будут располагаться рядом 6. Для предотвращения переноса шума в новое представление производится отбор значимых трансформант по принципу значительного превышения среднего арифметического значения трансформант ВЧ-диапазона. Для отбора значимых трансформант необходимо выбрать пороговое значение первый порог. Эксперименты показали, что значение порога может быть определено как удвоенное среднеквадратическое отклонение СКО гистограммы распределения амплитуд трансформант трех ВЧ-массивов для исходных кадров и утроенное СКО для разностных кадров. Объединение информации в ВЧ-диапазонах производится следующим образом где значение трансформанты в точке c координатами, показывающее изменения в вертикальном и горизонтальном направлениях значение трансформанты в точке с координатами, объединяющее информацию об изменениях в вертикальном, горизонтальном и диагональном направлениях. После объединения массив трансформант вновь подвергается пороговому ограничению для выявления наиболее значимых из объединенного ВЧ-диапазона рис. 4. Это вторая операция отбора отбор наиболее значимых трансформант. Эксперименты показали, что значение порога может быть определено как СКО гистограммы распределения амплитуд трансформант объединенного ВЧ-диапазона как для исходных, так и для разностных кадров. Полученное бинарное изображение разделяется на блоки размером 2 2, и в каждом блоке вычисляется суммарное число единиц, т. е. количество наиболее значимых трансформант вейвлет-преобразования, прошедших первые два этапа отбора. По критерию связности производится третья операция отбор значимых блоков. Исключаются блоки с одиночной связностью, т. е. содержащие изолированные трансформанты, которые являются шумовыми выбросами. Дальнейшая реализация морфологической операции наращивания позволяет выявить форму объекта. В морфологических операциях значение структурного элемента устанавливается после анализа соседних элементов, а в конкретном случае после анализа наличия в окрестности блоков фона и объектов. Результат морфологической обработки представляет собой массив из близкорасположенных элементов рис. 5, . Конечной целью сегментации является разбиение изображения на области. В случае бинарного изображения критерием, по которому производится объединение пикселей в области, является их яркость и пространственная близость. На бинарном изображении обозначим 0 фон, 1 объект. Сегментация должна быть полной, т. е. каждый единичный отсчет должен быть включен в какую-то область. Чтобы быть включенным в какую-либо область, отсчет должен быть 8-связанным, по меньшей мере, с одним отсчетом из этой области. Если обнаружено, что некоторый отсчет связан более чем с одной областью, то эти области сливаются. Области не должны пересекаться. Разработанный нами алгоритм сегментации бинарных изображений принадлежит к классу рекурсивных алгоритмов наращивания областей также известных как алгоритмы раскраски изображений 10. Альтернативным подходом к сегментации являются, например, алгоритмы прослеживания границ. Каждому размеченному объекту ставится в соответствие индивидуальное положительное целое число идентификатор метка. На основании этой метки можно впоследствии извлекать объекты из сегментированного изображения и производить классификацию, идентификацию и т. п. Алгоритмы наращивания областей начинаются с операции начальной разметки изображения, результат которой затем итеративно переопределяется. Необходимость этого объясняется тем, что при сложной форме объектов, т. е. наличии далеко отстоящих выступов, каждый из выступов будет получать свою метку. Таким образом, получится, что после начальной разметки объекты типа пятиконечная звезда будут состоять из множества полосок, имеющих метки разных объектов. Поэтому требуется операция переопределения меток для того, чтобы каждый объект имел свой уникальный идентификатор, а не несколько десятков, соответствующих его частям. Для этого производятся повторные просмотры точек растра, причем в результате каждого просмотра часть точек переопределяется. Особенностью повторного просмотра является учет всех размеченных соседей текущего элемента при определении его метки. Когда в результате выполнения этой процедуры возникнет ситуация, в которой дальнейшие изменения невозможны, то все области будут иметь индивидуальные идентификаторы. Этап начальной разметки выглядит так для единичной неразмеченной точки ищется максимальная метка среди восьми соседей и присваивается текущей. Если соседи не размечены, то текущей точке присваивается новая метка метка счетчик меток 1. Этап переопределения метки текущего пикселя состоит из следующих базовых операций если текущая размеченная точка имеет метку и она меньше, чем у размеченного соседа, то сосед получает метку текущей точки если текущая размеченная точка имеет метку и она больше, чем у размеченного соседа, то текущая точка получает метку соседа. В этом этапе участвуют все 8-связные размеченные соседи текущей размеченной точки. В соответствии с рекомендацией 10, после каждого этапа переразметки целесообразно менять направление сканирования порядок просмотра точек. Нечетные проходы первый и т. д. осуществляются в том же направлении, что и при начальной разметке если было слева направо, сверху вниз, то такое же направление и при переразметке четные проходы второй и т. д. в направлении, противоположном направлению нечетного прохода переразметки справа налево, снизу вверх. Каждая смена метки отмечается счетчиком переопределений. Этап переопределения повторяется до тех пор, пока количество переопределений не станет равным нулю. Теперь по номеру метки можно извлечь объект рис. 6, . После процесса переопределения меток определяются координаты крайних точек объектов. Для этого составляется список меток, соответствующих объектам. Как правило, между номерами меток есть значительные разрывы. Для устранения этих разрывов производится ранжирование номеров меток. По таблице соответствия номеров меток и их рангов производится переопределение меток номера меток 1, 5, 8 после финального переопределения становятся 1, 2, 3. После этого производится поиск крайних точек объектов. Минимальные и максимальные координаты точек выводятся в таблицу. По этой таблице на объекты, находящиеся в контрольной зоне, накладываются стробы. При видеосъемке зоны обзора на видеоизображении сцены имеются перспективные искажения. Это приводит к необходимости разделить изображение на ближнюю зону высокой детальности и дальнюю зону низкой детальности. В дальней зоне помехи могут оказывать значительное влияние на определение размеров ТС. Поэтому область низкой детальности не может использоваться для надежного обнаружения объектов. Учитывая сказанное, определим ближнюю зону высокой детальности как контрольную зону КЗ, а ее ближнюю и дальнюю границы как контрольные сечения КС. Граница, по которой определяется положение дальнего КС, определяется максимальным допустимым коэффициентом перспективных искажений, который характеризует ухудшение разрешающей способности. Коэффициент перспективных искажений это отношение количества сантиметров, приходящихся на пиксель в точке обзора, к минимальному значению этой величины в КЗ Величина максимального допустимого коэффициента перспективных искажений зависит от конкретных условий съемки высоты установки камеры, длины обозреваемого участка, а также определяется требованиями к разрешающей способности алгоритма определения класса ТС. Телевизионная камера устанавливается так, что строки телевизионного растра размещаются перпендикулярно направлению движения ТП 4. Метод контрольных зон дает возможность определить характеристики ТП. При входе в контрольную зону ТС идентифицируется, а на выходе из КЗ проходит повторную идентификацию. Для определения характеристик ТС необходимо определить три параметра момент въезда ТС в КЗ, время нахождения в ней, время прохода ТС через КС . На основании этой информации можно определить как первичные характеристики скорость, длину, тип ТС, так и вторичные интенсивность движения за интервал времени, среднюю скорость ТП и т. д. Зная время пересечения КС, расположенных на базовом расстоянии, определяем время прохождения автомобилем базового расстояния . Определение длины ТС осуществляется на основании времени прохода ТС через КС . Ширина ТС определяется по результатам прохождения его через логический обнаружитель КС как медиана в последовательности максимальных значений ширины ТС в активных строках логического обнаружителя. При проведении этой операции на дальнем КС необходима коррекция перспективных искажений умножением на величину коэффициента . Определение моментов вхождения ТС в КЗ и выхода из нее моментов пересечения КС производится с помощью логических обнаружителей ЛО движущихся объектов с критерием обнаружения типа из, где 7. Обработка ведется индивидуально по полосам движения, и для измерения параметров ТС необходимо выделить два КС, которые будут ограничивать начало и конец КЗ рис. 7. КС на телевизионном растре образуется пятью строками, число которых выбирается, исходя из надежного выделения движущегося ТС. В результате анализа яркостей пикселей в ЛО КС полосы движения производится обнаружение активных строк по принципу превышения порогового значения минимальной ширины транспортного средства. Количество активных строк в КС определяется положением ТС относительно КС. Двухпороговый анализ по числу активных строк и степени их активности позволяет надежно выделить ТС, а также зафиксировать значения, и . Определение скорости, длины и ширины ТС производится на обоих КС каждой полосы. На основании времени пересечения обоих КС, расположенных на базовом расстоянии, определяется время прохождения автомобилем базового расстояния и скорости ТС в КЗ Определение длины ТС осуществляется на основании среднего времени прохода ТС через оба КС и и Ширина ТС определяется по результатам анализа активных строк логического обнаружителя каждого КС при прохождении ТС через них. При проведении этого анализа на дальнем КС учитывается наличие перспективных искажений. Под классификацией понимается разделение ТС на классы в зависимости от их габаритных размеров. Для данной задачи не важно точное определение марки ТС, а достаточно лишь сравнительно грубое определение класса ТС. Предлагается использовать следующие классы ТС ТС, имеющие менее четырех колес легковые машины и джипы микроавтобусы и фургоны грузовики с прицепом, автобусы, трейлеры. Определение класса предлагается делать по геометрическим размерам ТС 1 транспортные средства, имеющие менее четырех колес мотоциклы, мотороллеры длина не более 3 м, ширина до 1,5 м 2 легковые машины, джипы, малые тракторы длина от 3 до 4,5 м, ширина от 1,5 до 2 м 3 микроавтобусы, фургоны, цистерны, тягачи без прицепа длина от 4,5 до 6,5 м, ширина от 2 до 2,7 м 4 грузовики с прицепом, автобусы, самосвалы, трейлеры и составные автобусы длина больше 6,5 м, ширина от 2 до 3 м. Определение класса производится сразу после полного пересечения ТС КС по ширине и длине ТС. После полного пересечения ЛО КС автомобиль получает индивидуальный строб и маркер номер. Уточнение класса возможно дважды после достижения ТС второго КС по результатам промежуточных сегментаций и после прохождения второго КС. Идентификация состоит в подтверждении присутствия распознанного ТС ТС, класс которого определен после пересечения КС1 в КЗ на промежутке от КС1 до КС2. Для этого необходимо использовать результаты маркировки и стробирования ТС в КЗ. Маркировка и классификация ТС по видам позволяет оценить такие параметры ТП, как общая плотность потока на участке магистрали, интенсивность движения по полосам, состав и неравномерность ТП в различные интервалы времени. Кроме того, могут быть подсчитаны средняя скорость ТП и ее изменения за определенный промежуток времени. Экспериментальная проверка предложенного алгоритма проводилась на 11 тестовых видеопоследовательностях с реальными сюжетами городских транспортных магистралей общей продолжительностью свыше 6000 кадров с разрешением 576 720, содержащих 97 ТС разных классов. В результате обработки было обнаружено 95 ТС при пересечении КС, при этом 84 были правильно классифицированы при сегментации внутри КЗ. Анализ результатов показал, что ошибки в работе алгоритма возникают в следующих ситуациях при низком контрасте и неравномерном освещении КЗ, при наличии знаков дорожной разметки или дефектов в дорожном покрытии, в случаях окраски ТС, близкой по тону к дорожному покрытию. Результаты моделирования и обработки реальных ситуаций в видеопоследовательностях показали, что предложенные виды обработки эффективно решают задачи измерения параметров транспортных потоков. Это еще раз подтверждает тезис о больших возможностях видеодетекторов транспорта и перспективности их широкого использования, особенно в свете удешевления видеодатчиков и программируемой электроники, обеспечивающей реализацию предлагаемых алгоритмов. Дальнейшие исследования направлены на изучение работы предлагаемых алгоритмов в сложных условиях освещения, при наличии теней, заслонов, в вечернее время и в непогоду дождь, снег, туман. 