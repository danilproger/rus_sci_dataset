АЛГОРИТМИЧЕСКОЕ  ОПИСАНИЕ И  СРАВНИТЕЛЬНЫЙ  АНАЛИЗ  СВОЙСТВ СИГМА-ДЕЛЬТА  АЦП (ЧАСТЬ 1) 

Предложено аналитическое описание алгоритма работы сигма-дельта АЦП  в виде нелинейного отображения, на основании которого осуществлено исследование его характеристик и выполнен аналитическими методами и посредством имитационного моделирования сравнительный анализ особенностей его функционирования. We propose a non-linear mapping that describes the algorithm of work of the delta-sigma analogto-digital converter. This model is used to investigate the characteristics of the converterand give a comparative analysis of its features. 

Известно, какую роль играют в информационных технологиях средства преобразования форм информации, в том числе различные типы и модификации аналого-цифровых преобразователей АЦП, составляющие заметную долю продукции на современном рынке электронных компонентов 18. Именно поэтому это направление в информационных технологиях обуславливает теоретический интерес, так как не только способствует дальнейшему совершенствованию АЦП, а и содействует обоснованному выбору типа АЦП с учетом требований решаемой технической задачи. Для этого необходимо знать, по возможности, все нюансы, связанные с особенностями работы соответствующего типа АЦП. Не останавливаясь на анализе различных способов реализации и разнообразных видах алгоритмов аналого-цифрового преобразования, лежащих в основе соответствующих типов АЦП, рассмотренных, например, в работах 1, 2, 7, 9 11, подвергнем анализу особенности алгоритма функционирования широко разрекламированного, высокоточного так называемого сигма-дельта АЦП 13, 7, 8 . В дальнейшем под понятием функционирования подразумевается смена состояний анализируемого прибора или устройства по определенным правилам, законам или алгоритмам в зависимости от значения входного сигнала. В современной, в основном технической литературе, а также в публикациях фирм-производителей данного типа АЦП например, фирмы Analog Devices даются, как правило, технические сведения и отрывочные данные о свойствах и особенностях работы АЦП 2, 46. В то же время вызывает теоретический интерес принцип функционирования, свойства и подробный аналитико-имитационный сравнительный анализ адекватного алгоритма функционирования АЦП, который обеспечивает по сравнению с другими типами АЦП, по данным фирм-производителей, его очень высокую разрядность до 24 в результатах аналого-цифрового преобразования. Но для такого анализа необходимо в математической форме описать и в явном виде представить соответствующий адекватный алгоритм, отсутствие которого затрудняет полное понимание специфики и сущности работы АЦП даже у самих инженеров-разработчиков. Различные модификации основной схемы АЦП, естественно, будут приводить к некоторой модификации алгоритма функционирования основной схемы АЦП. Прежде чем составить аналитическое представление алгоритма работы АЦП, рассмотрим основной вариант его структурной схемы с кратким описанием ее принципа действия. На рис. 1 изображена наиболее распространенная структурная схема АЦП 2. Приведем краткое описание принципа действия схемы. Входной аналоговый сигнал поступает на суммирующий вход аналогового сумматора, который совместно с аналоговым интегратором, сравнивающим устройством и одноразрядным 1-битовым цифроаналоговым преобразователем ЦАП, состоящим из -триггера с входами и и двухполярного источника образцового напряжения, выполняет так называемую функцию сигма-дельта-модулятора сумматора приращений. Непосредственно функция дельта-модуляции реализуется и -триггером. Выходной импульсный сигнал триггера с заданной тактовой частотой параллельно поступает на цифровой фильтр и в цепь обратной связи, включающей 1-битовый ЦАП, управление полярностью которого осуществляется выходным сигналом -триггера. Таким образом, частота переключения полярности 1-битового ЦАП, образующего цепь отрицательной обратной связи, зависит от частоты переключения -триггера, т. е. от тактовой частоты . Выходной сигнал ЦАП, уровень которого совпадает с заданным диапазоном преобразования сигнала, фактически непосредственно участвует в организации уравновешивающей величины. Сама уравновешивающая величина формируется интегратором в темпе с поступлением тактовой частоты . Таким образом, чем выше тактовая частота, тем за меньшее время устанавливается приращение сигнала на интеграторе . Сигнал с выхода ЦАП, согласно схеме, вычитается из входного сигнала, и результат вычитания снова поступает на вход интегратора . Структурная схема, изображенная на рис. 1, по принятой разработчиком классификации, отображает архитектуру АЦП первого порядка. Порядок модулятора определяется числом задействованных в его схеме сумматоров и, как следствие, интеграторов. Сигма-дельта модуляторы -го порядка содержат сумматоров и интеграторов и по логике работы схемы должны обеспечивать большее соотношение сигналшум при той же частоте отсчетов, по сравнению с модуляторами первого порядка. Применяют сигма-дельта модуляторы высокого порядка, например, в одноканальном АЦП седьмого порядка, реализованном в микросхеме AD7720, и двухканальном АЦП пятого порядка, выполненном в микросхеме ADMOD79. В соответствии с релятивным описанием работы АЦП по представленной структурной схеме аналитическая запись алгоритма функционирования АЦП с модуляторами первого порядка имеет адекватное нелинейное описание в виде следующего отображения 1 Выполняя интегрирование в 1 с учетом того, что выражение в фигурных скобках не зависит от времени пренебрегая конечной частотной полосой пропускания интегратора, получаем 2 или 3 где и 1 значение физической величины, например напряжения, которое накапливается на интеграторе за период тактовой частоты, 0 1, если 0 . В общем случае выражения 2 и 3 можно объединить в виде 4 где, 1 нелинейная функция, описывающая характер отклонения входного сигнала от уравновешивающей величины. Конкретный вид данной функции раскрыт выше. Причем слабое влияние полосы пропускания интегратора на формирование сигнала нелинейной отрицательной обратной связи обусловлено наличием двух нелинейных элементов сравнивающего устройства и триггера, при этом срабатывание сравнивающего устройства практически не зависит от уровня приращения сигнала на его входе. С учетом известного равенства, связывающего индикаторную и знаковую функции получаем следующее эквивалентное аналитическое отображение алгоритма работы АЦП 5 где . Прежде чем перейти к исследованию полученных алгоритмов, целесообразно отметить, что данные алгоритмы в соответствии с принятой в математике терминологией относятся к нелинейным итерационным уравнениям или более кратко отображениям 1117. Следовательно, с технической точки зрения, заданные в явном виде отображения как раз и определяют закономерности функционирования рассматриваемого устройства, прибора или системы, т. е. алгоритмы их работы. Переход к математической форме описания алгоритма функционирования и идентификация принадлежности его к соответствующему классу математических объектов позволяют применить по ходу изложения статьи с необходимыми дополнениями и пояснениями относительно рассматриваемого случая исследования тот богатый арсенал идей, терминологии, методов исследования и других атрибутов, которые накоплены в математике в области нелинейной динамики. Такой подход к исследованию алгоритмов работы АЦП, несмотря на имеющийся уже достаточно большой исторический период, связанный с созданием и исследованием АЦП и их алгоритмов см., например, работы 9, 10, 1824, далеко не традиционен и не очевиден и именно поэтому требует введения дополнительных понятий и пояснений. В дальнейшем термины алгоритм, отображения, итерационные уравнения в конечных разностях или просто уравнения будут пониматься как синонимы. Математическое представление 3 алгоритма АЦП первого порядка инициирует предварительное рассмотрение алгоритма следящего АЦП, заданного в виде 6 где 2 величина кванта. Этот алгоритм подробно исследован автором 24 с учетом воздействия помех относительно традиционными методами. Отметим, что алгоритм 6 представляет собой типичный пример одномерного нелинейного отображения, куда входит значение входного сигнала в виде некоторого параметра. При визуальном сравнении алгоритмов 3 и 6 возникает невольно ощущение, что появление алгоритма АЦП является продуктом эволюции алгоритма следящего АЦП. Фактически алгоритм 3, если принять точку зрения теории генетических алгоритмов 25, является мутантом алгоритма следящего АЦП, поскольку выполняет функцию аналого-цифрового преобразования на другом качественном уровне параметрического и временного усреднения с признаками следящего алгоритма аналого-цифрового преобразования и экспоненциального алгоритма усреднения 26. Особенностью и общностью всех алгоритмов аналогоцифрового преобразования, обладающих всеми признаками нелинейных отображений, является следующее наличие нелинейной функции сравнения область изменения параметра строго ограничена диапазоном преобразования число итераций, т. е. число операций сравнения, конечно и определяется способом выполнения операции сравнения параллельным, параллельно-последовательным и последовательным и числом разрядов решение уравнений, описывающих алгоритмы, при заданном числе итераций должно оказаться в некоторой окрестности установленного значения параметра значения входного сигнала, т. е. фактически данная окрестность представляет собой аттрактор 1117. С точки зрения метрологии, указанная в последнем пункте окрестность как раз и определяет погрешность аналого-цифрового преобразования. Поэтому очень важно количественно связать свойства алгоритма с некоторыми характеристиками данной окрестности или аттрактора, подразумевая при этом, что специфика построения алгоритма аналого-цифрового преобразования предусматривает решенным вопрос его сходимости в заданную окрестность. Однако, как это будет показано ниже, для алгоритма АЦП эта задача далеко не тривиальна и, как представляется, именно при исследовании сходимости данного алгоритма применение идей нелинейной динамики наиболее плодотворно. Для лучшего представления о возможностях использования идей нелинейной динамики исследуем свойства следящего алгоритма 6, начав с предварительного анализа переходного процесса, связанного с поиском его решения при отсутствии помех. Пусть для начального значения уравновешивающей величины выполняется равенство 0 0, тогда при 1 и 0 имеем 1 . Для 2 и имеем 2 2 и т. д. Пусть для выполняется равенство, а для 1 получаем 1 1 . Следовательно, согласно алгоритму, при следующих итерациях уравновешивающая величина, соответствующая решению уравнения 6, на каждом такте будет изменяться относительно значения на величину и, таким образом, она будет равна входному сигналу с точностью до кванта и, с точки зрения нелинейных отображений, образует аттрактор. Аттрактор, представляющий в виде псевдофазового портрета 17 в дальнейшем просто фазового портрета финальную траекторию уравновешивающей величины при бесконечном увеличении числа итераций, периодичен рис. 2. При дальнейшем анализе для упрощения формул положим величину временного шага 1. Это допущение никак не влияет на общие результаты анализа. Рассмотрим другой подход к анализу алгоритма 6. Поскольку уравновешивающая величина при достаточно большом числе итераций стремится с точностью до кванта к фиксированному значению параметра, то представим этот параметр в виде двоичного кода с погрешностью усечения, т. е. где 0 есть случайная величина с равномерным законом распределения вероятностей погрешность квантования или усечения. Тогда алгоритм 6 можно представить в виде отображения Усредним полученное отображение по случайной величине, в результате перейдем к следующему эквивалентному усредненному отображению где функция распределения погрешности усечения. Для этого отображения нетрудно определить так называемую особую или неподвижную точку 1117 усредненного алгоритма из уравнения Ввиду симметричности функции распределения вероятностей приходим к выводу, что решение данного уравнения будет достигаться при равенстве т. е. неподвижная точка соответствует случаю, когда уравновешивающая величина равна двоичному эквиваленту входного сигнала. Пусть теперь будем учитывать влияние аддитивной помехи, тогда алгоритм 6 преобразуется к виду 7 и динамика решения алгоритма 7 будет повторять динамику решения алгоритма 6, пока разность между сигналом и уравновешивающей величиной не будет соизмерима с уровнем помехи, т. е. когда решение отображения 7 не достигнет области аттрактора. В этом случае при многократном повторении алгоритма с одним и тем же значением входного сигнала независимо от начального значения уравновешивающей величины его реализации траектории решения от преобразования к преобразованию будут отличны друг от друга. Согласно алгоритму 7, при последующих итерациях уравновешивающая величина будет иметь другой фазовый портрет, отличный от портрета, приведенного на рис. 2, и, следовательно, другую форму аттрактора. Этот фазовый портрет для погрешности преобразования представлен в трехмерном фазовом пространстве рис. 3. По существу, учет аддитивной помехи приводит, с математической точки зрения, к случайному изменению параметра алгоритма при фиксированном входном сигнале. Если это изменение ограничено и происходит в заданном диапазоне, то в связи с устойчивостью алгоритма в целом оно не должно существенно влиять на конечный результат преобразования. Однако картина может измениться, если помеха на верхней и нижней границах диапазона выведет значение параметра за заданные пределы. Именно устойчивость алгоритма в целом приводит к заметному эффекту помехоподавления данного типа алгоритмов, если среднеквадратическое отклонение СКО помехи превышает величину кванта. Чтобы убедиться в этом, для сравнения с фазовым портретом уравновешивающей величины приведен фазовый портрет гауссова шума, представляющего собой аддитивную помеху рис. 4. Отметим попутно, что приведенный на рис. 4 фазовый портрет помехи выявляет его хорошие статистические свойства, в частности, свойство независимости. Сравнение фазовых портретов по геометрическим параметрам см. рис. 24 демонстрирует их качественное различие. Фазовые портреты дают интегральный образ характера поведения уравновешивающей величины как решения соответствующего отображения алгоритма с учетом влияния различных дополнительных факторов. В принципе по геометрическим параметрам фазового портрета можно получить определенные количественные оценки исследуемого объекта, включая оценки его метрологических характеристик, учитывающих влияние различных дополнительных факторов. Для иллюстрации сказанного приведем в матричной форме фазовые портреты помехи и погрешности преобразования следящим алгоритмом при воздействии помехи рис. 5. На рисунке наглядно представлена трансформация фазового портрета помехи в фазовый портрет погрешности преобразования отражена в этом же виде зависимость помехи и погрешности преобразования при фиксированном значении входного сигнала отчетливо просматривается эффект взаимодействия помехи и погрешности преобразования, приводящий к определенной упорядоченности исходного фазового портрета помехи. Однако традиционно в метрологии количественную оценку соответствующих свойств аттрактора выполняют по первым двум моментам, т. е. по математическому ожиданию и дисперсии, и значительно реже по другим вероятностным характеристикам, например плотности распределения вероятностей. Для алгоритма следящего АЦП данные вероятностные характеристики можно получить в аналитической форме. Подробные аналитические преобразования при выводе этих характеристик, кроме плотности распределения вероятностей, сделаны в приложении к статье. Методология нахождения математического ожидания отображения 7 заключается в следующем. Усредним правую и левую части отображения 7 по помехе. В результате усреднения получим новое отображение, эквивалентное в установленном смысле исходному отображению 7 8 где и усредненные по помехе значения уравновешивающей величины на -м и 1-м тактах итерации. Помеха, как правило, имеет гауссов закон распределения вероятностей с нулевым средним и, тем самым, симметрична относительно нуля. Поэтому после вычитания из входного сигнала значений правой и левой частей итерационного алгоритма 8 с последующим линейным приближением функции распределения вероятностей в малой окрестности неподвижной точки приходим к следующему линейному приближению 8 9 или Далее, учитывая, что а получаем из 9 10 где и 1 1. Поскольку, как было показано выше, для определенного значения числа итераций до выхода в стационарную точку уравновешивающая величина в алгоритме 7 изменяется линейно, то при достижении разности, например, для величины, при которой она становится соизмеримой с уровнем помех, начинает действовать условие сходимости, описываемое отображением 9. Применяя правило трех сигм для определения начального значения итерационного уравнения 9, получаем для разность 3 . Следовательно, выполняя последовательно итерации в 10 для 1, 2, при начальном значении 3, приходим к решению Пусть, тогда после упрощения получаем 11 Обычно значение параметра таково, что поэтому выражение 11 можно представить в приближенной, но более наглядной форме записи 12 Из равенства 12 следует, что переходный процесс и, следовательно, его математическое ожидание в условиях воздействия помех экспоненциально стремится к нулю с ростом числа итерации. Применяя аналогичный подход, можно получить оценку дисперсии погрешности. При этом см. приложение с учетом равенства нулю математического ожидания финальная или предельная при достаточно большом числе итераций дисперсия погрешности преобразования при воздействии определяется по формуле Если взять отношение полученной дисперсии к дисперсии помехи то из формулы следует, что эффект подавления помехи возникает при условии, что 0,6267. Следовательно, для подавления помехи с фиксированным значением СКО желательно брать величину кванта как можно меньше. Иллюстрация эффекта подавления помехи алгоритмом следящего АЦП хорошо просматривается на рис. 6, где представлены по результатам имитационного моделирования в одном и том же масштабе гистограммы погрешности преобразования в присутствии помех и самой помехи с гауссовым законом распределения вероятностей с указанием соответствующих средних и СКО. Аналитическая запись алгоритма работы АЦП, как отмечалось выше, позволяет сравнить его со следящим алгоритмом. Так, сравнение алгоритмов 3 и 7 показывает их аналитическую идентичность с, казалось бы, совсем незначительными отличиями. В частности, это отличие заключено в множителе перед знаковой функцией и в наличии дополнительного слагаемого . Поэтому можно было бы предположить, что и динамические свойства данных алгоритмов будут в какойто степени идентичны. Действительно, как это будет следовать из дальнейшего анализа, вид и, соответственно, аналитическая форма представления переходного периода у обоих алгоритмов совпадают. Заметим, что отличие в множителе, стоящем перед знаковой функцией, заключается в его размерности, так как в алгоритме 3 множитель имеет размерность вольт на секунду. Поэтому следует утверждение, что чем выше частота, тем меньше величина множителя . Если выбрать частоту, равную 2, то получаем для 2 почти полную идентичность следящего алгоритма и алгоритма работы АЦП первого порядка, отличающуюся только зависимостью в последнем приращении уравновешивающей величины на каждом шаге итерации от уровня входного сигнала. В следящем алгоритме уравновешивающая величина изменяется кратно величине кванта, а в алгоритме АЦП, согласно отображению 13 уравновешивающая величина изменяется в зависимости от величины входного сигнала пропорционально величине, где 2 и . Наличие второго параметра в отображении 13 в виде дополнительного слагаемого существенно изменяет фазовый портрет. Причем геометрическая форма аттрактора меняется в зависимости от изменения входного сигнала, т. е. параметра отображения, и тем самым форма аттрактора в отличие от просто следящего алгоритма несет информацию о величине входного сигнала. Как будет показано в части 2 статьи, изменение формы аттрактора дает новое качество алгоритму, следствием которого является значительное улучшение метрологических характеристик АЦП. Вычислим условное математическое ожидание следящего алгоритма без учета аддитивной помехи при условии, что входной сигнал принимает значение, где погрешность усечения. Выполним для этого значения входного сигнала усреднение по случайной погрешности усечения правой и левой частей алгоритма после вычитания справа и слева фиксированного значения входного сигнала в установившемся режиме, т. е. после переходного процесса. В результате получим для наглядности оставим значение временного такта, принимающего любую величину где 0, причем изменяется по равномерному закону с плотностью распределения вероятностей 1, 1 1 разность кодовых эквивалентов на -м и 1-м тактах итерации, при этом начальное значение для шага итерации 0 определяется в соответствии с равенством 0 0. В переходном режиме для всех знаковая функция равна единице, а после окончания переходного режима при с точностью до кванта . Поэтому математические ожидания соответствующих значений разностей находятся из равенств с учетом того, что функция распределения погрешности усечения в нуле равна 12. Таким образом, для неподвижной точки математическое ожидание погрешности преобразования следящим алгоритмом в отсутствие помехи равно нулю. Рассмотрим условие сходимости при воздействии аддитивной помехи, причем, помеха не зависит от номера такта итерации. В этом случае в результате аналогичных действий получаем так как . Представим математические ожидания разностей и 1 в виде тогда В результате при условии, что 2 0 1. Средний квадрат разности следящего алгоритма без учета воздействия аддитивной помехи определяется следующим образом. Пусть разность 1 равна погрешности усечения, т. е. итерационный процесс вышел в неподвижную точку и разность между уравновешивающей величиной и входным сигналом равна погрешности усечения, тогда Заметим, что поэтому Поскольку для погрешности усечения выполняется равенство то Учитывая, что окончательно получаем для среднего квадрата методической погрешности преобразования равенство В анализируемом случае усреднение осуществляется только по погрешности квантования, соответствующей погрешности усечения, поэтому здесь должен учитываться тот факт, что при выходе алгоритма 3 в стационарную точку для разности справедливо равенство 1 1 . Так как эта погрешность распределена равномерно в интервале, то ее средний квадрат равен 3. Рассмотрим вариант оценки среднего квадрата с учетом воздействия помехи при учете равенств 1 1 и, . Зафиксируем значение входного сигнала с точностью до погрешности квантования. Тогда итерационное уравнение при вычитании справа и слева погрешности усечения можно представить в виде Заметим, что и При достижении разности, например для, определенной величины, при которой она становится соизмеримой с уровнем помех, начинает действовать условие сходимости, описываемое отображением 9. Применяя правило трех сигм для определения начального значения итерационного уравнения 9, получаем для разность 3 . Следовательно, выполняя последовательно итерации для 1, 2, при начальном значении 3, приходим к решению и поскольку 4 0 1. Следует заметить, что в общем случае суммарная погрешность имеет не совсем симметричную функцию распределения вероятностей, тем не менее, она достаточно близка к симметричной функции. Поэтому погрешность используемого линейного приближения функции распределения допустима для технических расчетов. 