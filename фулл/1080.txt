ПОВЫШЕНИЕ ЗАЩИТЫ ПРОТОКОЛОВ РАСПРЕДЕЛЕНИЯ  КЛЮЧЕЙ ОТ АТАК ВТОРЖЕНИЯ В СЕРЕДИНУ КАНАЛА СВЯЗИ 

Постановка проблемы:  алгоритм Диффи — Хеллмана широко применяется во многих протоколах распределения  ключей, в том числе в протоколах IP-телефонии. Однако протокол является неустойчивым к атаке активного нарушителя  в канал связи, что приводит к компрометации выработанного ключевого материала. Целью работы является разработка  методов повышения защиты протоколов распределения ключей, основой которых является протокол Диффи — Хеллмана.  Методы:  исследованы особенности распространения пакетов между узлами глобальной сети Интернет в разных  городах при использовании нескольких провайдеров связи.  Результаты:  выполнены оценки вероятностей совпадения  пар и троек маршрутов в глобальной сети между разными городами при подключении через нескольких операторов  связи. Изложен подход к повышению защищенности протоколов распределения ключей при помощи параллельной  передачи сообщений по независимым каналам связи для случая, когда корреспонденты не имеют общего секрета.  В работе приведены методы обнаружения и снижения влияния действий нарушителя на работу протоколов распределения ключей. Представлены оценки вероятностей успешной атаки, обнаружения атаки активного нарушителя, успешной  генерации общего секрета.  Практическая значимость:  результаты исследований позволяют повысить безопасность  существующих протоколов распределения ключей. Ключевые слова  — криптографические протоколы, протоколы распределения ключей. 

Схема распределения ключей Диффи Хеллмана, лежащая в основе многих криптографических протоколов, получила широкое распространение среди схем распределения ключей между корреспондентами и позволяет корреспондентам выработать общий секретный ключ для симметричного шифрования данных. Данная схема является основой безопасного распределения ключевого материала для протоколов обеспечения безопасности IP-телефонии ZRTP 13, MIKEY 4, DTLS 5 и др. Вместе с тем схема Диффи Хеллмана может быть полностью компрометирована активным нарушителем при реализации атаки вторжения в середину канала связи. Поэтому при реализации алгоритма распределения ключей необходимо обеспечить подлинность сообщений протокола 6. С этой целью схему Диффи Хеллмана обычно реализуют в защищенном канале передачи данных, для которого невозможно выполнить подмену передаваемых сообщений 7, 8. При этом для аутентификации передаваемых сообщений, как правило, используют цифровые сертификаты. Однако в случае необходимости выработки общего секретного ключа корреспондентов, которые не имеют общего доверенного удостоверяющего центра, требование обеспечения аутентичности сообщений протокола Диффи Хеллмана не обеспечивается. В настоящее время наличие у одного корреспондента двух и более подключений к транспортной сети является обычным явлением. Для обнаружения нарушителя предлагается модифицировать протокол распределения ключей так, чтобы выполнять обмен сообщениями с использованием нескольких каналов связи одновременно. Рассмотрим ситуацию, когда корреспонденты, имеющие по два или более подключений к транспортной сети, пытаются установить защищенное соединение IP-телефонии без участия посредников. Подключения выполняются через разных операторов связи с различными публичными IPадресами для каждого из сетевых подключений. Для организации защищенного соединения корреспонденты обмениваются IP-адресами, создавая два или более виртуальных каналов. При выполнении протокола, как показано на рис. 1, передаются одинаковые сообщения по каждому из каналов. При этом респондент, получив сообщения, проверяет их на совпадение. Если обнаружено несовпадение имеет место атака MITM Man in the Middle в одном из каналов 9, 10. Респондент отвечает, отправляя по двум каналам связи ответные сообщения. Инициатор получает сообщения и выполняет аналогичную проверку. Если сообщения одинаковые, значит либо отсутствует активный нарушитель в двух каналах связи, либо присутствует активное воздействие одного нарушителя на оба канала связи одновременно. Очевидно, что подготовка к атаке вторжения требует значительных ресурсов нарушителя, поэтому вероятность вторжения в несколько каналов меньше, чем вероятность вторжения в один из каналов. Наиболее критична ситуация, когда трассы используемых каналов в некоторых узлах сходятся, поскольку нарушитель, атакуя такой узел, может воздействовать на все каналы. При модификациях протокола распределения ключей, заключающихся в использовании нескольких каналов связи, возрастает актуальность оценки вероятностей успешной атаки MITM, обнаружения атаки MITM и успешной генерации общего секрета. Введем вероятность того, что нарушитель выполняет атаку MITM в одном из каналов. Под успешной атакой на модифицированный протокол будем понимать событие успешной атаки MITM в каждом из каналов. Это возможно в том случае, когда один и тот же нарушитель контролирует используемые каналы и может выполнять синхронную модификацию сообщений в каждом из каналов. Тогда вероятность успешной атаки соответствует модификации сообщений в двух каналах связи одновременно . Обнаружение нарушителя определим как событие несовпадения сообщений протокола в различных каналах. Вероятность обнаружения нарушителя для двухканальной схемы соответствует вероятности нахождения нарушителя в одном канале связи при отсутствии в другом 21 . Успешная выработка ключа возможна только в случае необнаружения нарушителя ни в одном канале связи. Однако совпадение сообщений возможно и в том случае, когда нарушитель присутствует в обоих каналах и производит согласованную подмену сообщений. Поскольку эти события несовместны, вероятность успешной выработки ключа равна разности вероятностей отсутствия и присутствия нарушителя в обоих каналах 1 1 2 . Следует отметить, что необходимость синхронной модификации сообщений в двух каналах связи требует от нарушителя дополнительных ресурсов по сравнению с модификацией сообщений по отдельности в каждом из каналов связи. Пусть по трем каналам связи будут передаваться одинаковые сообщения схемы Диффи Хеллмана, тогда результатом работы протокола является одно из нескольких событий 1 все принятые сообщения совпадают 2 одно сообщение отличается от других 3 все сообщения разные. В первом случае протокол не обнаруживает нарушителя. Во втором случае протокол позволяет обнаружить нарушителя без определения атакованного канала или определить такой канал и исключить его при формировании ключа. В третьем случае атака обнаруживается, но атакованные каналы не идентифицируются. Поэтому возможно выделить два режима работы протокола с обнаружением и исключением нарушителя. При работе в режиме нарушителя протокол завершается с ошибкой, уведомляя пользователя о наличии нарушителя в канале связи. В случае работы в режиме нарушителя при обнаружении отличий в одном из сообщений протокол уведомляет о наличии нарушителя в конкретном канале связи, при этом он продолжает работу и учитывает сообщения лишь из тех каналов связи, где не обнаружен нарушитель. Вероятность правильного исключения нарушителя для трехканального протокола соответствует событию нахождения нарушителя в одном из каналов связи при его отсутствии в двух других 3 1 . При воздействии нарушителя одновременно на два канала связи из трех возможных, с синхронной модификацией сообщений механизм исключения может вызвать некорректное определение канала с нарушителем, что приведет к ошибочному выбору надежных каналов. Это позволит нарушителю успешно выполнить обмен ключами с корреспондентами, осуществив атаку MITM. Вероятность ошибочного исключения соответствует вероятности события, что нарушителем выполнена одновременная подмена сообщений сразу в двух каналах связи 3 1 . Вероятность успешной атаки соответствует вероятности того, что нарушитель перехватил и выполнил модификацию сообщений сразу в трех каналах одновременно . Определим вероятность обнаружения нарушителя . Вероятность наличия нарушителя в одном из каналов при отсутствии нарушителя в двух других каналах связи 31 . Вероятность наличия нарушителя в двух каналах при отсутствии нарушителя в третьем равна 31 31 31 . Вероятность успешного формирования общего ключа для трехканального протокола в режиме обнаружения нарушителя соответствует вероятности отсутствия нарушителя в трех каналах связи. Следовательно 1 . Вероятность успешной атаки соответствует вероятности события перехвата и модификации сообщений нарушителем в двух или трех каналах связи одновременно, которая равна 31 . Вероятность обнаружения нарушителя соответствует вероятности нахождения нарушителя в одном канале связи при отсутствии нарушителя в двух других каналах связи. Вероятность наличия нарушителя в одном из каналов связи при отсутствии нарушителя в двух других каналах связи будет иметь вид 31 . Вероятность успешного формирования общего ключа соответствует вероятности отсутствия нарушителя в двух или трех каналах связи. Следовательно 1 31 . Зависимости рассмотренных вероятностей от вероятности успешной подмены сообщений в одном из каналов связи для исходного протокола и модифицированного в двухи трехканальном варианте показаны на рис. 2, . Структура глобальной транспортной сети описана в различных источниках 11. Маршрутизация пакетов осуществляется динамическими протоколами и зависит от многих параметров 12. Предположим, что структура глобальной сети является случайной. Максимальное число групп независимых маршрутов определяется соотношением где число начальных точек маршрутов число удаленных точек маршрутов количество независимых маршрутов, сравниваемых для анализа числа совпадений. Для трассировки маршрутов от начальной до удаленной точки использовались программноаппаратные средства, состав и конфигурация которых остается за рамками данной работы. В результате сравнения маршрутов было получено число пар и троек непересекающихся маршрутов, а также количество маршрутов, на которых встречались общие точки. При сравнении троек маршрутов дополнительно оценивалось число маршрутов без общих точек, а также число троек маршрутов с одной, двумя или тремя общими точками. Итоговые данные эксперимента представлены в таблице. Из общего числа пар маршрутов 2478 в 122 обнаружены совпадения. Таким образом, только 4,4 из всех возможных пар имели общие точки. В результате эксперимента не обнаружено городов, к которым все подходящие пары маршрутов имели бы общую точку. Использование двух или трех каналов связи, предоставляемых разными операторами связи, позволяет с большой вероятностью организовать независимые каналы, не имеющие общих точек, и существенно уменьшить вероятность необнаруженного вторжения. Модификация протокола для работы по нескольким независимым каналам существенно уменьшает вероятность успешной атаки MITM. Эффективность защиты возрастает с увеличением числа независимых каналов. Исследования показывают, что при подключении корреспондентов к нескольким операторам связи независимые двойки и тройки маршрутов имеются всегда. Вероятность успешного формирования общего ключа в многоканальной схеме с обнаружением нарушителя уменьшается незначительно. В схеме с исключением нарушителя данная вероятность увеличивается, но при использовании трасс большой протяженности возможно совпадение узлов прохождения маршрутов, что может снизить эффективность работы модифицированного протокола. 