СУБОПТИМАЛЬНАЯ ЗВЕЗДЧАТАЯ СТРУКТУРА  АЛГЕБРАИЧЕСКОЙ БАЙЕСОВСКОЙ СЕТИ 

1 Выделен подкласс минимальных графов смежности — звездчатые графы смежности. Доказано, что множество таких графов содержит оптимальные вторичные структуры, т. е. графы смежности с минимальным диаметром. Представлен алгоритм синтеза такого множества. На основе этого предложен способ ускорения синтеза  оптимальной вторичной структуры алгебраической байесовской сети. Ключевые слова  — алгебраическая байесовская сеть, звездчатый граф, обучение глобальной структуры,  граф смежности, машинное обучение, субоптимальная вторичная структура.  

Алгебраическая байесовская сеть АБС активно развивающаяся теоретико-компьютерная модель, относящаяся к классу логико-вероятностных графических моделей, которая позволяет использовать как скалярные, так и интервальные оценки вероятности для представления неопределенности 16. АБС может быть применима как одна из математических моделей анализа информационной безопасности 7, в частности, для оценки защищенности системы от социо-инженерных атак 8. Кроме того, АБС могут применяться в задаче распознавания изображений 9 традиционной области, в которой используются вероятностные графические модели 10. Обработка интервальных оценок также оказывается востребованной в анализе гранулярных данных о рекордных интервалах между последними эпизодами 11. Известные алгоритмы глобального логико-вероятностного вывода для АБС опираются на ее вторичную структуру, которая представляет собой граф, построенный над ее первичной структурой 1, 2, 6, 12. Первичная структура АБС в свою очередь представляет собой набор математических моделей фрагментов знаний далее фрагментов знаний сложным образом устроенном представлении случайных элементов. Вторичной структурой могут выступать только особые графы минимальные по числу ребер графы смежности 6, 1214, формальное определение которых будет дано в следующем разделе. В силу специфики алгоритмов логиковероятностного вывода, предложенных в работах 1, 2, 6, 12, одной из важных характеристик минимальных графов смежности является их диаметр. Глобальное обучение АБС 15 это один из видов машинного автоматического обучения, развитие методов, моделей и алгоритмов которого одна из самых актуальных задач в искусственном интеллекте 6, 16, 17. В рамках задачи обучения глобальной структуры было бы желательно строить графы смежности с минимальным диаметром 18. Следует отметить, что кроме минимальности диаметра существуют и другие требования 18, поэтому минимальные графы смежности с минимальным диаметром являются оптимальной вторичной структурой. Построение минимального графа смежности, одновременно минимального по диаметру, возможно за счет построения всего множества минимальных графов смежности и выбора из него графа с минимальным диаметром. В рамках данной работы мы рассмотрим звездчатые графы особый класс минимальных графов смежности, который, как будет показано, характеризуется тем, что множество звездчатых графов смежности содержит в себе некоторые минимальные графы смежности с минимальным диаметром. Мощность этого множества меньше, чем мощность множества всех минимальных графов смежности, поэтому поиск минимального графа смежности с минимальным диаметром в таком множестве будет быстрее. Будет также предложен алгоритм синтеза указанного множества, который благодаря свойствам звездчатых графов отличается от алгоритма синтеза множества всех минимальных графов смежности лишь небольшими изменениями. В качестве вторичной структуры АБС выступает минимальный по числу ребер граф смежности. Дадим необходимые понятия, следуя введенной в работах 13, 14, 19 терминологии. граф, без петель, на вершинах и ребрах которого задана функция нагрузки множество значений которой состоит из подмножеств некоторого алфавита причем двух вершин называется пересечение их нагрузок. В согласованном нагруженном графе, как видно из определения, вес ребра равен сепаратору его концов. Множество сепараторов для данной первичной структуры обозначим как Separator. Две вершины называются если их сепаратор непуст. между двумя вершинами согласованного нагруженного графа это такой ненаправленный путь между ними, на котором нагрузка любой его вершины содержит сепаратор исходных вершин. Согласованный нагруженный граф магистрально связен, если между каждой парой сочлененных вершин существует магистральный путь, но не обязательно ребро. это магистрально связный согласованный нагруженный граф, ребра в котором возможны только между сочлененными вершинами т. е. нагрузка ребер непуста. минимальный по числу ребер граф смежности. В рамках исследования графов смежности вместо математических моделей фрагментов знаний достаточно сложных конструкций, описание которых можно найти в работах 5, 6 обычно рассматривается база таких моделей подалфавиты некоторого алфавита Набор таких подалфавитов PS образует разбиение, причем подалфавиты не поглощают друг друга и Введенный таким образом PS задает значения функций нагрузки либо просто нагрузку для вершин графа. Задачей глобального обучения вторичной структуры АБС является построение минимального графа смежности для заданного множества вершин именно на них осуществляются алгоритмы логико-вероятностного вывода. Далее необходимо ввести систему терминов, связанную с синтезом множества минимальных графов смежности, поскольку при помощи нее будут определены звездчатые графы смежности. Будем следовать работам 13, 19, 20. Для каждого сепаратора определим множество его является сыном сепаратора тогда и только тогда, когда и . Другими словами, если на множестве сепараторов задать частичный порядок, индуцированный отношением включения, то сыновья для сепаратора будут множеством его последователей в терминах теории частично-упорядоченных множеств. Множество сыновей сепаратора будем обозначать как Sons . Сужение согласованного нагруженного графа на подалфавит это ненаправленный граф, в который входят только те вершины и ребра исходного графа, нагрузки которых содержат или равны, . Сильное сужение сужение на сепаратор, из которого удалили все ребра c нагрузкой, . Рассмотрим граф смежности Сильное сужение разбивается на компоненты связности, которые называются для нагрузки их будем обозначать как Holdings . Вершина, которая образует одноэлементное владение для нагрузки, называется для этой нагрузки. Известно, что множество вершин во владении для нагрузки является либо множеством вершин, входящим в сужение на какого-либо ее сына, либо объединением таких множеств, либо доменной вершиной. Жила с нагрузкой набор ребер с нагрузкой, число которых равно числу владений для нагрузки уменьшенному на единицу, а граф, полученный добавлением к ребер из, является связным 1 2 3 граф связен. В определенном смысле жила является деревом на владениях строгая формализация этого рассуждения, не требующаяся в данной работе, приведена в работах 13, 14. 13, 14. Граф смежности является минимальным тогда и только тогда, когда множество ребер каждого значимого веса является в нем жилой. Теорема о минимальных графах смежности создает основу для конструктивного представления множества минимальных графов смежности как декартова произведения множеств жил, построенных для каждого сепаратора. Последнее лежит в основе алгоритмов синтеза такого множества, схема которого будет приведена ниже. Введем теперь определение звездчатого графа смежности. называется дерево, одна из вершин которого является концом каждого ребра. Такая вершина называется а диаметр такого графа равен двум. Верно также и то, что любое дерево с диаметром, равным двум, является звездой. будем называть граф, в котором каждая жила является звездой. Поскольку звезда является деревом, то, согласно теореме о минимальных графах смежности, звездчатый граф смежности является минимальным. будем называть такой минимальный граф смежности, что 1 любая его жила является звездой 2 концы любого ребра в любой жиле c нагрузкой являются либо доменными вершинами для этой нагрузки, либо центрами жилы с нагрузкой, Sons . В жиле графа смежности не существует трех вершин, попарно соединенных ребрами одного веса. Пускай существуют три такие вершины, попарно соединенные ребрами одной жилы. Они входят не более чем в три разных владения. По определению, в жиле число ребер на единицу меньше, чем число владений. Владения, в которые входят эти вершины, соединенные тремя ребрами, представляют компонент связности. Рассмотрим другое владение. Укажем ребро, которое соединяет его с указанным компонентом связности. Добавим это владение и это ребро к уже рассмотренным компонентам связности. Будем повторять эту операцию со всеми владениями, добавляя каждое из них вместе с ребром к компоненту связности. Когда мы станем рассматривать последний компонент связности, то окажется, что мы рассмотрели уже достаточное для жилы число ребер, ни одно из которых не соединяет это владение с оставшимися. Следовательно, предположение неверно. Существует минимальный граф смежности c минимальным диаметром, который является звездчатым. Рассмотрим произвольный минимальный граф смежности с минимальным диаметром и будем последовательно преобразовывать его к звездчатому графу. Для этого рассмотрим произвольную жилу графа В ней рассмотрим все кратчайшие пути между двумя вершинами в, длина которых максимальна среди таких путей и по определению равна диаметру, которые содержат ребра веса . Множество таких путей обозначим как Shortest . Выберем произвольный путь из Shortest, возьмем какой-либо из двух его концов назовем его и будем последовательно рассматривать вершины начиная с выбранного конца. Первую вершину, из которой выходит ребро нагрузки, обозначим Последнюю вершину, в которую входит ребро нагрузки, обозначим . Другой конец пути обозначим Вершины и будем называть Если бы мы обходили путь в обратном направлении, то ворота остались бы прежними, поменялся бы лишь порядок их прохода. По построению все ребра нагрузки, принадлежащие пути, принадлежат и пути между и Ненаправленные пути между и и между и будем называть Тупики не содержат ребер с нагрузкой . Тупику мы можем однозначно сопоставить ворота, являющиеся его концом. Теперь будем для каждого сепаратора менять жилу соответствующей нагрузки на жилу, являющуюся звездой на самом деле, семейство таких жил, таким образом, чтобы не увеличить диаметр. Пускай мы на данном шаге выбрали сепаратор . Рассмотрим множество тупиков для данного сепаратора, среди них выберем один наибольшей длины. Выбранный тупик обозначим, а его длину . Ворота тупика сделаем центром звезды, соединяя ее ребрами нагрузки с произвольными вершинами из других владений. Рассмотрим, как изменилась длина кратчайших путей, содержащих ребра веса . Каждый такой путь состоял из двух тупиков например, длины и длины, и длина такого пути была не менее 1, поскольку этот путь должен содержать не менее одного ребра веса, которые не входят в эти тупики. Соответственно, любой путь, содержащий тупик, по построению содержит ровно одно ребро веса поэтому его длина не увеличилась. Предположим, что увеличилась длина кратчайшего пути, не содержащего т. е. ни один из тупиков и не совпадает с . Обозначим исходный путь, а получившийся . Ворота, соответствующие и, обозначим и . По построению длина равна 2, следовательно, длина была равна 1, следовательно, в между и было ребро. Согласно лемме, в не могло быть ребер одновременно между и, между и . Пускай ребра не было между и, следовательно, путь между ними состоял не менее чем из двух ребер. Следовательно, путь, включающий тупики и, в имел длину не менее 2, что в силу максимальности не меньше, чем 2, откуда следует, что не был максимальным по длине. Следовательно, замена жилы на звездчатую не изменит длины максимальных путей. Проведя замену жил для каждого сепаратора, мы придем к звездчатому графу смежности, диаметр которого не больше, чем диаметр рассмотренного минимального графа смежности с минимальным диаметром, а, следовательно, минимален. Звездчатые графы смежности представляют интерес, в первую очередь, потому, что синтез множества таких графов похож на синтез множества минимальных графов смежности, поскольку основан на конструктивном представлении таких графов. Сначала приведем схему алгоритма синтеза множества минимальных графов смежности. Следует указать, что подобных алгоритмов существует значительное число, но приведем лишь наиболее общий, а затем покажем, как за счет внесения небольших изменений можно привести его к алгоритму синтеза множества звездчатых графов смежности. Подобные изменения будут применимы и для любого другого алгоритма синтеза множества минимальных графов смежности. На вход такого алгоритма подается множество взаимно непоглощающих подалфавитов некоторого алфавита, соответствующих первичной структуре алгебраической байесовской сети. 1. Построить множество Separator, содержащее все сепараторы. 2. Для каждого сепаратора построить соответствующее ему сильное сужение, найти компоненты связности такого сильного сужения . 3. Для каждого набора таких владений перебрать все возможные деревья, построенные над владениями как над вершинами. 4. Для каждого такого дерева построить все возможные жилы, ребра в которых соединяют вершины из двух владений в том и только том случае, если подобные владения соединены ребром в . 5. Объединить все жилы, построенные для одного сепаратора, в множество . 6. Перебрать все возможные кортежи жил, выбранных по одной для каждого сепаратора. Согласно теореме о минимальных графах смежности, объединение жил в каждом кортеже является множеством ребер какого-то минимального графа смежности, причем каждому минимальному графу смежности соответствует один из кортежей подобного вида. Следовательно, будет построено множество минимальных графов смежности. Схема алгоритма синтеза множества звездчатых графов совпадает с приведенной выше схемой во всех шагах, кроме четвертого и пятого, поэтому приведем только их. 4. Для каждого набора построенных на шаге 3 владений перебрать все возможные звезды, построенные над владениями как над вершинами. 5. Для каждой такой звезды построить все возможные жилы, ребра в которых соединяют вершины из двух владений в том и только том случае, если подобные владения соединены ребром в, причем один из концов каждого ребра является одной и той же вершиной лежащей во владении, соответствующем центру . Результатом работы алгоритма станет множество звездчатых графов. Поскольку все известные алгоритмы синтеза множества минимальных графов смежности различаются в первых трех шагах, то каждый из них можно использовать в качестве основы для синтеза множества звездчатых графов смежности. В работе рассмотрен особый класс минимальных графов смежности звездчатых графов смежности, содержащий минимальные по диаметру графы смежности. При отсутствии точных алгоритмов построения минимального по диаметру графа смежности поиск такого графа эффективнее осуществлять не среди вообще всех минимальных графов смежности, а среди именно звездчатых графов смежности, которые выступают субоптимальными структурами, т. е. структурами, множество которых содержит оптимальные структуры. Таким образом, представленный в работе результат развивает теорию алгебраических байесовских сетей в срезе более общей проблемы синтеза интеллектуальных систем, основанных на вероятностных графических моделях, автоматического обучения глобальной структуры таковых. Для решения задачи синтеза графа смежности с минимальным диаметром необходимо предложить конструктивное описание таких графов. Исследования в этом направлении показывают, что, вероятно, минимальность диаметра не является локальным свойством, т. е. графы с минимальным диаметром не могут быть описаны через особого вида жилы минимальных графов смежности. Поэтому в рамках решения той же задачи актуален вопрос поиска подкласса минимальных графов смежности, который меньше, чем звездчатые графы смежности, но обладает описанным выше свойством локальности и содержит хотя бы один граф смежности с минимальным диаметром. Работа выполнена при поддержке РФФИ, гранты 12-01-00945-а и 12-01-31202-мола. 