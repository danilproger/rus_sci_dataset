ПРОГРАММА СИНТЕЗА И АНАЛИЗА  ИНТЕРФЕРЕНЦИОННЫХ ПОКРЫТИЙ FILM MANAGER 

Постановка проблемы:  задача синтеза интерференционных покрытий является необходимой и составной частью процесса разработки всех оптических элементов приборов оптотехники. Ее решение сопряжено со значительными трудностями, характерными для обратных задач, так как отсутствуют строго определенные методы. Целью исследования является создание  современного программного обеспечения, позволяющего комплексно решать эту  проблему, проектировать интерференционные покрытия с требуемыми свойствами.  Результаты:  разработано программное обеспечение Film Manager для синтеза и анализа устойчивости интерференционных оптических покрытий  различного назначения. Проектировщик может определить начальную структуру, методы оптимизации, пригодность  синтезируемого покрытия, пленкообразующие материалы из имеющейся базы данных. Проверка качества программного обеспечения проведена на примере синтеза ахроматических просветляющих покрытий в средней инфракрасной области спектра на подложках из кремния. Выигрыш по оценке  функции качества и критерия устойчивости показал снижение остаточного отражения в полтора-два раза по сравнению с известными решениями.  Практическая значимость:  применение программного обеспечения Film Manager показало возможность реализации  ахроматических просветляющих покрытий в средней инфракрасной области спектра на любых подложках. Разработанные покрытия позволяют снизить остаточное отражение и обладают высокими оптическими и эксплуатационными  свойствами.  Ключевые слова  — интерференционные покрытия, спектры, критерий устойчивости, функция качества, эквивалентные слои, пленки. 

С широким применением тонких пленок в производстве задачи проектирования оптических покрытий стали очень актуальны, но они практически не поддаются аналитическому решению, поэтому важным является изучение эффективных численных методов, а также приобретение навыков создания программного обеспечения. Математическое описание синтеза многослойных оптических покрытий является нетривиальной проблемой в силу того, что сложны сами математические модели рассеяния электромагнитного излучения на дифракционных оптических системах. Поэтому в большинстве случаев используется следующий подход. Выполняется итеративный поиск оптимальной конструкции, на каждом шаге которого решается прямая задача дифракции света на многослойной системе. Переход от шага к шагу осуществляется методом улучшения целевой функции, характеризующей отклонения рассчитанных характеристик текущей системы от технического задания, т. е. решается задача оптимизации. Каждая задача оптимизации начинается с задания начальной конфигурации системы, поэтапного сравнения характеристик нового варианта с предыдущим и прекращения процесса оптимизации в зависимости от значения функции качества 1. В настоящей работе описан метод проектирования ахроматических просветляющих покрытий с использованием программы анализа и синтеза интерференционных покрытий ИП Film Manager. Программное обеспечение написано на языке Object Pascal в среде Delphi 2 и функционирует под управлением операционных систем Windows всех поколений. В основе описываемой программы лежит программа FilmMgr 3, 4, которая была модернизирована за счет включения ряда дополнительных опций и получила название Film Manager. Добавлены следующие опции замена пленки с произвольным показателем преломления на эквивалентную трехслойную структуру типа HLH или LHL, замена трехслойной структуры типа HLH или LHL на реальные пленки из базы данных, возможность анализа и синтеза от подложки конечной толщины наряду с полубесконечной поглощающей или непоглощающей подложкой. В программе Film Manager есть возможность использовать базы данных пленкообразующих материалов, где учтены дисперсии показателей преломления и поглощения во всем рассматриваемом диапазоне спектра. Задаваемыми параметрами являются спектральный интервал, число слоев, значения показателей преломления и оптических толщин слоев, диапазон перебора значений показателей преломления и оптических толщин слоев, величина шага поиска. Расчет спектров ведется как для нормального, так и для наклонного падения излучения, причем в случае наклонного падения излучение может быть любой поляризации. В программе используется поэтапное или выборочное выполнение двух поисковых алгоритмов случайного перебора с переменным шагом поиска 5, 6, когда генерируются случайные значения показателя преломления и толщины каждого слоя и вычисляется отклонение от эталонного спектра. В случае минимального отклонения значения показателей преломления и толщины сохраняются. В качестве отклонения используется сумма модулей относительных отклонений значений отражения или пропускания от заданных в каждой точке спектра квадратичной аппроксимации Пауэлла 6, при использовании которой начальным приближением может служить найденная первым методом структура. В общем случае данный метод применяется для уточнения полученного результата и для уменьшения времени поиска окончательной структуры покрытия. На последнем этапе синтеза возможна замена отдельных слоев с показателями преломления, для которых не найдены пленкообразующие материалы, на эквивалентные трехслойные симметричные системы, состоящие из реальных веществ. После замены проводится поиск решения по минимуму функции качества. На заключительном этапе конструирования покрытий с заданными характеристиками предусмотрен анализ устойчивости полученных решений к вариациям параметров слоев. С помощью программы можно смоделировать действие различных дестабилизирующих факторов, имеющих место при изготовлении покрытий. Задача синтеза сводится к решению задачи по минимизации функции качества в заданной области -мерного пространства, где число слоев интерференционного покрытия 5. В программе функция качества имеет следующий вид 1 где и расчетное и эталонное требуемое значение коэффициента отражения на длине волны 1, коротковолновая граница спектрального интервала, величина шага поиска число точек, в которых вычисляется спектр весовой множитель в точке, задаваемый пользователем. В формуле 1 модули относительных отклонений значений отражения или пропускания от заданных в каждой точке спектра умножаются на весовые множители, задаваемые пользователем, что дает возможность визуально корректировать расчетную спектральную кривую, максимально приближая ее к эталонной на наиболее важных участках спектра непосредственно в процессе синтеза. Спектры пропускания, отражения и поглощения рассчитываются матричным методом 7 и отображаются на экране на любом этапе синтеза. Используемый в процессе синтеза покрытия метод случайного поиска, совмещенный с задаваемым непосредственно пользователем шагом поиска и визуальной коррекцией синтезируемых спектров, позволяет с большей вероятностью, по сравнению с другими методами, получить необходимое устойчивое решение 8. Основываясь на физических свойствах задачи, практический интерес мы видим в поиске решений, имеющих малую чувствительность к вариациям параметров слоев. Поэтому после поиска минимума функции качества методом случайного перебора в программу заложена возможность дополнительной оптимизации структуры покрытия. После оптимизации есть возможность варьировать параметры. Если не добились требуемого результата покрытия, применяется метод квадратичной аппроксимации Пауэлла. Он относится к группе методов решения экстремальной задачи нулевого порядка, в которой, как и в первом случае, используются только значения минимизируемой функции, а не ее производные, методам прямого поиска. Для нашей программы была взята уже составленная 9 на языке Turbo Pascal программа квадратичной аппроксимации Пауэлла, но измененная на Object Pascal. Эти изменения носили непринципиальный характер, например, был заменен оператор вывода на печать. Основные элементы управления программы рис. 1 Data input ввод параметров среды, подложки, слоев, угловых характеристик излучения и т. д., а также запуск процесса оптимизации покрытия Calculations results отображение спектральных значений пропускания, отражения и поглощения, а также структура оптимизированного покрытия Graphs графическое изображение спектров Materials редактор базы данных используемых материалов Replacement with equiv. layers замена однослойных пленок на трехслойные эквивалентные комбинации Exit окончание работы с программой. Пример синтеза ахроматического просветляющего покрытия приведен ниже. Рассмотрим алгоритм программы синтеза ИП Film Manager, блок-схема которого представлена на рис. 2. В начале процесса синтеза ИП задается информация о пленкообразующих материалах, которые предполагается использовать в покрытии. Информация может быть введена двумя способами. В одном случае вводится число слоев и некоторый набор пленок с произвольными толщинами и показателями преломления в пределах допустимого от 1,3 до 5,2. Во втором случае набор пленок с некоторыми толщинами и показателями преломления . Далее задается рабочий спектральный диапазон в длинах волн или волновых числах, материалы подложек и окружающей среды, уточняется начальное приближение структуры покрытия, и число слоев исходя из общих требований для заданного типа покрытия, данные об эталонном требуемом спектре покрытия и т. д. После этого осуществляется выбор режима оптимизации по методу случайного поиска или методу Пауэлла. При этом запускается процесс генерации по случайному закону векторов и слоев в заданном диапазоне значений и вычисляются спектры отражения и пропускания первичной структуры покрытия путем определения значений соответствующих функций качества, которые сохраняются. Если новое вычисленное значение функции качества меньше предыдущего, то соответствующие векторы и сохраняются как оптимальные на данном этапе синтеза. Текущие значения функции качества выводятся на экран дисплея для того, чтобы пользователь мог визуально контролировать процесс оптимизации. Если принимается удовлетворительное решение, то строятся графики спектров и вновь визуально и аналитически теперь по графикам определяется близость полученного вывода к требуемому решению. При неудовлетворительном решении проводится корректировка весовых множителей в заданном спектре для устранения нежелательных экстремумов в расчетном спектре и вновь запускается процесс генерации по случайному закону и слоев и вычисляются значения функции качества для спектральных коэффициентов отражения и пропускания. В случае если вычисленное значение на этот раз больше предыдущего сохраненного значения и время, отведенное на процесс, еще не истекло, то вновь запускается процесс генерации по случайному закону векторов и слоев. Если же время истекло, то строятся графики, и вновь пользователь принимает решение об удовлетворительном или неудовлетворительном виде спектра по степени близости к заданному, исходя из конкретных условий физической задачи. При удовлетворительном виде рассчитанного спектра соответствующая структура берется как начальное приближение при дальнейшей оптимизации методом Пауэлла. Запускается процесс итерации для нахождения минимума функции качества при варьировании значений и слоев. Полученные векторы и сохраняются как оптимальные на данном этапе синтеза, и текущее значение функции качества выводится на экран для визуального и аналитического контроля. Если пользователь не прерывает процесс оптимизации, то процесс нахождения минимума функции качества продолжается. При положительном решении о достижении требуемого спектра с заданной степенью приближения пользователь может прервать процесс оптимизации. В этом случае проводится построение графиков и оценивается их вид. Если решение не устраивает, то осуществляется корректировка весовых множителей в эталонном спектре для устранения нежелательных экстремумов в рассчитанном спектре и вновь запускается итерационный процесс. Если вид спектра удовлетворительный, то проводится теоретическая замена слоев покрытия на близкие по значениям показателей преломления пленок слои из реальных веществ. Слои, для которых не нашлось в базе данных подходящих веществ, заменяются эквивалентными трехслойными структурами из реальных веществ. Вновь проводится итерационный процесс нахождения функции качества методом Пауэлла, но теперь только при варьировании толщины слоев с учетом дисперсии оптических констант материалов слоев. Значение векторов на данном этапе синтеза, текущее значение функции качества выводятся на экран для контроля процесса. Если пользователь прерывает процесс оптимизации, то строятся графики и оценивается их вид. При удовлетворительном виде графиков данные найденной структуры ИП и соответствующих спектров сохраняются и выводятся на печать как искомое решение задачи. При удовлетворительном виде рассчитанного спектра соответствующая структура берется как начальное приближение при дальнейшей оптимизации методом Пауэлла. Запускается процесс итерации для нахождения минимума функции качества при варьировании значений и слоев. Полученные векторы и сохраняются как оптимальные на данном этапе синтеза, и текущее значение функции качества выводится на экран для визуального и аналитического контроля. Если пользователь не прерывает процесс оптимизации, то процесс нахождения минимума функции качества продолжается. Задача синтеза, сформулированная в виде оптимизационной задачи, предусматривает выбор численного метода согласно определенному критерию выбора лучшего метода. В общем случае основными оценками работы алгоритма являются его надежность и быстродействие. При этом на значения показателей преломления и толщин слоев накладывается ряд ограничений, связанных с технологиями изготовления покрытий. С точки зрения практической реализации интерес представляет поиск не глобального минимума, а решений, имеющих малую чувствительность к вариациям параметров слоев. Выбранные нами поисковые алгоритмы при использовании их в комбинации позволяют на практике получить необходимое устойчивое решение. В качестве примера рассмотрим процесс просветляющего покрытия ПП на кремнии в диапазоне от 2 до 12 мкм. Как уже упоминалось выше, для того чтобы не попасть в локальный экстремум, осуществляя оптимизацию оптического покрытия, необходимо при поиске минимума функции качества использовать два алгоритма случайный перебор с переменным шагом поиска и квадратичную аппроксимацию Пауэлла. Поэтапный процесс синтеза включает выбор начального приближения, оптимизацию по показателям преломления и толщинам слоев, замену слоев эквивалентными комбинациями и оптимизацию ПП по толщинам слоев, а также расчет функции качества с помощью программы Film Manager. В качестве подложки мы использовали кремний марки КЭФ-4.5, показатель преломления которого 3,42. Далее синтезировали равнотолщинные покрытия. Пленкообразующими материалами служили германий, сульфид цинка и фторид бария. Роль обрамляющей среды играл воздух с 1. Синтез ПП проводится в несколько этапов. На первом этапе задается начальное приближение. Для подложек с высоким коэффициентом преломления в его основе лежит структура из пленок с последовательно уменьшающимися от подложки коэффициентами преломления. Число пленок и их толщины задаются требуемым спектральным диапазоном просветления и средним значением коэффициента отражения в указанной области спектра. В работе 4 предложено использовать для получения ПП следующие эмпирические выражения. Число пленок в первом приближении можно определить как 2 В зависимости от требований к остаточному коэффициенту отражения число пленок может быть увеличено от одной до трех. С увеличением числа слоев среднее отражение уменьшается, также уменьшается отражение в пиках. Средняя толщина этих пленок в первом приближении определяется из уравнения 3 Наконец, коэффициент преломления слоя нумерация от подложки можно задать как 4 Уравнения 24 позволяют задать начальное приближение при синтезе просветляющего покрытия на подложке с высоким коэффициентом преломления. Оптические толщины слоев покрытий равны 4 Для получения удовлетворительного ПП можно взять за основу последний слой пленки с минимальным коэффициентом отражения, в нашем случае использовалась пленка фторида бария BaF . В соответствии с этим в качестве начального приближения берем структуру, представленную в табл. 1 на первых этапах синтеза, полученную с использованием формул 2, 3. При синтезе покрытия последовательно использовались метод случайного перебора и метод Пауэлла. Опорная длина волны при расчете на нашей программе составляла 3 мкм. Задача синтеза неоднозначна, поэтому можно получить ряд покрытий, которые нуждаются в проверке на устойчивость. Для получения численного значения критерия устойчивости можно использовать методику, описанную в работах 10, 11. Спектры синтезированных покрытий представлены на рис. 3. Результаты расчетов конструкции ПП c использованием метода эквивалентных слоев приведены в табл. 2. Рассчитанные на разных этапах функции качества характеризуют отклонения от заданного спектра. Спектральные характеристики начального приближения и реальной структуры оптимизированной эквивалентной структуры представлены на рис. 4. В качестве исходного использовалось оптимизированное начальное приближение с помощью метода Пауэлла см. рис. 4, кривая . На следующем этапе синтеза проводилась замена слоев с произвольными показателями преломления на эквивалентные структуры. В качестве эквивалентной нами была использована структура HLH высокий-низкий-высокий для 7-слойной структуры. Затем проводилась замена на пленки из базы данных с учетом дисперсии показателей преломления и поглощения. В случае, когда требуемые коэффициенты преломления близки к коэффициентам преломления пленок, проводилась замена на одиночные пленки. В итоге 7-слойное покрытие стало 12-слойным. На последнем этапе проводилась оптимизация покрытия с реальными значениями дисперсионных констант пленок. На каждом этапе проводился расчет функции качества по формуле 1. Из полученных результатов видно, что спектральные характеристики начальной структуры почти совпадают со структурой, в которой несуществующие в природе показатели преломления заменялись на эквивалентные слои реально существующих материалов см. рис. 4, кривая . На последнем этапе проводился анализ устойчивости полученной структуры. Для этого варьировались в небольших пределах толщины отдельных слоев или группы слоев и для них находились изменения функции качества. Как уже говорилось выше, для более детального анализа устойчивости использовалась другая программа 10, в которой предусмотрен анализ устойчивости для отдельных слоев и всего покрытия в целом. В работе описана программа анализа и синтеза интерференционных покрытий Film Manager. В программе реализуется возможность синтеза интерференционных покрытий путем минимизации функции качества методами случайного перебора с переменным шагом поиска и квадратичной аппроксимации Пауэлла, а также нахождение оптимальной структуры покрытия на основе метода эквивалентных слоев. В качестве примера приведен синтез просветляющего покрытия на подложке из кремния. Синтез реализован с использованием известной базы данных по дисперсионным характеристикам пленкообразующих материалов. Работа выполнена при финансовой поддержке МОиН РФ в рамках государственного задания. 