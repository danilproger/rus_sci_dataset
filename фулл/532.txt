МОДЕЛИРОВАНИЕ УПРУГИХ ВОЛН   В СРЕДАХ СО СЛОЖНОЙ ТОПОГРАФИЕЙ СВОБОДНОЙ ПОВЕРХНОСТИ

Моделирование – неотъемлемая часть исследования процессов распространения сейсмических волн в различных   средах. Широко используемый способ разбиения области на прямоугольные ячейки обладает недостатком: при   сложном строении свободной поверхности (например, гора) возникают эффекты при отражении волны от этой   поверхности, связанные с тем, что граница аппроксимируется ступенчатой функцией для численного решения   задачи. В данной работе предложен иной подход к дискретизации области: построение криволинейной сетки,   хорошо согласующейся с геометрией свободной поверхности. Предложен алгоритм численного моделирования   на основе численного решения линейной 2D-системы теории упругости, записанной в смещениях, с использова  нием криволинейной сетки и пошагового метода Лагерра. Представлены результаты моделирования. Также были   реализованы две параллельные версии алгоритма, проведены расчеты на различных многоядерных системах   (на классической многопроцессорной архитектуре, а также архитектуре с использованием сопроцессоров Intel   Xeon Phi – РСК ПетаСтрим). Представлены сравнительные тесты ускорений на разных архитектурах, а также   описаны особенности распараллеливания алгоритма.   : теория упругости, упругие волны, криволинейная поверхность, криволинейные сетки, метод   Лагерра, Intel Xeon Phi, PetaStream.   Работа выполнена в рамках государственного задания ИВМиМГ СО РАН (проект № 0315-2016-0009), а также при поддержке грантов РФФИ № 16-07-00434 и № 16-01-00455 А.  

Эффективным инструментом исследования процессов распространения волн в различных моделях сложно построенных сред является математическое моделирование. Одним из из вестных методов численного моделирования распространения упругих волн в случае сложно построенных 2D-сред является разностный метод. При использовании данного метода не изменно сталкиваются с проблемой возникновения дифракционных волн при отражении волны от свободной поверхности. Связано это с тем, что для применения данного метода необходимо разбиение физической области на квадратные или прямоугольные ячейки, вследствие чего свободная поверхность заменяется ступенчатой функцией. Пример исполь зования разностного метода приведен на рис. 1 и 2. Подобные дифракционные волны вносят погрешность в решение. Таким образом, была поставлена задача об избавлении от дифракционных волн. Для этого в работе предлагается использовать криволинейные сетки. В последнее время все большую популярность приобре тает моделирование с использованием криволинейных сеток. Это гибкий инструментарии, нашедший применение в численном решении сингулярно-возмущенных задач, моделирова нии потоков плазмы в камере Токомака и др. Способы построения сеток, а также их при менение для решения упомянутых задач приведены в 1. Данная работа особенно важна для дальнейшей разработки 3D-алгоритма, нацеленного на развитие методов исследования областей, характерной особенностью которых является сложное строение топографии свободной поверхности. К таковым можно отнести магма тические вулканы, а также территории арктического шельфа и Сибири Баженовская свита, богатые залежами углеводородов. Существующие методы работы с такого рода задачами не позволяют получить желаемую точность моделирования ввиду большой трудозатратности и особенностей применяемых методов, таких как метод конечных элементов МКЭ. Существует много методов построения криволинейной сетки. Нкоторые из них описаны в работах 112. Криволинейная сетка в физической области получается в результате взаимно-однозначного отображения равномерной сетки расчетной области. Таким обра зом, необходимо установить взаимно-однозначное соответствие между физической и рас четной областью. Физическая область находится в пространстве переменных, а расчетная в пространстве переменных, . Для этого был использован метод трансфинитной интерполяции 1, с. 53. Автором были подобраны управляющие функции, позволяющие определять свойства криволинейной сетки. В данной работе важным моментом построения сетки является ее ортогональность к свободной поверхности, что накладывает ограничение на форму свободных поверхностей, с которыми можно работать при помощи данного метода построения сетки, а именно поверхность должна быть гладкой функцией первого порядка на промежутке, на котором она построена для данной области, а также для любых двух разных и не су ществует, такого что и . Пример на рис. 3. Таким образом, задачу, поставленную в переменных, можно переписать в пере менных, . Моделирование проводится на основе численного решения полной линейной системы теории упругости, записанной в смещениях. В физической области в переменных, линейная система уравнений в смещениях принимает вид 2 0, 2 0. 1 Граничные условия на и начальные условия 0, 0. 2 Условия на свободной поверхности 2 0, 2 0, 3 где, смещения вдоль координатных осей OX и OY, параметры Ламэ, плотность граница области, не включающей свободную поверхность свободная поверхность, единичный вектор нормали к сво бодой поверхности, правая часть, отвечает за работу источника возмущений в среде. В данной работе используется источник типа центр давления, работает в течение 2-х секунд., sin 1 0,8sin2 1 0,2sin3 1, 0 2, 0, 2, sin 1 0,8sin2 1 0,2sin3 1, 0 2, 0, 2. Аналогично работе 13 после преобразования системы 13 получаем задачу вида 2 2, 2 2, . 4 Начальные и граничные условия 0, 0. 5 На свободной границе 2 0, 2 0, 6 где, Якобиан проебразования. Впервые данный метод был применен в работе 14. В отличие от классических пре образований Фурье и Лапласа применение преобразования Лагерра приводит к решению за дачи для системы дифференциальных уравнений, не зависящей от параметра разделения, роль которого в данном случае играет номер проекции Лагерра. В результате примене ния этого преобразования получается задача для проекций Лагерра с правой частью, ре куррентно зависящей от проекций меньших номеров. После применения конечно-разностных аппроксимаций по пространственным переменным, решение исходной задачи сводится к решению системы линейных алгебраических уравнений со многими правыми частями, для решения которых можно использовать различные современные подходы к решению ли нейных систем. В работе рассматривается модификация метода, а именно преобразование Лагерра ис пользуется на последовательности конечных интервалов по времени. Полученное решение в конце одного временного отрезка используется в качестве начальных данных для реше ния задачи на следующем временном отрезке и т. д. Связано это с тем, что для получения решения с хорошей точностью через длительный промежуток времени необходимо очень большое количество проекций Лагерра, что критично скажется во время численной реали зации. Подробно пошаговый метод преобразования Лагерра описан в работе 15. При использовании данного подхода появляется необходимость выбора 4-х параметров количество проекций Лагерра масштабного множителя, необходимого для аппроксимации решения функциями Лагерра, экспоненциального коэффициента весовой функции, использующейся для нахождения решения на конечном временном интервале, и дли тельности этого интервала . Способ выбора этих параметров предложен в работе 15. Мы же ограничимся лишь основными терминами и непосредственно видом задачи после примененного к ней преобразования Лагерра. Полиномы Лагерра имеют вид 1, 7 1, 8 1 2 1, 1, 1 9, 1. 10 Функции Лагерра, 0, 11 образуют полную ортонормированную систему в 0, . Преобразование 12 называется прямым преобразованием Лагерра, а проекциями Лагерра функции . Обратное преобразование Лагерра . 13 Идея метода состоит в получении приближенного значения 14 и значения, 15 выбираем в качестве начальных данных для решения задачи при . Иначе говоря, теперь вместо нахождения неизвестной функции мы ищем значения проекций Лагерра для этой функции. Учитывая уравнения 715, задача 36 сводится к решению линейной системы уравнений 2, 2 2 3 2 2, 2 2 2 2 2, 2 2. 16 На 0, 0, . 17 На 2 18 0, 2 0. В 16 вместо подставляются, -е проекции Лагерра для и соответственно. Вместо оператора подставляются для и для соответственно. число проекций Лагерра, параметры преобразования Лагерра. Таким образом вместо из начальной системы из 2-х уравнений, записанной в смещениях, получаем систему из 2 1 уравнений, записанную в проекциях Лагерра. Далее для полученной системы строится разностный аналог на равномерной сетке раз мером ячеек. Разностная схема для, описана в работе 13, уравнения 3.3, 3.4, за исключением дискретных граничных условий на свободной по верхности и на, которые предложены автором данной работы. Упростив 18, получим на 0, 0. 19 Из 19 получаем разностный аналог 12 32 12 12 32 12, 12 32 12 12 32 12 . Здесь используются так называемые фиктивные узлы. На из 17 получаем разностный аналог 0, 0, 0, . В итоге получаем разностный аналог системы 1618 со вторым порядком аппрокси мации по пространственным и временной переменным. Для численного решения был задействован метод простой итерации. Подробно суть ме тода изложена в 16. Выбор этого метода обусловлен тем, что система для численного решения из 2 1 уравнений, переписанная в матричном виде, будет обладать матрицей с большим диаго нальным преобладанием, что обеспечит быструю сходимость метода. Далее, на примере вместо него подставляются и опишем общий алгоритм действий. 0. На интервале 0, начальные данные выглядят так 0, 0. 0 и 0 берутся из начальных данных задачи. 1. Получив все значения при помощи метода простой итерации, находим . 2. Отсюда, используя формулы, 0, 2, 2 1,2, найдем . 3. Затем, и, наконец, значения, берутся в качестве начальных данных для следующего временного интервала. Присваиваем, . 4. и будут начальными данными для следующего временного интерва ла. Далее, аналогично находим 2, 2 и т. д. При помощи языка Fortran и пакета MPI было создано 2 варианта параллельной программы и проведены численные расчеты на кластере ССКЦ НКС-30Т на узле G7 2 процессора Intel Xeon E5670 и 24 ГБ оперативной памяти. httpwww.sscc.icmmg. nsc.ruhardware.html с классической многопроцессорной архитектурой, а также на кластере МВС-10П МП с архитектурой РСК ПетаСтрим 8 модулей по 8 сопроцессоров Intel Xeon Phi 7120D, 61 ядеро, 244 потока, RAM 16 Gb DDR5. На каждом модуле также стоит процессор Intel Xeon E5-2667 v2. Твердотельные накопители Intel SSD DC S3500. http www.jscc.ruresourceshpc. Декомпозиция области для реализации на CPU и на Intel Xeon Phi представлена на рис. 4. Особенностью архитектуры РСК ПетаСтрим является то, что пользователю доступны для работы только сопроцессоры Intel Xeon Phi. Между собой они обмениваются при помощи MPI-пересылок, а внутри каждого Phi также осуществляется распараллеливание по потокам при помощи OpenMP. Подробнее с особенностями программирования для Intel Xeon Phi можно ознакомиться в работах 1721. Далее будут приведены сравнительные тесты ускорений на примере конкретной модели среды. Для решения системы линейных уравнений используется метод простых итераций, что позволяет прореживать обмены между процессами, так как это не влияет на сам факт схо димости итерационного процесса, а только на ее скорость. В ходе расчетов для модели, описаной далее, выяснилось, что относительно временных затрат на расчеты выгоднее сделать суммарно вдвое большее число итераций и вдвое меньшее число обменов. Другими словами, соседние процессы обмениваются раз в четыре итерации. Это ускорило работу программы в среднем в 1,5 раза, при этом точность решения пострадала незначительно в тестовых расчетах расхождение решений по амплитуде, полученных с прореживанием обменов и без прореживания, составило порядка 0,001 . Область однородная среда с горой на поверхности рис. 5. а б Параметры среды 1, 0,5, 0,25. На рис. 6 размеры области даны в километрах. Соответствующая ей расчетная область прямоугольник размером 64 32 км, дискрети зация области 5 120 2 060 ячеек. Источник типа центр давления работает в течение 2-х секунд. В уравнениях он представлен двумя компонентами, sin 1 0,8sin2 1 0,2sin3 1, 0 2, 0, 2, sin 1 0,8sin2 1 0,2sin3 1, 0 2, 0, 2. Важным свойством криволинейной сетки яляется ее ортогональность к свободой по верхности рис. 6. Следует также упомянуть, что для двух разных форм поверхности не всегда можно использовать один и тот же алгоритм построения сетки. Зачастую возникает необходимость подбирать параметры управляющих функций занова, чтобы не допустить перехлеста ячеек криволинейной сетки. Аналитический метод построения позволяет делать это быстро. Программный генератор сетки написан на языке Fortran и также предложен автором. На рис. 7 можно наблюдать отсутствие дифракций при отражении волны от поверхности, что подтверждает эффективность подхода, предложенного в данной работе. Далее приведены сравнительные тесты для разных архитектур рис. 8. Модель описана в разделе Математическая модель. Тесты для CPU выполнены на сервере G7 2 6ядерных Intel Xeon E5670 и 24 Гб оперативной памяти на узле кластера ССКЦ НКС-30Т, при этом технология hyperthreading отключена. Для Intel Xeon Phi на кластере МВС-10П. В случае Xeon Phi не проводилось никаких дополнительных процедур оптимизации вроде выравнива ния массивов или изменения числа потоков на ядро по умолчанию их 4. В тесте на мас штабируемость алгоритма на каждый сопроцессор Phi приходился объем вычислений, соот ветствующий нашей модели 5 120 2 060 ячеек. Как видно из результатов, даже один узел с 12 ядрами CPU на 1 ядро 1 MPI-поток справляется быстрее, чем один Intel Xeon Phi. При этом заметно, что в случае PetaStream алгоритм быстро уходит в насыщение, что может свидетельствовать о недостаточной оптимизации MPI-обменов между соседними Phi на уровне программного обеспечения кластера. В работе представлен алгоритм и результаты численного моделирования с использо ванием этого алгоритма. Также непосредственно автором создано 2 параллельных реали зации алгоритма, программно реализован генератор криволинейной сетки. Проведены сравнительные тесты для разных архитектур на примере конкретной модели. Новизна работы заключаются в следующем предложен новый способ аппроксимации граничных условий, впервые моделирование сейсмических полей проводилось с использо ванием локально-ортогональной криволинейной сетки, построенной аналитическим спо собом. Проведенные тесты показали отсутствие дифракции при отражении от криволинейной свободной поверхности. В дальнейшем эта работа послужит основой для полноценной 3Dзадачи, результаты которой могут быть применены для решения реальных задач. Автор выражает благодарность В. Н. Мартынову за консультации в ходе выполнения ра боты, а также ССКЦ РАН и МСЦ РАН за предоставленное оборудование для численных расчетов. 