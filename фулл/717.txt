РАСШИРЕНИЕ ФУНКЦИОНАЛЬНОСТИ СТАНДАРТОВ  ЭЛЕКТРОННОЙ ЦИФРОВОЙ ПОДПИСИ 

Рассмотрена реализация схем слепой и слепой коллективной подписи, использующих процедуры проверки  подлинности электронной цифровой подписи, рекомендуемые российскими стандартами. Ключевые слова  — электронная цифровая подпись, слепая подпись, открытый ключ, стандарты электронной  цифровой подписи, коллективная слепая подпись. 

Электронная цифровая подпись ЭЦП широко применяется для решения различных практических задач электронного документооборота и других современных информационных технологий. Важными типами схем ЭЦП являются протоколы слепой 1, 2 и коллективной 3, 4 ЭЦП. Протокол коллективной подписи позволяет сформировать единую ЭЦП фиксированного размера как криптографическую сумму индивидуальных цифровых подписей практически произвольного числа подписывающих. Схемы слепой ЭЦП применяются в системах тайного электронного голосования и системах электронных денег. Протоколы данного вида решают задачу обеспечения неотслеживаемости анонимности, которая состоит в том, что требуется подписать электронное сообщение таким способом, что подписывающий 1 не может ознакомиться с сообщением в процессе формирования подписи и 2 впоследствии при получении сообщения и подлинной подписи к нему не может однозначно идентифицировать пользователя, предоставлявшего данное сообщение для формирования ЭЦП. Прикладной интерес представляют также схемы ЭЦП, объединяющие возможности протоколов указанных двух типов, которые впервые были предложены в работе 5 как протоколы слепой коллективной ЭЦП. Для практических приложений важным является использование процедур формирования и проверки ЭЦП, рекомендуемых официальными стандартами. В настоящей работе рассматривается построение схем слепой и слепой коллективной ЭЦП с использованием процедур формирования и проверки ЭЦП, рекомендуемых ГОСТ Р 34.1094 6 и Р 34.102001 7, 8. Стандарт ЭЦП ГОСТ Р 34.1094 рекомендует использование простого числа, размер которого удовлетворяет условиям 1022 1024 бит. При этом число выбирается таким, что значение 1 содержит большой простой делитель 2 2 соответственно. Специфицируемые стандартом процедуры генерации и проверки ЭЦП используют число такое, что 1 и mod 1 является генератором циклической подгруппы конечного простого поля, имеющей порядок . Формирование ЭЦП в соответствии с ГОСТ Р 34.10 94 6 осуществляется следующим образом. 1. Генерируется случайное число, удовлетворяющее условию 1 . 2. Формируется рандомизирующий параметр ЭЦП значение mod mod, являющийся первой частью подписи. 3. По ГОСТ Р 34.1194 вычисляется хэш-функция от подписываемого сообщения . 4. Вычисляется второй элемент ЭЦП в виде числа mod, где личный секретный ключ пользователя, формирующего свою подпись к сообщению . Если 0, то следует перейти к шагу 1 и процедура генерации подписи повторяется. Процедура проверки подлинности ЭЦП состоит в выполнении следующих шагов. 1. Выполняется проверка условий и . Если хотя бы одно из этих условий не выполняется, то подпись признается недействительной. 2. Вычисляется по ГОСТ Р 34.1194 хэшфункция от подписываемого сообщения . 3. Вычисляется значение mod mod . 1 4. Сравниваются значения и . Если, то подпись признается действительной. Протокол слепой ЭЦП на основе ГОСТ Р 34.10 94 строится с использованием двух ослепляющих множителей, формируемых в виде mod и mod . Множители такого типа использовались ранее в схеме слепой подписи на основе алгоритма ЭЦП Шнорра 9, 10. Разработанный протокол слепой ЭЦП на основе ГОСТ Р 34.1094 описывается следующим образом. 1. Подписывающий генерирует случайное значение, вычисляет число mod и направляет его пользователю А, который намерен представить некоторое электронное сообщение для получения к нему слепой ЭЦП подписывающего, из которой пользователь А сможет самостоятельно вычислить правильное значение ЭЦП, которое пройдет процедуру проверки ЭЦП по ГОСТ Р 34.1094. 2. Пользователь А генерирует случайные равновероятные значения, 1, 2, 1, вычисляет значения mod, mod и mod, где значение хэшфункции от подписываемого документа, вычисленное по ГОСТ Р 34.1194. Значение, которое остается неизвестным подписывающему, представляет собой первый элемент подлинной ЭЦП. Значение представляет собой первый элемент формируемой слепой подписи. 3. Пользователь А отправляет подписывающему значение, из которого нельзя вычислить, поскольку для любого значения существует пара значений и, которые связывают значение с полученным числом . 4. Подписывающий вычисляет значение mod, где его секретный ключ, передает вычисленный элемент слепой подписи пользователю А. 5. Пользователь А вычисляет значение mod, которое является вторым элементом подписи. Полученная в соответствии с этим протоколом ЭЦП, является подлинной, т. е. она вместе со значением хэш-функции от сообщения проходит уравнение проверки ЭЦП, специфицируемое ГОСТ Р 34.1094. Корректность работы описанной схемы слепой ЭЦП доказывается следующим путем. . Элемент слепой подписи вычисляется на шаге 4 по формуле mod, из которой с учетом того, что число имеет порядок по модулю, следует справедливость сравнения mod, откуда имеем mod . Учитывая, что mod, вычисление правой части уравнения проверки подлинности ЭЦП 1 для подписи, и значения хэш-функции дает следующее 2 Последнее равенство означает, что подпись, к сообщению является подлинной. Рассмотренный протокол обеспечивает анонимность пользователя, предоставляющего сообщение для получения подписи вслепую в том смысле, что нельзя однозначно установить пользователя, предоставлявшего данное сообщение для формирования слепой ЭЦП предполагается, что число сообщений, подписанных данным подписывающим с помощью протокола слепой подписи, 1. Подписывающий при предъявлении ему его подлинной подписи, к сообщению не может установить пользователя, который предоставлял ему этот документ на подпись, с вероятностью выше значения, где количество документов, подписанных данным подписывающим с помощью протокола слепой подписи число документов, предоставлявшихся данным пользователем, поскольку любая подпись, может быть с равной вероятностью отнесена к каждой из выполненных процедур протокола слепой подписи. Действительно, любая тройка значений, из множества таких троек, которые известны подписывающему из выполненных им процедур подписывания сообщений вслепую, может быть ассоциирована с произвольной подлинной подписью, относящейся к некоторому сообщению, представленному значением хэш-функции . Это связано с тем, что тройки, и, в соответствии с описанным протоколом слепой ЭЦП связаны случайными равновероятными значениями и с помощью следующих соотношений mod и mod mod, т. е. mod, поэтому тройка, с равной вероятностью могла бы быть порождена из любой тройки, фигурировавшей в одной из выполненных процедур слепого подписывания сообщений. Отметим, что значение однозначно определяется парой чисел и . Стандарт ЭЦП ГОСТ Р 34.102001 по построению подобен рассмотренному выше стандарту. Основное отличие состоит в том, что в нем вычисления выполняются не в циклической подгруппе конечного поля, а в конечной группе другой природы, в качестве которой используется эллиптическая кривая ЭК над конечным полем. Групповой операцией в группе точек ЭК является композиция или сложение точек ЭК. Аналогами операций умножения и возведения в степень по модулю, используемых в стандарте ЭЦП ГОСТ Р 34.1094, в ГОСТ Р 34.102001 являются операции сложения точек ЭК и умножения точки на число соответственно. В силу указанной аналогии рассмотренный выше протокол слепой подписи может быть реализован также и на основе ГОСТ Р 34.102001. ГОСТ Р 34.102001 регламентирует использование простого числа модуля ЭК, которая задается в декартовой системе координат уравнением вида, где простого числа порядка циклической подгруппы точек ЭК точки с координатами такой, что, где бесконечно удаленная точка, являющаяся нейтральным элементом нулем группы точек ЭК. Секретным ключом является достаточно большое целое число, а открытым ключом точка . Формирование подписи, осуществляется в соответствии со следующим алгоритмом. 1. Генерируется случайное целое число 0 . 2. Вычисляется точка и определяется значение mod, где координата точки . 3. Вычисляется значение, где mod, значение хэш-функции от подписываемого сообщения. Подписью являются два числа, . Проверка подписи заключается в вычислении координат точки 3 определении значения mod и проверке выполнения равенства . Протокол слепой подписи на основе рассмотренного алгоритма реализуется следующим образом. 1. Подписывающий генерирует случайное число, вычисляет точку ЭК и направляет ее пользователю А, который намерен получить слепую ЭЦП к сообщению . 2. Пользователь А генерирует случайные значения, 1, 2, 1, вычисляет точку ЭК с координатами, значения mod, mod, где значение хэш-функции, вычисленное от, и mod . Значение, которое остается неизвестным подписывающему, представляет собой первый элемент формируемой ЭЦП. Значение является рандомизирующим элементом слепой ЭЦП. 3. Пользователь А отправляет подписывающему значение, из которого нельзя вычислить для любого существует пара чисел и, которые связывают значения и . 4. Подписывающий вычисляет значение mod, где его секретный ключ, передает вычисленный второй элемент слепой подписи пользователю А. 5. Пользователь А вычисляет значение mod, которое является вторым элементом подписи. Вычисленная подпись, является подлинной ЭЦП к сообщению . . Элемент слепой подписи вычисляется на шаге 4 по формуле mod, из которой следует выполнимость соотношения . Из последнего уравнения получаем . Вычисление правой части проверочного уравнения 3 для ЭЦП, и значения хэш-функции которое определяет значение mod дает следующее В соответствии с процедурой проверки ЭЦП выполнение равенства означает подлинность подписи, . Схема слепой ЭЦП на основе ГОСТ Р 34.102001 обеспечивает анонимность субъектов, предоставляющих электронные сообщения для подписывания, что легко доказывается по аналогии со случаем слепой ЭЦП на основе ГОСТ Р 34.1094. Протоколы слепой коллективной ЭЦП на основе ГОСТ Р 34.1094 и Р 34.102001 разработаны путем встраивания в описанные в предыдущем разделе схемы слепой ЭЦП механизма свертки открытых ключей всех субъектов, входящих в коллектив подписывающих, ранее апробированного в работах 3, 4. Схема слепой коллективной ЭЦП на основе ГОСТ Р 34.1094 описывается следующим образом. Пусть пользователь A желает подписать вслепую электронное сообщение у подписывающих, владеющих открытыми ключами mod, где личный секретный ключ -го подписывающего 1, 2, . Предполагается, что проверка коллективной ЭЦП осуществляется по проверочному уравнению, специфицируемому ГОСТ Р 34.1094 с использованием коллективного открытого ключа в виде произведения открытых ключей всех подписывающих ... mod . Процедура формирования коллективной подписи вслепую состоит в выполнении следующих шагов. 1. Каждый -й подписывающий генерирует случайное число 1 и вычисляет свое индивидуальное рандомизирующее значение mod . 2. Подписывающие вычисляют общее рандомизирующее значение путем перемножения всех индивидуальных рандомизирующих значений, т. е. в виде Значение направляется пользователю А. 3. Пользователь А генерирует случайные значения, 1, 2, 1, вычисляет значения mod, mod и mod, где значение хэш-функции от подписываемого документа. Значение является первым элементом слепой коллективной подписи, а первым элементом коллективной подписи к сообщению . 4. Пользователь А отправляет подписывающим значение . 5. Каждый -й подписывающий вычисляет значение mod, где его секретный ключ. 6. Подписывающие вычисляют свертку значений в виде суммы и направляют ее пользователю А. Значение является вторым элементом слепой коллективной подписи. 7. Пользователь А вычисляет значение mod, которое является вторым элементом коллективной подписи. Полученная в соответствии с этим протоколом ЭЦП, является подлинной, что подтверждается следующим доказательством. . Элемент слепой подписи, вычисляемый на шаге 6, может быть представлен в виде Из последнего соотношения с учетом того, что число имеет порядок по модулю, следует справедливость сравнения из которого имеем mod . Учитывая, что mod, вычисление правой части проверочного уравнения 1 в случае проверяемой коллективной подписи, и значения хэшфунк ции дает соотношения, совпадающие с 2, т. е. правая часть проверочного уравнения равна элементу проверяемой подписи, следовательно, подпись, к сообщению является подлинной. Действительно, подстановка значений и в 1 дает Протокол слепой коллективной подписи на основе ГОСТ Р 34.102001 реализуется следующим образом. 1. Каждый -й подписывающий генерирует случайное число, 1, вычисляет точку ЭК . 2. Подписывающие вычисляют результирующую точку и направляют ее пользователю А, который намерен получить слепую подпись к электронному сообщению . 3. Пользователь А генерирует случайные значения, 1, 2, 1, вычисляет точку ЭК с координатами, значения mod и mod, где mod значение хэш-функции от подписываемого сообщения. Значение является первым элементом формируемой подписи. 4. Пользователь А отправляет подписывающему значение . 5. Каждый -й подписывающий вычисляет значение mod, где его личный секретный ключ. 6. Подписывающие вычисляют значение mod, которое является элементом слепой подписи, и передают значение пользователю А. 7. Пользователь А вычисляет значение mod, которое является вторым элементом подписи. Проверка подлинности коллективной ЭЦП выполняется по проверочному уравнению 3, в которое вместо индивидуального открытого ключа подставляется коллективный открытый ключ, равный точке . Подписывающие не могут вычислить пару чисел, которая представляет собой подпись, полученную пользователем А в результате выполнения протокола слепой коллективной ЭЦП. Подпись, является подлинной и соответствует сообщению . Корректность последнего протокола легко доказать по аналогии с доказательствами корректности приведенных выше протоколов. Действительно, подстановка значений и в 3 дает 4 Описанные в этом разделе схемы слепой ЭЦП на основе российских стандартов ЭЦП решают задачу обеспечения анонимности. Доказательство этого выполняется аналогично для случаев использования обоих приведенных стандартов. Рассмотрим случай ГОСТ Р 34.102010. Пусть коллектив подписавших получил некоторый документ и коллективную подпись к нему в виде пары чисел, . Покажем, что любое из зарегистрированных им значений слепой подписи, может быть соотнесено с, . Вычисление долей подписи индивидуальными подписывающими выполнялось по формуле mod, поэтому имеем Из уравнения проверки подлинности ЭЦП и соотношений 4 для правильной подписи имеем Следовательно, для каждой из сформированных слепых коллективных подписей, имеется единственная пара значения и, которая связывает, с, . Поскольку данные значения формировались субъектами, представлявшими электронные сообщения для получения слепой ЭЦП, то любая из сформированных слепых подписей с одинаковой вероятностью может быть связана с данной конкретной подписью, . Предложенные схемы слепой и коллективной слепой ЭЦП используют проверочные уравнения, рекомендуемые стандартами ЭЦП ГОСТ Р 34.10 94 и Р 34.102001. Это означает, что разработанные протоколы могут быть положены в основу расширения функциональности этих стандартов, благодаря чему механизмы ЭЦП могут найти более широкое применение в информационных технологиях, в частности при построении систем электронных денег и систем тайного электронного голосования. Работа выполнена в рамках исследований по Федеральной целевой программе Научные и научнопедагогические кадры инновационной России на 20092013 гг. конкурсная заявка НК-563П59. 