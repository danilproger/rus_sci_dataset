CYTOSCAPE – ПЛАГИН ДЛЯ ПОСТРОЕНИЯ СТРУКТУРНЫХ МОДЕЛЕЙ   БИОЛОГИЧЕСКИХ СЕТЕЙ В ВИДЕ СЛУЧАЙНЫХ ГРАФОВ

Современные методы экспериментальных исследований позволяют реконструировать различного типа биологические сети, включая генные и метаболические сети, сети интерактомики, сети коэкспрессии генов, сети заболеваний и т. д. В данной статье представлена разработанная нами система построения структурных моделей   биологических сетей в виде набора случайных графов, структурные закономерности которых совпадают   со структурными закономерностями исходной биологической сети. Такие структурные модели могут быть использованы для проверки различных статистических гипотез на сетях, в исследовании влияния структурных закономерностей в биологических сетях на их функцию и других задачах.  При генерации структурных моделей в случайных графах могут быть зафиксированы следующие характеристики: распределение степеней вершин, попарное распределение степеней вершин, средняя степень соседних  вершин, коэффициент кластеризации, спектр кластеризации, частота структурных мотивов различных размеров   и др. Разработанная система построена по архитектуре клиент-сервер и состоит из плагина Cytoscape и удаленного вычислительного сервиса. Взаимодействие между клиентом и сервером реализовано посредством фреймворка  gRPC с применением протокола сериализации структурированных данных Protocol Buffers. Система позволяет  асинхронно конструировать структурные модели заданных биологических сетей в виде случайных графов посредством программ Random Network Generator и GTrie Scanner. Результат построения может быть загружен для  визуализации и анализа средствами пакета Сytoscape. С использованием разработанной системы проведен вычислительный эксперимент по реконструкции структурных моделей ряда биологических сетей, для которых удалось  построить алгоритм предсказания времени расчетов структурных моделей.  : биологические сети, случайные графы, структурные модели, Cytoscape.   Разработка программного обеспечения выполнена в рамках государственного задания ИВМиМГ СО РАН   по проекту № 0315-2016-0005. Подготовка данных для вычислительного эксперимента и расчеты с использованием вычислительных ресурсов ЦКП «Биоинформатика» проведены при поддержке бюджетного проекта № 03242018-0017.  

Современные методы экспериментальных исследований в молекулярной биологии позволяют реконструировать различного типа биологические сети, включая генные сети, сети метаболических и сигнальных путей, сети интерактомики сети взаимодействий белков, РНК, ДНК, сети коэкспрессии генов, сети ассоциации заболеваний и генетических мутаций, сети кровеносных и лимфатических сосудов, сети контактов в макромолекулах, ассоциативные и семантические сети и др. 111. Сетевое представление сложных биологических систем и процессов достаточно продуктивный подход, который в настоящее время получает широкое распространение. Активно развиваются новые методы анализа сетей для решения различных задач, включая выявление ключевых элементов, структурных мотивов и кластеров в биологических сетях, приоритизацию на этой основе генов, белков, мутаций, поиск биомаркеров заболеваний и т. д. 2 4 6 1113. Для проверки различных статистических гипотез на сетях в качестве нулевых гипотез, как правило, используются различные модели случайных графов, которые могут быть описаны распределением вероятностей на графах или случайным процессом, который генерирует случайные графы. Модели случайных графов, заданные структурные характеристики которых совпадают со структурными характеристиками анализируемой реальной биологической сети, можно рассматривать как структурные модели этой биологической сети. Исследование структурных моделей реальных биологических сетей позволяет выявлять внутренние зависимости между характеристиками сети. Для выявления таких зависимостей осуществляется генерация большого числа случайных графов, имеющих некоторую характеристику, и проверка гипотезы, что с большой вероятностью эти графы также имеют другую характеристику . Структурные модели позволяют также исследовать, от каких характеристик зависит целевой или функциональный признак биологической сети. Все структурные модели являются эквивалентными с точностью до структурных характеристик, по которым построены эти модели. Если имеется возможность оценки целевого или функционального признака биологической сети по ее структуре, то анализ структурных моделей позволяет выявить структурные закономерности в биологической сети, ответственные за проявление ее функций или целевых свойств. Например, сеть капиллярных сосудов характеризуется большой сложностью и может быть описана сетью, от структуры которой зависит кровоток 9 10. Другим примером такого рода целевых свойств могут быть робастность функционирования биологической сети сохранение функций при удалении вершины сети или ребра 14 15. Структурно-функциональные закономерности организации генной сети и сети белок-бел ковых взаимодействий могут быть важны для выделения главных компонент молекулярной системы и использоваться для построения математических моделей генных сетей или молекулярно-генетических систем. Целью настоящей работы является разработка плагина-приложения системы Cytoscape для реконструкции различного уровня приближения структурных моделей исследуемых биологических сетей в виде случайных графов. Мы сосредоточились на одном из типов биологических сетей, описываемых неориентированным графом. К такого рода биологическим сетям относятся сети интерактомики, в частности сети белок-белковых взаимодействий protein interaction network PIN. Исследования в этой области привели к осознанию того, что топологические особенности сетей молекулярных взаимодействий могут дать новые знания об их природе и функциональных характеристиках, участвующих в этих взаимодействиях биологических макромолекул. В статье представлены методы генерации структурных моделей сетей в виде случайных графов и описание распределенной системы генерации структурных моделей, реализованной с использованием клиент-серверной архитектуры клиент-плагин Cytoscape и вычислительный сервис для реконструкции структурных моделей в виде случайных графов. В заключение представлены результаты вычислительного эксперимента по реконструкции структурных моделей реальных биологических сетей. Случайный граф это граф, являющийся результатом случайного выбора из некоторого множества графов генеральной совокупности графов в соответствии с заданным на этом множестве вероятностным распределением. Случайные графы можно описать как распределением вероятности на множестве графов, так и случайным процессом, создающим эти графы. Наиболее простыми и распространенными моделями случайных графов являются модели Эрдша Реньи 16 и Гилберта 17. Для определения модели случайных графов Эрдша и Реньи рассмотрим вероятностное пространство всех графов, имеющих вершин и ребер, где 2 максимальное число всех возможных ребер между вершинами. Пусть, случайный элемент пространства т. е., . Будем считать, что все случайные элементы пространства равновероятны c 1 . Таким образом, заданное вероятностное пространство случайных графов имеет четко выраженную интерпретацию. Другая классическая модель случайных графов введена Гилбертом одновременно с моделью Эрдша и Реньи в 1959 г. 17. В модели Гилберта для определения вероятностного пространства графов задается матрица инцидентности графа в виде массива случайных переменные 1 1, для которых Pr 1 и Pr 0 1 . Случайный граф, в котором вершины и связаны, если случайная величина 1, является случайным элементом вероятностного пространства т. е., . Вероятность получения случайного графа, имеющего вершин и ребер, равна 1 . Для, где максимальное число возможных ребер, эти две наиболее широко используемые модели, и, почти взаимозаменяемы 18. Поэтому многие теоретические результаты получены с использованием модели Гилберта. Однако такие простые модели случайных графов пригодны в качестве нулевых моделей далеко не для всех статистических гипотез. Возможным обобщением модели случайных графов Эрдша и Реньи могут быть модели, в которых вероятности случайных элементов вероятностного пространства различны. Например, часто возникает необходимость использовать модели случайных графов, сохраняющих распределение степеней вершин 19 20 или другие структурные характеристики, наблюдаемые в реальной биологической сети. Такие модели случайных графов можно рассматривать как структурные модели биологической сети. Пусть задана биологическая сеть, которую можно представить в виде простого неориентированного графа, где это конечное множество вершин, а совокупность пар, где, . При этом в графе нет петель, кратных и ориентированных ребер. В данной работе используются следующие численные характеристики графов. 1 степень вершины или число ребер вершины 2 Распределение вероятности степеней вершин графа задается вектором, где вероятность того, что случайно выбранная вершина в графе будет иметь степень . 3 Совместное распределение вероятности степеней вершин определяется матрицей, где, вероятность того, что случайно выбранное ребро объединяет вершины со степенью и . 4 Коэффициент кластеризации 2, 1 где число связей, соединяющих всех соседей вершины, иными словами, есть вероятность того, что два ближайших соседа этой вершины сами есть ближайшие соседи. 5 Коэффициент ассортативности 2 2 2 это коэффициент корреляции Пирсона 0 1 между степенями связанных вершин, где и степень вершин на концах -го ребра, число ребер в графе. Для ассортативных сетей 0 вершины с большим числом ребер чаще связаны с такого же типа вершинами, а вершины с небольшим числом связей, в свою очередь, чаще связаны с вершинами с небольшой степенью, для дисассортативных сетей 0 вершины с большим количеством связей чаще связаны с вершинами с небольшим количеством связей 21. 6 Спектр кластеризации вероятность того, что две вершины, соседних с вершиной степени, будут соседями 22. 7 Структурный мотив неслучайный подграф, частота появления которого в сети значимо выше, чем по случайным причинам 23 24. Одним из подходов для получения случайного графа является рандомизация графа путем перестановки вершин в случайно выбранных парах ребер. В реализованной нами программе RNGmotifs для генерации случайных графов, сохраняющих заданные структурные характеристики, наблюдаемые в исходной биологической сети, используется метод рандомизации сети путем парной перестановки вершин в 2-х случайно выбранных ребрах графа. Процесс рандомизации соответствует Марковской цепи, которая стартует с, . Для рандомизации графа с сохранением распределения степеней вершин на каждом шаге выполняется выбор равновероятно двух непересекающихся ребер графа, и, где, и . Далее делается равновероятно одна замена из двух вариантов замен ребер в графе, или, . Если, простой граф отсутствие петель и параллельных рбер, то с заданной вероятностью принимается, иначе, . В работе 25 показано, что если размер, двух графов и распределение степеней вершин совпадает, то один граф может быть трансформирован в другой с помощью конечного числа шагов данной Марковской цепи. В процессе рандомизации кроме явно задаваемых критериев отбора графов ограничений используются разные алгоритмы реализации Марковских цепочек, которые обеспечивают получение равновероятно всех возможных графов, которые сохраняют либо распределение степеней вершин, либо совместное распределение степеней вершин. Для генерации случайных графов с заданными ограничениями можно задавать вероятность замены ребер, зависящую от функционала отклонения модели на очередном шаге Марковского процесса от исходной биологической сети по заданным структурным характеристикам, которые необходимо сохранить в модели, например коэффициент кластеризации, спектр кластеризации, частота структурных мотивов и т. д. Одним из наиболее распространенных является алгоритм, подобный оптимизации методом имитации отжига, когда вероятность отбора соответствует распределению exp, где функционал отклонения модели от исходной биологической сети, который можно интерпретировать как энергию системы при некоторой температуре . Например, в реализованной нами программе RNGmotifs для генерации случайных графов с частотой структурных мотивов, совпадающей с характеристиками исходной биологической сети, используется, где, частоты наблюдения мотивов в биологической сети и модели соответственно, число мотивов в ограничении. Предполагается, что процесс протекает при постепенно понижающейся температуре с увеличением шага Марковской цепи. В этом случае в начале Марковского процесса используется более мягкий критерий отбора принимаются варианты обмена рбер в графе, которые могут привести к отклонению значения функционала качества, но далее критерий становится более жестким, что обеспечивает, в конечном счете, сходимость структурных характеристик модели к характеристикам исходного графа. Такой вариант управления сходимостью функционала качества обусловлен необходимостью выйти из возможного локального минимума функционала и обеспечить возможность достижимости всех графов, имеющих заданные характеристики. Для отбора статистически значимых мотивов в качестве нулевой гипотезы могут быть использованы случайные графы, сохраняющие распределение степеней вершин. При другом подходе, предлагаемом нами, используется пошаговый алгоритм, когда для отбора мотивов степени 1 в качестве нулевой гипотезы используются случайные графы, сохраняющие не только распределение степеней вершин, но и частоты неслучайных структурных мотивов размером . В этом случае структурная модель строится последовательно, начиная от мотивов размером 3 и далее, пошагово включая в структурную модель мотивы большего размера. Для генерации структурных моделей нами также используется подход, основанный на так называемых -сериях, реализованный в программной библиотеке Random Network Generator 26. -серия является вложенной структурой каждый следующий уровень 1 -распре деления содержит тот же объем информации об исходном графе, что и -распределение, но при этом также предоставляет о нем дополнительные сведения посредством включения в список ограничений более строгих правил генерации. Так, нулевой элемент последовательности, 0 -распределение, фиксирует самую грубую из возможных характеристик графа среднюю степень вершин, что дает наиболее слабое из правил генерации. Следующий элемент, 1 -распределение, сохраняет распределение степеней вершин более строгое условие, чем сохранение средней степени вершин. 2 -распределение сохраняет уже совместное распределение степеней вершин, т. е. число подграфов размером 2 другими словами, рбер между вершинами со степенями и . Таким образом, 2 -распределение обозначает попарную корреляцию степеней вершин, а также коэффициент ассортативности графа. 3 -распре деление сохраняет 3-совместное распределение степеней вершин, т. е. подграфов в виде замкнутого треугольника и клик, состоящих из трех вершин со степенями, и, что определяет коэффициент кластеризации, и т. д. 20 26. Здесь используются два варианта рандомизации графа 1 описанный выше алгоритм рандомизации графа с сохранением распределения степеней вершин и 2 алгоритм рандомизации графа с сохранением совместного распределения степеней вершин. В последнем варианте на каждом шаге Марковского процесса выполняются следующие операции. 1. Выбираем равновероятно одно ребро графа, . Далее выбираем равновероятно одну вершину в этом ребре. Пусть это будет . 2. Выбираем равновероятно другую вершину графа такая, что . Далее выбирается равновероятно соседняя вершина, инцидентная . Это дает второе ребро, . 3. Замена рбер в графе, . 4. Если, простой граф, то с заданной вероятностью принимается, иначе, . Такая процедура позволяет выбирать равномерно случайно все возможные элементы, имеющие заданное распределение степеней рбер и совместное распределение степеней вершин 27. Для определения критерия остановки используют различные подходы. Однако теоретические оценки дают слишком большие значения числа шагов, что практически трудно реализуемо для больших графов. В работе 28 предложен более практичный критерий остановки, который находится на основе сходимости распределения вероятностей ряда структурных характеристик графа глобальный коэффициент кластеризации, диаметр графа, максимальное собственное значение Лапласиана графа к стационарному распределению, т. е. если распределение структурных характеристик графа практически не меняется при достижении неко тором числа шагов, то процесс можно останавливать. В результате рекомендовано исполь зовать число шагов Марковского процесса, где число рбер в графе, а 5 30. Говоря о возможностях генерации случайных графов в целом, следует отметить, что Random Network Generator поддерживает работу с -серией вплоть до уровня 2, включая его расширения в виде 2.1 и 2.5 26. Эти уровни являются частными расширениями 2, полученными в результате добавления правил генерации в виде сохранения коэффициента кластеризации и спектра кластеризации исходного графа соответственно. Таким образом, Random Network Generator может применяться для пошаговой реконструкции структурных моделей согласно -серии. Система генерации структурных моделей построена по архитектуре клиент-сервер, где в качестве клиента выступает плагин-приложение системы визуализации графов Cytoscape 2931, а в качестве сервера удаленный вычислительный сервис с модульным подключением программных средств построения структурных моделей. Система Cytoscape это программная платформа с открытым исходным кодом для визуализации и анализа сложных биологических сетей с возможностью интеграции разного типа биоинформационных данных, таких как функциональная аннотация генов, уровень экспрессии генов и пр. Важной особенностью программной архитектуры Cytoscape является технология расширения функциональности системы путем подключения дополнительных модулей плагинов, созданных на языке Java сторонними разработчиками. Большая часть плагинов более 300 доступна на Cytoscape App Store, и их можно устанавливать с помощью менеджера приложений App Manager 32. Большая часть этих плагинов Cytoscape разработаны для решения различных задач биоинформатики в частности, загрузка биологических сетей из доступных баз данных, реконструкция биологических сетей на основе интеграции гетерогенной информации, визуализация, сравнение и анализ сетей, выявление функциональных модулей в сети, генерация атрибутов узлов сети с использованием доступных баз биологических данных, например базы данных по экспрессии генов, GO Gene Ontology аннотации и т. д. Система Cytoscape при реализации проекта дает возможность использовать этот функционал как для получения биологических сетей, так и для анализа структурных моделей. В рамках разрабатываемой системы, плагин-приложение является тонким клиентом, т. е. весь функционал по обработке загружаемых сетей ложится на удаленный вычислительный сервис. Плагин-приложение Cytoscape реализовано на языке Java, вычислительный сервис реализован на языке GoLang 33. Взаимодействие между клиентом и сервером реализовано посредством фреймворка gRPC 34 35 с применением протокола сериализации структурированных данных Protocol Buffers 36. При разработке интерфейса использовались основные компоненты библиотеки Java Swing JPanel, JScrollPane и JTree. В качестве основного элемента интерфейса используется древовидное представление текущей сессии работы с удаленным сервисом. В зависимости от выбранного пользователем элемента дерева, ему предлагается различный набор доступных опций. Например, при выборе узла верхнего уровня, соответствующего одному из доступных методов обработки исходной сети, пользователю предоставляется панель настройки параметров запускаемого алгоритма см. рисунок. Разработанная нами система позволяет асинхронно конструировать структурные модели заданных биологических сетей в виде случайных графов посредством программных библиотек Random Network Generator 26 и RNGmotifs, разработанной в ИЦиГ СО РАН на основе модификации пакета GTrie Scanner 37. Пользовательский интерфейс плагина Cytoscape обеспечивает загрузку биологической сети для анализа, формирование запроса на удаленный вычислительный сервер для реконструкции различных структурных моделей в соответствии с их спецификацией, визуализацию реконструированных структурных моделей и их сравнительный анализ в пакете Cytoscape. Целью вычислительного эксперимента является исследование того, как изменяется время вычислений при генерации различных структурных моделей в зависимости от структурных характеристик исходных биологических сетей. В качестве исходных данных были выбраны следующие биологические сети 1 сеть взаимодействия заболеваний человека 1 419, 2 738, построенная на основе данных об известных ассоциациях заболевание ген и указывает на общее генетическое происхождение многих заболеваний 38 2 сеть белок-белковых взаимодействий у дрожжей 2 361, 5 375 39 3 сеть белок-белковых взаимодействий в печени мыши для белков с циркадным изменением скорости трансляции 5 753, 98 813 40 4 сеть белок-белковых взаимодействий в печени мыши для белков с циркадным изменением скорости трансляции и повышенной скоростью трансляции в начале суток 0 2 702, 25 893 40. Сеть белок-белковых взаимодействий в печени мыши PPI была построена на основе базы данных IID Integrated Interactions Database, версия от 2017-04 41. Далее было выбрано подмножество белков, скорость трансляции которых в печени мыши имеет выраженное изменение в течение суток. С использованием этого подмножества взаимодействующих белков с циркадным изменением скорости трансляции была сформирована сеть белок-белковых взаимодействий 3 PIN 40. Если из белков, гены которых имеют выраженную суточную динамику трансляции, выбрать для каждого момента времени суток подмножества белков со скоростью трансляции в это время больше, чем среднесуточное значение, то мы получаем множество сетей белок-белковых взаимодействий или динамическую сеть белокбелковых взаимодействий PIN T, зависящую от времени суток 40. Таким образом сформирована сеть 4 PIN T0, которая является подмножеством сети 3. Исследование циркадных изменений динамической сети белок белковых взаимодействий PIN T имеет большое значение для выявления главных компонент структуры математической модели циркадного осциллятора. Используя разработанный нами Cytoscape плагин и реконструированную сеть была проведена генерация структурных случайных моделей различного уровня точности dk1.0 сохранение распределения степеней вершин, dk2.0 сохранение совместного распределения степеней вершин, т. е. распределения и корреляций степеней вершин, dk2.1 сохранение совместного распределения степеней вершин и коэффициента кластеризации и dk2.5 сохранение совместного распределения степеней вершин и спектра кластеризации, т. е. вероятности того, что два узла, соседних с узлом степени, будут соседями. Расчеты выполнялись на рабочей станции HP Z800 Xeon 2x X5570QC 2.93ГГц. Сравнительные результаты времени расчетов указанных биологических сетей представлены в таблице. Время вычислений реконструкции моделей биологических сетей, с и предсказание времени вычислений по структурным характеристикам сети Как показывают результаты вычислительного эксперимента, скорость сходимости может сильно различаться даже на сетях с сопоставимым количеством вершин и рбер. Для исследования зависимости времени расчетов от структуры сети нами были оценены различные характеристики сети размеры сети, распределение степеней вершин, коэффициенты кластеризации и ассортативности. Анализ показал, что распределение степеней вершин во всех использованных в вычислительном эксперименте сетях имеет зависимость, где и параметры распределения, которые были оценены для каждой сети с коэффициентом детерминации от 0,87 до 0,92 и уровнем значимости value 10 . Далее для предсказания времени вычисления каждой модели мы использовали метод пошаговой регрессии. Наиболее информативным показателем, учитывающим влияние структуры сети на логарифм времени вычислений, оказались характеристики распределения степеней вершин, в частности параметр . В таблице представлены результаты предсказания времени расчета с указанием уровня достоверности и коэффициента детерминации квадрат коэффициента корреляции между предсказанным и истинным значением времени рас чета. Предсказание времени выполнения запросов для вычисления структурных моделей биологических сетей важно для планирования вычислительных экспериментов. Безусловно, полученные результаты можно использовать только для сетей, имеющих указанную зависимость распределения степеней вершин. Тем не менее предварительные результаты показали перспективность такого рода исследования для этого класса биологических сетей. При этом накопление вариантов проведенных расчетов моделей для различных биологических сетей такого рода могут автоматически использоваться для уточнения предсказания. Разработана система построения структурных моделей биологических сетей в виде набора случайных графов, структурные закономерности которых совпадают со структурными закономерностями исходной биологической сети. При генерации структурных моделей в случайных графах могут быть зафиксированы следующие характеристики распределение степеней вершин, попарное распределение степеней вершин, средняя степень соседних вершин, коэффициент кластеризации, спектр кластеризации, частота заданных структурных мотивов различных размеров и т. д. Система построена по архитектуре клиент-сервер и состоит из плагина-приложения Cytoscape и удаленного вычислительного сервиса. Взаимодействие между клиентом и сервером реализовано посредством фреймворка gRPC с применением протокола сериализации структурированных данных Protocol Buffers. Система позволяет асинхронно конструировать структурные модели заданных биологических сетей в виде случайных графов посредством программных библиотек Random Network Generator и RNGmotifs, разработанной в ИЦиГ СО РАН на основе модификации пакета GTrie Scanner. Пользовательский интерфейс плагина Cytoscape обеспечивает загрузку биологической сети для анализа, формирование запроса на удаленный вычислительный сервер для реконструкции различных структурных моделей в соответствии с их спецификацией, визуализацию реконструированных структурных моделей и их сравнительный анализ в пакете Cytoscape. С использованием разработанной системы проведен вычислительный эксперимент по реконструкции структурных моделей ряда биологических сетей, для которых удалось построить алгоритм предсказания времени расчетов структурных моделей. 