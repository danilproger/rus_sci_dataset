ОПТОЭЛЕКТРОННЫЕ ПРОЦЕССОРЫ С ПЗС-ФОТОПРИЕМНИКАМИ. КОНВЕЙЕРНАЯ ОБРАБОТКА СИГНАЛОВ 

Обсуждаются алгоритмы потоковой обработки информации в оптоэлектронных процессорах. Конвейерная обработка сигналов с применением ПЗС-фотоприемника в специальном режиме накопления позволяет существенно сжать поток данных на входе цифрового узла. Приводится одна из возможных реализаций оптоэлектронного процессора непрерывной обработки сигналов применительно к задаче радиоастрономии. Ключевые слова Ключевые слова Ключевые слова Ключевые слова Ключевые слова — оптоэлектронный процессор, конвейер, фотоприемник на приборе с зарядовой связью, акустооптический анализатор спектра, аппаратная функция, пульсар. 

В последнее десятилетие стремительно развиваются все направления вычислительной техники, особенно те, которые связаны с повышением скорости вычислений. Ввиду технологических ограничений на рост тактовых частот электронных процессоров все больше внимания уделяют исследованию и созданию архитектур отдельных процессоров, построенных на новых физических принципах, а также мультипроцессорных многоядерных систем с разнородными процессорами. Особое внимание привлекают оптические методы обработки информации. Одним из типов новых процессоров являются оптоэлектронные ОЭ процессоры, в которых высокие скорости и параллельность оптических преобразований сочетаются с традиционными электронными и цифровыми методами обработки. В рамках мультипроцессорных систем особенно эффективно применение таких гибридных ОЭ-процессоров на этапе предварительной обработки информации в системах обработки потоков данных в мультимедийных задачах, задачах астрономии, связи и др. Наиболее общая структура ОЭ-процессора, обеспечивающего решение задач обработки сигналов, имеет вид, представленный на рис. 1. Информация в ОЭ-процессор сигнал поступает в реальном времени с выхода источника сигналов. Оптический узел оптический процессор осуществляет практически в реальном времени интегральное преобразование над сигналом, вид которого определяется выбранной схемой. Пространственное распределение интенсивности света регистрируется многоэлементным ПЗС-фотоприемником и в виде последовательности отсчетов сигналов вводится в цифровой узел. Цифровой узел спецпроцессор обеспечивает надежную и долговременную память, необходимую точность и гибкость алгоритмов обработки сигнала, возможность оперативно управлять режимом работы ФПЗС и оптического процессора. Результатом обработки потока входных данных является выходная информация . Описанный ОЭ-процессор по классификации параллельных вычислительных систем Флинна можно рассматривать как векторный процессор класса SIMD 1. Векторность достигается за счет использования оптического узла. Размер входного вектора оценивается для 1D-процессора в 1000 элементов, а для 2D-процессора в 10 элементов. Быстродействие ОЭ-процессора в первую очередь определяется быстродействием оптического процессора, которое обычно для фурье-процессора оценивают величиной 10 флопсов 2. Однако традиционные ограничения, связанные с медленными вводом и выводом информации из оптического узла, снижают быстродействие до величины 1 Гфлопс. Особенно не хватает быстродействия при выводе, когда параллельную оптическую информацию фотоприемник преобразует в последовательную для цифрового узла. Структуры оптических 1Dи 2D-устройств, особенно акустооптических, для спектральной и корреляционной обработки сигналов достаточно глубоко изучены как в России 37, так и за рубежом 8, 9. Однако для эффективного применения оптической обработки информации необходимо использовать современные технологические достижения и разрабатывать новые алгоритмы распределенной потоковой обработки сигналов. Среди достижений по разработке компонент процессоров следует отметить создание многоэлементных матриц лазерных излучателей с вертикальными резонаторами vertical cavity surface emitting laser VCSEL ПЗС-фотоприемников с различной геометрией и архитектурой фотоприемников на МОП-структурах, которые включают и сенсорную матрицу, и программируемую логику для размещения программ обработки микропроцессоров с тактовыми частотами до 1 ГГц. Известен ОЭпроцессор EnLight 256 компании Lenslet Израиль 10. Он содержит линейку 256 лазеров, матричный транспарант размерностью 256 256 элементов, выполнен на основе микротехнологии MEMS, работает на тактовых частотах 125 МГц производительность 8000 ГГц. Процессор доведен до уровня использования его в качестве процессора обработки сигналов, оснащен всем комплексом технических средств отладки и разработки программ отладочный модуль, среда разработки. При разработке ОЭ-процессора решаются три задачи выбор типа оптического узла, определение режимов работы фотоприемника по обработке оптического сигнала и определение алгоритмов работы цифрового узла. При этом процессор цифрового узла полностью загружен операциями по управлению фотоприемником и потоковой обработкой отсчетов и является неотъемлемой частью ОЭпроцессора. В данной статье будет рассмотрен новый способ обработки сигналов в ОЭ-процессоре на примере задачи спектрального анализа. Будет показано преимущество этого способа, возможность его реализации с использованием линейного ФПЗС, а также его применение в радиоастрономии. Схема оптического узла рассматриваемого ОЭпроцессора соответствует традиционной схеме акустооптического спектроанализатора 5, 11 рис. 2. Подлежащий обработке радиосигнал после усиления подается на промежуточной частоте на акустооптический модулятор . АОМ и фурьелинза выполняют преобразование Фурье входного сигнала, формируя в выходной плоскости оптическое распределение с интенсивностью Пространственная координата линейно связана с частотой анализируемых радиосигналов. Распределение отражает спектр мощности анализируемого сигнала в скользящем окне длительностью, где временная апертура АОМ. Распределение детектируется и накапливается в, а затем считывается с частотой . В эквивалентной схеме аналоговой части ОЭпроцессора рис. 3 выделены три узла и соответствующие им основные этапы преобразования акустооптическое преобразование, накопление и перенос зарядовых пакетов в ФПЗС, последовательное считывание зарядов из выходного узла с усилением и аналого-цифровым преобразованием 7. На первом этапе когерентное излучение проходит через акустооптический транспарант, где входной сигнал координата в плоскости транспаранта АОМ скорость волны в звукопроводе модулятора. На модуляторе происходит дифракция Брэгга, в фокальной плоскости фурье-линзы наблюдается сигнал, близкий к спектру входного сигнала . Этот сигнал взвешен аппаратной функцией спектроанализатора . В плоскости фотоприемника наблюдается сигнал 1 На втором этапе происходит детектирование, дискретизация и интегрирование оптического сигнала в элементах ФПЗС 2 где заряд в -м элементе ФПЗС апертурная функция элемента. Каждый из элементов ФПЗС имеет свой коэффициент передачи. Третий этап передача зарядовых пакетов по ФПЗС. Наличие линии задержки отражает последовательный по тактовым импульсам характер передачи. Четвертый этап соответствует преобразованию зарядового пакета в цифровой отсчет. Заряд претерпевает преобразование в выходном узле с емкостью, усиливается в двух усилителях коэффициент усиления и преобразуется в аналого-цифровом преобразователе . При обработке сигналов с линейно-частотной модуляцией ЛЧМ, которые возникают в задачах связи, локации, радиоастрономии, сигнал перемещается по элементам ФПЗС со скоростью, определенной параметрами самого сигнала. Для непрерывной регистрации такого перемещающегося изображения можно применить один из двух режимов сканирования цифровое или аналоговое. Первый режим традиционный и широко применяется, второй разрабатывается с участием автора и применяется в ОЭ-процессорах при решении различных задач. Сравним эти режимы при использовании ОЭпроцессора в радиоастрономии для обработки сигналов пульсаров 12. При цифровом сканировании за время прохождения сигнала пульсара по фотоприемнику необходимо зарегистрировать не менее 100 отдельных кадров с ФПЗС, а затем в цифровом процессоре обработки просуммировать их с компенсацией сдвига. Период следования импульсов для одного из ярких и широко наблюдаемых пульсаров PSR 193721 составляет 1,55 мс. Отсюда требуемое время считывания кадра с ФПЗС 15 мкс, а частота вывода для 1000-элементного фотоприемника около 70 МГц. Максимальные же частоты вывода зарядовых пакетов из ФПЗС у лучших фирм мира Dalsa, Sony не превышают 40 МГц. Однако в процессоре Communication Research Laboratory, Japan 13 применено цифровое сканирование. В этой системе максимальная частота вывода зарядовых пакетов составляет 20 МГц, при этом пространственное разрешение уменьшено до 256 элементов. Другими недостатками такого подхода являются перерывы в сеансах регистрации сигналов, необходимые для цифровой обработки кадров повышенный уровень собственных шумов ОЭ-процессора, связанный с процессами неэффективности переносов и считывания из выходного узла ФПЗС 14. При аналоговом сканировании зарядовые пакеты в ФПЗС-регистре перемещаются синхронно и параллельно с перемещением изображения по фотоприемнику . Скорость движения элементов ПЗС определяется внешним управлением частотой, где шаг расположения элементов. В процессе перемещения в зарядовых пакетах происходит накопление, а значит и увеличение заряда. На выходе ФПЗС формируется сигнал, соответствующий огибающей радиоимпульса. ФПЗС в этом случае работает в режиме временной задержки и накопления ВЗН time delay and integrating TDI 15. Полное время накопления сигнала, где количество элементов в регистре ФПЗС. В этом случае ОЭ-процессор работает в конвейерном режиме с двумя этапами накопление кадра зарядовых пакетов с одновременным суммированием с зарядами предыдущего кадра, перенос пакетов на один ПЗС-элемент и снова первый этап. Конвейерное накопление зарядов соответствует классу MISD конвейерных процессоров в классификации Флинна 1. Конвейерный режим существенно упрощает аппаратуру цифровой регистрации, позволяет использовать линейный ФПЗС с большим количеством элементов более 1000. Для пульсара PSR 193721 частота конвейера частота вывода из ФПЗС составляет около 100 кГц, что легко получить для всех линейных фотоприемников. Рассмотрим влияние на аппаратную функцию процессора рассогласование скорости сканирования конвейера и скорости перемещения сигнала, считая, что сигнал ведет себя как ЛЧМсигнал . ЛЧМ-сигнал с длительностью можно записать cos2 2 2, где амплитуда 2 крутизна ЛЧМ-сигнала, здесь полоса частот, равная полосе АОМ. Определим аппаратную функцию процессора в движущейся со скоростью системе координат в случае приближения равномерной засветки и пренебрежения квадратичного набега фаз 16 3 где пространственная апертура АОМ фокусное расстояние линзы длина волны света нормированная координата в плоскости АОМ рассогласование скоростей., где шаг частотной шкалы. Во временной области . Аппаратные функции, рассчитанные по формуле 3 при разных частотах конвейера отстроенных от оптимальной, представлены на рис. 4. Координата нормирована на ширину аппаратной функции процессора . Если движение зарядов в ФПЗС синхронно с движением сигнала 0, то аппаратная функция конвейерного процессора является функцией sinc . Видно, что при рассогласовании наблюдается уширение, уменьшение амплитуды и смещение аппаратной функции. Необходима точная настройка не хуже 0,5 частоты конвейера на скорость изменения частоты сигнала. Применение конвейерного режима связано с решением двух вопросов организации режима ВЗН в фотоприемнике и его использования в рамках ОЭ-процессора. Известны специализированные матричные ВЗН-фотоприемники, которые применяются, в частности, в системах наблюдения участков небесной сферы при неподвижном телескопе. Такие ФПЗС выпускаются преимущественно фирмами Dalsa, Reticon, Texas Instruments и др. Для организации конвейерного накопления в линейных ФПЗС возможно использовать широко выпускаемые фотоприемники, предназначенные для покадрового вывода изображений. Можно выделить две основные схемы линейных ФПЗС для организации режима ВЗН с одним регистром накопления и сдвига отечественный ФПЗС-1Л и с выделенным регистром накопления фотоприемник ILX703A фирмы Sony. В первой схеме рис. 5, накопление и перенос зарядовых пакетов происходит в регистре сдвига и вывода режим ВЗН всегда реализуется. Во второй схеме рис. 5, накопление зарядов происходит в фоточувствительных элементах выделенного регистра накопления, затем заряд переносится в регистр сдвига, сдвигается на один элемент, новый заряд из регистра накопления переносится в регистр сдвига, где он суммируется с имеющимися зарядами, сдвигается и т. д. Чаще всего в регистре накопления используются фотодиоды. Не каждый фотоприемник с выделенным регистром накопления позволяет реализовать ВЗН-режим. Мы уже несколько лет используем ФПЗС ILX703 фирмы Sony для конвейерной обработки сигналов. Схема линейки ФПЗС аналогична схеме на рис. 5, . Режим ВЗН является нестандартным для данного фотоприемника. Временная диаграмма сигналов представлена на рис. 6. Сигнал CLK обеспечивает сдвиг на один элемент зарядовых пакетов в выходном регистре. Сигнал ROG подается на регистр переноса и обеспечивает перенос зарядов из регистра накопления в выходной регистр сдвига. Экспериментально определены временные соотношения сигналов CLK и ROG. Отрицательный импульс ROG должен быть вложен в положительный импульс CLK. Время должно быть не меньше 100 нс. На диаграмме показана форма сигнала с выхода ФПЗС, которая отличается от формы сигнала кадрового режима, и момент запуска АЦП. Для применения конвейерной обработки сигналов в цифровую часть ОЭ-процессора были включены рис. 7 целочисленный цифровой сигнальный процессор ADSP2181 формирователь импульсов управления ФПЗС синтезатор DDS AD9835 тактовой частоты, программируемый от ЦСП. Связь с ЭВМ поддерживается через интерфейс RS232. Формирователь импульсов по тактовым импульсам вырабатывает сигнал старта АЦП и два сигнала управления ROG и CLK см. рис. 6. В схеме реализована возможность переключать по команде из компьютера режим работы конвейерную или кадровую обработку сигналов. ЦСП выполняет следующие функции обработки двойную цифровую коррелированную выборку формирование виртуальных элементов за счет суммирования отсчетов синхронное с периодом повторения сигналов суммирование кадров в 32-разрядных словах непрерывный потоковый ввод отсчетов и вывод их в ЭВМ без потери входной информации. В процессе работы зарядовые пакеты непрерывно выводятся с ФПЗС, также непрерывно после АЦП отсчеты поступают в ЦСП, который их считывает по прерыванию от АЦП. Для выделения кадров, которые соответствуют периоду входных импульсов, используется внешний импульс . Особенность описанной схемы заключается в отсутствии синхронизации между импульсом периода кадров и импульсами с ФПЗС. В результате точность определения момента прихода входного сигнала определяется временем одного отсчета с фотоприемника период импульса CLK. В астрофизике и наблюдательной радиоастрономии одним из объектов исследований являются пульсары, представляющие собой нейтронные звезды с высокой и очень стабильной скоростью вращения. Импульсное радиоизлучение пульсаров наблюдается в широком диапазоне частот от 100 МГц до 10ГГц с периодом повторения импульсов от единиц миллисекунд до единиц секунд. Радиоизлучение пульсаров имеет ряд особенностей, главная из которых дисперсия в межзвездной среде 12. Из-за дисперсии короткий импульс радиоизлучения пульсара перемещается по частоте в полосе приема с центральной частотой от высоких частот к низким со скоростью 4 где мера дисперсии пульсара, парсексм частота, МГц. Каждый пульсар имеет свою и, следовательно, свою скорость перемещения по фотоприемнику. В некоторой полосе частот импульсы пульсаров можно представить в виде ЛЧМимпульсов. Для обработки этих импульсов можно использовать ОЭ-процессор с конвейерным режимом обработки. Нами был разработан рабочий макет ОЭ-процессора. Внем использовался He-Ne-лазер ЛГН-207А, АОМ, выполненный на кристалле ТеО с временной апертурой 15мкс, и линейный ФПЗС ILX-703A Sony, имеющий 2048 элементов размером 14 14 мкм. Акустооптический процессор имел центральную частоту 150МГц, рабочую полосу частот 80МГц и шаг следования частотных каналов 82кГц. ЦСП программированием синтезатора на разные тактовые частоты обеспечивал перестройку процессора для обработки сигналов пульсаров с мерой дисперсии от 15 до 1000парсексм . Установлен ОЭ-процессор в пульсарном приемном комплексе радиотелескопа РТ-64 с диаметром антенны 64м Калязинской радиоастрономической обсерватории ФИАН 17 рис. 8. Малые плотности потоков большинства пульсаров порядка 10 Втм Гц на частоте 1,4ГГц потребовали дополнительного накопления сигналов по большому числу до 10 и более периодов для получения отношения сигнал шум1. Полное время накопления для получения профиля одного импульса достигало 2 ч, причем в ЦСП сигналы накапливались в течение 3 мин. Работа ЦСП синхронизировалась по импульсам период пульсара . Специальная система синхронизации Служба времени рассчитывала ожидаемые моменты прихода импульсов излучения пульсаров, учитывая изменения периода из-за вращения Земли и другие факторы. С помощью разработанного процессора в диапазоне 1,4ГГц были проведены успешные наблюдения ряда пульсаров, как секундных, так и миллисекундных, одновременно и синхронно с их регистрацией в диапазоне 600МГц на штатном фильтровом комплексе АС-600160 ФИАН. Профили импульсов представлены в таблице. Время получения профиля для разных пульсаров различно и определяется плотностью потока излучения пульсара. Если для первых двух пульсаров это время составляло 1015 мин, то для слабых 24 мЯн миллисекундных пульсаров PSR 061302, 164022, 164312 время интегрирования достигало 2 ч. Профиль импульсов миллисекундного пульсара PSR 171307 выделялся из-под шума уже за 10 20мин и существенно лучше, чем на фильтровом приемнике. Формы профилей импульсов пульсаров, полученные на разных комплексах, несколько отличаются особенно для пульсара PSR 061302, что связано с разными частотными диапазонами, на которых работают эти устройства. Наблюдается более низкое отношение сигналшум у ОЭ-процессора, так как в диапазоне 1,4ГГц плотность потока излучения значительно меньше, чем на частоте 0,6ГГц. Особенность конвейерной работы предполагает, что в процессе регистрации сигналов от миллисекундных пульсаров по ФПЗС одновременно перемещаются несколько импульсов, для PSR 193721 таких импульсов пять. В случае секундных пульсаров по ФПЗС проходит один импульс. Представленные результаты наблюдений пульсаров см. таблицу позволяют сделать выводы о работоспособности рассмотренного ОЭ-процессора, а также о видимости приведенных пульсаров на радиотелескопе, выбрать пульсары для задач одновременных наблюдений на разных частотах. Более подробно результаты наблюдений представлены в работе 18. Применение ОЭ-процессора для решения задачи измерения меры дисперсии показано в работе 19. В настоящее время ведутся исследования по улучшению стабильности работы описанного ОЭ-процессора, связанные с разработкой методов учета дрейфов оптического узла. В статье рассмотрен ОЭ-процессор, в котором данные можно обрабатывать в реальном времени не только параллельно, но и конвейерно продемонстрирована его работа на радиотелескопе РТ-64. Перспективы использования таких процессоров для обработки сигналов связаны с улучшением параметров, применением новых оптических вычислителей и быстродействующих цифровых процессоров, а также с разработкой новых методов и алгоритмов обработки. Так, ведутся работы по созданию 2D-оптического вычислителя с использованием 2-канального АОМ. Это позволит реализовать в оптике совместное преобразование Фурье двух радиосигналов ортогональных поляризаций, определить их фазовые соотношения и поляризационные характеристики. В качестве ядра цифровой части рассматривается быстродействующий сигнальный процессор BlackFin 600 МГц. Автор выражает благодарность коллегам Центра оптоэлектронных проблем информатики СПбГПУ за совместную работу и участие в разработке и применении ОЭ-процессора, сотрудникам ФИАН доктору физ.-мат. наук Ю. П. Илясову и канд. техн. наук В. В. Орешко за организацию и участие в наблюдениях на радиотелескопе РТ-64. Автор особенно благодарен организатору работ руководителю Центра доктору физ.-мат. наук Н. А. Есепкиной. Работа поддержана грантами РФФИ 07-0201211 и 06-08-00090. 