ДВУМЕРНОЕ ПРЕОБРАЗОВАНИЕ ХААРА И ОСОБЕННОСТИ ЕГО ВЫЧИСЛЕНИЯ ПРИ ОБРАБОТКЕ ОПТИЧЕСКИХ ИЗОБРАЖЕНИЙ 

Рассмотрены особенности вычисления преобразования Хаара при обработке оптических изображений, которые описываются дискретными и непрерывными двумерными функциями. Приводятся обобщенная матрица преобразования Хаара и ее модифицированная форма. Показано, что у групп функций Хаара, соответствующих одинаковой эквивалентной секвенте, дисперсии коэффициентов разложения равны между собой. 

При цифровой обработке сигналов и изображений широкое распространение получило использование дискретных ортогональных преобразований в различных базисах 1, 2. При этом в случае двумерных сигналов, описывающих оптические изображения, двумерные ортогональные системы функций строятся на основе соответствующих одномерных систем. Свойством одномерного и двумерного преобразований Хаара является локальная определенность большинства базисных функций. Это делает неудобным их использование при обработке сигналов, определенных на всем анализируемом интервале в случае изображений сцен. В то же время при анализе локальных свойств сигналов, а также при обработке сигналов, локально определенных в области анализа изображений объектов конечных размеров, свойства функций Хаара могут быть полезными. Локальная определенность и связанная с ней нормировка функций Хаара приводят к особенностям вычисления двумерного преобразования Хаара, которые рассматриваются в настоящей работе. Одномерные функции Хаара определяются на интервале 0 следующим образом 13 1 Для одномерных функций Хаара 1 выполняются условия ортонормированности и замкнутости 3, а индексы обычной и двойной нумерации функции при связаны соотношением 2 где 1, ..., 2 . Вся система функций Хаара 1 образуется путем сжатия и сдвига функций, получаемых из функции . При этом степень сжатия определяется индексом, а величина сдвига индексом . Аналогичные функции с индексами и могут быть введены по координате в интервале 0 . Определим двумерные функции Хаара в области 0, 0 в виде произведений одномерных функций вида 1 2 При таком подходе образованная из исходных ортонормированных и замкнутых одномерных функций система двумерных функций 2 также оказывается ортонормированной и замкнутой 4 и может быть использована в обобщенном спектральном анализе. Следует отметить, что в работе 5 даны примеры построения на основе процесса сжатия и сдвига систем функций хааровского типа, отличающихся от приведенных. Мы будем рассматривать только классические функции Хаара, определяемые выражениями 1 и 2. В общем случае для любой квадратично-интегрируемой в области 0, 0 функции коэффициенты ФурьеХаара 3 образуют равномерно сходящийся двумерный ряд 4 где коэффициенты при функциях определяются выражением 2 5 где матрица коэффициентов Хаара размерностью матрица отсчетов исходной функции размерностью и матрицы преобразования Хаара размерностью и соответственно. Интервалы и при соответствующей нормировке отсчетов функции полагаются единичными, а число элементов разбиения выбирается равным 2 2, где и целые числа. Элементы матрицы преобразования Хаара определяются значениями базисных функций 1. Так, при 8 3 матрица преобразования Хаара имеет вид 6 Можно выделить следующие особенности матрицы, существенные с точки зрения вычисления двумерного преобразования Хаара. Во-первых, в отличие от матриц преобразований Фурье и Уолша, она является несимметричной, и в выражении 5 обязательно транспонирование второй матрицы преобразования. Во-вторых, элементы матрицы принимают значения 0 и где целое число, что создает определенные неудобства при реализации быстрых алгоритмов вычисления. В-третьих, при получении обобщенных выражений для матрицы преобразования Хаара приходится использовать нетрадиционные математические операции, что также затрудняет реализацию алгоритмов вычислений. Обобщенное выражение для матрицы преобразования Хаара при 2 может быть записано в виде 6 7 где знак вертикальной суммы 1 матриц, нумеруемых по сверху вниз знак кронекеровского произведения двух матриц матрица в -й кронекеровской степени Операции вертикального суммирования матриц, кронекеровского умножения и возведения матриц в степень определены в работах 1, 6. Первые две из вертикально суммируемых матриц в 7, соответствующие 0 и 1, имеют размерности 1, а последующие 1 матрицы, соответствующие 2, имеют размерность 2 . В результате получается квадратная матрица размерностью . Выполнение условия ортонормированности для локально определенных функций Хаара приводит к неодинаковым их уровням на интервалах ненулевых значений у различных групп из 2 функций, 1, и, соответственно, к различным значениям элементов матрицы преобразования Хаара . В то же время при реализации быстрых алгоритмов вычислений желательно использовать матрицы, элементы которых принимают значения 0 и 1. Этому условию удовлетворяет модифицированная матрица преобразования Хаара, которая получается при делении элементов матрицы 7 на При 8 3 модифицированная матрица преобразования Хаара имеет вид 8 С помощью модифицированной матрицы преобразования Хаара вычисляется матрица коэффициентов 9 а истинные коэффициенты Хаара равны На основе нормировочных коэффициентов могут быть составлены диагональные матрицы размерностями и так, что вычисление матрицы коэффициентов Хаара будет представлять собой умножение пяти матриц матрицы значений исходной функции, двух модифицированных матриц преобразования и двух нормировочных матриц. Выбор числа базисных функций в разложении 4 осуществляется следующим образом. Если функция дискретная и число точек по координатам и соответственно 2 и 2, то в силу полноты базисной системы функций Хаара 3 отсчеты функции могут быть однозначно представлены суммой двумерных функций . Если же функция непрерывная, то число элементов разложения определяется, исходя из требуемой точности ее аппроксимации конечной суммой ФурьеХаара. При этом элементы матрицы в выражении 5 соответствуют средним значениям функции на интервалах дискретизации размером по координатам и соответственно. Среднеквадратическая ошибка аппроксимации стационарной случайной функции конечным числом двумерных функций Хаара равна 10 где дисперсия случайной функции дисперсии случайных коэффициентов разложения 3 логический символ исключения. Коэффициент, исходя из определения функции Хаара, равен среднему значению функции в области анализа и поэтому исключается из рассмотрения. Для всех коэффициентов, образующих группы, соответствующие фиксированным значениям пар индексов и при двойной нумерации функций Хаара в выражении 1, дисперсии равны между собой. Это следует из выражения 11 где автокорреляционная функция стационарной случайной функции . Функции Хаара, соответствующие одинаковым значениям индексов и в двойной нумерации, отличаются друг от друга только сдвигом по соответствующей координате. Можно показать, что их произведения входящие в выражение 11, зависят только от величины сдвигов и . В результате все дисперсии соответствующие фиксированным значениям пар индексов и, равны между собой. Используем понятие секвенты как средней частоты пересечения функцией нулевого уровня 5. Тогда выделенные группы функции Хаара с одинаковыми индексами и характеризуются одинаковой эквивалентной секвентой. Следовательно, дисперсии коэффициентов функций Хаара при аппроксимации стационарных случайных функций равны для групп функций, соответствующих одинаковой эквивалентной секвенте. Число таких групп где log, log, а число функций в каждой группе 12 Они вносят одинаковый вклад в разложение функций . Таким образом, в работе приведены соотношения для двумерного преобразования Хаара, обеспечивающие реализацию на их основе простых вычислительных процедур. Даются рекомендации по составлению обобщенных матриц преобразования Хаара и выбор их размерности при анализе двумерных случайных функций. Опыт практического использования двумерного преобразования Хаара показывает, что вычислительные матрицы коэффициентов разложения удобно выводить в виде двумерных диаграмм, приведенных в работе 2. Такие диаграммы, упорядоченные по каждой координате по возрастанию номеров коэффициентов разложения и от 0 до и, характеризуют как пространственный спектр двумерной функции, так и форму описываемого ею объекта. 