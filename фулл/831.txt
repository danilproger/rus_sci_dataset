МЕТОДЫ ПОВЫШЕНИЯ КОНТРАСТНОСТИ РАСТРОВЫХ ИЗОБРАЖЕНИЙ ДЛЯ СИСТЕМ ЦИФРОВОЙ ОБРАБОТКИ ВИДЕОИНФОРМАЦИИ 

Приведен обзор методов повышения контрастности растровых изображений с целью увеличения визуальной различимости фрагментов, которые могут найти применение в системах цифровой обработки видеоинформации. Рассмотрены методы, основанные на преобразовании шкалы яркости, и адаптивные методы. We give a review of the methods to sharpen the contrast of raster images that can be used in the systems of digital video processing with the goal of increasing the visual discernibility of certain fragments. Methods based on the transformation of the brightness scale and adaptive methods are considered. 

В настоящее время коррекция изображений в системах цифровой обработки видеоинформации проводится в основном для компенсации пространственных искажений и подавления импульсных помех, а также для улучшения качества изображений. Алгоритмы, используемые для такой обработки, достаточно хорошо известны и применяются в различных программных пакетах и средах программирования, например в PhotoShop или Matlab. Следует отметить, что PhotoShop, обладая очень широкими возможностями по обработке изображений, предназначен в основном для создания различных визуальных эффектов с целью усиления эмоционального восприятия изображений, а не для повышения их информативности. Среда Matlab, включая в себя многочисленные процедуры обработки изображений, требует от пользователя знания специального языка программирования, а также необходимости написания и отладки отдельных программ для выполнения сложных алгоритмов обработки изображений. Для современных систем получения изображения в цифровом виде характерно практически полное отсутствие сколько-нибудь существенных яркостных и пространственных помех, однако полученные с их помощью изображения могут иметь недостаточную различимость отдельных фрагментов, которая может быть вызвана низкой или слишком большой освещенностью объектов отображаемой сцены. Известно 1, что человек не в состоянии точно определить границу между фрагментами монохромного растрового изображения, яркость которых отличается на один уровень при наиболее распространенном диапазоне в 256 уровней яркости. Неправильный выбор фокусного расстояния при получении изображения может вызвать существенное размывание контурных линий, что также снижает возможность визуального разделения отдельных фрагментов. Возможно и сочетание этих факторов, т. е. на одном изображении соседние фрагменты имеют низкие контрастность и резкость одновременно. Контрастность монохромного изображения можно определить как 1 где, соответственно максимальная и минимальная яркость пикселей на изображении. Относительная контрастность где 255 максимально возможная яркость. Из соотношения 1 видно, что контрастность может быть оценена как для всего изображения глобальная контрастность, так и для какой-то части изображения локальная контрастность. В частности, для локальной контрастности фрагментов под, понимаются соответственно яркости пикселей соседних фрагментов на линии их разделения. Под резкостью принято понимать отношение разности яркостей соседних фрагментов, т. е. их контрастность, к ширине контурной линии, разделяющей эти фрагменты, т. е. фактически пространственную производную яркости. Очевидно, что в отличие от контрастности резкость может быть только локальной. Исходя из данного определения резкость можно повысить, или сократив ширину контурной линии, или увеличив контрастность фрагментов, причем повышение контрастности всегда приводит к увеличению резкости. Методы увеличения контрастности и, как следствие, увеличения резкости можно разделить на глобальные, в основе которых лежит преобразование шкалы яркости, и адаптивные, в которых величина изменения яркости каждого пикселя зависит от характеристики окружающей его окрестности. В глобальных методах повышения контрастности производится линейное или степенное преобразование шкалы яркости. Если диапазон яркости изображения меньше, чем максимально возможный, то увеличение контрастности можно получить линейным растяжением шкалы яркости 1 где, яркость пикселя до и после преобразования. В результате гистограмма яркости станет более редкой, а разность яркости соседних фрагментов увеличится. Если диапазон яркости изображения уже максимален, то увеличения различимости соседних фрагментов можно добиться за счет нелинейного преобразования шкалы яркости методом гаммакоррекции или соляризации. Гамма-коррекция 2, или степенное преобразование шкалы яркости 2 где относительная яркость, позволяет увеличить контрастность в локальном диапазоне яркостей за счет снижения контрастности в других диапазонах рис. 1. Если известно, что плохо различимые фрагменты имеют высокую яркость, то следует выбрать значение для 2 из диапазона 210, в противном случае диапазон выбора для значения 0,10,5. Метод соляризации 3 позволяет еще больше увеличить различимость соседних фрагментов за счет слияния яркости фрагментов, симметрично расположенных на шкале яркости относительно ее середины рис. 2, причем снижается различимость фрагментов, имеющих яркость, близкую к средней. Примеры повышения контрастности приведены на рис. 3. Особенность исходного изображения заключается в том, что при общей недостаточной освещенности имеется несколько мелких фрагментов максимальной яркости снег на карнизах и подоконниках. Применение гамма-коррекции позволяет лучше увидеть ветки дерева в левом верхнем углу, а после соляризации можно рассмотреть и структуру занавесок на окнах. Приведенные гистограммы яркости обработанных изображений оказываются прореженными по сравнению с гистограммой исходного изображения. Методы повышения контрастности являются достаточно эффективными, так как в большинстве не требуют настройки параметров и очень быстро выполняются. Последнее обстоятельство объясняется тем, что сравнительно сложному преобразованию подвергается только шкала яркости, а яркость каждого пикселя обработанного изображения зависит от яркости только одного пикселя исходного изображения. В отличие от глобальных методов повышения контрастности ее адаптивное повышение требует установки ряда параметров и значительно большего времени на обработку. Визуального эффекта повышения контрастности при расфокусировке крупных фрагментов можно добиться путем подчеркивания контура, например, широко известным методом с использованием лапласиана 1. В данном методе яркость текущего пикселя обработанного изображения определяется как разность яркости соответствующего пикселя исходного изображения и второй производной яркости данного пикселя в некоторой окрестности с учетом знака. В результате яркость пикселя, находящегося в начале области перепада от меньшей яркости к большей, уменьшается, а яркость пикселя в конце этой области увеличивается. В итоге увеличивается контрастность контурной линии и визуально усиливается резкость изображения рис. 4. Основным недостатком этого метода является отсутствие избирательности, т. е. степень повышения резкости постоянна для всего изображения и не зависит от контрастности соседних фрагментов. Хорошие результаты дает адаптивное увеличение контрастности на основе локального контраста окрестности, который вычисляется 4 как где средняя яркость некоторой окрестности пикселя яркостью . Нелинейное усиление локального контраста задается как где нелинейная, монотонная функция, которая удовлетворяет условиям, 01, 01. В качестве функции можно выбрать степенную функцию 3 где 0,11,0. График такой функции совпадает с представленным на рис. 1 графиком гамма-коррекции для 1. Результирующая яркость центрального пикселя окрестности вычисляется по следующим соотношениям 4 Из 4 следует, что при 1 и соответственно . Чем меньше, тем больше относительно, а два варианта вычисления в зависимости от соотношения и позволяют увеличить контрастность граничных пикселей соседних фрагментов с близкой яркостью, практически не изменяя яркости пикселей хорошо различимых фрагментов. В 3 значение остается постоянным при любых значениях локальных контрастов, что приводит к нежелательному увеличению контрастности шумовой составляющей изображения. Избавиться от этого недостатка можно, выбирая для каждого пикселя значения в зависимости от характеристик локальной окрестности, т. е. используя адаптивную степень усиления локального контраста . Например, можно вычислять как 5 5 где, минимальное и максимальное значения степени соответственно 0,10,3 0,70,9 коэффициент адаптации 01 постоянный степенной коэффициент 1. Согласно 3, максимальное усиление локального контраста достигается при 0, т. е. при, а минимальное при 1, т. е. при . В качестве характеристик локальной окрестности пикселя предлагается использовать протяженность гистограммы, энтропию или среднеквадратичное отклонение яркости 5. Следует отметить, что размеры окрестности для вычисления этих характеристик могут существенно превышать размеры окрестности для вычисления локальной контрастности. Рекомендуемый в работе 5 размер составляет от 15 до 29 пикселей. Протяженность гистограммы локальной окрестности определяется 5 как 6 где, минимальное и максимальное значения яркости в окрестности соответственно максимальное значение гистограммы яркости окрестности. В данном случае под гистограммой яркости окрестности понимается функция, т. е. число пикселей в окрестности, имеющих яркость Из 6 следует, что фрагменты с постоянной яркостью имеют 0, так как на них . Фрагменты с равномерной гистограммой и максимально возможным диапазоном яркости имеют 255 при условии, что число пикселей окрестности 255 размер окрестности 16 16 пикселей и более, так как на них, ориентировочно, 0, 255, 1. У фрагментов с бимодальной гистограммой зависит от диапазона яркостей и соотношения числа пикселей в окрестности минимальной и максимальной яркости. При условии равенства этих чисел где диапазон яркости. Желательно определить так, чтобы 1 при 0 0 при и 1 при 1 и более. Данному условию отвечает уравнение Известно 5, что хорошие результаты можно получить при 0,5. Энтропия окрестности пикселя 5 7 где значение гистограммы яркости окрестности при, номер пикселя из окрестности 1 . Из 7 следует, что энтропия приобретает минимальное значение на однородных фрагментах, а максимальное на фрагментах с элементами, значения яркостей которых находятся на противоположных краях диапазона. В таком случае можно задать следующим образом 8 где, соответственно максимальное и минимальное значение энтропии окрестностей по всему изображению. Среднеквадратичное отклонение яркости локальной окрестности 9 где яркость пикселя из заданной окрестности средняя яркость окрестности число пикселей в окрестности. Согласно 9, среднеквадратичное отклонение ведет себя аналогично предыдущей характеристике локальной окрестности, следовательно, для вычисления вполне можно использовать формулу 8, заменив на соответствующие . На рис. 5 приведен пример обработки изображения с мелкими, плохо различимыми деталями различными адаптивными методами повышения контрастности. В результате обработки оказалась проработана структура волн на поверхности моря и подчеркнуты контуры мелких объектов. Следует отметить, что приведенный выше подход к определению для 5 сравнительно мало известен и еще не достаточно изучен. Для исследования возможностей адаптивного увеличения контрастности был создан программный продукт в виде Windows-приложения, реализующий описанные выше методы. Продукт позволяет подбирать параметры и наглядно сравнивать результаты обработки растровых монохромных изображений с плохо различимыми фрагментами разными методами. Представленные на рис. 35 изображения получены с помощью данной программы. Исследования показали, что подбор методов повышения контрастности изображения следует начинать с глобальных, как наиболее быстрых и не требующих настройки многочисленных параметров. Применение методов адаптивного повышения контрастности позволяет повысить различимость мелких малоконтрастных деталей, но требует проведения ряда предварительных экспериментов для точного подбора параметров. 