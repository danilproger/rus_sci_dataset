ВЫДЕЛЕНИЕ ОБЛАСТЕЙ ИНТЕРЕСА НА ОСНОВЕ КЛАССИФИКАЦИИ ИЗОЛИНИЙ 

Предлагается новый подход к выделению областей интереса на изображениях. Показано применение разработанного алгоритма к задаче выделения очагов поражения на изображениях магнитно-резонансной томографии мозга. Результаты тестирования разработанного алгоритма на реальных данных продемонстрировали его превосходство над аналогами.

 Задача семантической сегментации выделение объектов или областей интереса на изображениях особенно сложна при нечетких границах регионов, сильной зашумленности, отсутствии цветовой информации. Подобными свойствами обладают, например, изображения, полученные с помощью медицинского оборудования. В данной статье предлагается новый метод выделения областей интереса, который применим к изображениям с названными выше свойствами. Работа метода продемонстрирована на примере задачи выделения очагов поражения на изображениях магнитно-резонансной томографии мозга. Очаги поражения на изображениях МРТ мозга это обычно небольшие области повышенной или пониженной интенсивности, встречающиеся в нескольких местах. Иногда их количество достаточно велико. Они могут различаться между собой по форме и резкости границ, имеют вариации интенсивности и, как правило, визуально хорошо различимы по какому-либо признаку или набору признаков. Предложенный алгоритм направлен на то, чтобы максимально учесть глобальные свойства подобных областей интереса те свойства, которыми руководствуется человек при визуальном анализе. Алгоритм основан на построении изолиний функции интенсивности, расчете признаков на основе этих изолиний и построении классификатора, который идентифицирует изолинии, являющиеся контурами областей интереса. Обзор существующих алгоритмов В одной из первых работ в области выделения очагов поражения на изображениях МРТ мозга описан алгоритм, основанный на классификации пикселей в зависимости от их интенсивности с помощью искусственной нейронной сети 1. Фундаментальная работа 2 посвящена выделению областей интереса на основе принципа нечеткой связности. Связным объектом считается множество точек, в котором каждая пара точек удовлетворяет некоторому критерию связности. В данном случае этот критерий строится на основе разности интенсивностей пикселей и их пространственной близости. Алгоритмы из 1 и 2 являются полуавтоматическими, то есть требуют взаимодействия с пользователем. Для их работы необходимо предварительно отметить на изображениях достаточное количество точек, относящихся к другим областям, фону иили непосредственно к областям интереса. Данный подход может оказаться неустойчивым, так как принципиально зависит от аккуратности пользовательского ввода. К тому же у разных пользователей результаты могут сильно отличаться. Большинство существующих методов являются полностью автоматическими. Достаточное количество работ посвящено алгоритмам, которые используют классификаторы для отнесения пикселя к объекту или фону подобно 1. Вместо нейронных сетей применяются более современные и качественные классификаторы метод опорных векторов, рандомизированный решающий лес и т.д. 3. Для обучения классификаторов вместо отмеченных пользователем точек, как в 1 и 2, как правило, используются размеченные базы изображений. В таких алгоритмах решение об отнесении к объекту или фону принимается на уровне отдельных пикселей, имеющих весьма ограниченный набор характеристик интенсивность, координаты, информация о соседях. Этих сведений не всегда достаточно для принятия правильного решения. Существуют и другие подходы. Так, метод, описанный в 4, использует кластеризацию пикселей по интенсивности с помощью алгоритма ISODATA . Но при построении кластеров также берется лишь информация об интенсивности отдельных пикселей. Авторский алгоритм В данной работе предлагается новый подход классификация происходит сразу на уровне линий, а не на уровне отдельных пикселей. Это позволяет учесть информацию о форме, резкости границ и другие признаки объекта интереса, что невозможно в случае попиксельной классификации. Разработанный алгоритм является полуавтоматическим. На каждом изображении МРТ врач-радиолог выделяет прямоугольные регионы, в которых он подозревает наличие очагов поражения, если они имеются. Подобный подход описан в 5, где аналогичные ограничивающие прямоугольники называются слабыми метками. Далее внутри каждого из этих регионов очаги поражения выделяются автоматически. Данный подход позволяет повысить качество разметки по сравнению с полностью автоматическими методами и в то же время значительно сократить объем рутинной работы, необходимой при ручной разметке. Для построения замкнутых линий, среди которых имеются контуры искомых очагов поражения, применяется алгоритм построения изолиний функции интенсивности. Отбор линий, действительно являющихся контурами очагов поражения, происходит путем классификации методом опорных векторов. Построение изолиний. Алгоритм построения изолиний в общем случае используется для построения контурных карт карт изолиний некоторой функции от двух переменных. В данном случае в роли функции f выступает функция интенсивности пикселя I. По изображению строится карта высот, где высота точки задается интенсивностью пикселя с координатами на исходном изображении. Чтобы линии получались гладкими, определенным образом применяется интерполяция. В контексте задачи выделения областей интереса наибольшего внимания заслуживают замкнутые изолинии. Так, существует набор уровней, для которых замкнутые изолинии в точности соответствуют контурам очагов поражения на изображениях МРТ мозга. Классификация методом опорных векторов. Чтобы отделить замкнутые изолинии, соответствующие контурам искомых областей, от других замкнутых изолиний, требуется набор признаков, который будет использоваться классификатором. В задаче выделения очагов поражения на изображениях МРТ мозга врач-радиолог может идентифицировать нужные линии визуально. Необходимо подобрать признаки, наиболее схожие с теми, которыми пользуется человек при визуальном анализе и которые обеспечивают наилучшее разделение между искомыми и остальными замкнутыми изолиниями. Предлагается следующий набор признаков площадь фигуры, ограниченной линией периметр фигуры, ограниченной линией отношение средней интенсивности внутри и снаружи замкнутой линии разность интенсивностей вдоль внешней и внутренней границ замкнутой линии удлиненность фигуры, ограниченной линией. Обучение классификатора. Для обучения классификатора строится обучающая выборка. Метка класса y принимает два значения 1 в случае очаг и 1 в случае не-очаг.С целью наибольшей репрезентативности обучающая выборка формируется на основе изолиний, построенных по разным изображениям и регионам интереса. Для построения классификатора используется нелинейный метод опорных векторов с ядром RBF. Этот метод продемонстрировал лучшие результаты в отличие от метода с применением полиномиального ядра и линейного метода опорных векторов. Автоматическое выделение областей интереса внутри указанного региона. Чтобы найти контуры областей интереса внутри выделенного прямоугольного региона, необходимо сделать следующее построить изолинии для того же диапазона уровней, который использовался в обучающей выборке отобрать из построенных изолиний замкнутые линии для каждой из замкнутых линий рассчитать вектор-признак применить построенный в процессе обучения классификатор к каждому вектор-признаку оставить только те замкнутые линии, для которых классификатор выдал метку очаг.Таким образом, для каждого указанного прямоугольного региона с помощью описанной выше процедуры можно автоматически построить изображение, на котором обозначены контуры искомых областей. Эксперименты Для обучения и тестирования использовались данные, полученные из НИИ неотложной детской хирургии и травматологии . База состояла из МРТ-последовательностей мозга для семи пациентов, имеющих очаги диффузно-аксонального повреждения. Тестирование проводилось методом кросс-валидации. Каждая из семи МРТ-последовательностей поочередно была тестовой, а другие шесть в это время использовались для обучения. Результаты тестирования разработанного алгоритма и ISODATA приведены в таблице 1. В таблице 2 предложенный алгоритм сравнивается с алгоритмом Xie 5, в котором используются похожие слабые метки прямоугольные регионы интереса, предварительно указанные врачом. Из таблиц 1 и 2 видно, что и чувствительность предложенного алгоритма значительно превосходит аналоги, и коэффициент DSC выше. О показателях избирательности следует сказать, что большинство лишних изолиний отбрасывается еще на этапе выбора диапазона уровней для построения изолиний, потому линий с меткой не-очаг в обучающей выборке всегда примерно в 2 раза меньше, чем линий с меткой очаг.Таким образом, показатели избирательности предложенного алгоритма объективно выше приведенных в таблице значений. Более того, чувствительность алгоритма в медицинских приложениях, как правило, важнее избирательности, так как цена ошибки первого рода гораздо выше цены ошибки второго рода . В своей работе авторы проводили сравнение предложенного алгоритма с базовыми алгоритмами сегментации детектором краев Canny и разрастанием регионов. Результаты сравнения приведены на рисунке 2. Как видно из рисунка 2а, алгоритм Canny дает слишком много лишних линий, к тому же контуры очагов поражения могут получаться незамкнутыми. Разрастание регионов в целом демонстрирует лучшие результаты, чем детекторы краев, но этот метод пропускает много пикселей, относящихся к очагам поражения, иили дает много ложных срабатываний. Предложенный авторами алгоритм значительно превосходит оба этих алгоритма . Эти значения подобраны в ходе экспериментов. Для реализации предложенного алгоритма было разработано интерактивное приложение на языке C. На основании изложенного можно сделать следующие выводы. Предложенный подход к выделению областей интереса на изображениях основан на классификации изолиний, он может быть особенно полезен при обработке изображений, полученных с помощью медицинского оборудования. Разработанный алгоритм применен к задаче выделения очагов поражения на изображениях МРТ мозга. В работе проведен анализ существующих алгоритмов для решения подобных задач, перечислены их недостатки. Показано значительное превосходство предложенного алгоритма над базовыми алгоритмами сегментации, основанными на выделении краев, разрастании регионов, кластеризации. Кроме того, проведено сравнение алгоритма с одним из новых полуавтоматических алгоритмов выделения очагов поражения 5, которое показало общее превосходство предложенного алгоритма почти на 10 . 