ТРЕХМЕРНОЕ МОДЕЛИРОВАНИЕ И ИНВЕРСИЯ ДАННЫХ   КОМПЛЕКСА МЕТОДОВ ЭЛЕКТРОКАРОТАЖА В МОДЕЛЯХ СРЕД   С НАКЛОНОМ ГЛАВНЫХ ОСЕЙ ТЕНЗОРА ЭЛЕКТРИЧЕСКОЙ АНИЗОТРОПИИ  

    Впервые формулируются прямая и обратная задачи электрического каротажа об определении компонент тензора электрической анизотропии горных пород по комплексу измерений методами бокового каротажного зондирования и бокового каротажа в нефтегазовых скважинах. Рассматриваются особенности конечно элементной аппроксимации прямой задачи, использующей базисные функции большого порядка. Исследуется возможность  восстановления горизонтальной и вертикальной составляющих удельного электрического сопротивления, а также  угла наклона главных осей тензора электрической анизотропии.  : метод конечных элементов, многоуровневый метод, прямая и обратная задачи, электрический каротаж, тензор удельного электрического сопротивления.   Исследование выполнено при финансовой поддержке РФФИ и Правительства Новосибирской области   в рамках научного проекта № 17-45-540530.  

Начиная от поиска перспективных объектов, определения их запасов и заканчивая контролем за разработкой месторождений активно используются современные геофизические методы, позволяющие получить исчерпывающую информацию о нефтяных и газовых резервуарах. При изучении геологической среды большую роль играет реконструкция удельного электрического сопротивления УЭС горных пород по данным электрокаротажных зондирований 14. Оценка содержания углеводородов в резервуарах выполняется по значениям УЭС горных пород на основе измерений в скважине методами электрического каротажа. Существуют геологические среды, интерпретация данных измерений в которых требует специализированного математического описания и соответствующих вычислительных алгоритмов. К таким относятся слоистые осадочные породы, представленные переслаиванием тонких прослоев разного вещественного состава и электрофизических свойств, например сильно электропроводящих глинистых отложений и слабо электропроводящих нефтесодержащих песчаников. Такая среда является электрически анизотропной, поскольку значения УЭС в плоскости напластования и в вертикальном направлении существенно отличаются. Если не учитывать электрическую анизотропию при интерпретации данных электрического каротажа, это будет приводить к существенным ошибкам при определении оценки нефтесодержания. Эффект электрической анизотропии слабо изучен при исследовании трещиноватых карбонатных коллекторов, в которых наличие электрической анизотропии обусловлено системой субвертикальных трещин. Таким типом анизотропии обладают палеозойские сложнопостроенные коллекторы. Поэтому решение задачи об определении электрической анизотропии горных пород по данным электрического каротажа является чрезвычайно актуальной и имеет большое прикладное значение в промысловой геофизике. Требуется создание новых эффективных алгоритмов и реализация программных средств, адаптированных под традиционные комплексы методов каротажа скважин. Начиная с 1990-х гг. задачу определения параметров макроанизотропного коллектора решают, применяя индукционные зонды, где генерация токов и измерения выполняется в трехкомпонентных ортогональных катушках 511. Необходимость использования таких сложных систем, а также применения соответствующих ресурсоемких вычислительных схем и процедур интерпретации заметно снижает эффективность их применения. В настоящее время ведутся разработки принципиально новых каротажных систем, предназначенных для определения характеристик макроанизотропных коллекторов 1215. В представленной работе изучение электрической анизотропии геологических объектов базируется на интерпретации данных широко используемых методов электрического каротажа, исходно не предназначенных для изучения макроанизотропных сред. В рамках настоящей работы изучение эффекта электрической анизотропии выполняется по комплексу электрических каротажных методов бокового каротажного зондирования БКЗ и бокового каротажа БК. Необходимость их комплексирования обусловлена различной чувствительностью к компонентам электрической анизотропии. Особенности этих методов таковы, что сигналы зондов БКЗ имеют достаточную чувствительность к вертикальной компоненте анизотропии, а БК к радиальной. Таким образом, по комплексу данных БКЗ и БК становится возможным определение элементов диагонального тензора электрической анизотропии, а также оценки наклона его главных осей. Геофизическую модель рассматриваемой среды будем описывать при помощи функции, задающей зависимость УЭС от пространственных координат и вектора параметров . Последний будет содержать значения параметров геоэлектрической модели. В данной работе будут рассматриваться простые модели, состоящие из однородного пласта, скважины и корпуса зонда. Диаметр и УЭС скважины, а также геометрические характеристики корпуса каротажного зонда будем полагать фиксированными. В дальнейших обозначениях как один, так и оба параметра функции УЭС могут опускаться. УЭС будет полагаться анизотропным имеющим горизонтальную и вертикальную составляющие. Тензор УЭС будет характеризовать угол наклона локальной системы координат относительно оси скважины, в которой он является диагональным. Необходимо отметить, что наклон локальной системы координат описывается тремя углами. Но в рассматриваемом случае каротажные зонды являются симметричными относительно вертикальной оси координат, а также диагональный тензор имеет только две независимые компоненты горизонтальную и компоненты и вертикальную компонента составляющие. Таким образом, тензор УЭС будет иметь только три независимых параметра и выглядеть следующим образом 0 0 0 coscos sinsin cossin sincos, 0 cossin sincos coscos sinsin где и горизонтальная и вертикальная компоненты тензора УЭС соответственно, угол наклона оси зонда относительно локальной системы координат, в которой тензор УЭС является диагональным. В настоящей работе рассматриваются повсеместно используемые на практике при изучении геологических разрезов, вскрытых бурением, два метода электрокаротажа БКЗ и БК. Результатом измерения зондов БКЗ является кажущееся УЭС, которое вычисляется по формуле, где кажущееся сопротивление, коэффициент зонда, потенциал, измеренный на электроде, потенциал, измеренный на электроде, сила тока, протекающего через токовый электрод . В БКЗ используются трехэлектродные зонды, которые имеют следующее обозначение A2.0M0.5N. Здесь расстояние между электродами и составляет 2,0 м, а между и 0,5 м. Результатом измерения зонда БК также является кажущееся УЭС, вычисленное по той же формуле. Но в этом случае потенциал, измеренный на токовом электроде, а потенциал поверхности Земли или потенциал, измеренный на достаточном удалении от токового электрода, соответственно. В отличие от зондов БКЗ токовый электрод зонда БК окружен экранирующими электродами. Их главной задачей является фокусировка тока, достигаемая устранением части токов, протекающих вдоль зонда в окрестности токового электрода. Значение тока, протекающего через токовый электрод, можно получить при помощи следующей формулы I grad, где плотность тока, протекающего через поверхность электрода, удельная электрическая проводимость, напряженность электрического поля, электрический потенциал на электроде, поверхность электрода. Величину коэффициента зонда выбирают таким образом, чтобы кажущееся УЭС, измеренное зондом, совпадало с УЭС однородной среды. Таким образом, результатом измерений являются каротажные диаграммы значений кажущегося УЭС в зависимости от глубины расстояния по скважине, описываемые вектором . Под прямой задачей моделирования процесса каротажа при помощи зондов БКЗ и БК будем понимать определение измеренного кажущегося УЭС по заданной функции распределения УЭС с фиксированным вектором модельных параметров. Как следует из определения кажущегося УЭС, для нахождения его значения необходимо знать значение электрического потенциала на измерительных и токовых электродах. Далее при решении прямых задач БКЗ и БК будут учитываться не только особенности геоэлектрического строения околоскважинного пространства, но конструктивные особенности зондов диаметр корпуса, геометрические размеры электродов и их взаимное расположение. Распределение электрического потенциала в области моделирования описывается следующей краевой задачей div grad 0, 1 0, 2 0, 3, 4, 5 где потенциал напряженности электрического поля, grad, удельная электрическая проводимость, внешняя граница области, на которой электрический потенциал считается равным нулю расстояние от токового электрода до внешней границы выбирается таким образом, чтобы оно существенно не влияло на значение электрического потенциала на измерительных электродах, диэлектрическая поверхность зонда, поверхность токового электрода, поверхность экранирующих электродов зонда БК в случае зонда БКЗ соответствующее краевое условие опускается, напряжение на токовом электроде, напряжение на экранирующих электродах. Представим искомый электрический потенциал в виде суммы неизвестной функции, равной нулю на поверхностях токового и экранирующих электродов и границе, и некоторой функции . Данная функция должна удовлетворять краевым условиям исходной задачи и обладать достаточной гладкостью, 0, 0, 0, 6 Конкретный вид функции выбирается во время дискретизации задачи. Подставим выражение 6 в задачу 15 и сформулируем новую краевую задачу относительно неизвестной функции div grad, 7 0, 8 0, 9 где div grad, а . Для решения краевой задачи 79 будем использовать метод конечных элементов 16. Пусть трехмерная, возможно, неоднородная по физическим свойствам область с липщицнепрерывной границей. Введем следующие функциональные пространства H L grad L, H H 0, где L пространство Лебега, для элементов которого, определим следующее скалярное произведение, . . Для краевой задачи 79 сформулируем следующую вариационную постановку. H H grad grad . 10 Краевые условия 8 и 9 учитываются в данной постановке естественным образом 16. Приближенное решение вариационной постановки 10 будем искать в виде разложения по некоторому множеству базисных функций, образовывающему конечномерное подпространство H пространства 16, 11 где -я базисная функция, вес -й базисной функции в разложении. Дискретная вариационная постановка тогда будет иметь следующей вид. H H grad grad . 12 Поскольку данная постановка должна выполняться для всех функций из подпространства H, а любую такую функцию можно представить при помощи разложения по базису этого подпространства, нам достаточно потребовать, чтобы равенство 12 выполнялось только для всех базисных функций . В результате искомое приближенное решение должно удовлетворять следующим равенствам grad grad, 1,2,..., . В результате приближенное решение полностью определяется вектором весов,..., найти который можно, решив систему линейных алгебраических уравнений СЛАУ, 13 где элементы матрицы и вектора правой части можно вычислить следующим образом grad grad, . В качестве базисных функций будем использовать полиномы высоких порядков, определенных на тетраэдральной сетке, построенной в расчетной области 17. Далее под порядком базисных функций будем понимать максимальный порядок полиномов, использовавшихся при определении базиса. Для улучшения спектральных свойств матриц, получаемых после дискретизации исходной задачи, можно ортогонализовать базисные функции. Полная ортогонализация привела бы к резкому увеличению количества ненулевых элементов матрицы. В 17 предлагается проводить частичную ортогонализацию, т. е. разбить базисные функции на множество групп, а затем выполнить ортогонализацию только внутри каждой группы. Базисные функции высоких порядков могут быть ассоциированы с узлом, ребром, гранью или с самим тетраэдром. Это зависит от того, как определяется степень свободы конкретной базисной функции. Поскольку одно ребро, грань или элемент для базисов высоких порядков ассоциированы с несколькими функциями, будем использовать это свойство в качестве разделителя на группы. Определение групп ортогонализации подобным образом не приводит к увеличению количества ненулевых элементов матрицы, а также к изменению ее портрета. В 17 для ортогонализации используется стандартное скалярное произведение. В этой работе базисные функции внутри одной группы ортогонализуются относительно билинейной формы, которая используется для построения вариационной постановки. Таким образом, процесс ортогонализации будет эквивалентен использованию некоторой блочнодиагональной матрицы. Матрица A СЛАУ 13 является положительно определенной и может быть легко приведена к симметричному виду 16. Исходя из этого для нахождения решения 13 воспользуемся методом сопряженных градиентов. Поскольку решаемая задача является трехмерной, то время решения СЛАУ 13 будет существенным. Это особенно важно при решении обратной задачи, когда основные временные затраты будут приходиться на нахождение решений множества прямых задач. Для уменьшения требуемых вычислительных ресурсов воспользуемся многоуровневым алгоритмом 18. Это полный аналог многосеточного метода 16, но в отличие от него для нахождения решения прямой задачи используется не последовательность вложенных друг в друга сеток, а последовательность вложенных функциональных подпространств. Для формирования данной последовательности вложенных подпространств воспользуемся свойством иерархичности используемых для построения дискретной вариационной постановки базисных функций 16. А именно, множество базисных функций порядка 1 является подмножеством множества базисных функций порядка . Таким образом, операции интерполяции и проектирования между двумя пространствами базисных функций разного порядка вводятся естественным образом. Также существенным является вопрос выбора порядка базисных функций, используемых для построения дискретной задачи. С одной стороны, повышение порядка базисных функций ведет к увеличению порядка аппроксимации получаемого приближенного решения и, следовательно, к возможности использования для моделирования более грубых сеток обладающих существенно меньшим количеством узлов. С другой стороны, при увеличении порядка используемых базисных функций также увеличивается количество степеней свободы, связанных с различными геометрическими примитивами расчетной сетки. Например, для базиса первого порядка с каждым узлом сетки связана одна степень свободы, и размерность результирующей СЛАУ будет равна количеству узлов расчетной сетки. В то же время для базиса второго порядка, помимо степеней свободы, связанных с узлами сетки, возникают степени свободы, связанные с ребрами сетки. Таким образом, размерность СЛАУ будет равна количеству узлов сетки плюс количество ребер сетки. При этом необходимо отметить, что переход к базису второго порядка на одной и той же сетке не только увеличивает размерность СЛАУ, но также увеличивает и заполненность матрицы не нулевыми элементами, что также приводит к дополнительным вычислительным затратам. Поэтому встает вопрос оптимального выбора порядка базисных функций, обеспечивающий получение приближенного решения с заданной точностью за минимальное вычислительное время. В табл. 1 представлена зависимость времени вычисления приближенного решения прямой задачи БКЗ модель зонд скважина пласт. Для каждого выбранного порядка базисных функций подбиралась такая тетраэдральная сетка, что относительная погрешность нахождения кажущегося УЭС была не более двух процентов. В этой таблице используются следующие обозначения порядок полиномов, используемых для построения базисных функций время в секундах, необходимое для уменьшения относительной нормы невязки СЛАУ до 10 при помощи метода сопряженных градиентов время в секундах, необходимое для уменьшения относительной нормы невязки СЛАУ до 10 при помощи многоуровневого метода. Метод сопряженных градиентов использовался с блочно-диагональным предобуславливанием, или, иными словами, использовалась частичная ортогонализация базисных функций, описанная раннее. Как следует из табл. 1, использование базисных функций высоких порядков существенно уменьшает вычислительные затраты при решении прямой задачи БКЗ. В свою очередь, использование базисных функций больших порядков позволяет применять для решения СЛАУ многоуровневый алгоритм при использовании базиса первого порядка он вырождается в простой метод сопряженных градиентов, что также повышает вычислительную эффективность разработанных методов моделирования каротажа. Два этих подхода дают суммарное ускорения в 10 раз. Время вычисления приближенного решения прямой задачи БКЗ, 1 1567 1567 2 575 297 3 320 202 4 378 155 Используемые методы решения СЛАУ не исключают использования других способов предобуславливания, что также может дополнительно ускорить нахождение решения. Но это ускорение будет пропорциональным для всех рассмотренных вариантов расчетов, и не сможет нивелировать выигрыш именно от использования базиса высокого порядка и многоуровневого алгоритма. Необходимо сказать о способе повышения быстродействия вычислений с использованием графических процессоров GPU 19 20. Так, в работе 21 22 разработан и программно реализован алгоритм моделирования данных БКЗ на основе метода конечных элементов и высокопроизводительных гетерогенных вычислений на центральном процессоре CPU и GPU. Численное решение этой прямой задачи сводится к решению СЛАУ, для которого используется разложение Холецкого с последующим решением двух вспомогательных СЛАУ с треугольными матрицами. Особенностью реализации рассматриваемой задачи является то, что необходимо решать много СЛАУ с одной и той же матрицей, но с разными правыми частями, поэтому вычислительные затраты на решение двух СЛАУ с треугольными матрицами значительно превышают затраты на разложение матрицы основной СЛАУ. В работе показано, что это приводит к низкой эффективности использования только GPU и требует разработки гетерогенного метода CPU-GPU вычислений, который позволит повысить быстродействие. Сформулируем обратную задачу каротажа как задачу поиска вектора параметров геоэлектрической модели, минимизирующего функцию 23, min arg где количество измеренных кажущихся УЭС, полученных при каротаже измеренное кажущееся УЭС смоделированное кажущееся УЭС, рассчитанное для модели околоскважинного пространства, заданной вектором параметров решение обратной задачи. Для решения поставленной обратной задачи воспользуемся методом покоординатного спуска 24. Определим следующий вспомогательный алгоритм минимизации функции вдоль направления из точки с начальным шагом, 0 10, 2 Результатом работы данного алгоритма является шаг, на который необходимо сместиться из точки вдоль направления, чтобы получить новое приближенное решение задачи минимизации. Величина шага выбирается так, чтобы новое приближение находилось как можно дальше от текущего, а не как обеспечивающая наибольшее уменьшение целевой функции. Тогда -я итерация алгоритма покоординатного спуска примет следующий вид 1,2,..., 0 1, 0 0,5 где приближенное решение задачи минимизации на -й итерации вектор, параллельный -й оси координат в начальный момент времени -я ось координат, шаг поиска нового приближенного решения вдоль -й оси координат. Эффективность использования алгоритма минимизации для решения обратных задач рассматривается в 24. С использованием разработанного алгоритма трехмерной численной инверсии данных методов электрокаротажа проведено тестирование в типичных моделях сред, учитывающих наклон главных осей тензора анизотропии. В приведенных тестах для решения прямой задачи использовались базисные функции 4-го порядка. Анализ точности восстановления горизонтальной и вертикальной компонент УЭС, а также угла наклона оси скважины относительно локальной системы координат, в которой тензор УЭС является диагональным, выполнен в следующих модельных задачах. Первая включает скважину радиусом 0,108 м с УЭС бурового раствора 1 Омм и пласт с горизонтальной компонентой УЭС 4 Омм, вертикальной 9 Омм, а также различные углы наклона осей тензора УЭС относительно скважины 0, 15, 30, 45, 60, 75 и 90. Во второй горизонтальная и вертикальная компоненты УЭС пласта имеют значения 15 и 75 Омм соответственно, и те же углы наклона главных осей тензора УЭС. Для получения вектора измеренных кажущихся УЭС выполнено моделирование процесса каротажа с использованием четырех зондов БКЗ A0.4M0.1N, A1.0M0.1N, A2.0M0.5N, A4.0M0.5N, и зонда БК. При решении обратных задач использовались измерения с одной глубины. К полученным синтетическим каротажным данным предварительно были добавлены нормально распределенные случайные величины, пропорциональные начальным данным. Так, в табл. 2 приведены результаты решения обратной задачи для первой и второй моделей с дисперсией шума 0,025. В таблице используются следующие обозначения угол наклона осей тензора к оси скважины у исходной модели, восстановленная горизонтальная компонента УЭС, восстановленная вертикальная компонента УЭС, восстановленный угол наклона главных осей тензора к оси скважины. Результаты решения обратной задачи Для модели пласт с горизонтальной компонентой УЭС 4 Омм, вертикальной компонентой УЭС 9 Омм, дисперсия шума Для модели пласт с горизонтальной компонентой УЭС 15 Омм, вертикальной компонентой УЭС 75 Омм, дисперсия шума На основании результатов, приведенных в табл. 2, можно сделать следующие выводы точнее всего удается восстановить горизонтальную составляющую УЭС пласта, восстановленная вертикальная составляющая имеет несколько большую погрешность по сравнению с горизонтальной, при этом погрешность восстановления угла наклона в некоторых случаях может составлять до 20. С одной стороны, такая погрешность восстановления угла наклона является значительной, но с другой стороны, она постулирует саму возможность восстановления угла при помощи зондов, изначально не рассчитанных на решение подобных задач. При решении практических задач теперь появляется возможность такой оценки, что дает дополнительную существенную информацию о строении околоскважинного пространства. На основании проведенных вычислительных экспериментов можно сделать вывод, что совместное использование в конечноэлементной аппроксимации базисных функций больших порядков и многоуровневого алгоритма решения СЛАУ позволят существенно ускорить решение прямых и обратных задач каротажа. Использование комплекса данных БКЗ и БК при решении совместной обратной задачи позволяет восстанавливать значения элементов диагонального тензора удельного электрического сопротивления, а также проводить оценку угла наклона главных осей тензора электрической анизотропии. Относительная погрешность идентификации угла наклона обусловлена тем, что изначально каротажные методы БКЗ и БК не были предназначены для решения задач, связанных с изучением электрической анизотропии. Однако полученные результаты по определению компонент тензора электрической анизотропии и оценке угла наклона его главных осей пусть и с некоторой погрешностью открывают принципиально новые возможности при интерпретации повсеместно применяющихся методов БКЗ и БК для изучения геологических разрезов в Западной и Восточной Сибири. В завершение отметим, что с использованием разработанного алгоритма впервые становится возможным изучение эффекта электрической анизотропии при исследовании трещиноватых карбонатных коллекторов, в которых наличие электрической анизотропии обусловлено системой наклонных трещин. Именно этим типом анизотропии обладают глубокопрогруженные коллекторы в доюрском фундаменте, которые являются чрезвычайно перспективными. Информация о наклоне трещин и их преимущественном направлении играет существенную роль при проектировании наклонно-горизонтальных скважин, достоверная оценка которой возможна методами электрокаротажа. 