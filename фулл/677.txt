СЕГМЕНТАЦИЯ И СОПРОВОЖДЕНИЕ ОБЪЕКТОВ В СЛОЖНЫХ УСЛОВИЯХ ВИДЕОНАБЛЮДЕНИЯ 

Рассмотрен метод сегментации и сопровождения объектов на основе их слоевого представления. Метод реализует автоматический захват нескольких объектов на неоднородном фоне и их устойчивое сопровождение в сложных динамических сценах. Описаны априорная и апостериорная оценки достоверности векторов движения, а также анализ траекторий объектов интереса на этапе сопровождения, обеспечивающие применение метода слоевого представления при низких соотношениях сигнал/шум в исходных видеоданных. Ключевые слова Ключевые слова Ключевые слова Ключевые слова Ключевые слова — сегментация, сопровождение, слоевое представление, векторы движения, апостериорная достоверность, субпиксельная оценка векторов движения. 

В проблеме сопровождения объектов на сложном фоне телевизионными методами выделим следующие задачи первоначальная сегментация объектов сопровождение объекта в условиях динамики его свойств, а также взаимодействия с другими объектами и фоном. В одном кадре видеоряда сегментацию объектов осуществляют по признакам яркости, локальной детальности сгусткам высокочастотной энергии и формы. Анализ видеопоследовательности позволяет использовать признак движения. Учет признака движения обеспечивает устойчивую сегментацию областей изображения, принадлежащих движущимся объектам на неподвижном, в том числе сложном, фоне. Традиционно для оценки признака движения применяют . Под энергией движения понимают изменения яркости пикселей в соседних кадрах видеопоследовательности производная яркостного сигнала по времени где яркость пикселя с координатами в момент времени Скалярная оценка в виде энергии движения не обеспечивает различение объектов, находящихся в непосредственной близости друг к другу и двигающихся с различными скоростями. Более информативно . После проецирования на плоскость кадра реальное трехмерное движение объектов отображается двумерным движением, которое может быть оценено мгновенными скоростями или дискретными смещениями фрагментов изображения полем векторов движения. Методами на основе признака движения невозможно выделить стационарные объекты. Определенные трудности вызывает сегментация очень медленно движущихся объектов видимая скорость движения менее одного пикселя. Одновременное использование поля векторов движения, а также признаков пространственной связности и детальности позволяет сегментировать несколько объектов, в том числе неподвижных, на неоднородном сложном фоне. На основании первоначальной сегментации формируют модели объектов интереса, для которых определяют наилучшее соответствие в последующих кадрах. В системах используют модели объектов различной степени сложности подробности в зависимости от априорной информации об объектах. При известном алфавите объектов возможно использование 3D-компьютерных моделей с последующей подготовкой бинарной маски или контурного препарата рис. 1. При неизвестном алфавите модели строят на основе анализа сегментированной области изображения. Автоматическое построение модели эффективно реализуют на гладком фоне. На сложном фоне необходимо участие оператора, который формирует строб, охватывающий объект. В простейшем случае все изображение внутри строба рассматривают как модель объекта. Для локализации собственно объекта внутри окна получают контурный препарат с помощью операторов Собела Превитта Робертса позволяющих выделить, соответственно, вертикальные, горизонтальные и наклонные контуры. Процедура наиболее успешна при отсутствии контуров на фрагментах фона, попавших в строб. Считают, что в корреляционных системах основными проблемами являются потери объекта интереса на сложном фоне в условиях динамики свойств объекта, а также в момент перекрытия объекта интереса другими объектами или фрагментами фона. Объединение признаков детальности и формы с признаком движения на этапе сопровождения позволяет реализовать каждому объекту и фону сопоставляют свой слой 1, 2. Это обеспечивает автоматическое сопровождение объектов на сложном фоне, разрешение ситуаций окклюзии, слияния и разделения объектов. Основными процедурами предложенного метода являются предварительный анализ изображения на основе признака детальности 3 сегментация объектов интереса на основе признаков пространственной связности и движения сопровождение объектов на основе признаков движения, связности и формы признаки учитывают с адаптивным весом. Взаимодействие перечисленных процедур иллюстрирует рис. 2, где предварительная классификация изображения на основе признака детальности вид режима первичная сегментация сопровождение сегментация объектов на основе пространственной связности и движения формирование моделей формы и движения сегментированных объектов сопровождение объектов на основе признаков движения и формы, учитываемых с адаптивными весами проверка есть блоки, не отнесенные к ранее сегментированным объектам интереса обновление моделей формы и движения с учетом предсказания анализ свойств объекта и окружающей обстановки адаптация весов признаков представление полученной информации об объектах и выработка управляющих сигналов. Модель формы объекта строят на основе предположения вероятность принадлежности пикселя к изображению объекта тем выше, чем ближе он находится к центру тяжести последнего. Это приводит к гауссовой модели формы объекта в виде эллипсов рассеивания где вектор координат элемента в плоскости изображения вектор координат центра тяжести изображения объекта с номером матрица ковариаций где длины полуосей матрица поворота на угол . Сопровождение объектов реализуют путем определения степени соответствия вектора признаков фрагмента изображения блока к вектору признаков объекта с помощью математического аппарата теории нечетких множеств 4. Метод слоевого представления обеспечивает Автоматический захват и одновременное сопровождение до 50 объектов, в том числе на сложном фоне. В видеокадре тестового сюжета рис. 3 автоматически определены и ведутся цель с меткой 0 корабль, двигающийся справа налево цель с меткой 1 корабль, двигающийся слева направо цель с меткой 45 неподвижный корабль у пристани цели с метками 2, 7, 20 фрагменты фона. Устойчивое разрешение ситуации окклюзии, слияния и разделения объектов при сопровождении. Ошибку сегментации для объектов размером до 5 блоков 1520, для объектов большого размера 35 . Среднеквадратическую ошибку СКО определения центра тяжести при сопровождении объектов один пиксель. Указанные характеристики получены для видеоданных при соотношении сигналшум порядка 30 дБ. При меньших соотношениях сигнал шум использование поля векторов движения затруднено из-за влияния аномальных векторов векторов, не отражающих реальное движение. Основным для определения векторов движения является уравнение оптического потока, полученное на допущении о постоянстве яркости точки пикселя при ее движении 5 где яркостной вектор-градиент по пространственным координатам вектор оптического потока вектор движения. Анализ уравнения оптического потока показывает 1. Уравнение недоопределено неизвестных два, а уравнение одно. 2. Однозначное определение оптического потока возможно только в случае, если компоненты яркостного вектора градиента отличны от нуля имеют место изменения яркости по горизонтали и вертикали. Следовательно, в случае однородной поверхности без деталей или текстуры только в одном направлении достоверную оценку векторов движения потока найти нельзя. 3. Изменения уровня освещенности, тени, блики, прозрачные и зеркальные поверхности нарушают условие постоянства яркости перемещающейся точки, что затрудняет вычисления и приводит к ошибкам при определении векторов движения. Чтобы снизить влияние аномальных векторов, предложено дополнить двумерные векторы движения третьим компонентом оценкой его достоверности где составляющие по направлениям и вектора движения для блока с номерами по горизонтали и по вертикали. Проведенные теоретические и экспериментальные исследования позволили предложить вектора движения, определяющую вероятность корректного нахождения вектора движения достоверность в зависимости от свойств изображения в блоке где 3 параметр модели, численное значение которого найдено на основе экспериментальных данных модифицированная оценка уровня детальности в блоке где значение яркости пикселя в контурном препарате исходного изображения координаты левого верхнего угла блока, число пикселей в блоке по горизонтали и вертикали соответственно. Наиболее вероятный уровень детальности в блоке где и число блоков в изображении рис. 4. Введенная функция позволяет оставить для дальнейшей обработки блоки изображения с векторами движения, имеющими заданный уровень априорной достоверности. Это существенно снижает влияние аномальных векторов и вычислительную сложность задачи векторы движения для блоков с низким уровнем достоверности не определяют. Например, уровень достоверности 0,95 исключает из дальнейшей обработки до 90 блоков рис. 5 6. Следует отметить, что для обеспечения высокого уровня достоверности поля векторов движения 0,950,98 необходимо исключить блоки, у которых 3. При низких отношениях сигналшум, а также при высоком уровне детальности фона это может привести к резкому снижению числа блоков, разрешенных для сегментации. Недостаточное число блоков приводит к неполной сегментации объектов. Для оценки качества сегментации введем показатель степень сегментации объекта, под которой будем понимать отношение числа пришедшихся на объект блоков, оставленных для дальнейшего анализа, к эталонной блочной аппроксимации, На рис. 6, приведены графики зависимости степени сегментации объекта от величины порога, а также зависимость от величины порога вероятности ложной тревоги ЛТ. Вероятность ЛТ где число блоков, оставленных для дальнейшей обработки, но не принадлежащих объектам интереса число блоков в зоне поиска. Результаты экспериментальных исследований позволяют сделать вывод для тестовых последовательностей, мода оценок детальности фона которых не превышает 10 20 уровней квантования, может быть рекомендован порог 2 3 . Этот порог обеспечивает близкую к единице степень сегментации объекта и вероятность ЛТ 3,2 10 см. рис. 6. Следует отметить, что приведенный вероятность ЛТ является характеристикой первого этапа предварительной классификации. Он определяет не число ложных целей, а число оставленных для дальнейшего анализа блоков. Например, в проведенных экспериментах указанный уровень означает, что для зоны поиска 200 200 элементов с 625 блоками размером 8 8 число блоков, не принадлежащих объектам интереса, но оставленных для дальнейшей обработки, равно 23. В видеосюжетах с детализированным фоном или при низком соотношении сигналшум использование порога в 23 резко снижает степень сегментации объекта 1. В этом случае для повышения степени сегментации объекта интереса порог должен быть существенно снижен. Анализ видеосюжетов с различными уровнями детальности фона, а также с различными соотношениями сигналшум позволяет построить зависимость значения порога, обеспечивающего степень сегментации объекта интереса, близкую к единице, от характеристики фона. В качестве характеристики фона принята мода распределения оценок детальности см. рис. 4. Особенность введенной оценки детальности, рассчитываемой как сумма яркостных перепадов после пространственного дифференцирования или операции подчеркивания контуров, состоит в одновременном учете как детальности фона, так и шумовых составляющих, поскольку яркостные перепады в изображении обусловлены обоими факторами. Найденная зависимость оптимального уровня порога от рис. 7 показывает, что при низких значениях оптимальным является порог 2 3 моды, при высоких одна мода. В первом случае поле векторов движения имеет уровень достоверности 0,98. Во втором случае достоверность поля векторов движения существенно ниже вероятность ЛТ этапа предварительной классификации составляет 0,489 для дальнейшей обработки должно быть оставлено более 300 блоков см. рис. 4. Исправляют положение предварительной обработкой исходных изображений, а также дальнейшей пространственной и временной фильтрацией поля векторов движения. Пространственную фильтрацию реализуют за счет вычисления векторной медианы внутри скользящего прямоугольного окна. Временную на основе многомасштабной межкадровой разности, а также построением совокупности треков на этапе захвата и сопровождения многотрековое сопровождение. Пространственная медианная фильтрация поля векторов движения позволяет повысить степень сегментации протяженных объектов интереса за счет устранения аномальных векторов движения и вызванных ими дырок внутри сегментированного объекта. Однако объекты, меньшие по размерам маски медианного фильтра, могут быть потеряны. Использование многомасштабной межкадровой разности предполагает определение векторов движения в последовательности из кадров. Векторы движения находят для 1 пары кадров -я пара включает в себя кадр и кадр, 1 1. Результатом является 1 значений векторов движения, 1, ..., 1. Для приведения значений векторов движения к кадровому интервалу принимают где -й приведенный вектор пакета вектор, найденный методом совмещения блоков по кадрам и интервал между кадрами и . В кадре могут присутствовать объекты с различными скоростями движения. Полученная на основе пакета совокупность значений векторов движения включает три типа оценок. Первый тип нулевые значения, полученные по близко расположенным кадрам пакета при медленном движении расстояние между кадрами недостаточно для получения значимого вектора. Второй тип значимые корректные значения векторов движения. Третий тип аномальные оценки. В найденной для каждого блока совокупности векторов движения формируют кластеры по признаку близости векторов. Для дальнейшего анализа выбирают кластер с максимальной мощностью. Окончательную оценку вектора движения получают как среднее значение векторов, образовавших кластер с максимальной мощностью. Следует отметить, что полученная оценка будет иметь субпиксельный характер 7. Примем за исходное предположение чем больше мощность кластера, тем более высока достоверность найденного вектора движения. Введенное предположение позволяет получить оценку апостериорной достоверности найденного вектора движения где параметр число векторов, вошедших в кластер с наибольшей мощностью. Введение апостериорной оценки достоверности векторов движения обеспечивает фильтрацию полученного поля векторов в целях уменьшения числа блоков, оставленных для дальнейшего анализа. Фильтрацию выполняют путем исключения векторов, у которых мощность максимального кластера, сформированного в пакете, ниже заданного порога. Например, если пакет включает векторов, то для дальнейшего анализа следует оставить те блоки, которые вошли в кластер с наибольшей мощностью, при условии, что величина больше заданного порога . На основании экспериментальных данных, показывающих зависимость числа блоков, оставленных для вторичной обработки, а также степень сегментации объекта интереса при различных значениях априорного и апостериорного порогов, можно рекомендовать оптимальное значение апостериорного порога 0,110,37, что соответствует мощности кластера 2 3. В этом случае вероятность ЛТ снижается в 2 раза при среднем значении степени сегментации объекта около 0,7 таблица. Оставшиеся после фильтрации по априорному и апостериорному порогам блоки являются результатом этапа предварительной классификации. Далее реализуют сегментацию объектов интереса, объединяя блоки в кластеры. В результате получают кластеры двух типов соответствующие объектам интереса и ложным объектам, обусловленным шумом и флюктуирующими деталями фона. Число ложных объектов тем выше, чем больше блоков разрешено для кластеризации рис. 8. Для всех сегментированных объектов формируют модели движения и формы, на основании которых предсказывают положения объектов в следующем кадре. На этапе сопровождения блоки в последующих кадрах применяют для подтверждения существования объектов, уточнения моделей их формы и движения. Блоки, не соотнесенные ни с одним из существующих объектов, используют для сегментации новых объектов. Объекты, не нашедшие подтверждения в ряде кадров, уничтожают. Для дальнейшего снижения числа ложных объектов применяют траекторный анализ. По ряду измеренных положений объекта строят его траекторию в виде плоской кривой с использованием регрессионного анализа или фильтра Калмана. Следует признать ложными те объекты, время существования которых не превышает заданного отрезка времени, например 12 с. Диаграмма состояния системы сопровождения в течение отрезка наблюдения длительностью в 100 кадров телевизионной развертки рис. 9 показывает, что только два объекта являются истинными, а остальные семь могут быть признаны ложными. Введение фильтрации объектов по их времени существования позволяет значительно снизить загрузку вычислителя. Слоевое представление обеспечивает автоматический захват и сопровождение одновременно нескольких объектов на неоднородном фоне. Размещение объектов в разных слоях сохраняет возможность сопровождения не перекрытых объектов в ситуации окклюзии. Это исключает срыв сопровождения в случае маневра объекта. Эффективность определения векторов движения блоков изображения для слоевого представления заметно снижается при низких соотношениях сигналшум. Введение априорной и апостериорной оценок достоверности векторов движения, а также анализ траекторий позволяют обеспечить применение метода при низких соотношениях сигналшум с приемлемыми для практики степенью сегментации объектов интереса и числом обрабатываемых траекторий ложных объектов. 