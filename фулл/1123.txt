АДАПТИВНЫЕ АЛГОРИТМЫ ФИЛЬТРАЦИИ И ФРАГМЕНТАЦИИ  ЭКГ ВЫСОКОГО ВРЕМЕННОГО РАЗРЕШЕНИЯ ЧАСТЬ 2: СИНТЕЗ АДАПТИВНОГО АЛГОРИТМА  И РЕЗУЛЬТАТЫ ЭКСПЕРИМЕНТА 

Цель:  формулировка и решение задачи синтеза адаптивных алгоритмов фильтрации с параметрической адаптацией  к фрагментам ЭКГ и их апробирование на реальных ЭКГ, измеренных с высоким временным разрешением.  Результаты:  повышение эффективности подавления помех с минимальным искажением формы фрагментов при измерении  ЭКГ достигается на основе синтезированных и исследованных в статье адаптивных алгоритмов фильтрации, реализующих принцип параметрической адаптации к ее фрагментам. В качестве признака, выделяющего соответствующий  фрагмент при локальной оптимизации и фильтрации ЭКГ в реальном масштабе времени, предложено использовать  сочетание изменения знака дискретного приращения ЭКГ с порядковым номером его следования в наблюдаемой последовательности отсчетов ЭКГ. Для этого синтезирован адаптивный алгоритм, выявляющий порядок следования одноименных признаков, по которому устанавливается индекс признаков и идентифицируется фрагмент ЭКГ. При решении  задачи на основе синтезированного адаптивного алгоритма выполняются следующие действия: обнаруживаются реперные точки для установленного перечня фрагментов; измеряются длительности фрагментов; используются измеренные реперные точки и длительности фрагмента в целях реализации параметрической адаптации при фильтрации ЭКГ и  идентификации ее фрагментов. Так как предложенные адаптивные алгоритмы относятся к классу нелинейных алгоритмов, проведено исследование их сходимости на основе качественного аналитического анализа, иллюстрированного  результатами имитационного моделирования по измеренной ЭКГ с высоким временным разрешением.  Практическая  значимость:  аналитические исследования и эксперименты, проведенные на реальных ЭКГ, подтвердили эффективность  решения проблемы их фильтрации и фрагментации в условиях воздействия помех. Благодаря этому повышается достоверность измерения ЭКГ с минимальным искажением ее фрагментов и обеспечивается адекватность постановки  диагноза по электрофизиологическим показателям. Ключевые слова  — электрокардиограмма, адаптация, фильтрация, синтез алгоритмов, признаки фрагментов, диагностика, робастность, эксперимент. 

В соответствии с 1-й частью статьи 1 остановимся на основных моментах, связанных с фрагментацией и формированием признаков, свойственных фрагментам ЭКГ, применительно к решению задачи повышения качества ее измерения и фильтрации. Для этого рассматривается формально множество фрагментов Ф, Ф, Ф, каждому из которых присуща выделенная совокупность признаков, отличающихся видом, порядком следования и или значениями, т. е. количественно. Под признаком понимается определенный показатель особенность фрагмента. Например, одним из признаков является длительность фрагмента зубца ЭКГ, количественное значение которого меняется от цикла к циклу и от пациента к пациенту. Формально фрагменты можно различить только по той совокупности или множеству признаков, которое описывает выделенный фрагмент и, следовательно, принадлежит этому фрагменту. Таким образом, каждому фрагменту свойственна своя совокупность признаков, причем разные фрагменты могут содержать и совпадающие признаки, но в этом случае они различаются количественно. Поскольку априорно известен детерминированный порядок следования фрагментов с совпадающими признаками в виде временной последовательности, то в качестве признака, выделяющего и описывающего соответствующий фрагмент, целесообразно использовать сочетание признака с порядковым номером его следования в наблюдаемой последовательности отсчетов ЭКГ. Следовательно, если построить алгоритм, выявляющий порядок следования одноименных признаков, то распознавание фрагмента осуществляется по порядковому номеру или индексу выявленных одноименных признаков в наблюдаемой последовательности отсчетов ЭКГ. Прежде всего, отметим, что следует различать измеренные признаки фрагмента, необходимые для обнаружения, выделения и описания положения фрагмента в ЭКГ, например, реперные точки и временные отрезки между ними, и признаки, параметры и характеристики которых связаны с выявлением и идентификацией различных патологий функционирования сердца. Первые признаки могут, например, использоваться для повышения качества фильтрации фрагментов и, следовательно, ЭКГ в целом, вторые служат для постановки диагноза. Множество подмножеств признаков и вариации их параметров и характеристик, используемых в диагностике, должны быть намного разнообразнее и, как правило, не применяются для выделения фрагментов. Следовательно, процесс формирования признаков соответствующих фрагментов разбивается на два этапа. Первый этап необходим для формирования признаков, используемых для повышения качества измерения и фильтрации, а второй этап связан с формированием признаков в интересах проведения диагностики. В последнем случае формирование признаков может осуществляться уже по измеренной ЭКГ. Причем для диагностики множество подмножеств признаков обычно включает и те признаки, которые получены на первом этапе. В целом процесс обнаружения фрагментов, установление для них необходимых признаков, измерение их параметров и характеристик с последующей постановкой диагноза включает априорное установление перечня фрагментов и совокупности признаков каждого фрагмента, необходимых для синтеза адаптивного алгоритма фильтрации ЭКГ, при котором выполняются следующие действия обнаружение реперных точек для установленного перечня фрагментов установление длительности фрагментов по реперным точкам использование реперных точек и длительности фрагмента в целях адаптации алгоритма фильтрации ЭКГ априорное установление перечня фрагментов и совокупности признаков каждого фрагмента для формирования множества подмножеств признаков, необходимых для синтеза алгоритма постановки диагноза на основе выделенного множества подмножеств признаков установление альтернатив для принятия решения в целях диагностирования конкретной патологии, которое выполняется на основе измерения параметров и характеристик признаков в каждом фрагменте обработки результатов измерения параметров и характеристик установленного перечня признаков для каждого фрагмента в течение заданного времени измерения ЭКГ в целях осуществления диагностики непосредственного альтернативного решения задачи диагностики, т. е. выбора наиболее вероятной патологии или их совокупности из заданного множества альтернатив. Множество диагностирующих признаков включает в себя, как правило, вид и длительность фрагмента и, при необходимости, координаты реперных точек. При осуществлении процедуры мониторинга ЭКГ априорно устанавливают незначительное число фрагментов и их признаков 2. Например, ограничиваются только обнаружением реперных точек фрагмента и измерением по ним длительности фрагмента -интервала с последующей обработкой множества одноименных фрагментов, т. е. -интервалов, в течение всего времени измерения ЭКГ. При идентификации вида фрагмента и тем самым для определения для него совокупности диагностирующих признаков необходимы дополнительные измерения параметров и характеристик ЭКГ и их обработка. При этом допускается совпадение дополнительных диагностирующих признаков для каждого вида фрагмента, но, как правило, количественно они различаются. Пусть фрагменты Ф априорно определены и, следовательно, детерминированы что обычно и наблюдается при анализе ЭКГ. Тогда в качестве основного признака для автоматической идентификации фрагмента по одному и тому же признаку может служить номер следования фрагмента, начиная с определенной точки отсчета или начала следования последовательности фрагментов. Учитывая характер смены и вид фрагментов, выберем в качестве признака начала и конца текущего фрагмента ЭКГ смену знака ее первой производной и порядок следования этой смены, т. е. с на или с на . Тогда в качестве признака для определения реперных точек фрагментов Ф можно использовать смену знака производной и номера одноименной и разноименной смены знаков, начиная с начальной точки отсчета последовательности фрагментов. В этом случае в дополнение к указанным признакам требуется только один признак, необходимый для идентификации начальной точки отсчета последовательности измеряемых признаков для наблюдаемой последовательности фрагментов Ф . Для дальнейшего рассмотрения решения поставленной задачи фрагментации и измерения признаков несколько упростим задачу и сведем ее к измерению основных признаков, а именно начальных и конечных реперных точек и интервала между ними для главного фрагмента, т. е. для -интервала. Решение этой упрощенной задачи является ключевой, так как, во-первых, она имеет важное самостоятельное значение и, во-вторых, методически укажет подходы к решению общего случая фрагментации ЭКГ. Для решения рассматриваемой упрощенной задачи в качестве признака начала и конца текущего фрагмента ЭКГ, например -зубца, воспользуемся упомянутой выше сменой знака ее первой производной и порядком следования этой смены. Очевидно, что для этого необходимо построить алгоритм дополнительно к рассмотренному 1 алгоритму фильтрации, который должен отвечать следующим требованиям должен быть адаптивным иметь высокую помехоустойчивость, т. е. обладать робастными свойствами измерять указанные признаки с достаточной для диагностики точностью. Данную задачу целесообразно решить на основе следующего подхода. Из математического анализа известно, что производная функции определяется как предел отношения приращения функции к приращению ее аргумента, т. е. 1 В цифровых электронных устройствах указанный предел в принципе не достижим ввиду конечности интервала дискретизации исходного сигнала, описываемого математически функцией . В этом случае производная 1 аппроксимируется конечной разностью. Однако погрешность аппроксимации меняется при фиксированном интервале дискретизации в зависимости от динамики сигнала и, соответственно, описывающей его функции. Поэтому в работах 3, 4 и в более ранних работах был предложен адаптивный алгоритм, который позволял бы сохранить в установленном смысле постоянство погрешности определения производной через конечную разность независимо от динамики сигнала или его спектральной функции. Особенность предложенного в работе 3 алгоритма заключается в том, что он по заданной погрешности аппроксимации первой производной в зависимости от динамики сигнала меняет кратно исходному интервалу дискретизации приращение аргумента так, что погрешность аппроксимации производной в среднем остается постоянной и равной заданной величине. Этот алгоритм можно синтезировать на основе преобразования, которое 1, 5 имеет вид Здесь результат цифрового измерения на выходе АЦП, представленного в виде дискретных значений исходного сигнала ЭКГ с помехами, причем, 0, 1, 2, где дискретные значения реальной или искомой ЭКГ, сетевая помеха, широкополосный шум или помеха общего вида интервал дискретизации исходного или входного сигнала временной параметр, характеризующий величину временного отклонения в операторе отсчетов сигнала при 1, 2, от точки дифференцирования число соседних точек отсчетов сигнала с обеих сторон относительно точки дифференцирования . Параметр связан с интервалом равенством, где целое число, которое может устанавливаться в пределах 1, причем задается априорно. Для того чтобы адаптировать параметр к свойствам составляющих, введем в соответствии с работой 3 для поиска оптимального в установленном смысле значения параметра 1, адаптивный алгоритм вида 2 где 1 и значения искомого параметра на 1-м и -м тактах итерации при априорно выбираемая функция со свойствами функции меры 3, 4 априорно заданная величина, причем 0 1. Заметим, что в алгоритме 2 и в других подобных алгоритмах нетрудно установить правило сохранения граничных условий для искомого числа в случае его достижения граничных значений 1 или . При выборе функции меры в виде для 1, и 1, 2, 3, получаем в явном виде из 2 следующий адаптивный алгоритм для оптимального определения в установленном смысле интервала и, следовательно, временного сдвига по симметричной разности первого порядка 3 где, 0,5 при 1 и . Параметр в 3 целесообразно находить, например, в соответствии с алгоритмом 4 где индикаторная функция, равная единице, если аргумент не отрицателен, или равная нулю в противоположном случае, а некоторая априорно задаваемая константа в зависимости от требуемой точности определения искомого параметра. Алгоритм 4 можно представить с использованием знаковой функции в виде 5 Для алгоритмов 4 и 5 начальные значения, как правило, равны нулю, при этом нетрудно убедиться в том, что сходимость алгоритмов с учетом помехи обеспечивается к максимальному -зубцу ЭКГ. Следовательно, в дальнейшем будем считать, что в алгоритме 3 const. Алгоритмы 2 и 3 относятся к нелинейным адаптивным алгоритмам, исследование сходимости которых в общем случае для стационарных случайных процессов приведено в работах 3, 4. Однако ЭКГ относится к классу квазидетерминированных сигналов с выраженными фрагментами см., например, 1, рис. 1. Поэтому условия сходимости алгоритмов 2 и 3 существенно меняются по сравнению со случаем, когда можно рассматривать как стационарный случайный процесс. Это утверждение иллюстрирует рис. 1, на котором приведены результаты моделирования алгоритмов 3 5, определяющие по существу цифровое измерение интервала. ЭКГ представлена со смещением в положительную область относительно нуля, так как в электрокардиографе применен однополярный АЦП. Прежде чем осуществить аналитическое исследование сходимости рассматриваемых алгоритмов, проведем для анализа сходимости алгоритма 3 следующие рассуждения, представляющие наибольший интерес для рассматриваемой задачи. Предположим, что под знаковой функцией аргумент, представленный в виде разности, положителен. Тогда знаковая функция принимает значение, равное единице, при этом искомый интервал увеличивается на единицу. В результате выполнения этого события аргумент функции на каждом такте итерации в 3 увеличивается на 2 за счет увеличения текущего времени и числа на единицу, тогда как аргумент функции не изменяется. Такое положение остается до тех пор, пока выполняется неравенство 6 Как только неравенство 6 нарушается, так сейчас же динамика изменения аргументов указанных функций становится противоположной по знаку см. рис. 1, 2 и 3. Описанные свойства алгоритма 3, связанные с изменением аргументов для сигналов и, приводят к следующему при надлежащем выборе постоянной обеспечивается, в силу специфики формы ЭКГ, изменение числа в зависимости от числа тактов итерации в пределах -интервала, по крайней мере в среднем, в соответствии с линейной функцией максимум линейно изменяющейся функции достигается в средней точке, т. е. в середине между зубцами ЭКГ обеспечивается высокая робастность устойчивость работы алгоритма или, иначе, слабая чувствительность к помехам, воздействующим на сигнал ЭКГ, к параметрам и см. рис. 3, а также к пределам изменения, т. е. к вариации, -интервала. Рассмотренные свойства алгоритма 3 следуют также из качественно-аналитического исследования алгоритма 3. Прежде чем перейти к этому исследованию, заметим, что каждому из фрагментов ЭКГ соответствует свой локальный амплитудно-частотный спектр. Кроме комплекса и, в меньшей степени, для и зубцов ЭКГ, помеха имеет наибольшую по мощности составляющую спектра в области, примыкающей к верхней граничной частоте среза спектральной функции ЭКГ. Учитывая квазидетерминированные свойства ЭКГ, можно представить в виде суммы, в которой искомую составляющую целесообразно определить как изменяющееся во времени математическое ожидание для помехи . С учетом этого допущения для дальнейшего исследования в соответствии с подходом, рассмотренным, например, в работе 3, усредним правую и левую части алгоритма по случайной величине 7 где оператор усреднения по случайной величине . Абсолютная величина после первого же цикла ЭКГ в соответствии с алгоритмом 4 устанавливается равной постоянной величине, которая на следующем цикле ЭКГ может корректироваться только в бо льшую сторону см. рис. 1. Разность для сигнала в 3 и 6, используя линейное приближение, для дальнейшего анализа целесообразно представить в виде С учетом сделанных замечаний математическое ожидание от знаковой функции определяется в соответствии с равенством где аргумент функции распределения вероятностей для абсолютной величины производной суммарной помехи . На основе очевидного свойства знаковой функции, для которой выполняется равенство sign sign при 0, алгоритм 7 преобразуется к следующему эквивалентному, в установленном смысле, виду 8 Разность, определяющая аргумент функции распределения вероятностей, меняется в зависимости от изменения фрагментов ЭКГ с ростом см., например, рис. 1 в работе 1 в пределах цикла. Для того чтобы представить динамику алгоритма 8, рассмотрим рис. 4. Из рис. 4 следует, что в зависимости от того, превышает или не превышает разность диапазон изменения помехи настолько, что функция распределения помехи равна либо единице, либо нулю, значение увеличивается или уменьшается на единицу с вероятностью единица. Если это условие не выполняется, то значение увеличивается или уменьшается в среднем на величину, меньшую единице, а это значит, что в итерационном алгоритме 3 величина не возрастает и не убывает. В этом случае знаковая функция попеременно с соответствующей вероятностью принимает значение, равное либо единице, либо нулю рис. 5, и . Вероятность соответствующего события резко возрастает, когда искомая составляющая измеряемой ЭКГ меняет знак в экстремальных точках и точках перегиба, что и затрудняет их обнаружение по динамике значения . На рис. 5 введены следующие обозначения графиков 1 динамика изменения -интервала 2 изменение с ростом разности определяющей аргумент знаковой функции в алгоритме 3 3 скачкообразное изменение знаковой функции в алгоритме 3, причем для наглядности иллюстрации единичный скачок знаковой функции в положительную и отрицательную область умножен на 600 4 уровень, определяющий в алгоритме 3 произведение . Заметим, что алгоритм 3 по существу реализует триггерный режим работы, попеременно переходя от положительной к отрицательной обратной связи. На рис. 5, виден скачок разрыва первой производной ЭКГ для максимума зубца, который совпадает с локальным максимумом и изменением значения знаковой функции, поэтому реперные точки целесообразно устанавливать в экстремумах и, при необходимости получения дополнительной информации, в точках перегиба ЭКГ. В последнем случае для повышения достоверности измерения координат реперных точек следует принять во внимание тот факт, что знаковая функция принимает значения 1 либо 1. Благодаря этому свойству для нахождения экстремальных точек и точек перегиба ЭКГ с вероятностью, близкой к единице, в условиях воздействия помех достаточно применить к 1 в алгоритме 3 оператор суммирования с четным числом слагаемых, т. е. в виде 1, 2, 3, . 9 Результаты применения оператора 9 для выделения реперных точек проиллюстрированы на рис. 6 и 7. Равенство 9 представляет собой оператор скользящего усреднения для знаковой функции, что приводит к многократному усилению показателя, соответствующего экстремуму функции, а при необходимости и точки перегиба. Точность определения реперных точек ЭКГ предложенным методом с учетом измерения ЭКГ с высоким временным разрешением позволяет говорить об их измерении с достаточно высокой точностью или малой погрешностью долей процентов благодаря тому, что слагаемые в операторе 9 изменяются нормированно, т. е. на единицу. Следует заметить, что снижение погрешности измерения реперных точек зависит также от установленного числа слагаемых в 9. При этом, как следует из рис. 7, значение оператора 9 для экстремальных точек соответствующих функций стабильно, что и позволяет находить положение экстремальных или реперных точек ЭКГ за счет выполнения сравнения полученного результата суммирования с заданным порогом. Величина этого порога априорно устанавливается в 9 по числу слагаемых . В зависимости от того, какие из трех условий выполняются с установленным допуском для значений оператора 0, 0 и 0 принимается решение о наличии либо точки экстремума, либо соответствующей точки перегиба ЭКГ в условиях воздействия помех с минимальным искажением динамических свойств искомой составляющей измеряемой ЭКГ см. рис. 5, . Заметим, что для определения реперных точек ЭКГ возможны и другие алгоритмы. В заключение целесообразно привести пример использования алгоритма 2 для сжатого представления ЭКГ в целях диагностики рис. 8. График иллюстрирует динамику ЭКГ в сжатом виде в пределах -интервала по его реперным точкам от минимального значения до величины, равной половине -интервала. График напоминает летящего лебедя, и его конфигурация меняется в случае возникновения той или иной патологии в ЭКГ. Благодаря такому сжатому представлению ЭКГ в указанных системах координат на экране монитора электрокардиографа в укрупненном масштабе можно получить информацию о поведении ЭКГ пациента в пределах длительного наблюдения, значительно превышающего длительность графика ЭКГ, представленного в виде прямой зависимости от времени, как это делается в традиционных электрокардиографах см. рис. 1. Таким образом, результаты аналитических исследований и моделирования на реальных ЭКГ, измеренных с высоким временным разрешением, подтвердили эффективность решения проблемы адаптивной к фрагментам ЭКГ цифровой фильтрации в целях диагностики по электрофизиологическим показателям. Благодаря этому существенно снижаются требования к аналоговым схемотехническим способам борьбы с помехами, т. е. создаются предпосылки для полного перехода к цифровым методам измерения и фильтрации ЭКГ. 