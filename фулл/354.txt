ВОЗМОЖНОСТИ ПРОГНОЗИРОВАНИЯ ДИНАМИКИ ФОНДОВОГО ИНДЕКСА S&P 500 С ПОМОЩЬЮ НЕЙРОСЕТЕВЫХ И РЕГРЕССИОННЫХ МОДЕЛЕЙ 

В статье проводится сравнительный анализ нейросетевого моделирования и регрессионного анализа для целей прогнозирования индекса S&P 500. Изначально строится прогноз абсолютного значения индекса, обосновывается необходимость использования стационарных данных, то есть доходности S&P 500. Сравнение методов прогнозирования осуществляется в два этапа. Сначала методы сравниваются по коэффициенту детерминации за 3 и 12 месяцев и качеству предсказания тренда доходности. Отметим, что выбор модели и ее тестирование производятся на разных временных промежутках (так называемых периодах in-sample и out-of-sample). Исходя из того, что первостепенным желанием трейдера является извлечение прибыли, на втором этапе выбираются такие трейдинговые критерии, как прибыль и прибыль, взвешенная на риск, мерой которого является дродаун. На более длинном временном промежутке (12 месяцев) лучшую доходность показала факторная регрессия, однако по показателю экономической прибыли выиграла нейросеть. При рассмотрении более короткого промежутка (3 месяца) нейросеть опередила факторную и авторегрессию по обоим сравниваемым показателям. Таким образом, нейросети хорошо подходят для оценки биржевой динамики за счет своей гибкости и умения находить нелинейные закономерности.

 Биржевое ценообразование является наиболее эффективным способом распределения ограниченных ресурсов, в частности капитала. Поэтому ценообразование на финансовых рынках представляется актуальным направлением изучения как учеными-фундаменталистами, так и трейдерами. И если первых интересуют механизмы функционирования финансовых рынков, то цель вторых получение прибыли путем прогнозирования цены акций либо их доходности. Наиболее популярным методом прогнозирования среди трейдеров является технический анализ, однако он описывает поведение финансового инструмента в ближайшем будущем и не объясняет причины изменения цен. Для стабильного извлечения прибыли в долгосрочном периоде необходимы иные статистические инструменты, позволяющие найти экономические закономерности, сохраняющиеся долгое время. В последние десятилетия для этих целей используется регрессионный аппарат, существенными недостатками которого являются выявление только линейных закономерностей и необходимость сбора данных за длительные промежутки времени, что в России в принципе невозможно. Кроме того, остается дискуссионным вопрос о сопоставлении преимуществ и недостатков этих двух математических аппаратов. В статье проводится сравнительный анализ эффективности методов нейросетевого моделирования и регрессионного анализа для прогнозирования цены и доходности акций. Каждый из них позволяет выявлять закономерности между изменениями цены и различными факторами, а также использовать саму цену в качестве единственного фактора. Первые исследования, посвященные изучению методов прогнозирования и построению предсказательных моделей биржевой динамики, появились еще в 20-х годах прошлого века. Для решения поставленной выше задачи интересны работы, которые одновременно рассматривают различные методики прогнозирования. Нейронные сети практически не применяются в данной области, однако следует отметить работы Алана Тиммерманна 2, который для целей прогнозирования использовал и регрессии, и нейронные сети. При этом в его работе были применены только двухслойные нейронные сети с неизменяющейся структурой слоев, в то время как параметры регрессий менялись. Кроме того, выбранные им методики не тестировались на одном временном промежутке, что не позволяет проводить сравнительный анализ рассмотренных методов. Целью же настоящей статьи является именно сравнение двух методов, которые тестируются на различных по длительности промежутках. Однако длина промежутков в целях корректности эксперимента выбирается одинаковой для обеих моделей. Кратко опишем объект исследования. Индекс ориентирован на сегмент рынка с высокой капитализацией, охватывая более 80 акций американских компаний, что делает его идеальным инструментом, характеризующим состояние рынка в целом. Для построения моделей авторы использовали месячные данные о величине индекса с 1965 года, так как с того времени стала широко применяться модель САРМ для объяснения рыночной динамики, что сильно повлияло на ценообразование финансовых инструментов. Использование месячных данных объясняется необходимостью соблюдения баланса между наличием достаточного количества наблюдений для построения значимой регрессии и неслучайностью колебаний цен внутри выбранного временного промежутка. Например, дневные данные о колебаниях цен практически случайны, тогда как за месяц происходит большое число событий, создающих корреляции между ценами различных периодов, таких как выпуск отчетов, новости экономики и политики и т.д. Чтобы рассмотреть поведение выбранных методик на разных по протяженности временных промежутках, тестирование проводилось на различных периодах обучения и построения регрессий 1965 2006, 19902006, 20002006, 20032006. Результаты рассмотренных вариантов прогнозирования приведены в таблице 2, содержащей реальные значения индекса и его оценки. В случае построения регрессий использовался метод наименьших квадратов. Кроме того, при работе с реальными статистическими данными важно проверить, действительно ли желаемые ограничения имеют место. Период тестирования был выбран длиной в 3 и 12 месяцев для того, чтобы проверить, как изменяется качество прогнозов модели. Применение аппарата нейронных сетей В вычислительных экспериментах использовались нейронные сети слоистой структуры 1. Пробовались различные активационные функции нейронов входного и скрытого слоев для минимизации ошибки обучения. В результате серии вычислений была получена минимальная ошибка обучения при наборе функций сигмоида-сигмоида. Полученное выше оптимальное сочетание функций нейронов входного и скрытого слоев использовано в текущем и всех последующих тестах. Следующая серия экспериментов состояла в применении нейронных сетей на основе факторной зависимости. На обучение отводились различные временные промежутки. Результаты представлены в таблице 4. Как следует из таблицы 4, с сокращением времени обучения результаты улучшаются уменьшается ошибка обучения . Найдена оптимальная структура нейронной сети 3 скрытых слоя 25, 10, 10 нейронов. Максимальная ошибка составила 12,25 в абсолютном выражении, или 0,86 . На рисунке 1 представлены результаты прогнозирования нейронной сети на год вперед. Как видно из рисунка, нейросеть в целом справилась с предсказанием тренда. Для прогноза на 12 месяцев коэффициент детерминации 4 R составилзначением. Итак, можно сказать, что нейронная сеть, основанная на факторной зависимости, с поставленной задачей справилась. Нейронная сеть позволяет предсказывать тренд изменения индекса, а также дает квартальный прогноз с незначительной ошибкой. Применение регрессионного аппарата При построении регрессий использовался только один временной промежуток 19952006. Это связано с тем, что регрессионный аппарат требует большой выборки для выявления закономерностей. На рисунке 2 представлены результаты прогнозирования авторегрессии на год вперед. Применение регрессионного аппарата с использованием метода скользящее окно показало, что коэффициент детерминации R за 12 месяцев составил неприемлемо низкое значение -19,95. Итак, авторегрессия справилась с предсказанием тренда, однако точность прогноза неприемлемо низкая. Рассмотрим применение регрессионного аппарата с использованием факторной зависимости. Регрессионная зависимость строилась на основе факторов, приведенных в таблице 1. Результаты прогнозирования отражены на рисунке 3. Как видно из рисунка, регрессия плохо справилась с предсказанием тренда. Однако в целом результат следует признать неудовлетворительным. Опишем далее применение регрессионного аппарата с использованием факторной зависимости и стационарных данных. При построении регрессии следует учесть тот факт, что исходные данные должны быть стационарными. Стационарным называется ряд, в котором дисперсия и математическое ожидание постоянны. Поэтому имеющиеся данные были остационарены методом взятия первых разностей и на их основе построена регрессия. Следует учесть, что зависимой переменной построенной модели является не значение индекса, а его доходность, то есть каждое значение индекса поделено на предыдущее. Результаты прогнозирования представлены на рисунке 4. Коэффициент детерминации за 12 месяцев составилзначением. Таким образом, модель не справилась с предсказанием тренда и имеет неприемлемую точность. Сравнение моделей Результаты сравнения моделей на основе коэффициента детерминации за 12 месяцев и за 3 месяца, а также качество предсказания тренда приведены в таблице 5. Итак, факторная регрессия, построенная по стационарным данным, и нейросеть на основе окна не справились с предсказанием тренда. Лучший коэффициент детерминации имеет нейросеть на основе факторной зависимости с параметрами 25-10-10, построенная на временном промежутке 20032006. Она справилась с предсказанием тренда с достаточной точностью. Сравнение на основе трейдинговых критериев Используемые модели сравнивались по такому показателю, как коэффициент детерминации. Однако следует выяснить, насколько этот показатель подходит для индикации качества предсказательных моделей биржевой динамики. Выберем на основе рисунка 5 лучшую модель. Коэффициент детерминации левой модели выше, так как графики расположены близко друг к другу. Однако с помощью этой модели можно потерять деньги. Коэффициент детерминации правой модели ниже, однако она позволяет зарабатывать, поскольку способна предсказывать пики доходности. Из этих рассуждений можно сделать вывод, что коэффициент детерминации является довольно абстрактным показателем. Если целью, как отмечено ранее, является получение прибыли, выбирать жизнеспособные модели нужно не с помощью коэффициента детерминации, а по таким показателям, как прибыль и экономическая прибыль . На основе приведенных рассуждений из рассмотрения были исключены модели с отрицательным коэффициентом детерминации за год ввиду плохого качества прогноза. Опишем процедуру оценки. Операция открывалась по данным модели, прибыль считалась по фактическим ценам. В качестве показателя риска был выбран дродаун разница между максимумом и минимумом на кривой капитала, выраженная в абсолютной величине. При проведении сравнительного анализа также оценивалась точность предсказания тренда как рассчитанный в процентах показатель того, в скольких промежутках направление тренда совпадает с реальным направлением изменения цен. Как видно из таблицы 6, на более длинном временном промежутке лучшую доходность показала факторная регрессия, однако по показателю экономической прибыли выиграла нейросеть. При рассмотрении более короткого промежутка нейросеть опередила факторную и авторегрессию по обоим сравниваемым показателям. Однако цель трейдера на рынке извлечение прибыли, поэтому на втором этапе сравнения были выбраны такие трейдинговые критерии, как прибыль и прибыль, взвешенная на риск, мерой которого выбран дродаун. Доходность выбранной методики сравнивалась с доходностью пассивного держания акций. На более длинном временном промежутке лучшую доходность показала факторная регрессия, однако по показателю экономической прибыли выиграла нейросеть. При рассмотрении временного промежутка в 3 месяца нейросеть показала лучшие результаты, чем факторная регрессия и авторегрессия, по обоим рассматриваемым критериям. При этом, помня о гипотезе эффективности рынка, отметим поскольку нейронные сети это общедоступный инструмент, они не позволят стабильно получать сверхприбыль. С их помощью можно находить временные неэффективности, которые, однако, будут быстро устраняться действиями арбитражеров, обладающих той же информацией и предсказательными инструментами. Можно сказать, что именно они и создают эффективность рынка, считая его неэффективным, то есть пытаясь на нем заработать, получить сверхприбыль. В статье была исследована динамика индекса, поэтому полученные модели могут работать только для объяснения динамики этого индекса, а не конкретной акции. Кроме того, полученные модели не являются равновесными, не имеют экономической базы. Существует иной подход построение моделей, основанных на известных экономических закономерностях. Функции, объясняющие эти закономерности, можно принять за спецификацию модели и оценивать количественные параметры. Используемый же в статье подход позволяет получить лишь краткосрочный прогноз и требует постоянной переоценки параметров. В целом нельзя утверждать, что нейронные сети всегда решают задачи предсказания лучше регрессионного аппарата. С помощью нейросетей нельзя построить модель, не только показывающую движение цен, но и объясняющую его причины. Кроме того, регрессионный анализ позволяет оценить соответствие коэффициентов при переменных их экономическому смыслу и улучшить качество модели, занулив несоответствующие 5. Например, при построении зависимости доходности акций от дивидендов и балансовой стоимости был получен отрицательный коэффициент при дивидендах. Однако доходность не может обратно зависеть от дивидендов, поэтому для улучшения качества модели этот коэффициент лучше занулить. Такой прием часто используется при анализе данных фондового рынка. Регрессионные модели имеют более высокую объясняющую способность. Они позволяют выявлять закономерности в явной форме. Нейронные сети не дают ответ на вопрос почему. Однако проведенное исследование показывает, что они неплохо подходят для оценки биржевой динамики за счет своей гибкости и умения находить нелинейные закономерности. Несомненный плюс нейросетей также в том, что они не требуют большого объема выборки для корректного прогноза. 