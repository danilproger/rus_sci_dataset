КОД «ВИРТУАЛЬНЫЙ ПЛАНЕТАРИЙ»   ДЛЯ МОДЕЛИРОВАНИЯ АСТРОФИЗИЧЕСКИХ ОБЪЕКТОВ:   МАТЕМАТИЧЕСКАЯ МОДЕЛЬ, МЕТОДОЛОГИЯ И ПЕРВЫЕ РЕЗУЛЬТАТЫ  

  Сложность астрофизических процессов заключается в совместном рассмотрении компонент различной природы. Так, например, в задаче столкновения галактик рассматривается трехмерная динамика межзвездного газа и звездной компоненты. В основе моделирования этих компонент могут лежать совершенно разные классы  численных методов. Одним из возможных решений этой проблемы является использование эйлероволагранжева подхода, в котором физические величины сосредоточены в материальных точках, что характерно  для метода SPH (Smoothed Particle Hydrodynamics), а расчет сил производится на адаптивной сетке, привязанной к системе материальных точек. Такой подход единообразно учитывает динамику как сплошной среды, так  и дискретных частиц, а также позволяет устранить ряд недостатков, присущих оригинальному методу. Расчет  гравитационного взаимодействия осуществляется путем решения уравнения Пуассона для гравитационного  потенциала. При этом все частицы проецируются на расчетную сетку, и уже по ней вычисляются значения потенциала в каждой ячейке. Решение уравнения Пуассона для гравитационного потенциала выполняется с использованием быстрого преобразования Фурье. В статье описан новый код «Виртуальный планетарий» для  моделирования астрофизических объектов на основе метода SPH, дополненного методом Годунова для вычисления потоков давления и импульса между частицами и методом быстрого преобразования Фурье для решения уравнения Пуассона для гравитационного потенциала. В работе описано обоснование для перехода   к такой вычислительной модели, детально описаны кинетические и гидродинамические подходы. Выполнено  моделирование коллапса изотермического газового облака, показана возможность метода воспроизводить  развитие неустойчивостей в виде образования двух рукавов плотности.  

 Современная теоретическая астрофизика практически исчерпала возможности аналитических и полуаналитических решений, которые можно получить при допущениях простран ственной симметрии или рассматриваемых процессов. В настоящее время основным инструментом теоретической астрофизики стал вычислительный эксперимент. Сложность астрофизических процессов заключается в совместном рассмотрении компонент различной природы. Так, например, в задаче столкновения галактик рассматривается трехмерная динамика межзвездного газа и звездной компоненты 1. Для описания такого процесса требуется разрешение уравнений гидродинамики для описания движения газа и решение кинетического уравнения для записи движения звезд. В основе методов решения лежат совершенно разные классы численных методов. Один из трендов для разрешения подобных проблем заключается в использовании лагранжево-эйлеровых методов Arbitrary Lagrangian-Eulerian ALE в зарубежной литературе, которые одновременно подходят как для решения уравнений гидродинамики, так и для описания движения частиц. Хотя следует отметить, что существуют работы по модификации математических моделей для описания различных компонент единым классом гиперболических уравнений 2. Мы остановимся на развитии лагранжевоэйлерового подхода. В последнее десятилетие в области вычислительной астрофизики было создано несколько кодов, успешно и в то же время различным образом реализующих лагранжево-эйлеровый подход. Среди них коды AREPO 3, BETHE-HYDRO 4, GIZMO 5. Так или иначе, все коды основаны на представлении решения в виде набора материальных точек с размещенными в них физическими характеристиками, что характерно для метода сглаженных частиц 6 Smooth Particles Hydrodynamics SPH в зарубежной литературе. Далее используются различные механизмы способа взаимодействия с соседними точками, в частности способ построения сеток. Остановимся на описании каждого из кодов чуть подробнее. В основе кода AREPO лежит технология подвижных сеток на основе триангуляции Вороного и Делоне c регуляризацией Ллойда. Такой подход позволяет адаптировать сетку под решение. В качестве основного метода решения уравнений гидродинамики используется классический метод Годунова. Это связано с тем, что достаточно тяжело построить схему более высокого порядка на подвижной сетке. Для решения уравнения Пуассона используется подход на основе записи уравнения для полной механической энергии в уравнение для суммы всех видов энергии внутренняя, кинетическая и потенциальная. Такое уравнение для полной энергии имеет в правой части производную по времени от потенциала и его градиента, что вычисляется с помощью интеграла Пуассона методами типа частица сетка. Для интегрирования по времени используется индивидуальный шаг по времени для различных ячеек. При всех достоинствах такого подхода он достаточно тяжелый в плане вычислительных затрат, а также остается открытым вопрос о качестве решения в областях, описываемых менее подробными сеточными ячейками. Однако код AREPO является одним из наиболее используемых в мире в данный момент. В основе кода BETHE-HYDRO лежит ALE-подход, сочетающий достоинства как эйлерова так и лагранжева подходов. Уравнения гидродинамики формулируются в лагранжевой неконсервативной форме и решаются на неструктурированной сетке. В основе численного метода операторный подход, который позволяет построить согласованные схемы для аппроксимации операторов градиент и дивергенция. Для решения уравнения Пуассона в одномерной постановке используется метод прогонки или метод Томаса в зарубежной литературе. В двумерной постановке уравнение Пуассона решается с помощью метода сопряженных градиентов. Далее происходит коррекция потенциала для сохранения полной энергии сумма кинетической, внутренней и потенциальной энергий системы. Отметим, что сохранить полную энергию системы все равно не удается, но ошибка на задаче коллапса составляет порядка 10 процента, что очень незначительно. К сожалению, код не был развит для трехмерного случая. В программном коде GIZMO разработан и реализован новый бессеточный подход к решению уравнений гравитационной газовой динамики. Подход основан на комбинации классических сеточных методов и метода SPH. Метод состоит в использовании уравнений газовой динамики в эйлеровых координатах, которые с использованием вариационного принципа Галеркина умножаются на пробные функции. Особенностью этих функций является то, что они привязаны не к расчетной сетке, а к отдельным частицам, аналогичным по своей природе SPH частицам. Для определения значений на границах области используется решение задачи Римана с использованием метода Годунова. Анализ этих кодов показывает, что основной вычислительной проблемой является построение сетки или ее аналога для описания взаимодействия между частицами. При этом во всех методах сохранена идеология кинетического подхода на основе описания движения материальных точек. В этой концепции разработана вычислительная модель, описанная и в данной статье. Для организации вычислений мы будем использовать равномерную кубическую сетку, в которой будет помещаться облако частиц. Такой подход позволяет достаточно просто организовать эйлеров этап вычислений. Описание вычислительной модели мы разобьем на две части. Сначала опишем динамику частиц на основе сил гравитации. Эта модель соответствует газу с нулевым давлением pressureless hydrodynamics в зарубежной литературе. Затем добавим силы давления при использовании адиабатического уравнения состояния. Запишем уравнения гравитационной гидродинамики с нулевым давлением в виде законов сохранения массы и момента импульса в эйлеровых координатах 0, 1, 2 дополненные уравнением Пуассона для гравитационного потенциала 4, где плотность, вектор скорости, гравитационный потенциал, гравитационная постоянная. Будем рассматривать динамику материальной точки частицы с произвольным номером . Закон сохранения массы частицы получается естественным образом при интегрировании уравнения 1 в малой окрестности точки, в которую не попадают другие частицы. Второй закон Ньютона для частицы с номером запишем, используя уравнение 2 в лагранжевой постановке . 3 В уравнении 3 необходимо сократить функцию плотности, которая в малой окрестности точки отлична от нуля. В результате получим уравнения для движения частиц, . 4 Для решения уравнений 4 нам необходимо вычислить градиент потенциала. Для этого введем равномерную кубическую эйлерову сетку с шагом по каждому направлению, и каждую частицу спроецируем на соответствующую ячейку. Другими словами, каждая частица будет давать вклад в массу соответствующей ячейки, . Таким образом, в каждой ячейке мы можем вычислить плотность по формуле, 5 где это масса частицы, попадающей в ячейку, . Зная плотность в каждой ячейке расчетной области, с помощью метода, основанного на использовании быстрого преобразования Фурье, мы можем найти гравитационный потенциал. Для этого необходимо с помощью прямого преобразования Фурье перейти от функции плотности к ее амплитудам в пространстве гармоник, затем перейти к амплитудам гармоник потенциала c помощью формулы 2 3 2sin 2sin 2sin 1 1 1 1 3 3, 3 6 где, размер расчетной сетки по каждому из направлений в настоящей статье эти величины принимаются равными, так как используется равномерная кубическая сетка. Затем с помощью обратного преобразования Фурье из амплитуд гармоник потенциала восстанавливаются значения функции потенциала в соответствующих ячейках . Исследование и описание метода решения уравнения Пуассона подробно описано в работах 7 8. Так как функция гравитационного потенциала суть гладкая функция, то для нахождения градиента потенциала мы будем использовать центральные разности, 2 2 . 2 Для разрешения уравнений 4 для частицы на временном шаге мы будем использовать двухслойную схему с перешагиванием, где скорости вычисляются по формуле, 2, 2, 2 7 а координаты с использованием формулы, . 8 Такая схема соответствует эйлерово-лагранжеву подходу, использованному коллективом авторов ранее 2 7 8. Важным условием устойчивости численной схемы является выбор шага по времени. Для этого будем использовать условие Куранта для введенной сетки, max 9 где 1 число Куранта Фридрихса Леви. При использовании гидродинамической модели вычислительная процедура осложняется введением новой силы давления. Основная сложность заключается в том, что функция давления в общем случае разрывная функция, и для определения его градиента необходимо использовать решение задачи о распаде разрыва. Последовательно опишем изменения в вычислительной модели. Уравнения гравитационной гидродинамики в виде законов сохранения массы и момента импульса в эйлеровых координатах записываются в виде 0, 10 . 11 Уравнения 10, 11 дополнены уравнением Пуассона для гравитационного потенциала 3 4, где плотность, вектор скорости, давление, гравитационный потенциал, гравитационная постоянная. Уравнения замкнуты уравнением состояния для адиабатического газа, где показатель адиабаты, значение энтропии. Выше было описано, как получить плотность газа в ячейке и восстановить гравитационный потенциал. Опустив очевидные выкладки, уравнения 4 перепишем в виде, . 12 Для разрешения уравнений 12 для частицы на временном шаге мы будем использовать двухслойную схему с перешагиванием, где, сохранив способ пересчета координат 8, изменим формулу для определения скорости 7, которая записывается в виде, 2, 2, 2 13 где величины поток давления, получаемый в результате решения задачи о распаде разрыва для эйлерова этапа численного метода. Для аппроксимации потока рассмотрим комбинацию правой и левой расчетных ячеек, получим 7 . 2 2 14 В случае адиабатического уравнения состояния в этом случае величина энтропии суть постоянная величина для всех материальных точек, уравнение 14 записывается в виде . 2 2 В случае изотермического уравнения состояния суть энтропии температура, показатель адиабаты 1 уравнение 14 записывается в еще более простой форме . 2 2 Перепишем уравнения 13 для изотермического газа 2, 2 2, 2 2 . 2 15 Как уже говорилось ранее, формула пересчета координат 8 осталась без изменений. Важным моментом в формуле 15 является проекция скоростей материальных точек в ячейку. Для этого мы будем использовать весовую функцию по массе точек, 16 где и это масса и соответствующие компоненты скорости всех частиц, попадающих в ячейку, . Далее перейдем к основным этапам реализации программного кода. В этом разделе приведем описание алгоритма, приведя все расчетные формулы для каждого этапа. Не снижая общности, мы остановимся на случае периодических граничных условий и изотермическом процессе. Также будем считать, что трехмерное преобразование Фурье уже реализовано в библиотеке например, в работе 9 в виде процедуры FFT3D. 1. Определим значения размер расчетной области, размер расчетной сетки, количество материальных точек, температура газа, шаг по пространству, определим число Куранта, масса каждой частицы. Моделировать динамику газа будем до момента времени . 2. Для всех частиц определим координаты и вектор скорости . 3. Обнулим время динамики системы 0. 4. Если переходим к шагу 5, в противном случае процесс моделирования заканчиваем. 5. Для каждой ячейки, определяем ее плотность по формуле 5. 6. В случае использования гидродинамической модели нам необходима сеточная функция скорости. Для этого в каждой ячейке, определяем компоненты скорости по формулам 16. 7. Определяем шаг по времени из условия 9. . max 8. Прибавляем к текущему времени временной шаг . 9. Делаем прямое преобразование Фурье для функции плотности 3 . 10. Решаем уравнение Пуассона в пространстве гармоник по формуле 6. 11. Делаем обратное преобразование Фурье для гармоник потенциала 3 . 12. Для каждой частицы пересчитываем ее скорость по формуле 15. 13. Для каждой частицы пересчитываем ее координату с использованием формулы 8 и полученных скоростей. 14. Переходим на шаг 4. Как уже было сказано, при использовании кинетической модели шаг 6 пропускается. Далее мы обсудим дискуссионные вопросы по вычислительной модели и перспективы развития модели для более сложных случаев. Опишем дискуссионные моменты, связанные с построенной вычислительной моделью и программной реализацией. Эти моменты пока не включены в код, однако могут быть использованы в развитии кода. 1. Во введении было сказано об использовании только равномерной кубической сетки. Это сделано только для упрощения описания вычислительной модели и ее использования для нужд новосибирского планетария. Конечно, использование материальных точек позволяет нам достаточно простым и естественным образом вводить адаптивные сетки, используя соответствующие численные методы для восстановления гравитационного потенциала. В дальнейшем мы планируем развить наш подход в этом направлении. 2. Мы использовали адиабатическое и изотермическое уравнения состояния, которые зависят только от функции плотности. Для проекции частиц на эйлерову сетку для определения плотности достаточно использовать закон сохранения масс. Однако для описания идеального газа необходимо использовать термодинамическую переменную энтропию, и способ проекции, аналогичный проекции скоростей материальных точек на ячейку. 3. Для нахождения потока давления через границу использовалась схема первого порядка точности из работы 7. Использование равномерной сетки позволяет достаточно просто повысить порядок точности схемы, например, как это было сделано в работе 8. 4. Также в статье была использована простейшая проекция материальных точек на расчетную сетку. Для устранения вычислительных шумов необходимо использовать ядра сглаживания, аналогичные методам SPH и методам типа частиц-в-ячейках. В дальнейшем при необходимости вопрос выбора ядра будет рассмотрен отдельно. 5. Формулы пересчета скоростей и координат материальных точек 7, 8 и 15 явно записываются в векторной форме, что делает логичным использование векторных SSE расширений, встроенных в процессоры Intel и AMD современных персональных компьютеров, для которых и рассчитан программный код из этой статьи. Также большинство персональных компьютеров оснащено графическими ускорителями NVIDIA, для которых в рамках технологии CUDA созданы специальные библиотеки для расчета быстрого преобразования Фурье например, cuFFT. В качестве модельной задачи будем рассматривать коллапс изотермического облака в безразмерных переменных. Для этого в кубической области размером 3,2 введем вспомогательную расчетную сетку 128 . В начальный момент времени в сфере единичного радиуса равномерно распределим частицы единичной суммарной массы с модельной температурой 0,1 и кеплеровской скоростью вращения. В нашей модельной задаче мы бу дем исследовать поведение ансамбля частиц газа при различных значениях дисперсии скоростей . Проблема исследования фрагментации вращающегося холодного облака особенно интересна в контексте эволюции эллиптических галактик 10. Анализ результатов моделирования при различных показывает см. рисунок, что при увеличении дисперсии скоростей до 0,5 для одинакового начального распределения плотности имеет место развитие неустойчивостей виде двух рукавов плотности. В рамках настоящей статьи мы не планируем проводить анализ развития неустойчивостей, подобных описанным в работе 8. Основной результат вычислительных экспериментов это возможность воспроизведения подобных возмущений разработанной вычислительной моделью. В дальнейшем мы более подробно рассмотрим развитие неустойчивостей в системе многих тел в контексте моделирования планетных систем и галактик 11. В статье приведено описание нового кода Виртуальный планетарий для моделирования астрофизических объектов. Код основан на эйлерово-лагранжевой комбинации метода сглаженных частиц и метода Годунова. В работе описано обоснование для перехода к такой вычислительной модели. С помощью разработанного кода смоделирован коллапс вращающегося газового облака. 