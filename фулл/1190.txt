АЛГОРИТМ МАКСИМИЗАЦИИ ЭНТРОПИИ  ОБУЧАЮЩЕЙ ВЫБОРКИ И ЕГО ИСПОЛЬЗОВАНИЕ  ПРИ СИНТЕЗЕ МОДЕЛЕЙ ПРОГНОЗА ДИСКРЕТНЫХ СОСТОЯНИЙ  НЕЛИНЕЙНЫХ ДИНАМИЧЕСКИХ СИСТЕМ 

Постановка проблемы:  для описания процессов функционирования и прогнозирования состояния неисправных,  но работоспособных сложных технических объектов, находящихся в условиях нестационарного воздействия факторов  внешней среды, часто используется математический аппарат, учитывающий нелинейный и вероятностный характер  процессов функционирования его подсистем, например автоматы с памятью, вероятностные автоматы или логиковероятностные модели. При этом низкая достоверность прогнозных моделей дискретных состояний обусловлена статистическими свойствами обучающей выборки. Цель работы — повысить достоверность класса прогнозных моделей  дискретных состояний нелинейных динамических систем, получаемых на основе последовательного статистического  обучения при заданном времени их обучения.  Результаты:  сформулирована общая постановка задачи синтеза нейросетевой прогнозной модели, использующей кодированную информацию о дискретных состояниях нелинейной динамической системы, с учетом ограничений на время ее обучения. Разработан алгоритм обучения прогнозной модели,  учитывающий требования к ее применению. Предложен алгоритм максимизации энтропии обучающей выборки, позволяющий значимо повысить достоверность нейросетевой прогнозной модели дискретных состояний с последовательным  обучением и улучшить данный показатель по сравнению с наилучшей авторегрессионной полиномиальной моделью.  Приведен пример прогнозной модели дискретных состояний бортовой аппаратуры космического аппарата в условиях  нештатного функционирования.  Практическая значимость:  разработанные алгоритмы позволяют сравнительно быстро  синтезировать достоверную прогнозную модель на основе кодированной информации о состояниях дискретной динамической системы при низком значении энтропии исходной обучающей выборки. Рекомендовано использовать разработанные алгоритмы в бортовых комплексах управления летательных аппаратов для синтеза автоматов, описывающих  сложные процессы функционирования бортовых систем, в том числе в условиях нештатного функционирования. Ключевые слова  — нелинейная динамическая система, прогнозная модель, энтропия обучающей выборки, телеметрическая информация. 

При проведении автоматизированных испытаний и в процессе эксплуатации сложных технических объектов широко используются модели в виде детерминированных конечных автоматов 13. Синтез таких моделей осуществляется на основе априорной информации о процессах функционирования объектов испытаний и результатах анализа телеметрической информации об их состоянии. Одним из перспективных подходов в моделировании неисправных, но работоспособных объектов, находящихся в условиях воздействия внешних факторов среды, является применение искусственных нейронных сетей. Для нейросетевых моделей, реализующих методы статистического обучения с последовательным предъявлением обучающих примеров, доказана теоретически и показана на практике возможность аппроксимации автоматов различной сложности 48. Достоверность нейросетевых прогнозных моделей сильно зависит от свойств выборки обучающих примеров. В данной работе рассматривается подход к формированию обучающей выборки на основе максимизации энтропии, позволяющий повысить достоверность прогнозной модели дискретных состояний нелинейной динамической системы при заданных ограничениях на время обучения. Приведены результаты его применения для моделирования процессов функционирования бортовой аппаратуры космического аппарата в условиях нештатного функционирования. Пусть объект испытаний представляет собой систему с конечным числом состояний. В каждый -й момент времени система находится в одном из состояний, которое кодируется двоичным словом . Разряды двоичного слова несут информацию о состоянии -х функциональных узлов системы, где 1.., количество разрядов в слове состояния. Для ликвидации неопределенности относительно процессов управления в каждый момент времени в кодовую последовательность добавлена информация о текущей команде управления . Команда управления представляет собой кодовое слово с основанием кода, равным 3 включить 1, выключить 2, оставить неизменным 0. Разряды слова команды управления несут информацию об изменении состояния отдельных функциональных узлов системы. На основе анализа телеметрической информации, получаемой в ходе испытаний и эксплуатации системы, можно получить большое количество кодовых последовательностей различной длины, характеризующих процессы функционирования системы и т. д. Для их описания могут быть использованы детерминированные конечные автоматы 46. Неисправности могут являться причиной воздействия внешних факторов на процессы функционирования системы, вследствие чего происходят несанкционированные изменения ее состояния отказы. В динамике таких отказов, несмотря на их вероятностный характер, может наблюдаться закономерность, обусловленная квазицикличностью воздействия некоторых внешних факторов. Рассмотренный случай интересен тем, что процессы функционирования системы становятся нелинейными, более сложными и менее предсказуемыми, а ее состояния в последующий момент времени зависят не только от текущего состояния и команды управления, но и от состояний системы в предыдущие моменты времени. Предсказание дискретных состояний такой системы сводится к задаче экстраполяции функции многих переменных по заданному набору примеров с помощью процедуры погружения полученной кодовой последовательности слов состояния в многомерное пространство прогнозной модели 7. Решение задачи прогнозирования состоит в нахождении функции 1 где размерность окна прогнозирования глубина погружения, удовлетворяющая заданной достоверности прогноза на проверочной и тестовой выборке. Используем в качестве прогнозной модели многослойную нейронную сеть с одним входным, одним выходным и двумя скрытыми слоями. Такая структура показала свою эффективность при решении сложных задач обучения с учителем 8. На выходе модели имеется пороговое устройство, позволяющее преобразовать непрерывные значения выходных нейронов в дискретные величины. Параметрами модели являются матрицы весовых коэффициентов сети, количество нейронов в скрытых слоях и количество нейронов во входном слое . Векторы входных данных и выходных данных образуют обучающую пару таблица. В состав обучающей пары входят задержанные значения тех параметров состояния, которые оказывают влияние на состояние системы в последующий момент времени. Множество таких параметров состояния определяется экспертом. Устройство прогнозирования дискретных состояний представляет собой нейросетевой автомат, который должен по команде от бортового комплекса управления гарантированно обучиться на имеющихся данных о функционировании контролируемой системы в течение заданного времени не зависимо от начальных значений весовых коэффициентов и, также по команде, выдать сведения о достигнутой в ходе обучения достоверности прогнозной модели и прогноз дискретных состояний контролируемой системы с заданным временем упреждения. При этом достоверность прогнозной модели должна быть как можно выше. Введение ограничения на достоверность прогнозной модели снизу ведет к появлению вероятности невыполнения задачи за указанное время, что недопустимо для обеспечивающей системы, так как может помешать выполнению целевой задачи бортового комплекса управления. Для уменьшения чувствительности прогнозной модели к начальным значениям весовых коэффициентов целесообразно на интервале времени 0, провести несколько экспериментов по обучению нейронной сети. Статистическую оценку математического ожидания показателя достоверности прогнозной модели определим в соответствии с выражением 2 где статистическая оценка математического ожидания вероятности ошибок первого и второго рода по результатам экспериментов количество экспериментов номер эксперимента, 0 статистическая оценка вероятности ошибки многошагового прогноза дискретных состояний системы, полученная в эксперименте Здесь интервал дискретных отсчетов времени, на котором вычисляется интервал упреждения прогноза в дискретных отсчетах номера дискретных отсчетов времени прогнозное значение слова-состояния в -й момент времени истинное значение слова-состояния в -й момент времени Определим доверительный интервал математического ожидания достоверности прогнозной модели по результатам экспериментов с доверительной вероятностью 0,99 9. Зададимся целью максимизации математического ожидания достоверности прогнозной модели дискретных состояний системы. Тогда задача оптимизации прогнозной модели дискретных состояний примет следующий вид где среднеквадратическое отклонение величины по результатам экспериментов время, выделяемое для обучения моделей. Достоверность прогнозной модели дискретных состояний системы сильно зависит от свойств обучающей выборки. В результате значительной неравномерности распределения во времени режимов работы системы и управляющих воздействий, наличия в обучающей выборке информации не о всех переходах между состояниями системы, а также необходимости учета задержанных значений параметров состояния отдельных функциональных узлов возникает неравномерное распределение символов в обучающих примерах и примеров в обучающей выборке. При этом нейронная сеть с последовательным предъявлением обучающих примеров реагирует только на примеры обучающей выборки, характеризующие наиболее частые переходы между состояниями системы, в результате чего часть весовых коэффициентов сети не участвует в процессе обучения и эффект обобщения символьной информации не проявляется. Для решения данной проблемы осуществляют поиск оптимального основания кода путем перебора для обучающей пары векторов нейронной сети либо реализуют перекодирование имеющейся информации с использованием слоя Кохонена, что требует значительных временных затрат. Оба пути основаны на общем принципе предобработки исходных данных, который состоит в максимизации энтропии входов и выходов нейросетевой модели 10. С другой стороны, энтропия будет максимальна, если дискретные величины, поступающие на каждый входной и выходной нейрон сети, будут распределены во времени равномерно. Преодолеть неравномерность возбуждения входных и выходных нейронов символами различных классов можно, изменяя частоту повторения тех или иных обучающих примеров на входе нейронной сети. Рассмотрим матрицу исходных данных, где 2 1 размер обучающей пары векторов рис. 1. Дополняя матрицу содержащимися в ней векторами-строками, 1, необходимо сформировать матрицу, для которой характерно максимально равномерное распределение символов различного класса в столбцах. При этом необходимо ввести промежуточную матрицу количество векторов в которой изменяется в процессе решения следующей задачи оптимизации где количество итераций процедуры оптимизации число элементов матрицы в -м столбце, принадлежащих классу номер строки и столбца промежуточной матрицы соответственно показатель плотности вероятности распределения элементов го класса на входе -го нейрона количество классов элементов в -м столбце 1 показатель плотности вероятности распределения элементов на входе -го нейрона в случае равномерного закона распределения, границы допусков на изменение и . Минимизация функции 5 сопровождается увеличением количества обучающих пар векторов в выборке. Условия 6 означают, что с уменьшением значения целевой функции математическое ожидание достоверности прогнозной модели должно расти, а доверительный интервал уменьшаться, при этом допускаются случайные изменения указанных характеристик в пределах заданных допусков. Критерием останова процедуры минимизации целевой функции 5 будем считать достижение такого значения, при котором характеристики модели прогнозирования не соответствуют условиям 6. Эффективность решения задачи 5 для повышения достоверности прогнозной модели может быть низкой в следующих случаях исходная обучающая выборка обладает высокой энтропией свойства обучающей выборки таковы, что при решении задачи 5 изменения целевой функции будут крайне малы. Алгоритм обучения и применения нейросетевой прогнозной модели, позволяющий решить задачу 4, использует принцип обратного распространения ошибки 10. Схема алгоритма приведена на рис. 2. Задать структуру модели, сформировать обучающую, проверочную и тестовую выборки присвоить номер эксперименту обучения 1, 1.. задать матрицы для хранения значений весовых коэффициентов каждого слоя наилучшей прогнозной модели, полученной по результатам экспериментов, номер слоя, 1..3 задать значение промежуточной переменной для хранения минимального значения ошибки многошагового прогноза, полученной по результатам экспериментов, 1. Задать начальные значения весовых коэффициентов матриц каждого слоя и на интервале 0,5 0,5 присвоить элементам матриц изменений весовых коэффициентов и нулевые значения задать количество циклов обучения в каждом эксперименте задать начальное значение статистической оценки вероятности ошибки на проверочной выборке 1 значение периода упреждения прогноза номер цикла обучения 1, 1, где заданное количество циклов обучения матрицы для хранения значений весовых коэффициентов каждого слоя наилучшей прогнозной модели, полученной в эксперименте задать значение промежуточной переменной для хранения минимального значения ошибки многошагового прогноза, полученной в эксперименте, 1. Присвоить значение счетчику векторов обучающей выборки 1, где 1.., количество векторов в обучающей выборке выбрать соответствующую пару векторов из обучающей выборки, . Подать на входвыход модели обучающую пару, вычислить компоненты вектора выходных значений каждого слоя вычислить взвешенные суммы каждого слоя нейронной сети осуществить нелинейное преобразование с использованием сигмоидной функции активации и получить векторы выходных значений каждого слоя 7 где входной вектор-строка параметров модели текущая матрица весовых коэффициентов го слоя текущий вектор постоянного смещения номер элемента вектора-строки. В результате прямого прохода сигналов на выходе нейросетевой прогнозной модели получаем вектор 8 где компоненты выходного вектора-строки сигмоидная функция активации 7. Для сети с двумя скрытыми слоями целевая функция будет иметь вид 9 где целевой вектор компоненты целевого вектора размер выходного вектора. Далее реализуется процедура обратного распространения ошибки и вычисляется вектор ошибок каждого слоя нейронной сети 10 Затем осуществляется коррекция значений элементов матриц 11 где скорость обучения момент обучения. Проверить выполнение условия использования всех примеров обучающей выборки если, то увеличить значение счетчика векторов на единицу и повторить шаг 4, иначе перейти к шагу 6. Определить статистическую оценку вероятности ошибки многошагового прогноза 3 на проверочной выборке после каждого цикла обучения. Если, то присвоить переменной значение, а элементам матриц текущие значения матриц весовых коэффициентов каждого слоя сети и . Проверить выполнение условия если количество циклов обучения не превысило заданное значение, то увеличить значение счетчика циклов обучения на единицу и выполнить шаги 36, иначе перейти к шагу 8. Величина подбирается экспериментальным путем до начала серии экспериментов, исходя из приемлемого значения времени обучения . Определить статистическую оценку вероятности ошибки многошагового прогноза на тестовой выборке, получаемую для прогнозной модели с матрицами весовых коэффициентов . Если, то присвоить переменной значение, а элементам матриц текущие значения матриц весовых коэффициентов каждого слоя, при невыполнении условия перейти к шагу 9. Проверить выполнение условия если достигнуто заданное количество экспериментов обучения модели, то перейти к шагу 10, иначе увеличить значение счетчика экспериментов на единицу и выполнить шаги 28 Величина выбирается экспериментальным путем до начала серии экспериментов, исходя из приемлемого значения времени обучения . Определить статистическую оценку математического ожидания достоверности прогнозной модели на тестовой выборке 2 и доверительный интервал 4. Результатом работы шагов 110 алгоритма является прогнозная модель структура нейронной сети и набор из матриц весовых коэффициентов каждого ее слоя и характеристики, позволяющие оценить, насколько можно доверять ее прогнозам. По команде на применение прогнозной модели значению счетчика векторов присвоить значение 0, на вход модели подать новый входной вектор . Вычислить компоненты вектора выходных прогнозных значений нейронной сети, соответствующие входному вектору . Проверить выполнение условия реализации многошагового прогноза с периодом упреждения если, то выполнить шаг 15, иначе шаг 14. Осуществить сдвиг окна прогнозирования вправо с добавлением прогнозного значения слова состояния во входной вектор, увеличить значение счетчика на единицу, выполнить шаги 1213. Проверить выполнение условия если поступила команда закончить прогноз, то выполнить шаг 16, иначе повторить шаги 1114 для очередного входного вектора. Проверить выполнение условия если поступила команда дообучить модель на новых данных, то, при необходимости, верифицировать структуру прогнозной модели и выполнить шаги 115, иначе закончить работу. Для повышения достоверности прогнозной модели, синтезируемой в результате работы описанного алгоритма, решим задачу максимизации энтропии обучающей выборки 5. Для ее решения разработан алгоритм, представленный на рис. 3. Задаются исходная обучающая выборка в виде матрицы структура пробной прогнозной модели и начальные значения ее весовых коэффициентов промежуточная матрица, элементам которой присваиваются значения элементов исходной обучающей выборки матрица для хранения промежуточных вариантов матрицы граничные значения допусков на характеристики модели 4, параметр, показывающий количество циклов обновления выборки, 0 оценивается значение целевой функции для матрицы в соответствии с 6. Осуществляется инициализация значения счетчика векторов 0 Осуществляется выборка обучающей пары, из матрицы . Обучающая пара векторов, добавляется к матрице снизу, а значения элементов промежуточной матрицы заносятся в матрицу . Оценивается значение целевой функции для матрицы . Проверяется следующее условие если значение целевой функции уменьшается, то, осуществляется повтор шагов 45 для обучающей пары векторов, иначе, если, то значение счетчика векторов увеличивается на единицу. Проверяются следующие условия если, то необходимо повторить шаги 36 для очередного вектора, . Если же, то 1, осуществляется загрузка исходных данных для обучения прогнозной модели, строится пробная прогнозная модель на основе обучающей выборки при заданных начальных значениях весовых коэффициентов, оцениваются характеристики пробной прогнозной модели. Проверяется следующее условие если характеристики прогнозной модели удовлетворяют условиям 6 при увеличении, то выполняются шаги 27, иначе останавливается процесс оптимизации целевой функции, переписываются значения элементов матрицы в матрицу, обучается прогнозная модель на обучающей выборке с учетом ограничений на время обучения 4. Пробная прогнозная модель используется в алгоритме для определения качества формируемой обучающей выборки. При сравнении разных вариантов обучающей выборки шаг 7 необходимо обеспечить равные условия для обучения пробных прогнозных моделей структуру модели, начальные значения весовых коэффициентов и количество векторов, поступивших на вход модели за время ее обучения . Поэтому с ростом размера обучающей выборки при решении задачи 5 необходимо пропорционально уменьшать количество циклов обучения. Полученная в результате решения задачи 5 обучающая выборка используется для решения задачи 4 уже при заданных ограничениях на время обучения. Рассмотренные алгоритмы были использованы для синтеза прогнозной модели дискретных состояний бортовой аппаратуры космического аппарата с неисправной системой электропитания. Неисправность стала причиной срабатывания систем автоматики и нештатных отключений солнечной батареи. Результаты моделирования представлены на рис. 4. Во входной вектор прогнозной модели вошли слово состояния бортовой аппаратуры и солнечной батареи в текущий момент времени 5 бит, команда управления 4 бит и задержанные значения параметра состояния солнечной батареи 20 бит. Выходной вектор представлял собой слово состояния бортовой аппаратуры и солнечной батареи в следующий момент времени 5 бит. Размер обучающей выборки составил 1000 примеров на интервале времени, равном одному году. Время обучения прогнозной модели было выбрано равным периоду одного витка космического аппарата. В результате работы алгоритма максимизации энтропии обучающей выборки и решения задачи 5 количество векторов в ней увеличилось до 8500 рис. 4, . Полученная обучающая выборка была использована для обучения нейронной сети и решения задачи 4 при заданных ограничениях на время обучения, в результате чего достоверность пробной прогнозной модели увеличилась с 60 до 85 рис. 4, . На рис. 4, представлены результаты применения полученной прогнозной модели при различном времени упреждения прогноза в сравнении с наилучшей полиномиальной авторегрессионной моделью. На рис. 5 представлены фрагменты зависимости истинных и прогнозных значений параметра состояния солнечной батареи разряд в слове состояния, характеризующего ее отключения штатные и несанкционированные, полученные нейросетевой прогнозной моделью на интервале упреждения, равном одному дискретному отсчету времени 3 мин, без использования алгоритма максимизации энтропии обучающей выборки рис. 5, и с использованием разработанного алгоритма рис. 5, . На рассмотренном интервале времени алгоритм максимизации энтропии обучающей выборки позволил уменьшить вероятность пропуска отказа. Для оперативного решения задач технической диагностики сложных объектов испытаний используется телеметрическая информация, содержащая сведения о состояниях объекта и значения некоторых наиболее важных его функциональных параметров. В работе показана возможность использования такого рода данных для синтеза нейросетевых прогнозных моделей дискретных состояний нейросетевых автоматов нелинейных динамических систем на примере бортовой аппаратуры космического аппарата в условиях нештатного функционирования. Использование алгоритма максимизации энтропии позволило повысить достоверность прогнозной модели дискретных состояний бортовой аппаратуры космического аппарата на основе многослойной нейронной сети на 25 и улучшить данный показатель по сравнению с авторегрессионной полиномиальной моделью на 57 . Разработанный алгоритм максимизации энтропии обучающей выборки позволяет сформировать такую последовательность обучающих примеров на входевыходе прогнозной модели, которая улучшает ее возможности к обобщению символьной информации и повышает достоверность при введении ограничений на время обучения. 