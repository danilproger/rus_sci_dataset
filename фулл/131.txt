ПРОГРАММА ДЛЯ АВТОМАТИЧЕСКОГО СОЗДАНИЯ И ПРОВЕРКИ ИСХОДНЫХ МАТЕРИАЛОВ КОНСТРУКТОРСКОЙ ДОКУМЕНТАЦИИ 

Описана программа, позволяющая за несколько минут выполнить большинство операций, которые невозможно автоматизировать с помощью САПР, и тем самым существенно сократить количество ошибок и время создания документации для производства печатной платы. Генератор спецификаций дает все необходимые возможности редактирования спецификации и проверки актуальности используемых компонентов. 

 Современные САПР печатных плат, как правило, содержат исчерпывающий перечень автоматизированных функций и операций при разработке проекта. Однако в процессе использования таких систем при производстве технической документации готового проекта были выявлены важные операции, которые не могут быть автоматизированы средой разработки, хотя достаточно просто поддаются алгоритмизации. Эти операции выполнялись вручную, что отнимало много времени и часто приводило к ошибкам в технической документации и к изготовлению бракованных печатных плат, которые требовали доработки или повторного производства. Для решения этой проблемы была разработана программа автоматизации процесса создания технической документации из готового проекта, предназначенная для автоматизации большинства процессов подготовки проекта к производству и позволяющая значительно уменьшить время разработки технической документации и количество ошибок. Для удобства и оптимизации разработки проектов печатных плат программа может использоваться не только после завершения работы над проектом, но и во время его разработки с целью выявления ошибок при трансляции схемы, то есть до размещения компонентов на печатной плате, что существенно на этапе проектирования. Работоспособность программы проверялась при использовании ее для создания технической документации проекта печатной платы, разработанного в системе автоматизированного проектирования печатных плат Cadence Allegro PCB Designer 1. Программу можно использовать частично, для генерации только требуемой документации. Рассмотрим этапы более подробно. Вначале составляется электрическая схема печатной платы. После успешной трансляции схемы в системе Cadence необходимо проверить активность используемых компонентов. Контроль компонентов, входящих в электрическую схему проекта, необходим для выяснения их текущего состояния можно использовать, использование ограничено, не использовать. Для работы используется БД текущих компонентов в формате MS Excel. Если БД неактуальна, программа предложит обновить ее. Далее можно сравнить список компонентов электрической схемы с БД используемых элементов и увидеть результаты работы в окне. Для удобства из результатов исключаются компоненты, которые можно использовать, чтобы увидеть лишь требующие проверки. Обычно в проекте должны присутствовать только компоненты, которые можно использовать. Если в проекте есть компоненты, использование которых ограничено, необходимо вернуться к этапу разработки принципиальной схемы и изменить ее. Наличие компонентов с ограниченным использованием согласуется с руководителем работ. После завершения разработки проекта следует этап проверки готовности печатной платы для производства. В большей мере проверка необходима для стабильности работы программы во время создания документации, так как использование незавершенного проекта печатной платы может привести к сбоям в работе программы для создания документации, а также в самой системе проектирования. Программа генерирует необходимые отчеты в САПР, анализирует их и подтверждает готовность проекта для автоматизированного процесса создания технической документации. В случае нахождения ошибок или замечаний к проекту программа выводит в окно соответствующее сообщение. Часть результатов проверки и информация из отчетов в дальнейшем используются программой, чтобы генерировать скрипты для этапа пакетных задач. Приведение таблицы компонентов, выводимой системой проектирования, к стандартизованному формату спецификации на печатную плату всегда отнимает много времени. Благодаря разработанной программе, выводимая системой Cadence информация отображается как таблица с порядком столбцов готовой спецификации, а не в виде сплошного неотформатированного списка с разделителями. Поля и их последовательность соответствуют виду готовой спецификации и расположены на тех же местах. Спецификация приобретает вид, требуемый ГОСТом, при необходимости в конце добавляется расшифровка сокращений названий фирм. Добавлена возможность замены названий для соответствия их библиотеке с русскими компонентами, так как САПР может не поддерживать кириллицу. Кроме того, можно заменить название и фирму-производителя для часто используемых компонентов . Названия таких компонентов заменяются их характеристиками, а в качестве фирмы-производителя указывается любая . Предусмотрена возможность прямого вывода готовой спецификации на печать с ее предварительным просмотром. Формат и шрифт подобраны для правильного отображения на листе формата А4. Также имеется возможность генерации перечня компонентов для конструкторской документации в формате csv . Для сохранения спецификации разработан промежуточный файл, содержащий отредактированный список компонентов, а также всю требуемую для создания спецификации по ГОСТу информацию. Генерация документации основной этап работы программы. Он реализован в виде отдельных пакетных задач, которые могут выполняться независимо друг от друга. Используемые в программе методы дают возможность экономить время и получать только требуемые технические документы, а не создавать всю документацию за один раз позволяют легко проследить процессы, выполняемые в данный момент программой, и выявить конкретный шаг, на котором происходит ошибка допускают возможность редактировать только те пакетные задачи, изменение которых необходимо в связи с новыми требованиями производства, а не весь этап генерации документации. Под пакетной задачей понимается набор операций, требуемых для создания определенного документа или документов одного типа. Требование очистки системы до ее запуска продиктовано необходимостью точно знать состояние и поведение системы в момент выполнения скриптов и операций в системе и получать требуемый результат независимо от внешних факторов, например таких, как настройка системы конкретного пользователя. Пакетные задачи выполняются отдельным программным потоком 2. Такой принцип позволяет более гибко управлять работой программы и дает возможность прервать ее практически в любой момент. Для увеличения производительности иногда используются скрипты, которые позволяет создавать система Cadence. В любом случае программа выполняет все действия без участия оператора, что было бы невозможно при использовании только внутрисистемных скриптов САПР Cadence. Создание разностной спецификации необходимо только для проектов, имеющих несколько версий. Разница считается между файлами спецификаций в специальном формате, которые можно получить на этапе создания спецификации. Программа поддерживает сложные проекты, содержащие несколько исполнений, компоненты для отладки и неустанавливаемые компоненты. Для такого рода проектов вводится дополнительный параметр, указывающий на использование компонента в конкретном исполнении. Проверяется целостность данных, чтобы не происходило ошибок при работе с проектами, содержащими несколько исполнений. Использование данной программы позволило сократить время подготовки технической документации в САПР печатных плат Cadence Allegro PCB Designer с 12 дней до 15 минут при условии, что проект печатной платы не содержит серьезных ошибок. 