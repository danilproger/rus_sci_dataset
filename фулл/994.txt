МЕТОД ОЦЕНКИ РИСКОВ  В МУЛЬТИАГЕНТНОЙ СИСТЕМЕ УПРАВЛЕНИЯ  ПРОЕКТАМИ НИР И ОКР В РЕАЛЬНОМ ВРЕМЕНИ  

Предлагаются удобные для практики количественная модель и метод оценки рисков проектной деятельности  по срокам выполнения, позволяющие интерактивно учитывать ход выполнения проектов НИР и ОКР в мультиагентной системе управления проектами в реальном времени. Агенты представляют подразделения, проекты,  задачи и сотрудников, причем задачи каждого проекта являются связанными и распределяются на общем поле  ресурсов подразделений. Модель основана на линейной аппроксимации вероятностных распределений и вычислении рисков по задачам, связанным отношениями следования. Метод представляет собой порядок расчетов, позволяющий оценивать риск и перепланировать цепочки связанных задач непосредственно в реальном  времени, когда распределение задач по сотрудникам постоянно меняется в связи с непредвиденными событиями. Разработанный метод предназначен для снижения рисков при планировании проектов НИР и ОКР в аэрокосмических приложениях.  Ключевые слова  — управление проектами, оценка рисков, вероятностный подход, мультиагентные системы, адаптивное планирование, реальное время. 

Современные проекты научно-исследовательских и опытно-конструкторских работ НИР и ОКР в современной технике имеют все возрастающую организационную, техническую и управленческую сложность и, по определению, содержат высокую степень неопределенности и постоянной динамики распределения ресурсов, вызванную новизной создаваемых продуктов и возникающими непредвиденными событиями разного рода. При этом задачи создания образцов новой техники, особенно в уникальных аэрокосмических приложениях, могут состоять из десятков и сотен этапов, разбиваться на тысячи подзадач и требовать сотен и тысяч исполнителей различной квалификации, которые должны работать согласованно. Чтобы координировать деятельность таких научных коллективов, необходимы значительные управленческие усилия для достижения поставленных целей и получения практических результатов с заданным качеством, в установленные сроки, в ограниченный бюджет, с минимальными рисками. В условиях возрастающей сложности, уникальности и разнородности таких проектов адекватные программные средства должны учитывать влияние внешних условий, конъюнктуру рынка труда, изменения в календарных планах и составах исполнителей, возникновение новых задач в ходе выполнения проекта и т. д. Однако гибко и эффективно реагировать на все эти требования позволяют лишь системы, функционирующие в реальном времени, поскольку в противном случае возникают длительные задержки, простои или, наоборот, дефицит ресурсов. Одной из важных задач управления проектной деятельностью при этом становится определение реалистичных сроков выполнения задач и постоянный учет рисков в целях минимизации влияния внешних неблагоприятных факторов, так как НИР и ОКР относятся как раз к той сфере, где риски особенно велики и адекватный их учет особенно востребован. Управление проектной деятельностью осложняется тем, что существуют значительные неопределенности, связанные с внешними и внутренними факторами неполнотой и возможной недостоверностью информации обо всех параметрах и обстоятельствах, затрудняющих выбор оптимального решения принципиальной невозможностью адекватно и точно учитывать все доступные сведения вероятностной сущностью поведения исследуемой среды и создаваемого продукта и т. п. Случайные внешние факторы обычно заранее просто невозможно корректно прогнозировать и предусмотреть даже в вероятностной интерпретации из-за большой степени неопределенности их влияния на результат. С другой стороны, присутствие субъективных факторов, когда взаимодействие руководителей и исполнителей проектных работ напоминает ситуацию конкуренции и кооперации партнеров с несовпадающими интересами и целями на внутреннем рынке предприятия, еще более затрудняет процесс принятия управленческих решений, способствует росту неопределенности и риска. В этой связи в настоящей работе предлагаются удобные для практики количественная модель и метод оценки рисков проектной деятельности по срокам выполнения, позволяющие интерактивно учитывать ход выполнения проектов НИР и ОКР в интеллектуальной системе управления проектами в реальном времени 1. Разработанная система построена на основе мультиагентной технологии адаптивного планирования ресурсов 24, находящей все большее применение при управлении ресурсами в реальном времени. В разработанной системе агенты представляют подразделения, проекты, задачи и сотрудников, причем задачи каждого проекта являются связанными и распределяются на общем поле ресурсов подразделений. При этом исполнитель не рассматривается как винтик в проекте, а участвует в определении и согласовании сроков работы, может откладывать или изменять длительность работы, вводить новые работы и т. д. Соответствующая модель оценки рисков основана на линейной аппроксимации вероятностных распределений и вычислении рисков по задачам, связанным отношениями следования. Метод представляет собой порядок расчетов, позволяющий оценивать риск и перепланировать цепочки связанных задач непосредственно в реальном времени, когда распределение задач по сотрудникам постоянно меняется в связи с непредвиденными событиями появлением нового проекта, задержками по этапам и т. д.. Будем далее полагать под неопределенностью в проектной деятельности неполноту и неточность исходной и текущей информации о стадиях в реализации проекта, в том числе о результатах и затратах. Под риском понимается потенциальная, численно измеримая возможность неблагоприятных ситуаций и связанных с ними последствий в виде потерь, ущерба, убытков денежных средств в связи с неопределенностью, т. е. со случайным изменением условий выполнения проекта, а также возможность получения непредсказуемого результата в зависимости от принятых управленческих решений и действий. Согласно теории и практике современного управления проектами Project Management Body of Knowledge PMBOK 5, управление рисками включает в себя процессы, касающиеся идентификации, анализа и оперативного реагирования на риски, возникающие в проекте. Управление рисками должно приводить к максимизации положительных влияний и минимизировать отрицательные последствия. Основными процессами, согласно PMBOK, являются 1 идентификация рисков определение, какие риски воздействуют на проект, и документирование характеристик каждого из них 2 качественная оценка оценка условий возникновения рисков и их последствий количественная оценка оценка вероятностей рисков и влияния их на успех проекта 3 разработка мер реагирования на риск определение способов и методов ослабления отрицательных последствий 4 мониторинг рисков постоянное слежение за рисками, определение рисков, оставшихся к данному моменту, и оценка эффективности принятых мер. Подробно рассмотренные в работе 6 методы оценки рисков следующие количественная оценка рисков с помощью методов математической статистики методы экспертной оценки рисков методы имитационного моделирования рисков комбинированные методы, представляющие собой объединение нескольких методов или их отдельных элементов. В настоящей работе мы рассмотрим подход, позволяющий в реальном времени оценивать изменения рисков выполнения задач по мере ввода факта выполнения задач и сразу же осуществлять перепланирование, направленное на уменьшение рисков. Этот подход важен для построения интеллектуальной системы, поддерживающей интерсубъективную теорию управления, учитывающую множество точек зрения участников процесса, действенную роль акторов и социальную самоорганизацию в коллективе по исполнению проектов 7. В современных стандартах PMBOK признаны обязательными методы экспертной оценки и SWOT-метод, когда все факторы, влияющие на проект, делятся на категории сильные стороны, слабые стороны, возможности и угрозы strengths, weakness, opportunities, threats. Затем эксперты оценивают качественно или полуколичественно влияние этих факторов на вероятность успешного завершения проектов 8, 9. Качественно-количественные шкалы для оценки вероятностей рисков и их последствий часто используются в методах построения матрицы рисков, когда в зависимости от степени опасности факторов и влияния их последствий составляют соответствующие таблицы. Матрицы рисков используются для анализа и прогнозов проектного планирования 10. Для оценки последствий различных сценариев развития проектов применяется метод оценки, основанный на построении дерева решений. Такие деревья используются обычно в двух вариантах деревья событий и деревья отказов. Метод дерева решений может быть применен в случае обозримого количества вариантов. Строятся узлы, представляющие собой основные события проекта, и ветви начала и окончания работ. Затем могут быть рассчитаны вероятности развития событий по каждому сценарию 11. Такой подход часто применяется в оценке надежности промышленных объектов 12. Оценка рисков в проектах может быть произведена на основе построения PERT-диаграмм Project Evaluation Review Technique и расчета наиболее вероятной продолжительности стадий работ на основе бета-распределения вероятностей и нахождения критического пути. Несмотря на длительный с середины 1950-х гг. период использования PERT-методов, в настоящее время они признаны рискованными сами по себе, поскольку дают слишком оптимистические оценки 13, 14. Один из мощных методов количественного анализа и оценки рисков базируется на применении метода имитационного моделирования Монте-Карло. При моделировании этапов выполнения проекта оцениваются диапазоны результатов влияния различных случайных факторов на исследуемый проект при розыгрыше различных сценариев. Такая технология помогает предсказывать наиболее вероятные результаты внешних воздействий. Большое количество вариантов и факторов, потенциально влияющих на проект, трудно оценить без моделирования. Для решения этой проблемы анализируются наилучший и наихудший сценарии развития, после чего рассчитываются промежуточные сценарии. В большинстве случаев получаемые оценки выходных параметров соответствуют нормальному закону распределения вероятностей. Однако методы МонтеКарло довольно трудно использовать в реальных проектах из-за отсутствия достаточно удобных программных средств, сложности выбора факторов и их диапазонов 15, 16. Значительный вклад в современные математические методы управления в организационных структурах и построения оценки рисков составляют работы 17, 18, где рассмотрены действенные механизмы выявления и реакции на риски, например самоопережающий контроль стимулирование к раннему обнаружению рисков или компенсационные реакции направленные на повышение оплаты исполнителей или вовлечение новых исполнителей. Эти методы хорошо согласуются с мультиагентным подходом, поскольку могут применяться индивидуально к участникам в ходе выполнения проектов в реальном времени, но не рассчитаны на постоянное перевычисление рисков в ходе поступления непредвиденных событий. В целом можно утверждать, что многие разработанные модели исходят из сложившейся классической централизованной и статической природы проектов, и, как следствие, адаптивный пересмотр плана проекта не происходит при возникновении непредвиденных событий. Кроме того, рассматриваются такие отношения центра и исполнителей, в которых лишь центр является активным, а исполнитель не способен к активному добавлению или изменению задач и не может динамически менять планы. Модели и методы, рассматриваемые в статье, напротив, используются при построении системы, которая призвана позволять оценивать риски в ходе выполнения проекта и на основе этих оценок перепланировать задачи в реальном времени. В настоящем подходе в качестве основы мы используем разработанную интеллектуальную систему управления проектами НИР и ОКР в реальном времени 1, реализованную на основе концепции сетей потребностей и возможностей 24. Мультиагентные технологии в последнее время находят все больше применений и позволяют решать сложные и динамичные задачи адаптивного планирования в различных предметных областях от грузовых перевозок и производственного планирования до управления грузопотоком Международной космической станции и роем спутников 19. Разработанная система представляет собой новое поколение интеллектуальных систем управления ресурсами на основе адаптивного планирования, в котором реализуется полный цикл управления планирование исполнение контроль анализ в реальном времени. При этом система ориентирована не на планирование сверху-вниз, когда начальник все решает за подчиненных, а наоборот, стимулирует планирование снизу-вверх, когда исполнители договариваются между собой. Механизмы адаптивного планирования позволяют более гибко реагировать на все поступающие события в реальном времени и предотвращать критические ситуации. В разработанной системе на основе подхода, изложенного в работах 24, задачи каждого проекта представляются множеством агентов потребностей, которые непрерывно ищут наилучшее размещение на ресурсах, представленных агентами возможностей. В результате строится сеть связанных операций задач, формирующая сеть потребностей и возможностей, открытую к изменениям под действием событий любого рода приход нового проекта, приостановка или завершение существующего, отказ или задержка исполнителя, перенос задачи на более поздний срок и т. д. Более подробно разработанный подход адаптивного планирования, реализованный в системе, рассматривается в работе 1. Очевидно, что при таком подходе в реальном времени меняются и риски проекта, вследствие чего та часть проекта, где ранее все было в зеленом цвете без риска, становится в красном цвете получает риск и наоборот, т. е. постоянно меняются оценки, которые должны вызывать адекватные изменения в планах, например, сложная задача должна быть переброшена на менее загруженный ресурс и т. д. Нами предлагается метод аппроксимации вероятностей завершения проектов в срок, который позволяет приближенно количественно оценивать в реальном времени риски завершения НИР и ОКР для сокращения объема вычислений. Рассмотрим множество проектов, 1.., количество проектов. Проект состоит из множества подзадач, 1.., количество подзадач в проекте. Обозначим запланированный срок выполнения проекта, предельный срок выполнения проекта, реальный срок выполнения проекта, длительность выполнения подзадачи в проекте . Под риском в задаче проектного планирования будем понимать вероятность выхода за предельный срок реального времени выполнения данного проекта . 1 Длительность выполнения проекта определяется как время окончания последней подзадачи в проекте, которое вычисляется по цепочке от первой подзадачи и зависит от всех предыдущих запланированных подзадач перед каждой подзадачей данного проекта на каждом ресурсе исполнителе. Поэтому точное вычисление вероятности выхода за предельный срок потребует большого количества вычислений. Рассмотрим некоторые упрощения, которые позволят приближенно вычислить значение вероятности. Будем рассматривать один проект, 1. Предположим, что каждая подзадача проекта выполняется на отдельном ресурсе исполнителе, множество исполнителей, 1.. . Предположим, что разного рода неопределенные факторы, которые в принципе очень трудно или даже невозможно учесть, случайным образом влияют на среднюю продолжительность выполнения конкретной подзадачи и на время ее завершения, поэтому является случайной величиной. Согласно теории вероятностей, распределение времени окончания проекта при учете несистематических факторов подчиняется нормальному закону, который описывается гауссовой функцией распределения. Предположим также, что в целом запас времени исполнителей достаточен для выполнения каждой подзадачи в срок в идеальном случае, без учета несистематических факторов. Оценим неопределенность времени выполнения подзадачи т. е. той части распределения времени выполнения предыдущей подзадачи, с которой перекрывается следующая подзадача за счет хвостов гауссовой функции распределения вправо от каждой подзадачи величиной стандартное отклонение, номер исполнителя, номер проекта. Таким образом, время выполнения каждой подзадачи описывается, кроме длительности, величиной неопределенности . Аппроксимируем хвост гауссовой функции с помощью линейной функции рис. 1, при этом получим трапециевидную форму функции распределения. Считаем, что момент времени начала каждой подзадачи достоверно известен. Поскольку величина оценивает интервал неопределенности времени окончания подзадачи, начало следующей подзадачи может попасть в этот интервал. Поэтому при выстраивании цепочки подзадач вправо по оси времени суммарная неопределенность будет накапливаться по теореме сложения дисперсий. Это означает, что время окончания последней подзадачи может выйти за предельный срок рис. 2. Отметим, что суммарное распределение времени выполнения подзадач может иметь очень сложную форму. Например, сумма двух равномерно распределенных величин имеет треугольное распределение, распределение суммы бесконечного количества произвольных случайных величин стремится к нормальному распределению согласно центральной предельной теореме теории вероятностей. Поэтому упрощаем рассуждение и считаем, что итоговое распределение также можно аппроксимировать трапецией, правый треугольник которой имеет основание, равное результирующей неопределенности цепочки подзадач . Например, для проекта, состоящего из двух подзадач, вычисляется по формуле 2 Согласно рис. 2, где рассматривается единственный проект 1, вероятность выхода за предельный срок окончания проекта, состоящего из двух подзадач, равна площади закрашенного прямоугольного треугольника, одну из сторон которого образует плотность вероятности . Здесь и коэффициенты, определяемые из условия прохождения графика через точку 0, и условия нормировки 3 4 Из 3 и 4 получаем значения коэффициентов и Тогда плотность вероятности 5 Вероятность выхода срока выполнения проекта за предельный срок вычисляется как площадь прямоугольного треугольника с катетами и 6 Соответственно, риск равен при условии т. е. предельный срок выполнения проекта находится внутри интервала результирующей неопределенности. Таким образом, риск выхода времени выполнения проекта за предельный срок определяется выражением 7 С учетом 5 среднее время окончания проекта 8 Следует отметить, что возрастающие значения неопределенности объясняют существование естественного горизонта планирования. Если результирующая неопределенность будет сравнима со средним временем выполнения подзадачи, дальнейшее планирование теряет смысл, так как накопившаяся неопределенность однозначно делает невыполнимым план последней подзадачи. При рассмотрении нескольких проектов следует учитывать, что исполнитель может выполнять подзадачи различных проектов. На рис. 3 приведена диаграмма Гантта для двух исполнителей, представляющая график выполнения двух проектов, каждый из которых включает по две подзадачи. Оценим нижнюю границу риска каждого проекта упрощенным способом, учитывая максимум из двух значений результирующей неопределенности по ресурсу исполнителю и результирующей неопределенности по подзадачам проекта . На том ресурсе, где находится финальная подзадача данного проекта, последовательно суммируются перекрытия распределений времени выполнения всех подзадач, которые стоят до финальной подзадачи 9 где область перекрытия неопределенности предыдущей подзадачи со временем выполнения следующей подзадачи по исполнителю неопределенность последней подзадачи. Аналогично подсчитывается неопределенность по последовательности подзадач в данном проекте 10 где область перекрытия неопределенности предыдущей подзадачи со временем выполнения следующей подзадачи по проекту. Далее на основании и с использованием формулы 7 вычисляем риск по исполнителю и риск по цепочке подзадач проекта, после чего определяем риск проекта по формуле max, . 11 Следует отметить, что даже треугольная аппроксимация правой части функции вероятности потребовала бы пересчета цепочек распределений, поскольку распределения меняли бы свою дисперсию в сторону увеличения, при этом возникали бы дополнительные вычислительные сложности. Поэтому предлагается считать дисперсии распределений постоянными или оценивать их по статистике истории выполнения подобных задач и выбирать максимум из оценки по ресурсу и по последовательности подзадач. Грубые оценки можно сделать, не учитывая перекрытия распределений, а вычисляя полную сумму дисперсий. Эту величину можно считать близкой к верхней оценке риска. Реальный риск будет больше, чем вычисленный, поэтому естественно предположить, что найдена нижняя оценка. Однако вполне возможно, что в реальности время выполнения подзадач может быть не только больше, но и меньше, чем среднее. Можно предположить, что неопределенность во времени для последовательности подзадач различна для разных исполнителей, и чем меньше неопределенность, тем больше стоимость выполнения подзадачи конкретным исполнителем. Таким образом, можно найти вероятности выхода проектов за предельный срок, используя расписание, существующее в текущий момент времени, например сразу после внесения в него отметок об очередном событии. Далее должно быть принято решение о снижении рисков при выходе их значений за допустимые границы и выбрана стратегия парирования рисков. Решение зависит от величины штрафных санкций по каждому проекту, от стоимости снижения разброса выполнения подзадач обычно плохо определенная и быстро растущая величина и от стоимости привлечения дополнительных ресурсов. Поэтому потенциально возможны следующие способы снижения рисков, которые требуют определения критического пути для каждого проекта 1 перепланирование наиболее рискованных подзадач 2 уменьшение неопределенности проекта путем дополнительных затрат на работу исполнителей, уже участвующих в проекте выплата премий 3 привлечение дополнительных исполнителей 4 разрешение сверхурочной работы исполнителей. Выбор наилучшего сценария зависит от конкретного плана на данный момент, степени допустимых рисков, наличия и стоимости работ дополнительных исполнителей. Рассчитаем риск выполнения некоторого проекта на гипотетических модельных данных. Пусть имеются три проекта, состоящие из подзадач, для выполнения которых могут быть привлечены три исполнителя. Неопределенности одинаковы для всех подзадач и равны четырем единицам времени. Характеристики проектов приведены в таблице, план выполнения проектов представлен на рис. 4. Найдем риски с учетом перекрытий неопределенностей неопределенность по ресурсу 1 равна 0 0 4 4 время начала последней подзадачи 1,2 превышает неопределенности предыдущих подзадач, момент окончания проекта равен 34, предельное время окончания проекта 36. По формуле 7 1 14 0,25 учитываются только перекрытие подзадач 2,2 и 1,2 и распределение последней подзадачи 1,2 проекта 2, при этом неопределенность равна 0 4 4 8, момент окончания равен 34, предельный срок равен 36. По формуле 7 риск по подзадачам проекта 2 равен 2 1 28 2 916 0,56. Таким образом, риск проекта 2 составляет 2 0,56. Обнаружение риска, его увеличение или сокращение могут идентифицироваться в разрабатываемой системе на бизнес-радаре руководителя проекта и вызывать автоматическое или ручное перестроение плана для минимизации риска соответствующего проекта. Предположим, что штрафные санкции за опоздание проекта 2 велики и равны 10 единицам за каждую единицу времени отставания от графика например, от срока окончания проекта 2 зависят другие дорогостоящие проекты. Проект 1 предусматривает простые штрафы, пропорциональные времени опоздания. Имеется также более дешевый на 30 ресурс исполнитель 2, который, однако, дает и вдвое большую неопределенность по срокам 8 единиц. Допустим, что снижение неопределенностей выполнения подзадач исполнителя 2 требует больших затрат и невозможно. Проанализируем два варианта снижения рисков 1 перепланирование подзадач проектов 1 и 2 на 2-м исполнителе 2 привлечение исполнителя 2 . Средние потери при существующем плане складываются из средних потерь за счет штрафов по проектам 1 и 2. Среднее время завершения проекта 1 с учетом неопределенности по подзадачам, равной 8, по формуле 8 будет 20 83 22,7. Поэтому средний штраф по проекту 1 составит 0,7. Среднее время завершения проекта 2 с учетом неопределенности по подзадачам, равной 8, будет 34 83 36,7. Тогда средние потери для данного плана составят 0,7 10 36,7 36 7,7. В результате перепланирования подзадач 2,1 и 2,2 проектов 1 и 2 получается расписание, представленное на рис. 5. В данном варианте плана средние потери по проекту 2 равны 0, потому что среднее время окончания проекта 2 не выходит за предельный срок. Среднее время окончания проекта 1 зависит от неопределенности, связанной с исполнителем 2, и равно 24 83 26,6. Средний штраф за отставание по проекту 1 составит 26,6 22 4,6. Поэтому план, полученный в результате перепланирования, выгоднее первоначального плана на 7,7 4,6 3,1 единицы. Рассмотрим теперь вариант привлечения дополнительного исполнителя 2 . Стоимость выполнения минимальной по длительности подзадачи 2,2 равна 8 единицам и 5,6 единицам в первоначальном и новом планах соответственно. Следовательно, привлечение дополнительного исполнителя невыгодно. Разработанный метод в настоящее время реализуется в рамках указанной выше интеллектуальной системы, находящейся в опытной эксплуатации в подразделениях ОАО РКК Энергия. Автоматизация планирования, мониторинга и контроля выполнения НИР и ОКР при создании сложных технических объектов требует учета специфики, связанной с высокой степенью неопределенности и динамики в этапах проектов. В свою очередь планирование в условиях высокой неопределенности связано со значительными рисками. Рекомендуемые в настоящее время стандартами PMBOK методы носят скорее качественно-количественный характер и на практике не позволяют оценивать риски непосредственно в ходе проекта в реальном времени, особенно при интерактивном изменении планов исполнителями. Предлагаемый в создаваемой интеллектуальной системе управления проектами НИР и ОКР метод приближенного расчета рисков выполнения проектов дает возможность в реальном времени на практике учитывать и контролировать возникающие риски для оперативного принятия решения по перераспределению ресурсов или привлечению новых ресурсов и минимизации рисков. Предложенный в статье метод предполагается в дальнейшем развивать в направлении многокритериального подхода к планированию, что позволит комплексно учитывать многие важные критерии, например качество и стоимость работ, равномерность загрузки персонала, индивидуальные предпочтения и ограничения отдельных исполнителей и многие другие. 