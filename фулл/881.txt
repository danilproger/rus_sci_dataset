ПРОГНОЗИРУЮЩИЕ АЛГОРИТМЫ УПРАВЛЕНИЯ  ДИНАМИЧЕСКИМИ ОБЪЕКТАМИ 

Предложены алгоритмы терминального управления нелинейными динамическими объектами, использующие методы математического программирования для поиска оптимального решения. Благодаря применению  прогнозирующих моделей, включающих наряду с моделями объектов уравнения чувствительности, задача оптимального управления сводится к задаче на условный экстремум функции нескольких переменных. Ключевые слова  — оптимальное управление, прогнозирующая модель. 

При решении задач оптимального управления методами математического программирования возникают трудности, связанные с поиском экстремума функций при огромном количестве переменных и ограничений. В соответствии с традиционно используемой методикой при формулировании задачи оптимального управления в виде задачи математического программирования каждая скалярная компонента вектора состояния или управления рассматривается для каждого дискретного момента времени как особая переменная. При этом число таких переменных и соответствующих ограничений увеличивается с увеличением количества временных интервалов дискретизации при описании показателя качества и модели объекта в дискретной форме и в пределе стремится к бесконечности 1. Увеличение размерности задачи снижает точность вычислений и увеличивает время поиска оптимального решения, что затрудняет использование разрабатываемых алгоритмов управления на практике, особенно при их реализации в реальном масштабе времени. Использование прогнозирующих моделей для описания поведения объекта в будущем и для определения чувствительности компонент его вектора состояния к управляющим воздействиям позволяет заменить решение задачи математического программирования в традиционной постановке на последовательность более простых, т. е. с меньшим количеством переменных и ограничений, задач математического программирования. Это даст возможность разработать алгоритмы терминального управления нелинейными объектами, способные функционировать в реальном масштабе времени. Пусть объект управления описывается уравнением 1 где, вектор состояния, вектор управляющих функций, вектор начальных условий, дифференцируемая по всем аргументам нелинейная вектор-функция. Требуется перевести объект 1 из начального состояния в конечное состояние, причем требования на конечное состояние могут накладываться не на все компоненты, а на компонент вектора . Предполагается также, что система 1 управляема по этим фазовым координатам. Каких-либо дополнительных требований к траектории в процессе движения объекта 1 в конечное состояние не предъявляется. Вектор управлений зададим в виде 2 где, -мерный вектор настраиваемых параметров, . Компоненты вектора 3 где, при, т. е. множество компонент вектора параметров разбито на непересекающихся подмножеств . Функции 3 могут выбираться в достаточной мере произвольно, однако они должны быть дифференцируемы по своим аргументам. Например, возможно их задание в виде 4 где опорные управления, получаемые с использованием известных методов оптимального управления, например принципа максимума, для номинального режима функционирования объекта 2. Таким образом, функции определяют качество процесса управления и удовлетворение технологическим и техническим ограничениям в определенных пределах в процессе движения объекта к конечной точке. Настраиваемые параметры в 4 играют роль модулирующих функций, деформируя опорные управления по частоте, фазе, амплитуде и углу наклона к оси времени . Таким образом, с помощью соответствующего выбора настраиваемых параметров можно найти такой вектор управляющих функций, который бы переводил систему 1 из начального состояния в конечное . При этом в ограниченной области изменения начальных и конечных условий получаемые траектории близки к оптимальным в том смысле, в каком были получены опорные управления Управление объектом 1 представляет собой итеративный процесс. На каждом цикле коррекции траектории путем прогнозирования определяются отклонения реализуемых конечных значений вектора от заданных, на основе которых вычисляются поправки к вектору настраиваемых параметров . Рассмотрим решение системы 1 с управлением 2. Так как при реализации траектории, начальные условия в точке уже выбраны и не варьируются, полагаем, что, . Потребуем, чтобы в некоторый момент времени выполнялось равенство, . Линеаризуя левую часть данного равенства в окрестности точки, где значение вектора параметров, полученное на -й итерации фиксированный момент времени, имеем 5 Выражение 5 может быть использовано для определения поправок к вектору и поправок к длине интервала прогнозирования для случая, когда время управления жестко не фиксировано или неизвестно. Подставляя в выражение 5, получим уравнение для вычисления поправок для случая фиксированного конечного момента времени 6 где, или в скалярной форме 7 где чувствительность переменной по параметру поправка к -му настраиваемому параметру невязка по -й управляемой переменной на -й итерации. В уравнения 7 вошли компонент вектора состояния, на которые наложены требования в конечной точке . При система 7 представляет собой систему из линейных алгебраических уравнений относительно неизвестных поправок, Решая систему 7 относительно, производим уточнение вектора параметров по формуле 8 где симметричная матрица, характеризующая величину шага номер итерации на каждом цикле коррекции траектории. Выбирая соответствующим образом элементы матрицы, можно реализовать тот или иной алгоритм спуска к искомому . Уравнения 6 или 7 могут также использоваться для вычисления поправок и для случая, когда время управления жестко не фиксировано. Это возможно, если контроль за остановом процесса интегрирования при прогнозировании осуществлять по достижению какой-либо монотонно изменяющейся координаты вектора своего заданного значения . Это более эффективный способ, чем находить искомые поправки из уравнения 5. Выражения для частных производных в 7 известны и определяются видом управляющих функций 3. Производные являются функциями чувствительности параметров траектории по управлениям и определяются из решения соответствующих уравнений чувствительности 3 9 где матрица чувствительности матрицы Якоби размерности соответственно и . Использование уравнений чувствительности резко сокращает число прогнозов по сравнению со случаем, если бы частные производные системы 7 определялись численным дифференцированием, а также повышает точность определения поправок . Таким образом, для организации управления объектом 1 на каждом цикле коррекции траектории необходимо совместно интегрировать уравнения модели 1 и уравнения чувствительности 9, затем, используя выражения 7 и 8, определять уточненные значения вектора параметров . Количество прогнозов итераций зависит от требуемой точности, выбранного начального приближения и уровня возмущений, действующих на объект 1. Вариант реализации данного алгоритма представлен в работе 4. Решим задачу, рассмотренную выше, при дополнительных требованиях, предъявляемых к управляемому процессу, в виде минимизации некоторого показателя качества 10 где, дифференцируемая скалярная функция векторных аргументов, отражающая мгновенные потери качества. Требуется с помощью управления 2 перевести объект 1 из начального состояния в конечное за время и при этом обеспечить минимизацию показателя качества 10. В соответствии с 10 расширим вектор состояния системы 1, тогда 11 где, 0, . Переменная в системе 11 характеризует текущее значение показателя качества, уравнение для которой получается дифференцированием 10 по . При разложим, в ряд Тейлора в окрестности точки, оставляя в разложении члены до 2-го порядка включительно 12 При и решим задачу на условный экстремум функции 12 при ограничениях 7, для чего введем функцию Лагранжа 13 где множители Лагранжа. Заметим, что число уравнений системы 7 должно быть меньше числа настраиваемых параметров, т. е. . Стационарная точка, соответствующая минимуму функции, а следовательно, минимуму по функции 12 при ограничениях 7, определяется из системы уравнений 14 Решая систему 14, состоящую из линейных алгебраических уравнений с неизвестными, производим уточнение вектора параметров по формуле 8. Частные производные системы 14 определяются из выражений 15 Частные производные в 15 определяются так же, как и в первом разделе, функции чувствительности из решения следующей системы уравнений чувствительности 1-го и 2-го порядков при нулевых начальных условиях 16 Поскольку порядок дифференцирования в производных 2-го порядка системы 16 безразличен, то общее число различных уравнений этой системы равно 3 12. Итак, для определения управлений 2 для объекта 1, доставляющих минимум показателю 10 и переводящих объект из в, необходимо на каждом цикле коррекции траектории определять вектор параметров, для чего организуется итеративный процесс 8. Поправки на каждой итерации определяются из системы линейных алгебраических уравнений 14, коэффициенты которой вычисляются с помощью формул 15. Функции чувствительности, входящие в формулы 15, определяются из решения системы дифференциальных уравнений 16 при, которые интегрируются совместно с уравнениями модели 11. Рассмотрим задачу из предыдущего раздела при условии, что на управления наложены ограничения в виде диапазонов изменения настраиваемых параметров 17 где, заданные вещественные числа. Требуется перевести объект 11 из в, обеспечив при этом минимизацию, при выполнении условий 17. Как и ранее, решение поставленной задачи осуществляем итеративным путем. На каждом цикле коррекции траектории организуем итерации для определения вектора настраиваемых параметров . Каждая итерация переход от к включает последовательность операций 1 нахождение направления уменьшения функции т. е. вектора спуска с координатами 2 выбор величины шага, с которым надо двигаться по направлению спуска 3 собственно итерационный переход от по направлению спуска с выбранным шагом к следующей точке . Выбор величины шага, в отличие от алгоритмов, рассмотренных выше, здесь играет существенную роль, поскольку велика вероятность выхода за границы допустимой области 17. Таким образом, на каждом цикле коррекции траектории решается задача нелинейного программирования. Воспользуемся для ее решения алгоритмами метода внутренних точек 5, а именно комбинированным алгоритмом, который позволяет совместить поиск допустимого решения с поиском оптимального и упростить тем самым вычислительную процедуру. 1. Определение направления спуска . Линеаризуем, в окрестности точки 18 где Для определения направления спуска, согласно работе 5, необходимо минимизировать функцию 19 при условиях 7, где весовые коэффициенты вычисляются по формуле 20 где некоторое положительное число. При неограниченности по условиям 17 сверху и снизу всегда равно . Функция Лагранжа для данной задачи имеет вид 21 Следуя известной методике, находим условия оптимальности 22 Пусть решение задачи 19 при условиях 7, тогда 23 Подставляя во второе уравнение системы 22, получим систему уравнений 24 где Система 24 состоит из линейных алгебраических уравнений с неизвестными, причем матрица всегда симметрична и неотрицательно определена. Решая систему 24, находим двойственные переменные и вычисляем двойственные невязки Затем определяем направление спуска вектор с координатами 25 Частные производные в выражениях 7, 18 определяются аналогично предыдущим разделам. 2. Выбор величины шага. При определении величины шага корректировки решения необходимо, во-первых, гарантировать выполнение условий 17 в виде строгих неравенств на следующей итерации. Это достигается при соблюдении соотношения 26 27 где заданная величина из открытого интервала 0, 1. Во-вторых, необходимо стремиться к сокращению невязок балансовых ограничений 7 и уменьшению целевой функции, . Этого можно достичь с помощью функции 28 где достаточно большой штрафной коэффициент. Шаг корректировки решения вычисляется по формуле 29 где определяется из выражения 27, в точке, где реализуется минимум . Таким образом, выбор величины шага сопровождается решением задачи одномерной минимизации функции 28, которая достаточно просто решается одним из регулярных методов оптимизации 6. 3. Итерационный переход. Переход к следующему шагу определения вектора производим по формуле 30 Компоненты вектора начального приближения можно определять по правилам где заданная положительная величина. Итерации заканчиваются при выполнении условия где, определяются в соответствии с 28 при 0 заданное достаточно малое положительное число. При реализации алгоритмов из двух последних разделов в случае незначительных возмущений, действующих на объект управления, нет необходимости использовать данные алгоритмы на каждом цикле коррекции траектории. Если найденный с помощью этих алгоритмов оптимальный вектор настраиваемых параметров лежит внутри области ограничений 17, то достаточно использовать данные алгоритмы только на первом цикле коррекции траектории для определения новых опорных управлений за которые принимаем управления, соответствующие вектору, полученному на первом цикле. Далее на последующих циклах используется алгоритм из первого раздела при начальном приближении Аппроксимацию можно произвести либо с помощью метода наименьших квадратов, либо для функций сложной формы с помощью сплайнов или каким-либо другим методом. Во всех случаях функции должны быть дифференцируемы по . Такая комбинация алгоритмов позволит реализовать управление объектом в реальном масштабе времени, сократить вычислительные затраты при незначительном отклонении от оптимального режима. 