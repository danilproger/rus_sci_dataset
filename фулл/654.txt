СОПРЯЖЕНИЕ ПРОГРАММНЫХ СРЕД   В ЗАДАЧАХ МОДЕЛИРОВАНИЯ И   ТЕСТИРОВАНИЯ СИСТЕМ УПРАВЛЕНИЯ  ЭНЕРГЕТИЧЕСКИМИ ГАЗОТУРБИННЫМИ УСТАНОВКАМИ  

Приводится решение задачи сопряжения программных сред для программной реализации разработанной  математической модели газотурбинной мини-электростанции. Математическая модель предназначена для тестирования систем управления энергетическими газотурбинными установками. Ключевые слова  — электроэнергетическая система, газотурбинная установка, автоматическое управление.  

Предприятия отечественного авиационного двигателестроения, решая задачи конверсии и диверсификации производства, уделяют значительное и возрастающее внимание разработке газотурбинных установок ГТУ наземного применения. В частности, только для нужд электроэнергетики на предприятиях Российской Федерации сегодня разрабатывается и эксплуатируется до 20 типоразмеров малых ГТУ мощностью от 1 до 25 МВт 1. Новые, резко отличные от полетных, условия функционирования ГТУ предъявляют повышенные и специфические требования к их системам автоматического управления САУ, которые, тем не менее, до настоящего времени в основном продолжают строиться на базе чисто авиационных прототипов без учета особенностей и характеристик электрической нагрузки. Как результат снижается эффективность принимаемых на этапах проектирования решений, что, в свою очередь, приводит к серьезным препятствиям в обеспечении удовлетворительных эксплуатационных характеристик конечных изделий. Основную причину следует искать в отсутствии адекватных программно-алгоритмических средств, обеспечивающих решение задач комплексной автоматизации проектирования и отладки САУ наземных энергетических ГТУ. В статье обсуждаются возможности решения данной проблемы на основе создания гибких компьютерных средств тестирования и наладки алгоритмов САУ ГТУ. С этой целью анализируется математическое описание и исследуется решение задачи сопряжения программных сред разработки алгоритмического аппарата. Современные энергетические ГТУ представляют собой достаточно сложные для управления объекты. Во-первых, сегодня для наземного применения используются главным образом ГТУ, выполненные по двухвальной схеме, что в сравнении с одновальными ГТУ обеспечивает повышенную экономичность и позволяет свободно выбирать частоту вращения отдельных блоков 2. Однако в то же время данная кинематическая схема не способствует улучшению динамических характеристик. Основными причинами затягивания переходных процессов по частоте, например при резких изменениях электрических нагрузок, являются наличие газовой связи между валами ГТУ и их малый момент инерции. Во-вторых, для обеспечения требуемого качества вырабатываемой электроэнергии, в значительной мере определяемого характером переходных процессов установки, требуется дальнейшее совершенствование систем и алгоритмов управления ГТУ. При решении этой задачи ГТУ должны рассматриваться во взаимодействии с другими подсистемами и узлами, для энергетических ГТУ это, прежде всего, электрогенератор и электроэнергетическая система ЭЭС в целом. К сожалению, до настоящего времени разработка и проектирование САУ ГТУ, САУ синхронного генератора производятся в значительной степени независимо, и их объединение в рамках единой мини-электростанции происходит лишь на завершающих стадиях проектирования. При этом при проектировании и отладке САУ ГТУ не учитывается или учитывается крайне приближенно влияние ЭЭС на процессы регулирования ГТУ, то же самое следует сказать и о проектировании САУ генератора. В результате на практике часто возникают аварийные режимы по причине отсутствия согласования алгоритмов функционирования локальных САУ. Для решения указанной проблемы на самых ранних этапах проектирования разработчик должен иметь возможность исследовать поведение ГТУ в качестве модуля единой сложной взаимосвязанной системы. Подобный подход обеспечивает условия согласования характеристик подсистем и локальных САУ и прежде всего САУ ГТУ и САУ синхронного генератора. По этим же причинам разработка, тестирование и отладка алгоритмов САУ ГТУ должны выполняться на основе математического моделирования основных элементов и взаимодействующих подсистем для последующей поэтапной проверки правильности принимаемых решений. Таким образом, для проектирования, тестирования и отладки алгоритмического обеспечения САУ ГТУ необходимо создать адекватную математическую модель, обеспечивающую моделирование ГТУ во взаимодействии с синхронным генератором и другими структурными элементами ЭЭС. Задачи моделирования ГТУ, структурных элементов ЭЭС, САУ, а также задачи настройки и коррекции алгоритмов САУ целесообразно объединять для совместного исполнения в рамках программного моделирующего комплекса 3. Подобные гибкие программные моделирующие комплексы являются многофункциональными, они предназначены для комплексного решения задач моделирования, проектирования, тестирования и отладки алгоритмического обеспечения САУ энергетических ГТУ при учете динамических процессов не только собственно в ГТУ, но и в электрогенераторах и прочих элементах ЭЭС. Предложенная концепция совместного моделирования ГТУ и ЭЭС в задачах тестирования и отладки алгоритмов САУ ГТУ хорошо согласуется с современными подходами к управлению энергетическими объектами, обусловливает возможность применения современных методов синтеза и оптимизации САУ 4, 5. В рамках программного моделирующего комплекса энергетические ГТУ моделируются совместно с разнообразными элементами ЭЭС. При этом имеют место следующие главные проблемы. 1. Необходимость моделирования различных конфигураций газотурбинных электростанций, различающихся по числу энергетических установок и вариантам возможных схем электроснабжения. 2. Необходимость сопряжения программных сред моделирования, что обусловлено объективными причинами. Математическая модель ГТУ является достаточно сложной, она учитывает геометрию основных сечений установки, вследствие чего ее реализация возможна только при связном воспроизведении всех выходных координат ГТУ, используемых в контурах регулирования. Модель, обеспечивающая такое связное воспроизведение всех координат, строится путем объединения моделей, описывающих различные узлы двигателя или различные процессы в нем. Именно такая модель применяется для доводки и отладки специализированного программного обеспечения САУ 6. Указанные математические модели ГТУ достаточно давно разработаны и сертифицированы отечественными предприятиями авиационного двигателестроения, вследствие чего в настоящее время актуальна задача сопряжения программных сред создания и исполнения математических моделей ГТУ в составе гибких программно-вычислительных комплексов. Для разрешения первой проблемы необходима универсальная методика построения сложной математической модели ЭЭС с возможностями ее реконфигурации. Математическая модель ЭЭС включает в себя большое количество взаимосвязанных линейных и нелинейных дифференциальных и алгебраических уравнений она также должна учитывать изменения в топологии, в направлении передачи энергии и отвечать ряду других разнообразных, зачастую противоречивых требований. Сложная математическая модель состоит из моделей структурных элементов и модели их взаимодействия 7. Для того чтобы представить математические модели всех структурных электрически-взаимодействующих элементов в единой обобщенной форме, представим математическую модель каждого структурного элемента в координатах ПаркаГорева, а затем преобразуем математические модели элементов к единообразной векторно-матричной форме записи. Математические модели всех структурных элементов ЭЭС представим в виде следующего векторно-матричного уравнения, 1 где символ дифференцирования, вектор токов и вектор производных токов элемента знак означает, что структурный элемент является источником электрической мощности генератором, знак потребителем вектор напряжений, приложенных между внешними зажимами элемента, матрицы, размерность которых зависит от системы координат, в которых моделируется структурный элемент, а также от того, полные это уравнения или упрощенные вектор, определяющий воздействие на элемент со стороны средств регулирования электрических параметров. Компоненты вектора связанные с внешним воздействием на элемент, для пассивных элементов электрической системы нулевые, для синхронных машин меняются на каждом шаге расчета. При реализации динамической модели уравнения 1 решаются на каждом шаге расчета методом численного интегрирования относительно внешних токов структурного элемента. При этом следует отметить, что для пассивных элементов выражение 1 содержит всю систему дифференциальных уравнений элемента. Для электрических машин уравнения 1 следует интегрировать совместно с уравнениями роторных контуров уравнениями, описывающими механическое состояние элемента, и уравнениями, описывающими действие систем автоматического регулирования. Знаки при слагаемых уравнения 1 соответствуют нормальному направлению токов в электрических машинах от генератора к узлу. Математическую модель для расчета установившегося режима получаем из уравнений 1, принимая 0. В качестве примера рассмотрим процесс получения уравнения вида 1 для наиболее ответственного элемента ЭСС синхронного генератора. Система дифференциальных уравнений синхронного генератора представлена в относительных единицах в системе вращающихся координат ПаркаГорева в -, -осях с учетом общепринятых допущений в следующем виде 2 где напряжение на обмотке статора по продольной и поперечной осям, потокосцепления статора по продольной и поперечной осям угловая частота вращения ротора токи статора по продольной и поперечной осям активное сопротивление обмотки статора напряжение обмотки возбуждения, потокосцепление, ток и сопротивление обмотки возбуждения, потокосцепления демпферных контуров по продольной и поперечной осям токи демпферных контуров по продольной и поперечной осям активные сопротивления демпферных контуров по продольной и поперечной осям постоянная времени механической инерции электрической машины момент турбины электромагнитный момент генератора угол поворота вращающихся осей, по отношению к неподвижным осям внутренний угол генератора угол нагрузки угловая частота вращения поля статора. При переходе к относительным единицам в качестве базовых приняты номинальные значения соответствующих величин. Используя известные нелинейные соотношения между потокосцеплениями и токами, после ряда громоздких, но несложных преобразований получаем описание синхронного генератора в форме 1, где векторы формируются следующим образом вектор производных статорных токов вектор токов вектор статорных напряжений где, индуктивные сопротивления обмотки возбуждения, генератора по продольной оси и демпферной обмотки по продольной оси. Вслед за математическими моделями отдельных элементов необходимо построить математическую модель их взаимодействия, которая должна отражать состав элементов и топологию ЭЭС. Математическая модель взаимодействия структурных элементов использует матрицу инцидентности, отражающую топологию рассматриваемой локальной системы электроснабжения. Представим взаимодействие элементов в виде следующего векторно-матричного уравнения для определения узловых напряжений на каждом шаге расчета, 3 где клеточная матрица инцидентности, клетками матрицы являются единичные, нулевые матрицы или матрицы преобразований координат блочная матрица проводимостей ветвей элементов, образующих систему транспонированная матрица инцидентности вектор искомых напряжений узлов вектор, полученный из правых частей уравнений элементов в форме 1 матрица, элементами которой являются нулевые клетки или клетки производных элементов матриц преобразования координат. Матрица составляется из матриц всех элементов моделируемой системы электроснабжения, записанных в форме 1, матрица составляется из правых частей уравнений элементов в форме 1 Полученная математическая модель обеспечивает расчет всех узловых напряжений системы электроснабжения по векторно-матричному уравнению 3 на текущем шаге расчета. Вслед за этим вновь решаются дифференциальные уравнения элементов 1 и находятся мгновенные значения токов каждого элемента. Процесс повторяется требуемое число шагов в течение всего расчета. В результате рассчитываются переходные процессы всех режимных параметров ЭЭС. Рассмотрим функциональность представленной методики на примере топологически простой системы рис. 1, где нет задающего узла и два генератора работают на общую линию связи. Положительное направление тока для каждой линии показано стрелками. Уравнения элементов генератор 1 4 генератор 2 5 линия связи . 6 Уравнение 3 в этом случае будет выглядеть следующим образом 7 где единичная матрица нулевая матрица матрица преобразования координат матрица производных по времени элементов матрицы угол между -, -осями первого и второго генераторов. Алгоритм расчета для примера на рис. 1 следующий. 1. Задаются параметры и начальные значения переменных всех элементов системы генераторов и линии связи. 2. По выражению 7 за один шаг рассчитываются векторы и напряжения первого и второго узлов ЭЭС. 3. Решением дифференциальных уравнений элементов 46 определяются значения токов, угловых скоростей и других переменных на первом шаге расчета. 4. По вычисленным значениям токов по уравнению 7 рассчитываются новые значения векторов и для следующего шага расчета. 5. Процедура повторяется в течение заданного числа шагов. Конфигурация моделируемой системы электроснабжения модифицируется за счет внесения изменений в матрицу инцидентности уравнения 3, благодаря чему пользователь имеет возможность формировать различные конфигурации моделируемых ЭЭС. Рассмотренный выше алгоритмический аппарат может быть проиллюстрирован структурной схемой рис. 2. На схеме обозначено система автоматического управления электростанцией механические мощности синхронных генераторов входные переменные моделей ГТУ угловые скорости свободных турбин выходные переменные ГТУ. Математическая модель взаимодействия структурных элементов использует для вычисления узловых напряжений токи элементов, подсчитанные на предыдущем шаге расчета. Узловые напряжения являются входными переменными для математических моделей элементов ЭЭС синхронные генераторы, трансформаторы, линии связи, статические нагрузки и т. п., которые вычисляют токи для следующего шага расчета. Дополнительные входы представляют собой дополнительные входные переменные элементов ЭЭС, например, для синхронных генераторов это напряжения возбуждения, вырабатываемые системами возбуждения и автоматическими регуляторами возбуждения АРВ. Поскольку электростанция может включать в себя несколько энергоблоков несколько ГТУ, необходимо предусмотреть отдельную САУ ЭС, выполняющую общие координирующие и согласующие функции. Как следует из представленной схемы, математические модели ГТУ должны поддерживать непрерывный обмен данными с остальными компонентами системы моделирования. И здесь разработчик сталкивается с необходимостью разрешения второй проблемы проблемы сопряжения программных сред моделирования. Как правило, используемые в настоящее время многорежимные математические модели ГТУ различного класса сложности созданы с помощью языка программирования Fortran, что обуFortran, что обу, что обусловлено ориентацией этого языка на вычисления. С другой стороны, программное обеспечение программно-вычислительного комплекса целесообразно разрабатывать на основе современных программных средств, например, используя DelDelphi. Необходимость включать модели ГТУ в со. Необходимость включать модели ГТУ в состав программно-вычислительного комплекса потребовала разработать специальную методику сопряжения программных сред. Рассмотрим суть предлагаемой методики. Использование модулей, написанных на языке Fortran, из приложения, написанного на DelDelphi, осуществляется в два шага. Каждый из этих шагов рассмотрим детально. правила оформления функции на языке Fortran в виде, допускающем их испольFortran в виде, допускающем их исполь в виде, допускающем их использование. Рассмотрим вызов фортрановской функции Единственный способ вызывать функцию, написанную на языке Fortran, это оформить ее как DLL. Для совместимости с программной средой Delphi необходимо выполнить следующие дей необходимо выполнить следующие действия. 1. Явно указать соглашение о вызовах и экспортировать имя функции 2. Для всех параметров и переменных указать их тип, совместимый с типами Delphi. Типы Integer совпадают в обоих языках, а типу Double в Delphi будет соответствовать -EAL8 в Fortran. Для того чтобы гарантировать правильный способ описания всех переменных, рекомендуется в начале модуля вставить строчку 3. Принять меры для доступа к COMMON-блокам. Для этого необходимо, во-первых, сделать их имена доступными, т. е. экспортировать их имена так же, как имя функции во-вторых, описать явно переменные, входящие в COMMON-блоки. Так, вместо описания получим 4. Те же самые правила нужно применить для всех функций и процедур, вызываемых из головной функции. 5. Особые преобразования нужно применять, если в исходном тексте использовалась встроенная функция, параметрами которой являются числа с плавающей точкой, отличной от -EAL8. Например, если в исходном тексте использовалась функция ALOG, параметром и результатом которой является -EAL4, необходимо проде-EAL4, необходимо проде4, необходимо проделать следующие преобразования. Пусть имеем исходный текст переменные T2, T1 описываются по умолчанию. После преобразования получаем следующий фрагмент После трансляции и построения библиотеки DLL ее нужно разместить в том же каталоге, что приложение на Delphi, которое будет ее использоDelphi, которое будет ее использо, которое будет ее использовать. В рассматриваемом случае имя библиотеки GTD.dll вызов процедур и функций, написанных на языке Fortran из Delphi-программы. Для выполнения функции, находящейся в DLL, нужно, во-первых, импортировать эту функцию, описав ее прототип обратим внимание, что параметры необходимо описывать как параметры-переменные, что совпадает с соглашениями Fortran. Второй этап более неочевиден следует обеспечить доступ из программы к переменным, описанным в общих блоках библиотек. Для этого требуется совершить следующие действия. 1. Импортировать имена общих блоков. Единственный способ импортировать такие имена это описать их как функции, тем самым обмануть транслятор и получить фактически адрес общего блока внутри dll. Для общих блоков D и -EZ1 получим описание 2. Для доступа к переменным, входящим в общий блок, нужно подготовить структуры, соответствующие общим блокам. Для этого опишем типы, соответствующие импортированным общим блокам типы, соответствующие блокам D и -EZ1, будут иметь названия TD и T-EZ1 3. Зарезервировать переменные, которые впоследствии будут использованы для доступа к переменным, располагающимся в общих блоках 4. Подготовить функцию для получения адреса общего блока, описанного как функция Поясним, что именно помещается в адрес перехода Pn2, проиллюстрировав на примере. Инструкция вызова фиктивной функции D выгляD выгля выглядит следующим образом рис. 3. В результате вызова функции GetAdrCOMGetAdrCOMMON мы получаем адрес общего блока, фактиче мы получаем адрес общего блока, фактически располагаемого в памяти, выделенной dll. 5. И последнее при инициализации модуля получить указатели на описанные общие блоки Теперь, чтобы получить доступ, например, к переменной DT внутри блока D, нужно воспольDT внутри блока D, нужно восполь внутри блока D, нужно воспольD, нужно восполь, нужно воспользоваться следующим фрагментом Если переменная внутри блока является массивом, то для доступа к -му элементу массива воспользуемся следующим фрагментом показываем на примере массива CP1 из -EZ1 Вычислительная эффективность математической модели, построенной с использованием описанной методики сопряжения, была проверена экспериментально. Для большинства существенных переходных процессов максимально допустимый шаг расчета для модели ГТУ составляет 1 мс, для ЭЭС 10 мкс. Например, характерный переходный процесс продолжительностью 1 с для системы из 6 синхронных генераторов и распределенной комплексной электрической нагрузки рассчитывается с помощью одноточечного метода Рунге Кутта четвертого порядка за время 14,6 мин на базе Pentium IV, 3 ГГц персонального компьютера. Применение многоточечных методов АдамсаБашфорта, АдамсаМоултона позволяет сократить время расчета, для чего можно применить так называемое распределенное моделирование на нескольких компьютерах 8. Основанием для выбора метода и шага расчета является вид возмущения, налагаемого на энергосистему. Требования к вычислительным ресурсам для разработанных программно-вычислительных комплексов Microsoft Windows XP, Windows Vista Pentium IV, 3 ГГц ОЗУ 512 MБ. График характерного переходного процесса представлен на рис. 4. Переходный процесс отражает изменение напряжения на внешних зажимах генератора при удаленном коротком замыкании до и после 0,03 c включения в работу САУ. Напряжение изc включения в работу САУ. Напряжение из включения в работу САУ. Напряжение измеряется в относительных единицах, время в секундах. Время расчета на базе Pentium IV, 3 ГГц персонального компьютера составляет 0,6 мин. Предложенные методики математического моделирования и сопряжения программных сред обеспечивают непосредственное включение математических моделей энергетических ГТУ в состав программно-вычислительных комплексов, предназначенных для проектирования и тестирования САУ ГТУ. 