СОВМЕСТНЫЙ СПИСОЧНЫЙ ДЕКОДЕР ТУРБОКОДА  И ВОКОДЕРА AMR-NB ДЛЯ СЕТЕЙ ЧЕТВЕРТОГО ПОКОЛЕНИЯ 

Постановка проблемы:  на практике декодирование кодера канала и источника в системах связи производится независимо, что ограничивает возможность использования избыточности источника для улучшений производительности  приемника в целом. Целью работы является разработка алгоритма совместного декодирования турбокода и кодера  источника с избыточностью для сетей четвертого поколения.  Результаты:  предложен совместный списочный декодер  турбокода и кодера источника. При построении декодера учитывается тот факт, что в сетях четвертого поколения данные  источника, т. е. коррелированные данные, составляют лишь часть информационного слова. Поэтому в первую очередь  целью алгоритма является корректное декодирование коррелированных бит за счет избыточности и списочного декодирования. После этого влияние правильно декодированных бит распространяется на все информационное слово благодаря перемежителю в схеме турбокода. Критерием выбора правильного слова при списочном декодировании является  корректность проверки CRC. Результаты работы нового декодера представлены для турбокода стандарта 3GPP LTE и вокодера AMR-NB. Выигрыш, достигаемый при использовании нового алгоритма по сравнению с обычным итеративным  декодером, составляет 0,15 дБ по вероятности ошибки на декодированное слово. В свою очередь, это соответствует  улучшению качества принимаемой речи в 0,4—0,15 MOS.  Практическая значимость:  предложенный алгоритм позволяет уменьшить вероятность ошибки на декодированное слово и значительно улучшить качество принимаемой речи,  что является важной и актуальной задачей в современных беспроводных сетях. Ключевые слова  — турбокод, совместное декодирование, кодирование речи, сети четвертого поколения. 

С точки зрения теории кодирования и теории информации задачу сжатия источника и передачи информации по каналу связи можно решать независимо без потери качества для системы передачи в целом 1. Однако теоремы кодирования, исследующие потенциальные возможности систем связи, доказываются в условиях отсутствия ограничений на длину кодового слова, т. е. в отсутствие ограничений на сложность кодирующих и декодирующих устройств. На практике такие ограничения часто являются принципиальными. Поэтому задачи совместного кодирования и декодирования источника и канала связи вызывают значительный теоретический и практический интерес. Особенно это касается передачи голосовых и видеоданных, при сжатии которых не от всей избыточности удается избавиться. В настоящей статье предложен алгоритм совместного декодирования канала и источника СДКИ, основанный на применении турбодекодирования. Рассматривается использование предложенного алгоритма в сетях четвертого поколения на примере передачи речи в стандарте 3GPP LTE 2. Рассмотрим кодер источника с фиксированной длиной, выходом которого являются пакеты данных, которые в дальнейшем поступают на кодер канала. Обозначим такой пакет как, где это -й символ пакета длиной бит. Избыточность, связанная с различной вероятностью появления символов на выходе кодера источника, может быть использована как априорная информация на входе декодера канала. Поэтому наибольший интерес вызывает избыточность, которая обусловлена межсимвольной корреляцией и определяется вероятностями, . Если, 12, то зависимости нет. В противном случае говорят о наличии последней. Чаще всего корреляция между символами рассматривается как марковский процесс первого порядка, который характеризуется лишь связями между соседними символами 1 Во многих случаях это предположение верно, в частности, для речевых кодеков. Марковский процесс, описывающий источник, можно представить как полносвязную решетку, которая состоит из секций и где каждый переход соответствует выходу символа кодера источника. Пример такой решетки представлен на рис. 1, где через обозначено состояние решетки в -й момент времени и 12 . По аналогии со сверточными кодами для оценки значений символов при известных переходных вероятностях может быть использован алгоритм BCJR 3. Для совместного декодирования кодеров источника и канала существует два способа. Первый связан с построением единой решетки, по которой производится декодирование. Однако данный подход является трудоемким и не реализуемым в практических системах. Второй подход основан на использовании турбопринципа 4, в ходе которого декодеры канала и источника итеративно обмениваются информацией, за счет чего достигается лучшее качество приема. В данной статье рассматривается второй метод совместного декодирования. Далее показано, как происходит декодирование источника, и представлена схема совместного итеративного декодера. Рассмотрим модель системы, где выход источника описывается марковским процессом первого порядка с состояниями. Битовое представление последовательности символов обозначим как, где битовое представление -го символа. Пусть канал связи является каналом с аддитивным белым гауссовым шумом АБГШ 5, тогда если для передачи используется двоичная фазовая манипуляция, то принятая последовательность будет выглядеть как, где Соответственно где а независимая гауссова величина с нулевым математическим ожиданием и дисперсией . Плотность условной вероятности значения гауссова канала описывается как 2 Поскольку канал без памяти, то для символа можно написать следующее выражение 3 Используя алгоритм BCJR на декодере источника, можно оценить апостериорные вероятности для всех возможных символов в каждой секции решетки. Символ, для которого значение является наибольшим, считается правильным. Рассчитаем вероятность того, что -й символ последовательности при условии равен некоторому значению . В соответствии с алгоритмом BCJR эта вероятность может быть рассчитана как где, значения, обозначающие символы, принятые до момента времени, в -й момент и после него соответственно. Обычно вероятности, обозначают как, 3. Для расчета и существуют рекуррентные выражения 5 6 Начальные значения и обычно устанавливают равными 1 . Значение, называется метрикой перехода и вычисляется как 7 где, легко находится с помощью выражения 3. Вероятность есть не что иное, как переходная вероятность рассматриваемого марковского процесса, которая считается известной. Таким образом, можно рассчитать вероятности символов в каждой секции решетки. В дальнейшем из вычисленных значений можно получить вероятности бит каждого символа следующим образом где 0, 1 значение бита. Необходимо, чтобы при совместном декодировании кодера канала и источника декодер канала мог обрабатывать мягкие значения и учитывать априорные значения бит. Примером такого кода может быть сверточный код или турбокод, 4 где для декодирования используется алгоритм Log-MAP или Scaled Max-Log-MAP 6. При совместном декодировании сверточного кода и источника с избыточностью можно использовать итеративную схему, которая описана в работе 7. В данном случае выходные значения декодера сверточного кода можно представить как произведение априорной и канальной составляющих вероятности Для декодера источника выходные значения также можно записать в виде где а составляющая, которая известна благодаря избыточности источника. Таким образом, при итерировании совместного алгоритма два декодера обмениваются канальными и внешними составляющими, т. е. и Однако данная техника может быть улучшена для турбокода. Основными элементами турбокода являются два рекурсивных систематических сверточных кода компонентные коды, связанных между собой перемежителем 4. В качестве декодера используется итеративная схема, ядром которой является декодер компонентного кода с мягким входом и выходом. Для улучшения параметров совместного декодирования декодер источника необходимо внедрить непосредственно в итеративный процесс турбодекодирования. Итоговая схема будет выглядеть, как показано на рис. 2. Большое распространение турбокоды получили за счет использования в связи четвертого поколения 3GPP LTE 8. Сеть LTE организована как сеть с коммутацией пакетов, и все данные, в том числе и голосовые, используют IP-протокол для передачи. Таким образом, при организации совместного декодирования необходимо учитывать специфику формирования пакета данных на входе кодера канала. В системах с коммутацией пакетов данные с выхода кодера источника обрабатываются на сетевом IP, транспортном TCP UDP и нижестоящих уровнях, после чего поступают на физический уровень. Прежде чем закодировать данные, к ним прибавляют проверку CRC для обнаружения ошибок декодирования на приемнике. В результате этих операций совместное декодирование может быть использовано лишь для части информационного слова, что сильно снижает эффективность декодирования рис. 3. При совместном декодировании такого информационного слова биты источника декодируются лучше за счет имеющейся избыточности, при этом они влияют на рядом стоящие биты. В случае турбодекодирования за счет использования перемежителя можно говорить о том, что биты источника оказывают свое влияние на все слово. Для улучшения параметров декодирования в такой системе предлагается следующий алгоритм. Допустим, что благодаря избыточности удалось успешно декодировать символы источника. Тогда, чтобы увеличить влияние этих бит на все остальные, можно установить их надежности равными, в зависимости от значения бита. В дальнейшем такие биты будем называть пилотными, по аналогии с пилотными сигналами. Однако не всегда за счет избыточности данные источника удается успешно декодировать. Но, учитывая то, что символы источника декодируются с меньшей вероятностью ошибки на бит, чем остальные, оставшиеся ошибки в битах источника можно исправить за счет использования списочного декодера Витерби 9 на решетке первого компонентного кода турбокода. Но списочный декодер Витерби нужно использовать не на всей решетке, а лишь в окне, где расположены данные с выхода кодера источника. В результате будет получен список последовательностей, из которых необходимо выбрать правильную. После этого, приняв ее как пилотную, выполнить несколько итераций обычного турбодекодера, чтобы увеличить влияние пилотных бит на остальное информационное слово. Если нет возможности определить корректность декодированных бит источника, можно использовать параллельный списочный подход 10, т. е. предположить, что каждая последовательность является корректной, принять эти значения как пилотные и независимо для каждого элемента списка выполнить итерации обычного турбодекодера. Декодирование считается успешным, если проверка контрольной суммы CRC, добавленной на физическом уровне, является корректной. С учетом всех замечаний для обоих случаев представим схему результирующего декодера рис. 4, . Для оценки производительности предложенного декодера рассмотрим систему 3GPP LTE. Поскольку передача речи является одним из основных пунктов дохода современных операторов, то качество принимаемой речи играет важную роль. Поэтому в качестве источника принят вокодер AMR-NB, который используется для сжатия голоса в сетях LTE. Для передачи голоса в 3GPP LTE кодеком по умолчанию является AMR-NB. Он работает на основе алгоритма ACELP 11 и поддерживает скорости кодирования от 4,75 до 12,2 Кбитс, но основным является режим 12,2 Кбитс, который будет обсуждаться далее. В рамках вокодера AMR определен алгоритм VAD обнаружения фреймов, которые не содержат речевого сигнала и для передачи которых используются короткие пакеты. Такие пакеты не рассматривались в ходе анализа. Для кодирования речи алгоритм AMR-NB делит входной речевой сигнал на фреймы по 20 мс и для каждого извлекает параметры коэффициенты артикуляторного фильтра. После этого фрейм делится на 4 сабфрейма, для которых вычисляются индексы и коэффициенты усиления фиксированной и адаптивной кодовых книг. Поскольку коэффициент адаптивной кодовой книги характеризует период основного тона человека, который мало изменяется во времени, то во втором и четвертом сабфреймах каждого фрейма передается лишь значение приращения относительно предыдущего сабфрейма. Декодер вокодера AMR-NB показан на рис. 5 12. Все вычисленные параметры обладают большой избыточностью, поэтому перед передачей они предобрабатываются и квантуются, что приводит к заметному уменьшению размера передаваемой информации и к тому, что в параметрах, относящихся к артикуляторному фильтру, от имеющейся избыточности удается практически полностью избавиться. Однако оставшуюся корреляцию остальных параметров, для которых ниже представлены результаты измерения символьной корреляции, можно использовать для улучшения параметров приема. Битовый поток с выхода вокодера делится и группируется в три класса A, B и C. В классе A находятся наиболее важные для восстановления речи биты, которые соответствуют наиболее коррелированным данным. В класс B и C входят биты менее важные и чувствительные к ошибкам и относящиеся к некоррелированным данным. После этого к сформированному AMRпакету добавляется заголовок RTP-пакета и RTPзаголовок. Стандартом 12 предусмотрено два возможных формата заголовка RTP-пакета, один из которых включает 8-битовую проверку CRC для бит класса A. Так как голосовые пакеты чувствительны к заголовкам, на транспортном уровне для передачи используются протоколы UDP и IP. Перед поступлением на физический уровень голосовой пакет с добавленными заголовками обрабатывается на PDCP-, RLCи MAC-уровнях, которые добавляют свои собственные 12-байтовые заголовки. Поскольку общая длина RTP UDPIP заголовков достаточно велика, а сами эти заголовки обладают большой избыточностью, на PDCP-уровне они подвергаются компрессии с помощью алгоритма ROHC, после чего их длина с 4060 Б уменьшается до 23 Б. На физическом уровне к сформатированному пакету добавляется CRC длиной 24 бита CRC24B 8, после чего пакет кодируется. С учетом всех уровней обработки длина AMR-пакета увеличивается с 244 бит до минимальных 320 бит на входе кодера канала. Учитывая тот факт, что все коррелированные данные находятся в битах класса A, на входе первого компонентного кода информационное слово будет выглядеть, как показано на рис. 6. Также на рисунке изображено окно, для которого будет выполняться оконный списочный алгоритм Витерби предложенного алгоритма с учетом использования CRC в заголовке RTP-пакета, в противном случае окном являются лишь биты класса A. Для оценки избыточности на выходе речевых кодеков исследованы мужская и женская русская речь длительностью от 1,5 до 2 ч. Оба сигнала были сжаты с помощью алгоритма AMR-NB, и была собрана статистика по различным параметрам, которые в дальнейшем рассматривались отдельно. Зависимость параметров рассматривалась в рамках одного фрейма и между ними. Для оценки корреляции в рамках одного фрейма с помощью собранной статистики оценены вероятности и где возможное значение -го параметра в -м фрейме. Также рассчитаны вероятности и описывающие корреляцию между фреймами. С помощью полученных вероятностей для различных параметров рассчитаны энтропия и условная энтропия для коррелированных параметров Избыточность была измерена как разность между количеством бит, которые используются по стандарту для передачи, и измеренным значением энтропии В результате анализа получено, что наибольшей корреляцией обладает индекс адаптивной кодовой книги, поскольку период основного тона, который он характеризует, мало меняется во времени. Также большой межфреймовой зависимостью обладают первый и второй индексы, отвечающие за передачу информации о коэффициентах артикуляторного фильтра. Меньшей избыточностью обладают коэффициенты усиления обеих кодовых книг. Во всех остальных параметрах избыточность практически отсутствует, в то время как кодовые последовательности фиксированной кодовой книги имеют случайный характер. Также из полученных результатов сделан вывод, что биты, которые соответствуют наиболее коррелированным параметрам, относятся к классу A AMR-пакета. Поскольку для женского и мужского исследуемых голосов получены практически одинаковые результаты, то приведены замеры лишь для мужской речи. Примеры измерений для наиболее коррелированных параметров для межфреймовой и внутрифреймовой корреляции приведены в таблице, где число бит, используемых для передачи того или иного параметра по стандарту. Для сравнения обычного совместного турбодекодера и предложенного алгоритма была использована модель, представленная на рис. 7. При моделировании предполагалось, что передаются лишь голосовые пакеты, в то время как для коротких VAD-пакетов передача всегда считалась успешной. Заголовки считались случайными. В качестве компонентного декодера турбокода рассмотрен алгоритм Scaled Max-Log-MAP с взвешивающим коэффициентом, равным 0,75. Итерирование турбодекодера заканчивалось после восьми итераций, поскольку дальнейшее итерирование декодера практически не дает прироста производительности. Пакет считался принятым успешно, если корректной была контрольная сумма CRC24B. Для предложенного списочного совместного алгоритма после построения списка выполнялось еще 8 итераций обычного турбодекодера в соответствии со схемами рис. 4, и 5. Размерность списка обозначена как и при моделировании была установлена 16. В качестве критерия сравнения алгоритмов использована вероятность ошибки на пакет FER, однако данный критерий не отображает улучшения качества декодированной речи. Поэтому было проведено сравнение с использованием критерия MOS Mean Option Score 13, результаты которого принимают следующие значения 1 плохое 2 низкое 3 удовлетворительное 4 хорошее 5 прекрасное. Для расчета значения MOS может быть использован алгоритм PESQ 14, результат которого обозначают как MOS-LQO. Результаты моделирования для случая с использованием CRC в заголовке и без последнего были близки, поэтому графики рис. 8, приведены для случая с использованием CRC для класса A бит. Как видно из графиков, предложенный алгоритм позволяет получить выигрыш в 0,15 дБ по сравнению с обычным декодером, что эквивалентно выигрышу по MOS от 0,4 до 0,15 пункта. В частности видно, что за счет использования предложенного алгоритма качество принимаемой речи переходит из разряда удовлетворительное в разряд хорошее. В данной работе представлен алгоритм совместного декодирования кодера канала и источника для сетей четвертого поколения. По результатам моделирования видно, что предложенный совместный списочный декодер турбокода показывает лучшую производительность, чем независимый и обычный совместный декодеры, что проиллюстрировано на примере вокодера AMR-NB. Данный алгоритм может быть использован и для других источников, необходимым является лишь оценка избыточности таких источников для выполнения совместного декодирования. Работа выполнена по плану работ, представленному в заявке 14-11-00644 на конкурс грантов Российского научного фонда Проведение фундаментальных научных исследований и поисковых научных исследований отдельными научными группами. 